import{i as xa,a as Ne,s as hn,b as _k,c as wa,d as Ra,T as Yn,g as Ak,e as Ei,_ as ae,D as re,f as ye,h as fe,j as he,k as ke,l as be,m as C,n as Il,o as oe,p as Ek,R as ze,G as al,q as b,r as v,t as R,I as x,E as Xl,u as Kn,v as ee,w as Vd,x as Nd,y as Ve,z as Le,A as Fe,B as Fo,C as Co,N as Ya,F as Tn,P as Mn,H as xn,J as Ln,K as Xn,L as Va,M as es,O as mn,Q as nn,S as Zn,U as $e,V as ln,W as je,X as Te,Y as Ee,Z as la,$ as ll,a0 as $n,a1 as Oe,a2 as we,a3 as me,a4 as ta,a5 as ja,a6 as zd,a7 as Dn,a8 as $d,a9 as In,aa as tn,ab as ns,ac as xl,ad as Od,ae as jd,af as On,ag as ve,ah as Re,ai as jn,aj as $t,ak as _e,al as gn,am as ua,an as wk,ao as Mk,ap as Rk,aq as Qd,ar as Er,as,at as wi,au as Vk,av as Nk,aw as ls,ax as Ko,ay as oi,az as zk,aA as rn,aB as qe,aC as Ma,aD as $k,aE as Ok,aF as Bd,aG as qd,aH as To,aI as fn,aJ as fa,aK as cn,aL as Ll,aM as Dl,aN as na,aO as Bn,aP as dn,aQ as jk,aR as Qk,aS as Bk,aT as qk,aU as Cn,aV as ea,aW as Uk,aX as Ja,aY as Hk,aZ as Ud,a_ as Hd,a$ as Qa,b0 as ts,b1 as is,b2 as Gk,b3 as rs,b4 as Wk,b5 as Jk,b6 as Zk,b7 as Xk,b8 as Yk,b9 as e0,ba as n0,bb as a0,bc as l0,bd as t0,be as Ot,bf as i0,bg as _l,bh as r0,bi as qn,bj as Qn,bk as s0,bl as ss,bm as os,bn as He,bo as Ge,bp as We,bq as jl,br as o0,bs as ha,bt as ds,bu as En,bv as ma,bw as Mi,bx as Ri,by as cs,bz as d0,bA as Gd,bB as Wd,bC as Vi,bD as La,bE as Ql,bF as wr,bG as zt,bH as Jd,bI as st,bJ as c0,bK as Zd,bL as u0,bM as ut,bN as us,bO as Al,bP as Rn,bQ as m0,bR as Qt,bS as yt,bT as Bt,bU as Ti,bV as Xd,bW as Yd,bX as ec,bY as g0,bZ as qt,b_ as ga,b$ as tl,c0 as p0,c1 as y0,c2 as Ol,c3 as f0,c4 as mt,c5 as nc,c6 as Hl,c7 as ac,c8 as h0,c9 as k0,ca as b0,cb as lc,cc as S0,cd as Bl,ce as v0,cf as kn,cg as ms,ch as Ni,ci as zi,cj as $i,ck as Mr,cl as Ut,cm as Rr,cn as Oi,co as Ht,cp as Un,cq as gs,cr as F0,cs as tc,ct as ic,cu as Po,cv as Io,cw as C0,cx as Vr,cy as ji,cz as rc,cA as gt,cB as ps,cC as K0,cD as T0,cE as il,cF as P0,cG as I0,cH as ft,cI as x0,cJ as L0,cK as D0,cL as sc,cM as ht,cN as oc,cO as Qi,cP as kt,cQ as ia,cR as dc,cS as ka,cT as Na,cU as Cl,cV as el,cW as cc,cX as ys,cY as _0,cZ as A0,c_ as uc,c$ as E0,d0 as mc,d1 as w0,d2 as gc,d3 as fs,d4 as pc,d5 as Gl,d6 as hs,d7 as ks,d8 as yc,d9 as M0,da as R0,db as ba,dc as Kl,dd as Nr,de as cr,df as bs,dg as fc,dh as V0,di as N0,dj as z0,dk as $0,dl as O0,dm as j0,dn as xo,dp as cl,dq as Ye,dr as Q0,ds as B0,dt as hc,du as kc,dv as Ss,dw as Bi,dx as zr,dy as q0,dz as U0,dA as $r,dB as H0,dC as G0,dD as bc,dE as Sc,dF as W0,dG as Or,dH as vc,dI as vs,dJ as Fs,dK as J0,dL as Lo,dM as Z0,dN as Fa,dO as Ca,dP as Ka,dQ as Ta,dR as X0,dS as Y0,dT as eb,dU as nb,dV as ab,dW as Ba,dX as qa,dY as ul,dZ as Gt,d_ as lb,d$ as ki,e0 as tb,e1 as ib,e2 as rb,e3 as sb,e4 as Cs,e5 as ob,e6 as db,e7 as cb,e8 as qi,e9 as Fc,ea as Ks,eb as ub,ec as mb,ed as Ts,ee as Ps,ef as gb,eg as ot,eh as pb,ei as yb,ej as Ui,ek as fb,el as hb,em as kb,en as Is,eo as Pi,ep as bb,eq as Sb,er as Cc,es as kl,et as bi,eu as vb,ev as Fb,ew as Kc,ex as Cb,ey as Kb,ez as Yl,eA as Tb,eB as Pb,eC as Ib,eD as xb,eE as Lb,eF as Si,eG as Do,eH as Db,eI as ur,eJ as _b,eK as Ab,eL as _o,eM as Ao,eN as Eb,eO as wb,eP as Mb,eQ as Rb,eR as Vb,eS as Tc,eT as Pc,eU as Nb,eV as zb,eW as $b,eX as Ob,eY as jb,eZ as Qb,e_ as Bb,e$ as qb,f0 as Ub,f1 as Hb,f2 as Gb,f3 as Wb,f4 as Eo,f5 as wo,f6 as Jb,f7 as Zb,f8 as Ua,f9 as ml,fa as xs,fb as Ic,fc as xc,fd as Mo,fe as Ro,ff as bt,fg as St,fh as vt,fi as Ls,fj as Hi,fk as Lc,fl as Dc,fm as _c,fn as Ac,fo as xt,fp as Ec,fq as Xb,fr as Yb,fs as xe,ft as eS,fu as nS,fv as aS,fw as lS,fx as tS,fy as iS,fz as rS,fA as sS,fB as wc,fC as oS,fD as dS,fE as cS,fF as uS,fG as mS,fH as gS,fI as pS,fJ as yS,fK as fS,fL as hS,fM as Vo,fN as kS,fO as bS}from"./components-BKHboE32.js";import{J as Wt,K as Mc,M as Gi,u as El,b as le,bP as Ds,c as _s,bQ as SS,bR as As,e as en,bS as Sa,o as Y,f as et,l as ca,bT as ra,bU as Tl,bV as Je,bW as Nn,bX as zn,bY as Za,bZ as Xa,b_ as vi,b$ as Lt,r as f,j as e,N as Jt,br as za,i as o,V as te,R as Da,c0 as Ue,O as T,ag as se,b4 as Qe,b5 as de,ao as bn,b6 as Vn,b8 as Be,X as J,h as K,c1 as wn,aU as Xe,ak as sn,c2 as jr,an as H,Y as ge,Z as Ae,b3 as Ha,$ as Se,c3 as vS,c4 as CS,c5 as KS,aj as nt,c6 as No,c7 as Rc,al as Vc,am as Nc,c8 as zc,c9 as Es,ca as TS,aY as wl,cb as on,ad as ws,bg as Fl,W as rl,cc as PS,d as IS,b9 as va,cd as xS,bb as LS,ce as DS,q as di,bw as Me,bv as Ft,bf as Zt,bm as $a,bk as An,bl as sl,cf as _n,k as zo,bp as $c,n as _S,cg as AS,ch as mr,ci as gr,cj as Dt,aI as Ii,ck as ES,aV as Xt,cl as Ms,bh as Oc,cm as wS,a7 as xi,cn as MS,co as $o,cp as RS,cq as VS,cr as NS,cs as zS,ct as $S,cu as OS,cv as jS,cw as QS,cx as BS,cy as Pl,g as qS,cz as jc,cA as Qc,cB as US,cC as HS,cD as GS,b1 as Wi,cE as WS,cF as JS,D as Bc,cG as ZS}from"./vendor-CsMRTpYT.js";import{g as Ml,i as Rl,j as XS,E as qc,R as Vl,k as Rs,d as YS,p as Yt,q as Uc}from"./vendor-codemirror-mdRc_AQb.js";import{P as Vs,C as Ns,T as pn,a as zs,R as yn,b as Sn,X as vn,Y as an,B as Ze,L as sa,c as oa,d as e1,e as Pa,f as at,A as jt,g as Hc,h as Gc}from"./vendor-recharts-Dt4RZHaT.js";const n1=({projectId:n,tableId:a})=>`arize-phoenix-tracing-${n}-${a}`,a1=n=>{const a=l=>({...n,columnVisibility:{metadata:!1},columnSizing:{metadata:200},annotationColumnVisibility:{},setColumnVisibility:t=>{l({columnVisibility:t},!1,{type:"setColumnVisibility"})},setAnnotationColumnVisibility:t=>{l({annotationColumnVisibility:t},!1,{type:"setAnnotationColumnVisibility"})},setColumnSizing:t=>{typeof t=="function"?l(i=>({columnSizing:t(i.columnSizing)}),!1,{type:"setColumnSizing"}):l({columnSizing:t},!1,{type:"setColumnSizing"})}});return Wt()(Mc(Gi(a,{name:"tracingStore"}),{name:n1(n)}))},Qr={OPENAI:"OpenAI",AZURE_OPENAI:"Azure OpenAI",ANTHROPIC:"Anthropic",GOOGLE:"Google",DEEPSEEK:"DeepSeek",XAI:"xAI",OLLAMA:"Ollama",AWS:"AWS Bedrock"},Ji="OPENAI",Wc="gpt-4o",Jc="user",l1=["2024-10-01-preview","2024-09-01-preview","2024-08-01-preview","2024-07-01-preview","2024-06-01","2024-05-01-preview","2024-04-01-preview","2024-03-01-preview","2024-02-15-preview","2024-02-01","2023-10-01-preview","2023-09-01-preview","2023-08-01-preview","2023-07-01-preview","2023-06-01-preview","2023-05-15","2023-03-15-preview"],Fi={user:["user","human"],ai:["assistant","bot","ai","model"],system:["system","developer"],tool:["tool"]},ol={OPENAI:[{envVarName:"OPENAI_API_KEY",isRequired:!0}],AZURE_OPENAI:[{envVarName:"AZURE_OPENAI_API_KEY",isRequired:!0}],ANTHROPIC:[{envVarName:"ANTHROPIC_API_KEY",isRequired:!0}],GOOGLE:[{envVarName:"GEMINI_API_KEY",isRequired:!0}],DEEPSEEK:[{envVarName:"DEEPSEEK_API_KEY",isRequired:!0}],XAI:[{envVarName:"XAI_API_KEY",isRequired:!0}],OLLAMA:[],AWS:[{envVarName:"AWS_ACCESS_KEY_ID",isRequired:!0},{envVarName:"AWS_SECRET_ACCESS_KEY",isRequired:!0},{envVarName:"AWS_SESSION_TOKEN",isRequired:!1}]},t1=4,i1="Unable to parse span input messages, expected messages which include a role and content.",r1="Unable to parse span output messages, expected messages which include a role and content.",s1="Unable to parse span output expected output.value to be present.",o1="Unable to parse span attributes, attributes must be valid JSON.",d1="Unable to parse model config, expected llm.model_name to be present.",c1="Unable to parse model config, expected llm.invocation_parameters JSON string to be present.",u1="Unable to parse invocation parameters response_format, expected llm.invocation_parameters.response_format to be a well formed json object or undefined.",m1="Unable to parse tools, expected tools to be an array of valid tools.",g1="Unable to parse prompt template variables, expected prompt template variables to be a valid JSON object string.",Oo={AZURE_OPENAI:[],ANTHROPIC:["claude"],OPENAI:["gpt","o1"],GOOGLE:["gemini"],DEEPSEEK:["deepseek"],XAI:["grok"],OLLAMA:[],AWS:["nova","titan"]},nl="TOOL_CHOICE",dt="tool_choice",Gn="RESPONSE_FORMAT",Wn="response_format",p1=[nl,Gn],y1=El([le(),Ds(),_s(),SS()]),Wl=As(()=>El([y1,en(Wl),Sa(Wl)])),jo=Y({type:et(["string","number","boolean","object","array","null","integer"]).describe("The type of the parameter"),description:le().optional().describe("A description of the parameter"),enum:en(le()).optional().describe("The allowed values")}).passthrough().describe("A map of parameter names to their definitions"),ei=Y({type:ca("object"),properties:Sa(El([jo,Y({anyOf:en(jo)}).describe("A list of possible parameter names to their definitions")])).optional(),required:en(le()).optional().describe("The required parameters"),additionalProperties:_s().optional().describe("Whether or not additional properties are allowed in the schema")}).passthrough(),Ct=Y({type:ca("function").describe("The type of the tool"),function:Y({name:le().describe("The name of the function"),description:le().optional().describe("A description of the function"),parameters:ei.extend({strict:_s().optional().describe("Whether or not the arguments should exactly match the function definition, only supported for OpenAI models")}).describe("The parameters that the function accepts")}).passthrough().describe("The function definition")}).passthrough(),f1=ra(Ct,{removeAdditionalStrategy:"passthrough"}),Zi=Y({name:le(),description:le(),input_schema:ei}),h1=ra(Zi,{removeAdditionalStrategy:"passthrough"}),Xi=Y({toolSpec:Y({name:le(),description:le().min(1),inputSchema:Y({json:ei})})}),k1=ra(Xi,{removeAdditionalStrategy:"passthrough"}),Yi=Y({name:le(),description:le().optional(),parameters:ei}),b1=ra(Yi,{removeAdditionalStrategy:"passthrough"}),S1=Xi.transform(n=>({type:"function",function:{name:n.toolSpec.name,description:n.toolSpec.description,parameters:n.toolSpec.inputSchema.json}})),v1=Ct.transform(n=>({toolSpec:{name:n.function.name,description:n.function.description??n.function.name,inputSchema:{json:n.function.parameters}}})),F1=Zi.transform(n=>({type:"function",function:{name:n.name,description:n.description,parameters:n.input_schema}})),C1=Ct.transform(n=>({name:n.function.name,description:n.function.description??n.function.name,input_schema:n.function.parameters})),K1=Yi.transform(n=>({type:"function",function:{name:n.name,description:n.description,parameters:n.parameters}})),T1=Ct.transform(n=>({name:n.function.name,description:n.function.description,parameters:n.function.parameters})),$s=El([Ct,Zi,Xi,Yi,Wl]),Zc=n=>{const{success:a,data:l}=Ct.safeParse(n);if(a)return{provider:"OPENAI",validatedToolDefinition:l};const{success:t,data:i}=Zi.safeParse(n);if(t)return{provider:"ANTHROPIC",validatedToolDefinition:i};const{success:r,data:s}=Xi.safeParse(n);if(r)return{provider:"AWS",validatedToolDefinition:s};const{success:d,data:c}=Yi.safeParse(n);return d?{provider:"GOOGLE",validatedToolDefinition:c}:{provider:"UNKNOWN",validatedToolDefinition:null}},ci=n=>{const{provider:a,validatedToolDefinition:l}=Zc(n);switch(a){case"AZURE_OPENAI":case"OPENAI":return l;case"ANTHROPIC":return F1.parse(l);case"AWS":return S1.parse(l);case"GOOGLE":return K1.parse(l);case"UNKNOWN":return null;default:Ne()}},pr=({toolDefinition:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return n;case"ANTHROPIC":return C1.parse(n);case"AWS":return v1.parse(n);case"GOOGLE":return T1.parse(n);default:Ne()}};function P1(n){return{type:"function",function:{name:`new_function_${n}`,description:"a description",parameters:{type:"object",properties:{new_arg:{type:"string"}},required:[]}}}}function I1(n){return{name:`new_function_${n}`,description:"a description",input_schema:{type:"object",properties:{new_arg:{type:"string"}},required:[]}}}function x1(n){return{toolSpec:{name:`new_function_${n}`,description:"a description",inputSchema:{json:{type:"object",properties:{new_arg:{type:"string"}},required:[]}}}}}function L1(n){return{name:`new_function_${n}`,description:"a description",parameters:{type:"object",properties:{new_arg:{type:"string"}},required:[]}}}const D1=n=>{const a=$s.safeParse(n);return!a.success||a.data===null||!xa(a.data)?null:"function"in a.data&&xa(a.data.function)&&"name"in a.data.function&&typeof a.data.function.name=="string"?a.data.function.name:"name"in a.data&&typeof a.data.name=="string"?a.data.name:null},_1=n=>{const a=$s.safeParse(n);return!a.success||a.data===null||!xa(a.data)?null:"function"in a.data&&xa(a.data.function)&&"description"in a.data.function&&typeof a.data.function.description=="string"?a.data.function.description:"description"in a.data&&typeof a.data.description=="string"?a.data.description:null},Kt=Y({id:le().describe("The ID of the tool call"),type:ca("function").describe("The type of the tool call").default("function"),function:Y({name:le().describe("The name of the function"),arguments:Sa(Tl()).describe("The arguments for the function")}).describe("The function that is being called").passthrough()}),A1=en(Kt),E1=ra(A1,{removeAdditionalStrategy:"passthrough"}),ni=Y({toolUse:Y({toolUseId:le().describe("The ID of the tool call"),name:le().describe("The name of the tool"),input:Sa(Tl()).describe("The input for the tool")})}),w1=en(ni),M1=ra(w1,{removeAdditionalStrategy:"passthrough"}),Xc=Kt.transform(n=>({toolUse:{toolUseId:n.id,name:n.function.name,input:n.function.arguments}})),R1=ni.transform(n=>({id:n.toolUse.toolUseId,type:"function",function:{name:n.toolUse.name,arguments:n.toolUse.input}})),ai=Y({id:le().describe("The ID of the tool call"),type:ca("tool_use"),name:le().describe("The name of the tool"),input:Sa(Tl()).describe("The input for the tool")}).passthrough(),V1=en(ai),N1=ra(V1,{removeAdditionalStrategy:"passthrough"}),z1=ai.transform(n=>({id:n.id,type:"function",function:{name:n.name,arguments:n.input}})),Yc=Kt.transform(n=>({id:n.id,type:"tool_use",name:n.function.name,input:typeof n.function.arguments=="string"?{[n.function.arguments]:n.function.arguments}:n.function.arguments??{}})),eu=El([Kt,ai,ni,Wl]);en(eu);const nu=n=>{const{success:a,data:l}=Kt.safeParse(n);if(a)return{provider:"OPENAI",validatedToolCall:l};const{success:t,data:i}=ai.safeParse(n);if(t)return{provider:"ANTHROPIC",validatedToolCall:i};const{success:r,data:s}=ni.safeParse(n);return r?{provider:"AWS",validatedToolCall:s}:{provider:"UNKNOWN",validatedToolCall:null}},ql=n=>{const{provider:a,validatedToolCall:l}=nu(n);switch(a){case"AZURE_OPENAI":case"OPENAI":return l;case"ANTHROPIC":return z1.parse(l);case"AWS":return R1.parse(l);case"UNKNOWN":return null;default:Ne()}},Br=({toolCall:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return n;case"AWS":return Xc.parse(n);case"ANTHROPIC":return Yc.parse(n);case"GOOGLE":return n;default:Ne()}},au=(n,a)=>{const l=ql({id:n.toolCall.toolCallId,function:{name:n.toolCall.toolCall.name,arguments:hn(n.toolCall.toolCall.arguments).json||""}});return l?Br({toolCall:l,targetProvider:a}):null};function Qo(){return{id:"",type:"function",function:{name:"",arguments:{}}}}function $1(){return{id:"",type:"tool_use",name:"",input:{}}}const Os=Y({id:le().optional(),name:le().optional(),arguments:Sa(Tl()).optional(),function:Y({name:le().optional(),arguments:Sa(Tl()).optional()}).optional()});function O1(n){let a=n;typeof n=="string"&&(a=hn(n).json);const l=ql(a);if(l)return l.id;const t=Os.safeParse(a);return t.success?t.data.id??t.data.name??null:null}function j1(n){var i;let a=n;typeof n=="string"&&(a=hn(n).json);const l=ql(a);if(l)return l.function.name;const t=Os.safeParse(a);return t.success?((i=t.data.function)==null?void 0:i.name)??t.data.name??t.data.id??null:null}function Q1(n){var i;let a=n;typeof n=="string"&&(a=hn(n).json);const l=ql(a);if(l)return l.function.arguments;const t=Os.safeParse(a);return t.success?t.data.arguments??((i=t.data.function)==null?void 0:i.arguments)??null:null}const B1=Y({tool_call:Y({id:le().optional(),function:Y({name:le(),arguments:le()}).partial()}).partial()}).partial(),lu=Y({[Je.message]:Y({[Nn.role]:le(),[Nn.content]:El([le(),en(Sa(le(),Tl()))]).default(""),[Nn.contents]:en(Y({message_content:Sa(le())})).optional(),[Nn.tool_calls]:en(B1).optional(),[Nn.tool_call_id]:le().optional()})}),q1=Y({[Je.llm]:Y({[zn.input_messages]:en(lu)})}),U1=Y({[Je.llm]:Y({[zn.output_messages]:en(lu)})}),H1=Y({[Je.output]:Y({value:le()})}),tu=_k()(et(["user","ai","system","tool"])),G1=Y({id:Ds(),role:tu,content:le().optional(),toolCallId:le().optional(),toolCalls:en(eu).optional()}),W1=en(G1),iu=As(()=>Sa(Wl)),J1=iu,ru=le().transform((n,a)=>{const{json:l}=hn(n);if(!xa(l))return a.addIssue({code:Za.custom,message:"The invocation parameters must be a valid JSON object"}),Xa;const{success:t,data:i}=J1.safeParse(l);return t?i:(a.addIssue({code:Za.custom,message:"The invocation parameters must be a valid JSON object"}),Xa)}).default("{}"),Z1=Y({[Je.llm]:Y({[zn.provider]:le().optional(),[zn.model_name]:le()})}),su=Y({[Je.llm]:Y({[zn.invocation_parameters]:ru})}),X1=Y({[Je.llm]:Y({[zn.invocation_parameters]:ru.pipe(Y({response_format:iu.optional()}))})}),ou=Y({url:Y({full:le(),path:le().optional()})}),Y1=le().transform((n,a)=>{const{json:l}=hn(n);return l==null||!xa(l)?(a.addIssue({code:Za.custom,message:"The tool JSON schema must be a valid JSON object"}),Xa):l}).transform((n,a)=>{const{data:l,success:t}=$s.safeParse(n);return t?l:(a.addIssue({code:Za.custom,message:"The tool JSON schema must be a valid tool schema"}),Xa)}),ev=Y({[Je.llm]:Y({[zn.tools]:en(Y({[Je.tool]:Y({[vi.json_schema]:Y1})}).optional()).optional()}).optional()}).optional(),nv=As(()=>Y({type:ca("json_schema"),json_schema:Y({name:le().describe("The name of the schema"),schema:ei.describe("The schema itself in JSON schema format"),strict:ca(!0).describe("The schema must be strict")})})),av=ra(nv,{removeAdditionalStrategy:"passthrough"}),lv=le().transform((n,a)=>{const{json:l}=hn(n);return wa(l)?Object.entries(l).reduce((i,[r,s])=>{if(typeof s=="string")i[r]=s;else{const{json:d}=Ra(s);d!=null&&(i[r]=d)}return i},{}):(a.addIssue({code:Za.custom,message:"The prompt template variables must be a valid JSON object"}),Xa)}),tv=Y({[Je.llm]:Y({[zn.prompt_template]:Y({variables:lv}).optional()}).optional()}).optional();function du(n){return tu.safeParse(n).success}function bl(n){const a=n.toLowerCase();if(du(a))return a;for(const[l,t]of Object.entries(Fi))if(t.includes(a))return l;return Jc}function iv({toolCalls:n,provider:a}){if(n!=null)return n.map(({tool_call:l})=>{var i,r,s,d;if(l==null)return null;let t={};if(((i=l.function)==null?void 0:i.arguments)!=null){const{json:c}=hn(l.function.arguments);wa(c)&&(t=c)}switch(a){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"AWS":case"OLLAMA":return{id:l.id??"",type:"function",function:{name:((r=l.function)==null?void 0:r.name)??"",arguments:t}};case"ANTHROPIC":return{id:l.id??"",type:"tool_use",name:((s=l.function)==null?void 0:s.name)??"",input:t};case"GOOGLE":return{id:l.id??"",function:{name:((d=l.function)==null?void 0:d.name)??"",arguments:t}};default:Ne()}}).filter(l=>l!=null)}function cu({messages:n,provider:a}){return n.map(({message:l})=>{var t,i;return{id:pa(),role:l.tool_call_id!=null?bl("tool"):bl(l.role),content:Array.isArray(l.contents)?((i=(t=l.contents.find(r=>r.message_content.type==="text"))==null?void 0:t.message_content)==null?void 0:i.text)??void 0:typeof l.content=="string"?l.content:void 0,toolCalls:iv({provider:a,toolCalls:l.tool_calls}),toolCallId:l.tool_call_id}})}function rv({provider:n,parsedAttributes:a}){var t;const l=q1.safeParse(a);if(!l.success)return{messageParsingErrors:[i1],messages:null};if(n==="ANTHROPIC"){const{success:i,data:r}=su.safeParse(a);if(i){const s=l.data.llm.input_messages,d=(t=r.llm.invocation_parameters)==null?void 0:t.system;typeof d=="string"&&d&&(!s||s[0].message.role!=="system")&&l.data.llm.input_messages.unshift({message:{role:"system",content:d}})}}return{messageParsingErrors:[],messages:cu({provider:n,messages:l.data.llm.input_messages})}}function sv({provider:n,parsedAttributes:a}){const l=[],t=U1.safeParse(a);if(t.success)return{output:cu({provider:n,messages:t.data.llm.output_messages}),outputParsingErrors:l};l.push(r1);const i=H1.safeParse(a);return i.success?{output:i.data.output.value,outputParsingErrors:l}:(l.push(s1),{output:void 0,outputParsingErrors:l})}function uu(n){if(n==null)return null;switch(n.toLowerCase()){case"openai":return"OPENAI";case"anthropic":return"ANTHROPIC";case"aws":return"AWS";case"google":return"GOOGLE";case"azure":return"AZURE_OPENAI";default:return null}}function ov(n){for(const a of Object.keys(Oo))if(Oo[a].some(t=>n.includes(t)))return a;return Ji}function dv(n){const{success:a,data:l}=Z1.safeParse(n);if(a){const t=uu(l.llm.provider)||ov(l.llm.model_name),{baseUrl:i}=uv(n),r=t==="AZURE_OPENAI"?cv(n):{deploymentName:null,apiVersion:null,endpoint:null},s=t==="AZURE_OPENAI"&&r.deploymentName?r.deploymentName:l.llm.model_name;return{modelConfig:{...Object.fromEntries(Object.entries({baseUrl:i,endpoint:r.endpoint,apiVersion:r.apiVersion}).filter(([d,c])=>c!==null)),modelName:s,provider:t,invocationParameters:[],supportedInvocationParameters:[]},parsingErrors:[]}}return{modelConfig:null,parsingErrors:[d1]}}function cv(n){var u;const{success:a,data:l}=Mv.safeParse(n),t=a&&typeof((u=l==null?void 0:l.metadata)==null?void 0:u.ls_model_name)=="string"&&l.metadata.ls_model_name.trim()?l.metadata.ls_model_name.trim():null,{success:i,data:r}=ou.safeParse(n),{endpoint:s,apiVersion:d,deploymentName:c}=i?Rv(r.url.full):{endpoint:null,apiVersion:null,deploymentName:null};return{deploymentName:c??t,apiVersion:d,endpoint:s}}function uv(n){const{success:a,data:l}=ou.safeParse(n);if(a)try{let i=new URL(l.url.full);if(l.url.path)try{i=new URL(l.url.full.split(l.url.path)[0])}catch{}return{baseUrl:`${i.origin}${i.pathname}`}}catch{}return{baseUrl:null}}function mv(n,a=[]){const{success:l,data:t}=su.safeParse(n),i=[];return l||i.push(c1),{invocationParameters:Sv((t==null?void 0:t.llm.invocation_parameters)??{},a),parsingErrors:i}}function gv(n){const{success:a,data:l}=X1.safeParse(n);return a?{responseFormat:l.llm.invocation_parameters.response_format,parsingErrors:[]}:{responseFormat:void 0,parsingErrors:[u1]}}function pv(n){var a;return(((a=n==null?void 0:n.llm)==null?void 0:a.tools)??[]).map(l=>(l==null?void 0:l.tool)==null?null:{id:rt(),definition:l.tool.json_schema}).filter(l=>l!=null)}function yv(n){var t;const{data:a,success:l}=ev.safeParse(n);return l?((t=a==null?void 0:a.llm)==null?void 0:t.tools)==null?{tools:null,parsingErrors:[]}:{tools:pv(a),parsingErrors:[]}:{tools:null,parsingErrors:[m1]}}function fv(n){var t;const{success:a,data:l}=tv.safeParse(n);return a?((t=l==null?void 0:l.llm)==null?void 0:t.prompt_template)==null?{variables:null,parsingErrors:[]}:{variables:l.llm.prompt_template.variables,parsingErrors:[]}:{variables:null,parsingErrors:[g1]}}function hv(n){const{instance:a,instanceMessages:l}=qs(),t={...a,template:{__type:"chat",messages:Object.values(l)}},{json:i,parseError:r}=hn(n.attributes);if(r)return{playgroundInstance:{...t,repetitions:{1:{output:null,spanId:n.id,error:null,toolCalls:{},status:"notStarted"}}},parsingErrors:[o1]};const s=n.invocationParameters,d=dv(i);let{modelConfig:c}=d;const{parsingErrors:u}=d,{messages:m,messageParsingErrors:g}=rv({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{output:p,outputParsingErrors:y}=sv({provider:(c==null?void 0:c.provider)??t.model.provider,parsedAttributes:i}),{invocationParameters:h,parsingErrors:k}=mv(i,s),{variables:S,parsingErrors:F}=fv(i),{parsingErrors:I}=gv(i);c=c!=null?{...c,invocationParameters:I.length>0?h.filter(P=>P.invocationName!==Wn&&P.canonicalName!==Gn):h}:null;const{tools:L,parsingErrors:M}=yv(i),E=m==null?void 0:m.map(P=>({...P,content:P.role==="tool"?js(P.content):P.content}));return{playgroundInstance:{...t,model:c??t.model,template:E!=null?{__type:"chat",messages:E}:t.template,repetitions:{...t.repetitions,1:{output:p??null,spanId:n.id,error:null,toolCalls:{},status:"finished"}},tools:L??t.tools},playgroundInput:S!=null?{variablesValueCache:S}:void 0,parsingErrors:[...g,...y,...u,...M,...k,...I,...F]}}const kv=n=>W1.safeParse(n).success,mu=({instance:n,templateFormat:a})=>{if(a==Yn.NONE)return[];const l=new Set,t=n.template.__type,i=Ak(a);switch(t){case"chat":{n.template.messages.forEach(r=>{(r.content==null?[]:i.extractVariables(r.content)).forEach(d=>{l.add(d)})});break}case"text_completion":{i.extractVariables(n.template.prompt).forEach(s=>{l.add(s)});break}default:Ne()}return Array.from(l)},bv=({instances:n,templateFormat:a})=>a==Yn.NONE?[]:Array.from(new Set(n.flatMap(l=>mu({instance:l,templateFormat:a})))),gu=({instances:n,templateFormat:a,input:l})=>{if(a==Yn.NONE)return{variablesMap:{},variableKeys:[]};const t=bv({instances:n,templateFormat:a}),i=l.variablesValueCache??{};return{variablesMap:t.reduce((s,d)=>(s[d]=i[d]||"",s),{}),variableKeys:t}};function Oa(n,a){return n.invocationName===a.invocationName||n.canonicalName!=null&&a.canonicalName!=null&&n.canonicalName===a.canonicalName}const pu=(n,a)=>n.filter(l=>a.some(t=>Oa(t,l))).map(l=>{var t;return{...l,invocationName:((t=a.find(i=>Oa(i,l)))==null?void 0:t.invocationName)??l.invocationName}}),Tt=n=>n.replace(/_([a-z])/g,(a,l)=>l.toUpperCase()),Sv=(n,a)=>Object.entries(n).map(([l,t])=>{const i=a.find(r=>r.canonicalName&&r.canonicalName.toLowerCase()===l.toLowerCase()||r.invocationName&&r.invocationName.toLowerCase()===l.toLowerCase());return i==null||i.invocationInputField==null||i.invocationName==null?null:{canonicalName:i.canonicalName,invocationName:i.invocationName,[Tt(i.invocationInputField)]:t}}).filter(l=>l!=null),yu=n=>{const{provider:a,validatedToolDefinition:l}=Zc(n.definition);switch(a){case"OPENAI":case"AZURE_OPENAI":return l.function.name;case"ANTHROPIC":return l.name;case"AWS":return l.toolSpec.name;case"GOOGLE":return l.name;case"UNKNOWN":return null;default:Ne()}},vv=({provider:n,toolNumber:a})=>{switch(n){case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":case"AZURE_OPENAI":return{id:rt(),definition:P1(a)};case"ANTHROPIC":return{id:rt(),definition:I1(a)};case"AWS":return{id:rt(),definition:x1(a)};case"GOOGLE":return{id:rt(),definition:L1(a)};default:Ne()}},Fv=n=>{switch(n){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"AWS":case"OLLAMA":return Qo();case"ANTHROPIC":return $1();case"GOOGLE":return Qo();default:Ne()}};function Cv(n){return{content:n.content,role:Kv(n.role),toolCalls:n.toolCalls,toolCallId:n.toolCallId}}function Kv(n){switch(n){case"system":return"SYSTEM";case"user":return"USER";case"tool":return"TOOL";case"ai":return"AI";default:Ne()}}const fu=n=>n.filter(a=>!(a.valueFloat!==null&&typeof a.valueFloat=="number"&&isNaN(a.valueFloat))).map(({dirty:a,...l})=>l),hu=({playgroundStore:n,instanceId:a,credentials:l})=>{var p;const{instances:t,allInstanceMessages:i}=n.getState(),r=t.find(y=>y.id===a);if(!r)throw new Error(`No instance found for id ${a}`);if(r.template.__type!=="chat")throw new Error("We only support chat templates for now");const s=r.template.messageIds.map(y=>i[y]).filter(y=>y!=null),d=r.model.supportedInvocationParameters;let c=fu(r.model.invocationParameters);const u=Ei({toolChoice:r.toolChoice,targetProvider:r.model.provider});r.tools.length>0?(c=c.filter(y=>y.invocationName!==dt&&y.canonicalName!==nl),c.push({canonicalName:nl,invocationName:dt,valueJson:u})):c=c.filter(y=>y.invocationName!==dt&&y.canonicalName!==nl),c=d.length?pu(c,d):c;const m=r.model.provider==="AZURE_OPENAI"?{endpoint:r.model.endpoint,apiVersion:r.model.apiVersion}:{},g=r.model.provider==="AWS"?{region:r.model.region}:{};return{messages:s.map(Cv),model:{providerKey:r.model.provider,name:r.model.modelName||"",baseUrl:r.model.baseUrl,customHeaders:r.model.customHeaders,...m,...g},invocationParameters:bu(c,r.model.provider,r.model.modelName),tools:r.tools.length?r.tools.map(y=>y.definition):void 0,credentials:Tv(l,r.model.provider),promptName:(p=r.prompt)==null?void 0:p.name,repetitions:n.getState().repetitions}},er=(n,a)=>{if(n.template.__type==="chat"){const{messageIds:l,...t}=n.template;return{...n,template:{...t,messages:n.template.messageIds.map(i=>a[i])}}}return n};function Tv(n,a){const l=n[a],t=ol[a];return l?t.length===0?[]:t.map(i=>({envVarName:i.envVarName,value:l[i.envVarName]??""})):[]}const Pv=({playgroundStore:n,instanceId:a,credentials:l})=>{const t=hu({playgroundStore:n,instanceId:a,credentials:l}),{instances:i,templateFormat:r,input:s,allInstanceMessages:d}=n.getState(),c=i.map(m=>er(m,d)),{variablesMap:u}=gu({instances:c,input:s,templateFormat:r});return{...t,template:{variables:u,format:r}}},Bo=({playgroundStore:n,instanceId:a,credentials:l,datasetId:t,splitIds:i})=>({...hu({playgroundStore:n,instanceId:a,credentials:l}),templateFormat:n.getState().templateFormat,repetitions:n.getState().repetitions,datasetId:t,splitIds:i??null});function js(n){if(typeof n=="string"){const a=n.startsWith('"{')||n.startsWith('"[')||n.startsWith('"\\"');try{if(a){const t=JSON.parse(n),i=typeof t=="string"?JSON.parse(t):t;return JSON.stringify(i,null,2)}}catch{}if(/^\s*[0-9{[]|true|false|null/.test(n))return n}return JSON.stringify(n,null,2)}function ku(n,a){return a.filter(l=>l.required).every(l=>n.some(t=>Oa(t,l)))}const Iv=n=>{for(const[a,l]of Object.entries(n))if(a.endsWith("DefaultValue")&&l!=null)return n[a]};function xv(n,a){const l=new Map(n.map(t=>[t.invocationName,t]));return a.forEach(t=>{var c;const i=t.invocationName,r=Iv(t),s=Tt(t.invocationInputField||"");if(!t.invocationName||!t.invocationInputField||!i||r==null||((c=l.get(i))==null?void 0:c[s])!=null)return;const d={canonicalName:t.canonicalName,invocationName:t.invocationName,[s]:r};l.set(i,d)}),Array.from(l.values())}const Lv=Y({type:ca("enabled")}).passthrough(),Dv=Y({type:et(["any","tool"])}).passthrough(),_v=(n,a)=>{if(!a)return n;const l=n.some(t=>t.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&t.valueJson&&Lv.safeParse(t.valueJson).success);return n.filter(t=>{if(t.canonicalName==="ANTHROPIC_EXTENDED_THINKING"&&!t.valueJson)return!1;if(l){if(t.canonicalName==="TEMPERATURE"||t.canonicalName==="TOP_P")return!1;if(t.canonicalName===nl)return!Dv.safeParse(t.valueJson).success}return!0})},Av=["frequency_penalty","presence_penalty"],Ev=n=>n.filter(l=>l.invocationName&&Av.includes(l.invocationName)?!(l.valueFloat==0||l.valueInt==0):!0),bu=(n,a,l)=>{const t=Ev(n);return a==="ANTHROPIC"?_v(t,l):t},wv=/(?:^|\/)deployments\/([^/]+)(?:\/?|$)/,Mv=Y({metadata:Y({ls_model_name:le().optional()}).optional()}).passthrough();function Rv(n){try{const a=new URL(n),l=a.origin.trim(),t=a.searchParams.get("api-version"),i=t&&t.trim()?t.trim():null,s=(a.pathname||"").toString().match(wv),d=s&&s[1]?s[1].trim():null;return{endpoint:l,apiVersion:i,deploymentName:d}}catch{return{endpoint:null,apiVersion:null,deploymentName:null}}}const Vv=({instanceTools:n,provider:a})=>n.map(l=>{switch(a){case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":case"AZURE_OPENAI":{const t=ci(l.definition);return{...l,definition:t??l.definition}}case"ANTHROPIC":{const t=ci(l.definition),i=t?pr({toolDefinition:t,targetProvider:a}):l.definition;return{...l,definition:i}}case"AWS":{const t=ci(l.definition),i=t?pr({toolDefinition:t,targetProvider:a}):l.definition;return{...l,definition:i}}case"GOOGLE":{const t=ci(l.definition),i=t?pr({toolDefinition:t,targetProvider:a}):l.definition;return{...l,definition:i}}default:Ne()}}),Qs=({toolCalls:n,provider:a})=>{if(n!=null)return n.map(l=>{switch(a){case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":case"AZURE_OPENAI":return ql(l)??l;case"ANTHROPIC":{const t=ql(l);return t!=null?Br({toolCall:t,targetProvider:a}):l}case"AWS":{const t=ql(l);return t!=null?Br({toolCall:t,targetProvider:a}):l}case"GOOGLE":return l;default:Ne()}})};let Nv=0,zv=0,$v=1,Ov=0;const Su=()=>Nv++,pa=()=>$v++,rt=()=>Ov++,jv=()=>zv++,vu=()=>({__type:"chat",messages:[{id:pa(),role:"system",content:"You are a chatbot"},{id:pa(),role:"user",content:"{{question}}"}]}),Bs=n=>({template:{__type:"chat",messageIds:n.messages.map(a=>a.id)},messages:n.messages.reduce((a,l)=>(a[l.id]=l,a),{})}),Qv={__type:"text_completion",prompt:"{{question}}"},Fu=()=>({model:{provider:Ji,modelName:Wc,invocationParameters:[],supportedInvocationParameters:[]},tools:[],toolChoice:"auto",repetitions:{1:{output:null,spanId:null,error:null,status:"notStarted",toolCalls:{}}},activeRunId:null});function qs(){const n=vu(),a=Bs(n);return{instance:{id:Su(),template:a.template,...Fu(),selectedRepetitionNumber:1},instanceMessages:a.messages}}function Bv(){return{type:"json_schema",json_schema:{name:"response",schema:{type:"object",properties:{},required:[],additionalProperties:!1},strict:!0}}}function qv(n){if(n.instances!=null&&n.instances.length>0){let s={};return{instances:n.instances.map(c=>{if(c.template.__type==="chat"){const u=Bs(c.template);return s={...s,...u.messages},{...c,template:u.template}}return c}),instanceMessages:s}}const{instance:a,instanceMessages:l}=qs(),t=Object.values(n.modelConfigByProvider);if(!(t.length>0))return{instances:[a],instanceMessages:l};const r=t.find(s=>s.provider===Ji)??t[0];return a.model={...a.model,...r},{instances:[a],instanceMessages:l}}const Uv=n=>{const{instances:a,instanceMessages:l}=qv(n);return Wt(Gi((i,r)=>({streaming:!0,repetitions:1,operationType:"chat",inputMode:"manual",dirtyInstances:{},input:{variablesValueCache:{}},templateFormat:Yn.Mustache,...n,instances:a,allInstanceMessages:l,setInput:s=>{i({input:s},!1,{type:"setInput"})},setOperationType:s=>{if(s==="chat"){const d=[];let c={};r().instances.forEach(u=>{const m=vu(),g=Bs(m);c={...c,...g.messages},d.push({...u,template:g.template})}),i({instances:d,allInstanceMessages:c},!1,{type:"setOperationType/chat"})}else i({instances:r().instances.map(d=>({...d,template:Qv}))},!1,{type:"setOperationType/text_completion"});i({operationType:s},!1,{type:"setOperationType"})},addInstance:()=>{const s=r().instances,d=r().allInstanceMessages,c=r().instances[0];if(!c)return;let u=[],m={};if(c.template.__type==="chat"){const p=c.template.messageIds.map(y=>d[y]).map(y=>({...y,id:pa()}));u=p.map(y=>y.id),m=p.reduce((y,h)=>(y[h.id]=h,y),{})}i({allInstanceMessages:{...d,...m},instances:[...s,{...c,...c.template.__type==="chat"?{template:{...c.template,messageIds:u}}:{},id:Su(),activeRunId:null,experimentId:null,repetitions:{}}]},!1,{type:"addInstance"})},updateModelSupportedInvocationParameters:({instanceId:s,supportedInvocationParameters:d,modelConfigByProvider:c})=>{const u=r().instances;i({instances:u.map(m=>{if(m.id===s){const{baseUrl:g,endpoint:p,apiVersion:y,region:h}=c[m.model.provider]??{},k=m.model.invocationParameters.find(P=>P.canonicalName===Gn||P.invocationName===Wn),S=m.model.invocationParameters.filter(P=>P.dirty),F=pu(S,d),I=xv(F,d),L=d.some(P=>P.canonicalName===Gn||P.invocationName===Wn),M=I.some(P=>P.canonicalName===Gn||P.invocationName===Wn),E=k&&L&&!M?[...I,k]:I;return{...m,model:{...m.model,baseUrl:m.model.baseUrl??g,endpoint:m.model.endpoint??p,apiVersion:m.model.apiVersion??y,region:m.model.region??h,supportedInvocationParameters:d,invocationParameters:E},tools:d.find(P=>P.canonicalName===nl)?m.tools:[]}}return m})},!1,{type:"updateModelSupportedInvocationParameters"})},updateProvider:({instanceId:s,provider:d,modelConfigByProvider:c})=>{const u=r().instances,m=u.find(S=>S.id===s);if(!m||m.model.provider===d)return;const g=c[d],p=m.model.invocationParameters.find(S=>S.canonicalName===Gn||S.invocationName===Wn),y=S=>S==="OLLAMA"?"http://localhost:11434/v1":null,h={model:(()=>{const S={...m.model},F={modelName:null,baseUrl:y(d),apiVersion:null,endpoint:null,region:null,customHeaders:null};return{...S,...F,...g||{},...g&&{invocationParameters:[...g.invocationParameters,...p?[p]:[]]},provider:d}})(),toolChoice:Ei({toolChoice:m.toolChoice,targetProvider:d})??void 0,tools:Vv({instanceTools:m.tools,provider:d})},k={};m.template.__type==="chat"&&m.template.messageIds.forEach(S=>{const F=r().allInstanceMessages[S];F&&(k[S]={...F,toolCalls:Qs({toolCalls:F.toolCalls,provider:d})})}),i({allInstanceMessages:{...r().allInstanceMessages,...k},dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:u.map(S=>S.id===s?{...S,...h}:S)},!1,{type:"updateProvider"})},updateModel:({instanceId:s,patch:d})=>{const c=r().instances;c.find(m=>m.id===s)&&i({dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:c.map(m=>m.id===s?{...m,model:{...m.model,...d}}:m)},!1,{type:"updateModel"})},deleteInstance:s=>{const d=r().instances;i({instances:d.filter(c=>c.id!==s),dirtyInstances:{...r().dirtyInstances,[s]:!1}},!1,{type:"deleteInstance"})},addMessage:({playgroundInstanceId:s,messages:d})=>{const c=r().instances;let u=[];Array.isArray(d)?u=d:d?u=[d]:u=[{id:pa(),role:Jc,content:""}],i({allInstanceMessages:{...r().allInstanceMessages,...u.reduce((m,g)=>(m[g.id]=g,m),{})},dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:c.map(m=>m.id===s&&(m!=null&&m.template)&&(m==null?void 0:m.template.__type)==="chat"?{...m,template:{...m.template,messageIds:[...m.template.messageIds,...u.map(g=>g.id)]}}:m)},!1,{type:"addMessage"})},updateMessage:({messageId:s,patch:d,instanceId:c})=>{const u=r().allInstanceMessages;i({allInstanceMessages:{...u,[s]:{...u[s],...d}},dirtyInstances:{...r().dirtyInstances,[c]:!0}},!1,{type:"updateMessage"})},deleteMessage:({instanceId:s,messageId:d})=>{const c=r().instances,u=r().allInstanceMessages;i({allInstanceMessages:Object.fromEntries(Object.entries(u).filter(([,{id:m}])=>m!==d)),dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:c.map(m=>m.id===s&&(m!=null&&m.template)&&(m==null?void 0:m.template.__type)==="chat"?{...m,template:{...m.template,messageIds:m.template.messageIds.filter(g=>g!==d)}}:m)},!1,{type:"deleteMessage"})},setSelectedRepetitionNumber:(s,d)=>{const c=r().instances,u=c.findIndex(m=>m.id===s);u!==-1&&i({instances:c.map((m,g)=>g===u?{...m,selectedRepetitionNumber:d}:m)},!1,{type:"setSelectedRepetitionNumber"})},updateInstance:({instanceId:s,patch:d,dirty:c})=>{const u=r().instances;i({dirtyInstances:{...r().dirtyInstances,...c!=null?{[s]:c}:{}},instances:u.map(m=>m.id===s?{...m,...d}:m)},!1,{type:"updateInstance"})},runPlaygroundInstances:()=>{const s=r().instances,d=r().repetitions;i({instances:s.map(c=>({...c,activeRunId:jv(),repetitions:Object.fromEntries(Array.from({length:d},(u,m)=>[m+1,{output:null,spanId:null,error:null,status:"pending",toolCalls:{}}])),selectedRepetitionNumber:1}))},!1,{type:"runPlaygroundInstances"})},cancelPlaygroundInstances:()=>{const s=r().instances;i({instances:s.map(d=>({...d,activeRunId:null,repetitions:Object.fromEntries(Object.entries(d.repetitions).map(([c,u])=>[c,u?{...u,status:"finished"}:void 0]))}))},!1,{type:"cancelPlaygroundInstances"})},markPlaygroundInstanceComplete:s=>{const d=r().instances;i({instances:d.map(c=>c.id===s?{...c,activeRunId:null,repetitions:Object.fromEntries(Object.entries(c.repetitions).map(([u,m])=>[u,m?{...m,status:"finished"}:void 0]))}:c)},!1,{type:"markPlaygroundInstanceComplete"})},setTemplateFormat:s=>{i({templateFormat:s},!1,{type:"setTemplateFormat"})},setVariableValue:(s,d)=>{const c=r().input;i({input:{...c,variablesValueCache:{...c.variablesValueCache,[s]:d}}},!1,{type:"setVariableValue"})},setStreaming:s=>{i({streaming:s},!1,{type:"setStreaming"})},setRepetitions:s=>{i({repetitions:s},!1,{type:"setRepetitions"})},updateInstanceModelInvocationParameters:({instanceId:s,invocationParameters:d})=>{r().instances.find(u=>u.id===s)&&i({dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:r().instances.map(u=>u.id===s?{...u,model:{...u.model,invocationParameters:d}}:u)},!1,{type:"updateInstanceModelInvocationParameters"})},upsertInvocationParameterInput:({instanceId:s,invocationParameterInput:d})=>{const c=r().instances.find(m=>m.id===s);if(!c)return;c.model.invocationParameters.find(m=>Oa(m,d))?i({dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:r().instances.map(m=>m.id===s?{...m,model:{...m.model,invocationParameters:m.model.invocationParameters.map(g=>Oa(g,d)?d:g)}}:m)},!1,{type:"upsertInvocationParameterInput/update"}):i({dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:r().instances.map(m=>m.id===s?{...m,model:{...m.model,invocationParameters:[...m.model.invocationParameters,d]}}:m)},!1,{type:"upsertInvocationParameterInput/insert"})},deleteInvocationParameterInput:({instanceId:s,invocationParameterInputInvocationName:d})=>{r().instances.find(u=>u.id===s)&&i({dirtyInstances:{...r().dirtyInstances,[s]:!0},instances:r().instances.map(u=>u.id===s?{...u,model:{...u.model,invocationParameters:u.model.invocationParameters.filter(m=>m.invocationName!==d)}}:u)},!1,{type:"deleteInvocationParameterInput"})},setDirty:(s,d)=>{i({dirtyInstances:{...r().dirtyInstances,[s]:d}},!1,{type:"setDirty"})},appendRepetitionOutput:(s,d,c)=>{const u=r().instances;u.find(g=>g.id===s)&&i({instances:u.map(g=>{if(g.id===s){const p=g.repetitions[d];return{...g,repetitions:{...g.repetitions,[d]:p?{...p,output:(p.output||"")+c}:void 0}}}return g})},!1,{type:"appendRepetitionOutput"})},setRepetitionError:(s,d,c)=>{i({instances:r().instances.map(u=>{if(u.id!==s)return u;const m=u.repetitions[d];return{...u,repetitions:{...u.repetitions,[d]:m?{...m,error:c}:void 0}}})},!1,{type:"setRepetitionError"})},setRepetitionStatus:(s,d,c)=>{i({instances:r().instances.map(u=>{if(u.id!==s)return u;const m=u.repetitions[d];return{...u,repetitions:{...u.repetitions,[d]:m?{...m,status:c}:void 0}}})},!1,{type:"setRepetitionStatus"})},addRepetitionPartialToolCall:(s,d,c)=>{i({instances:r().instances.map(u=>{if(u.id!==s)return u;const m=u.repetitions[d],g=(m==null?void 0:m.toolCalls)??{},p=c.id in g?{...g,[c.id]:{...g[c.id],function:{...c.function,arguments:g[c.id].function.arguments+c.function.arguments}}}:{...g,[c.id]:c};return{...u,repetitions:{...u.repetitions,[d]:m?{...m,toolCalls:p}:void 0}}})},!1,{type:"addRepetitionPartialToolCall"})},setRepetitionToolCalls:(s,d,c)=>{i({instances:r().instances.map(u=>{if(u.id!==s)return u;const m=u.repetitions[d],g=c.reduce((p,y)=>(p[y.id]=y,p),{});return{...u,repetitions:{...u.repetitions,[d]:m?{...m,toolCalls:g}:void 0}}})},!1,{type:"setRepetitionToolCalls"})},clearRepetitions:s=>{i({instances:r().instances.map(d=>d.id!==s?d:{...d,repetitions:{}})},!1,{type:"clearRepetitions"})},setRepetitionSpanId:(s,d,c)=>{i({instances:r().instances.map(u=>{if(u.id!==s)return u;const m=u.repetitions[d];return{...u,repetitions:{...u.repetitions,[d]:m?{...m,spanId:c}:void 0}}})},!1,{type:"setRepetitionSpanId"})}}),{name:"playgroundStore"}))};function li(n){return n==="OPENAI"||n==="AZURE_OPENAI"||n==="ANTHROPIC"||n==="GOOGLE"||n==="DEEPSEEK"||n==="XAI"||n==="OLLAMA"||n==="AWS"}function Ia(n){switch(n){case"OPENAI":return"OpenAI";case"AZURE_OPENAI":return"Azure OpenAI";case"ANTHROPIC":return"Anthropic";case"GOOGLE":return"Google";case"DEEPSEEK":return"DeepSeek";case"XAI":return"XAI";case"OLLAMA":return"Ollama";case"AWS":return"AWS";default:Ne()}}function zl(n){switch(n){case"OPENAI":return Lt.OPENAI.toString();case"AZURE_OPENAI":return Lt.AZURE.toString();case"ANTHROPIC":return Lt.ANTHROPIC.toString();case"GOOGLE":return Lt.GOOGLE.toString();case"AWS":return Lt.AWS.toString();case"DEEPSEEK":return"deepseek";case"XAI":return"xai";case"OLLAMA":throw new Error("Ollama is not supported");default:Ne()}}function Hv(n){return typeof n=="object"&&n!==null&&Object.keys(n).length>0&&Object.keys(n).every(a=>a in ol)&&Object.values(n).every(a=>typeof a=="string")}function Gv(n){const a={};for(const l of Object.keys(n))li(l)&&ol[l].length===1&&(a[l]={[ol[l][0].envVarName]:n[l]});return a}const Wv=n=>{const a=l=>({setCredential:({provider:t,envVarName:i,value:r})=>{l(s=>({[t]:{...s[t],[i]:r}}),!1,{type:"setCredential"})},...n});return Wt()(Mc(Gi(a),{version:1,name:"arize-phoenix-credentials",migrate:l=>{if(Hv(l))return Gv(l)}}))},Cu=f.createContext(null);function E9({children:n,...a}){const[l]=f.useState(()=>Wv(a));return e(Cu.Provider,{value:l,children:n})}function Jl(n,a){const l=f.useContext(Cu);if(!l)throw new Error("Missing CredentialsContext.Provider in the tree");return Jt(l,n,a)}const Ku="arize-phoenix-feature-flags",yr={evaluators:!1};function Jv(){const n=localStorage.getItem(Ku);if(!n)return yr;try{const a=JSON.parse(n);return Object.assign({},yr,a)}catch{return yr}}const Tu=f.createContext(null);function Pu(){const n=Da.useContext(Tu);if(n===null)throw new Error("useFeatureFlags must be used within a FeatureFlagsProvider");return n}function Zv(n){const{featureFlags:a}=Pu();return a[n]}function w9(n){const[a,l]=f.useState(Jv()),t=i=>{localStorage.setItem(Ku,JSON.stringify(i)),l(i)};return e(Tu.Provider,{value:{featureFlags:a,setFeatureFlags:t},children:e(Xv,{children:n.children})})}function Xv(n){const{children:a}=n,{featureFlags:l,setFeatureFlags:t}=Pu(),[i,r]=f.useState(!1);return za("ctrl+shift+f",()=>r(!0)),o(te,{children:[a,e(oe,{isOpen:i,onOpenChange:r,children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Feature Flags"}),e(ke,{children:e(be,{slot:"close"})})]}),e(C,{padding:"size-100",children:Object.keys(l).map(s=>e(Il,{isSelected:l[s],onChange:d=>t({...l,[s]:d}),children:s},s))})]})})})})]})}const Iu=f.createContext(null);function Yv(){const n=f.useContext(Iu);if(n===null)throw new Error("useFunctionality must be used within a FunctionalityProvider");return n}function M9(n){return e(Iu.Provider,{value:{authenticationEnabled:window.Config.authenticationEnabled},children:n.children})}function R9(){return e("main",{children:"Evaluators Page"})}function V9(){return o(te,{children:[e(Ek,{}),e(Ue,{})]})}const xu=(function(){var n=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsPromptsPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelsSettingsCardFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsPromptsPageLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptLabelConnection",kind:"LinkedField",name:"promptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"promptLabels(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"PromptLabelsTable__promptLabels",kind:"LinkedHandle",name:"promptLabels"}]},params:{cacheID:"6535608721c8bfc6cd7b5cd97463a7e0",id:null,metadata:{},name:"settingsPromptsPageLoaderQuery",operationKind:"query",text:`query settingsPromptsPageLoaderQuery {
  ...PromptLabelsSettingsCardFragment
}

fragment PromptLabelsSettingsCardFragment on Query {
  ...PromptLabelsTableFragment
}

fragment PromptLabelsTableFragment on Query {
  promptLabels(first: 100) {
    edges {
      node {
        id
        name
        description
        color
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();xu.hash="44dc2c69c64dbe1d68af886497083b2b";const Lu=xu;function N9(){return T.loadQuery(ze,Lu,{})}const Du={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GenerativeProvidersCard_data",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,concreteType:"GenerativeProviderCredentialConfig",kind:"LinkedField",name:"credentialRequirements",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"envVarName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"credentialsSet",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Du.hash="4062531cfa3f77e541172a44101f5331";function eF({query:n}){"use no memo";const a=T.useFragment(Du,n),l=f.useMemo(()=>[...a.modelProviders],[a]),t=f.useMemo(()=>[{header:"Name",accessorKey:"name",cell:({row:s})=>o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(al,{provider:s.original.key,height:18}),s.original.name]})},{header:"Environment Variables",accessorKey:"apiKeyEnvVar",cell:({row:s})=>{const d=ol[s.original.key],c=(d==null?void 0:d.map(u=>u.envVarName).join(", "))||s.original.credentialRequirements.map(u=>u.envVarName).join(", ")||"--";return e(v,{children:c})}},{header:"configuration",accessorKey:"credentialsSet",cell:({row:s})=>e(nF,{dependenciesInstalled:s.original.dependenciesInstalled,credentialRequirements:s.original.credentialRequirements,providerKey:s.original.key,credentialsSet:s.original.credentialsSet})},{header:"",accessorKey:"id",cell:({row:s})=>e(b,{direction:"row",justifyContent:"end",gap:"size-100",width:"100%",children:o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Xl,{})})}),e(oe,{children:e(ae,{size:"M",children:e(aF,{provider:s.original})})})]})})}],[]),i=Qe({columns:t,data:l,getCoreRowModel:Be(),getSortedRowModel:Vn()}),r=i.getRowModel().rows;return e(ee,{title:"AI Providers",children:o("table",{css:Kn,children:[e("thead",{children:i.getHeaderGroups().map(s=>e("tr",{children:s.headers.map(d=>e("th",{colSpan:d.colSpan,children:d.isPlaceholder?null:e("div",{children:de(d.column.columnDef.header,d.getContext())})},d.id))},s.id))}),e("tbody",{children:r.map(s=>e("tr",{children:s.getVisibleCells().map(d=>e("td",{children:de(d.column.columnDef.cell,d.getContext())},d.id))},s.id))})]})})}function nF({dependenciesInstalled:n,credentialRequirements:a,providerKey:l,credentialsSet:t}){const i=Jl(d=>d);if(!n)return e(v,{color:"warning",children:"missing dependencies"});if(!li(l))return e(v,{color:"warning",children:"unknown provider key"});const r=i[l];return a.every(({envVarName:d,isRequired:c})=>!!(r!=null&&r[d])||!c)?e(v,{color:"success",children:"local"}):t?e(v,{color:"success",children:"configured on the server"}):e(v,{color:"text-700",children:"not configured"})}function aF({provider:n}){return e(re,{children:o(ye,{children:[o(fe,{children:[o(he,{children:["Configure Local ",n.name," Credentials"]}),e(ke,{children:e(be,{slot:"close"})})]}),o(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-100",children:o(v,{size:"XS",children:["Set the credentials for the ",n.name," API. These credentials will be stored entirely in your browser and will only be sent to the server during API requests."]})}),e(bn,{children:e(lF,{provider:n.key})})]})]})})}function lF({provider:n}){const a=Jl(r=>r.setCredential),l=ol[n],t=Jl(r=>r[n]),i=f.useCallback(()=>{l.forEach(r=>{a({provider:n,envVarName:r.envVarName,value:""})})},[n,l,a]);return o(b,{direction:"column",gap:"size-100",children:[l.map(r=>o(Vd,{isRequired:r.isRequired,onChange:s=>{a({provider:n,envVarName:r.envVarName,value:s})},value:(t==null?void 0:t[r.envVarName])??"",children:[e(J,{children:r.envVarName}),e(Nd,{})]},r.envVarName)),e(R,{onPress:i,css:K`
          align-self: flex-start;
          margin-top: var(--ac-global-dimension-size-100);
        `,children:"Clear Local Credentials"})]})}function z9(){const n=wn();return Xe(n),e(eF,{query:n})}const _u={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsAIProvidersPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"GenerativeProvidersCard_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsAIProvidersPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null},{alias:null,args:null,concreteType:"GenerativeProviderCredentialConfig",kind:"LinkedField",name:"credentialRequirements",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"envVarName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"credentialsSet",storageKey:null}],storageKey:null}]},params:{cacheID:"1238ea27e05b70fd2c203ab4be6a1209",id:null,metadata:{},name:"settingsAIProvidersPageLoaderQuery",operationKind:"query",text:`query settingsAIProvidersPageLoaderQuery {
  ...GenerativeProvidersCard_data
}

fragment GenerativeProvidersCard_data on Query {
  modelProviders {
    name
    key
    dependenciesInstalled
    dependencies
    credentialRequirements {
      envVarName
      isRequired
    }
    credentialsSet
  }
}
`}};_u.hash="2c8eecb8897f8c7dadfdc3de4e2a41a8";async function $9(){return await T.fetchQuery(ze,_u,{}).toPromise()}const Au=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"UpdateAnnotationConfigPayload",kind:"LinkedField",name:"updateAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"UpdateAnnotationConfigPayload",kind:"LinkedField",name:"updateAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[l,t,i,r,s,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,t,i,r,s,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l,t,i,r],type:"FreeformAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[l],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"061e03033b94ecf7796c1f75b9a9cca2",id:null,metadata:{},name:"SettingsAnnotationsPageUpdateAnnotationConfigMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageUpdateAnnotationConfigMutation(
  $input: UpdateAnnotationConfigInput!
) {
  updateAnnotationConfig(input: $input) {
    query {
      ...AnnotationConfigTableFragment
    }
  }
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}
`}}})();Au.hash="ff1766a94d47c68a8a31fc0953c98428";const Eu=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"CreateAnnotationConfigPayload",kind:"LinkedField",name:"createAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[l],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",selections:[{alias:null,args:a,concreteType:"CreateAnnotationConfigPayload",kind:"LinkedField",name:"createAnnotationConfig",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfig",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}]},params:{cacheID:"8f81a5e67c5c540e2d03bc14f15ef0c3",id:null,metadata:{},name:"SettingsAnnotationsPageCreateAnnotationConfigMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageCreateAnnotationConfigMutation(
  $input: CreateAnnotationConfigInput!
) {
  createAnnotationConfig(input: $input) {
    annotationConfig {
      __typename
      ... on Node {
        __isNode: __typename
        id
      }
    }
  }
}
`}}})();Eu.hash="9d83d5bc4f9f1aefdfe14c9a706f5a34";const wu=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",selections:[{alias:null,args:a,concreteType:"DeleteAnnotationConfigsPayload",kind:"LinkedField",name:"deleteAnnotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfigs",plural:!0,selections:[l],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",selections:[{alias:null,args:a,concreteType:"DeleteAnnotationConfigsPayload",kind:"LinkedField",name:"deleteAnnotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"annotationConfigs",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}]},params:{cacheID:"26434e94a78f9d52aa61c8e885eb5ca3",id:null,metadata:{},name:"SettingsAnnotationsPageDeleteAnnotationConfigsMutation",operationKind:"mutation",text:`mutation SettingsAnnotationsPageDeleteAnnotationConfigsMutation(
  $input: DeleteAnnotationConfigsInput!
) {
  deleteAnnotationConfigs(input: $input) {
    annotationConfigs {
      __typename
      ... on Node {
        __isNode: __typename
        id
      }
    }
  }
}
`}}})();wu.hash="b9c71db625b896a55591c5d5e88a2929";const Mu=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SettingsAnnotationsPageFragmentQuery",selections:[{args:null,kind:"FragmentSpread",name:"SettingsAnnotationsPageFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SettingsAnnotationsPageFragmentQuery",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t],type:"FreeformAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"233ee9e561b453f1cf6b2334b7000a54",id:null,metadata:{},name:"SettingsAnnotationsPageFragmentQuery",operationKind:"query",text:`query SettingsAnnotationsPageFragmentQuery {
  ...SettingsAnnotationsPageFragment
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}

fragment SettingsAnnotationsPageFragment on Query {
  ...AnnotationConfigTableFragment
}
`}}})();Mu.hash="1108c006f0bdef6068549534988a5206";const Ru={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Mu}},name:"SettingsAnnotationsPageFragment",selections:[{args:null,kind:"FragmentSpread",name:"AnnotationConfigTableFragment"}],type:"Query",abstractKey:null};Ru.hash="1108c006f0bdef6068549534988a5206";const qo="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),tF=["MAXIMIZE","MINIMIZE","NONE"],iF=["CATEGORICAL","CONTINUOUS","FREEFORM"],Vu=({onAddAnnotationConfig:n,initialAnnotationConfig:a})=>{"use no memo";const l=Ve(),t=Le(),i=a?"edit":"new",{control:r,handleSubmit:s,watch:d}=sn({defaultValues:a||{annotationType:"CATEGORICAL",values:[{label:"",score:null},{label:"",score:null}],optimizationDirection:"MAXIMIZE"}}),{fields:c,append:u,remove:m}=jr({control:r,name:"values"}),g=(y,h)=>{const k=()=>{t({title:i==="new"?"Annotation config created!":"Annotation config updated!"}),h()},S=F=>{l({title:i==="new"?"Failed to create annotation config":"Failed to update annotation config",message:F})};switch(y.annotationType){case"CATEGORICAL":{const F={annotationType:"CATEGORICAL",name:y.name,values:y.values,id:(a==null?void 0:a.id)||"",optimizationDirection:y.optimizationDirection,description:y.description};n(F,{onCompleted:k,onError:S});break}case"CONTINUOUS":{const F={annotationType:"CONTINUOUS",name:y.name,lowerBound:y.lowerBound,upperBound:y.upperBound,id:(a==null?void 0:a.id)||"",optimizationDirection:y.optimizationDirection,description:y.description};n(F,{onCompleted:k,onError:S});break}case"FREEFORM":{const F={annotationType:"FREEFORM",name:y.name,id:(a==null?void 0:a.id)||"",description:y.description};n(F,{onCompleted:k,onError:S});break}}},p=d("annotationType");return e(re,{css:K`
        border: none;
        width: 700px;
        max-width: 90%;
      `,children:({close:y})=>e(ee,{title:i==="new"?"New Annotation Config":"Edit Annotation Config",children:o(bn,{onSubmit:h=>{s(k=>{g(k,y)})(h)},children:[e(C,{minWidth:"200px",padding:"size-200",children:o(b,{direction:"column",gap:"size-200",className:"new-annotation-dialog-container",children:[e(H,{name:"name",control:r,rules:{required:"Name is required"},render:({field:h,fieldState:{error:k}})=>o(Fe,{...h,isInvalid:!!k,autoFocus:!0,children:[e(J,{children:"Annotation Name"}),e(ge,{placeholder:"e.g. correctness"}),e(Ae,{children:k==null?void 0:k.message})]})}),e(H,{name:"description",control:r,render:({field:h})=>o(Fe,{...h,value:h.value??void 0,css:K`
                        & .react-aria-TextArea {
                          resize: vertical;
                          transition: none;
                        }
                      `,children:[e(J,{children:"Description"}),e(Ha,{rows:2,placeholder:"A description of the annotation configuration"})]})}),e(H,{control:r,name:"annotationType",render:({field:h})=>o(Fo,{...h,"aria-label":"Type","data-testid":"type-picker",isReadOnly:i==="edit",children:[e(J,{children:"Annotation Type"}),iF.filter(k=>i==="edit"?k===h.value:k).map(k=>e(Co,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()},k)),o(v,{slot:"description",children:["Categorical - assign a category - e.g. grade, A, B, C",e("br",{}),"Continuous - assign a score within a range - e.g. 0-1, 0.5",e("br",{}),'Freeform - assign a freeform text comment, e.g. "good"']})]})}),(p==="CONTINUOUS"||p==="CATEGORICAL")&&e(H,{control:r,name:"optimizationDirection",render:({field:h})=>o(Fo,{...h,"aria-label":"Optimization Direction","data-testid":"optimization-direction-picker",css:K`
                          height: 100%;
                        `,children:[e(J,{children:"Optimization Direction"}),tF.map(k=>e(Co,{value:k,children:k.charAt(0).toUpperCase()+k.slice(1).toLowerCase()},k)),o(v,{marginTop:"auto",slot:"description",children:["Maximize - higher the score the better - e.g., correctness",e("br",{}),"Minimize - lower the score the better - e.g., hallucinations",e("br",{}),"None - higher is not better or worse",e("br",{})]})]})}),p==="CONTINUOUS"&&o(b,{gap:"size-800",css:K`
                      // prevent input from growing when sibling inputs have errors
                      & input {
                        max-height: fit-content;
                      }
                    `,children:[e(H,{control:r,name:"lowerBound",rules:{required:"Min is required"},render:({field:{value:h,...k},fieldState:{error:S}})=>o(Ya,{...k,value:typeof h=="number"?h:void 0,isInvalid:!!S,children:[e(J,{children:"Min"}),e(ge,{placeholder:"0"}),e(Ae,{children:S==null?void 0:S.message})]})}),e(H,{control:r,name:"upperBound",rules:{validate:h=>{const k=d("lowerBound");return k!=null&&h!=null&&h<=k?"Max must be greater than min":h!=null&&isNaN(h)?"Max is required":!0}},render:({field:{value:h,...k},fieldState:{error:S}})=>{const F=d("lowerBound");return o(Ya,{...k,value:typeof h=="number"?h:void 0,isInvalid:!!S,minValue:typeof F=="number"?F:void 0,children:[e(J,{children:"Max"}),e(ge,{placeholder:"1"}),e(Ae,{children:S==null?void 0:S.message})]})}})]}),p==="CATEGORICAL"&&o(te,{children:[e(v,{size:"XS",weight:"heavy",children:"Categories"}),c.map((h,k)=>o(b,{direction:"row",gap:"size-100",alignItems:"start",children:[e(H,{control:r,name:`values.${k}.label`,rules:{required:"Category label is required"},render:({field:S,fieldState:{error:F}})=>o(Fe,{...S,"aria-label":`Value ${k+1}`,isInvalid:!!F,autoFocus:k>0,children:[e(ge,{placeholder:`e.g. ${qo[k%qo.length]}`}),e(Ae,{children:F==null?void 0:F.message})]})}),e(H,{control:r,name:`values.${k}.score`,render:({field:S,fieldState:{error:F}})=>o(Ya,{...S,value:typeof S.value=="number"?S.value:void 0,"aria-label":`Score ${k+1}`,isInvalid:!!F,children:[e(b,{direction:"row",gap:"size-100",alignItems:"center",children:e(ge,{placeholder:`e.g. ${k} (optional)`})}),e(Ae,{children:F==null?void 0:F.message})]})}),e(R,{type:"button",leadingVisual:e(x,{svg:e(Tn,{})}),"aria-label":"Remove category",onPress:()=>m(k)})]},h.id)),e(b,{justifyContent:"end",width:"100%",children:e(R,{type:"button",onPress:()=>{u({label:"",score:null})},leadingVisual:e(x,{svg:e(Mn,{})}),children:"Add category"})})]})]})}),e(C,{paddingX:"size-200",paddingY:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(R,{type:"button",onPress:y,children:"Cancel"}),e(R,{type:"submit",variant:"primary",children:i==="new"?"Create Annotation Config":"Update Annotation Config"})]})})]})})})},Nu=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AnnotationConfigTableFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t],type:"FreeformAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();Nu.hash="21da6fc76dc125423a2f4ecd8ef70866";const rF=({selectedConfig:n,onClearSelection:a,onEditAnnotationConfig:l,onDeleteAnnotationConfig:t})=>{const[i,r]=f.useState(!1);if(!n)return null;const s=n==null?void 0:n.id;return e("div",{"data-editing":i,css:K`
        position: fixed;
        bottom: var(--ac-global-dimension-size-600);
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        box-shadow: 8px 8px 20px 0 rgba(0, 0, 0, 0.4);
        border-radius: var(--ac-global-rounding-medium);
        &[data-editing="true"] {
          display: none;
        }
      `,children:e(C,{backgroundColor:"light",padding:"size-200",borderColor:"light",borderWidth:"thin",borderRadius:"medium",minWidth:"size-6000",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",justifyContent:"space-between",children:[o(v,{children:['Config: "',n==null?void 0:n.name,'"']}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(R,{variant:"quiet",onPress:a,children:"Clear Selection"}),o(se,{onOpenChange:d=>{r(d),d||a()},children:[o(R,{variant:"danger",size:"S",children:[e(x,{svg:e(Tn,{})}),"Delete"]}),e(oe,{children:e(ae,{children:e(re,{css:K`
                      border: none;
                    `,children:({close:d})=>o(ee,{title:"Delete Annotation Config",children:[e(C,{padding:"size-200",children:e(v,{children:"Are you sure you want to delete this annotation config? Annotations made with this config will not be impacted."})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(R,{variant:"quiet",onPress:d,children:"Cancel"}),e(R,{size:"S",variant:"danger",onPress:()=>{s&&t(s,{onCompleted:()=>{d()}})},children:"Delete"})]})})]})})})})]}),o(se,{onOpenChange:d=>{r(d),d||a()},children:[o(R,{size:"S",variant:"primary",children:[e(x,{svg:e(Xl,{})}),"Edit"]}),e(oe,{children:e(ae,{children:e(Vu,{initialAnnotationConfig:n,onAddAnnotationConfig:l})})})]})]})]})})})},sF=[{id:"select",maxSize:10,header:()=>null,cell:({row:n})=>e(Va,{isSelected:n.getIsSelected(),isDisabled:!n.getCanSelect(),isIndeterminate:n.getIsSomeSelected(),onChange:n.toggleSelected})},{id:"name",header:"Name",accessorKey:"name",cell:({row:n})=>e(es,{annotation:n.original,annotationDisplayPreference:"none",css:K`
            width: fit-content;
          `},n.original.id)},{id:"description",header:"Description",accessorKey:"description",sortUndefined:"last",accessorFn:n=>n.description??void 0,maxSize:150,cell:({row:n})=>e(mn,{maxWidth:"100%",children:e(v,{children:n.original.description})})},{id:"annotationType",header:"Type",accessorKey:"annotationType",minSize:10,cell:({row:n})=>e(v,{children:n.original.annotationType.charAt(0).toUpperCase()+n.original.annotationType.slice(1).toLowerCase()})},{id:"values",header:"Values",enableSorting:!1,accessorFn:n=>{switch(n.annotationType){case"CATEGORICAL":{if(!n.values)return"";let a=n.values.map((l,t)=>e(nn,{title:l.label,children:e(mn,{maxWidth:"40px",children:l.label})},t));return n.values.length>5&&(a=[...a.slice(-4),o(Se,{delay:64,children:[e(Zn,{children:o(nn,{css:K`
                      white-space: nowrap;
                    `,children:["+ ",n.values.length-5," more"]},"ellipsis")}),o($e,{placement:"bottom right",children:[e(ln,{}),n.values.map(l=>l.label).join(", ")]})]},"ellipsis")]),a}case"CONTINUOUS":return`from ${n.lowerBound} to ${n.upperBound}`;case"FREEFORM":return"";default:return""}},cell:({getValue:n})=>{const a=n();return e(b,{gap:"size-100",children:a})}}],oF=({annotationConfigs:n,onDeleteAnnotationConfig:a,onEditAnnotationConfig:l})=>{"use no memo";const[t,i]=f.useState({}),r=T.useFragment(Nu,n),s=f.useMemo(()=>r.annotationConfigs.edges.map(y=>y.annotationConfig),[r.annotationConfigs.edges]),d=Qe({data:s,columns:sF,getCoreRowModel:Be(),getSortedRowModel:Vn(),enableRowSelection:!0,onRowSelectionChange:i,enableMultiRowSelection:!1,state:{rowSelection:t}}),c=d.getRowCount()===0,u=d.getRowModel().rows,m=d.getSelectedRowModel().rows,g=m.map(y=>y.original),p=()=>{i({})};return o("div",{css:K`
        overflow: auto;
      `,children:[o("table",{css:Kn,style:{width:d.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:d.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(h=>e("th",{colSpan:h.colSpan,children:h.isPlaceholder?null:o("div",{className:h.column.getCanSort()?"sort":"",onClick:h.column.getToggleSortingHandler(),style:{left:h.getStart(),width:h.getSize()},children:[de(h.column.columnDef.header,h.getContext()),h.column.getIsSorted()?e(x,{className:"sort-icon",svg:h.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},h.id))},y.id))}),c?e(Xn,{message:"No Annotation Configs"}):e("tbody",{children:u.map(y=>e("tr",{onClick:()=>{i({[y.id]:!(t!=null&&t[y.id])})},children:y.getVisibleCells().map(h=>e("td",{style:{width:h.column.getSize(),maxWidth:h.column.getSize()},children:de(h.column.columnDef.cell,h.getContext())},h.id))},y.id))})]}),m.length>0&&e(rF,{selectedConfig:g[0],onClearSelection:p,onEditAnnotationConfig:l,onDeleteAnnotationConfig:a})]})},zu=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsAnnotationsPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"SettingsAnnotationsPageFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsAnnotationsPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotationConfig",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t,i,{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n,a,l,t],type:"FreeformAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"38239699bb1676189730a7c5bfaf3e16",id:null,metadata:{},name:"settingsAnnotationsPageLoaderQuery",operationKind:"query",text:`query settingsAnnotationsPageLoaderQuery {
  ...SettingsAnnotationsPageFragment
}

fragment AnnotationConfigTableFragment on Query {
  annotationConfigs {
    edges {
      annotationConfig: node {
        __typename
        ... on CategoricalAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          id
          name
          description
          annotationType
          optimizationDirection
          upperBound
          lowerBound
        }
        ... on FreeformAnnotationConfig {
          id
          name
          description
          annotationType
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
}

fragment SettingsAnnotationsPageFragment on Query {
  ...AnnotationConfigTableFragment
}
`}}})();zu.hash="b14c2976ebc78d4709a4e54aa2a20132";const $u=zu;function O9(){return T.loadQuery(ze,$u,{})}const j9=()=>{const n=wn();Xe(n);const a=T.usePreloadedQuery($u,n);return e(dF,{annotations:a})},dF=({annotations:n})=>{const[a,l]=T.useRefetchableFragment(Ru,n),t=()=>{l({},{fetchPolicy:"store-and-network"})},[i]=T.useMutation(wu),[r]=T.useMutation(Eu),s=g=>p=>{const y=je(p);g==null||g((y==null?void 0:y[0])??"Failed to create annotation config")},d=(g,{onCompleted:p,onError:y}={})=>{const{id:h,annotationType:k,...S}=g,F=k.toLowerCase();r({variables:{input:{annotationConfig:{[F]:S}}},onCompleted:()=>{p==null||p(),t()},onError:s(y)})},[c]=T.useMutation(Au);return e(ee,{title:"Annotation Configs",extra:o(se,{children:[o(R,{size:"S",children:[e(x,{svg:e(Mn,{})}),"New Configuration"]}),e(oe,{children:e(ae,{children:e(Vu,{onAddAnnotationConfig:d})})})]}),children:e(oF,{annotationConfigs:a,onEditAnnotationConfig:(g,{onCompleted:p,onError:y}={})=>{const{id:h,annotationType:k,...S}=g,F=k.toLowerCase();c({variables:{input:{id:h,annotationConfig:{[F]:S}}},onCompleted:()=>{p==null||p(),t()},onError:s(y)})},onDeleteAnnotationConfig:(g,{onCompleted:p,onError:y}={})=>{i({variables:{input:{ids:[g]}},onCompleted:()=>{p==null||p(),t()},onError:s(y)})}})})},Ou=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},d=[t,i,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[s,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,t],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"CreateRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"createProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"RetentionPoliciesTable_retentionPolicy",selections:d,args:null,argumentDefinitions:[]}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"CreateRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"createProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:d,storageKey:null},{alias:null,args:null,filters:null,handle:"prependNode",key:"",kind:"LinkedHandle",name:"node",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"},{kind:"Literal",name:"edgeTypeName",value:"ProjectTraceRetentionPolicyEdge"}]}],storageKey:null}]},params:{cacheID:"e0981aca4bdf8872ca8bb16aba1f9b5c",id:null,metadata:{},name:"CreateRetentionPolicyMutation",operationKind:"mutation",text:`mutation CreateRetentionPolicyMutation(
  $input: CreateProjectTraceRetentionPolicyInput!
) {
  createProjectTraceRetentionPolicy(input: $input) {
    node {
      ...RetentionPoliciesTable_retentionPolicy
      id
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}})();Ou.hash="a111dbcaa8facd112289cd919cca3a3b";const ju=({numberOfDays:n,numberOfTraces:a})=>{if(n===0&&!a)return"This policy will not delete any traces.";const l=n!=null&&!isNaN(n)?`older than ${n} days`:"",t=a!=null&&!isNaN(a)?`when there are more than ${a} traces`:"",i=l&&t?`${l} or ${t}`:l||t;return i===""?"Enter a number of days or a number of traces, or both, to configure this policy.":`This policy will delete traces ${i}`},Us=({schedule:n})=>{let a="unknown";try{vS.parse(n)}catch{return"invalid schedule"}try{a=CS.toString(n)}catch{return"invalid schedule"}return`${a} (UTC)`};function Qu(n){"use no memo";const{onSubmit:a,mode:l,isSubmitting:t,defaultValues:i}=n,{control:r,watch:s,handleSubmit:d}=sn({defaultValues:i??{name:"New Policy",numberOfTraces:null,numberOfDays:400,schedule:"0 0 * * 0"},mode:"onChange"}),[c,u,m]=s(["numberOfDays","numberOfTraces","schedule"]);return o(bn,{onSubmit:d(a),children:[o(C,{padding:"size-200",children:[e("p",{children:"A retention policy can be defined so that either a certain number of traces or traces for a certain amount of time is retained in certain projects. If both are defined, the policy will delete traces that are either older than the number of days or have more than the number of traces, whichever comes first."}),e("p",{children:"Once a retention policy is defined, you can associate multiple projects to the same policy."}),o(b,{direction:"row",gap:"size-100",children:[o(C,{flex:"1 1 auto",children:[e(H,{control:r,name:"name",rules:{required:"Name is required"},render:({field:g,fieldState:{invalid:p,error:y}})=>o(Fe,{...g,size:"S",value:g.value,isInvalid:p,children:[e(J,{children:"Name"}),e(ge,{}),y?e(Ae,{children:y==null?void 0:y.message}):e(v,{slot:"description",children:"The name of the retention policy"})]})}),e(H,{control:r,name:"numberOfDays",rules:{required:"Number of days is required. 0 means infinite.",min:{value:0,message:"Number of days must be at least 0"}},render:({field:g,fieldState:{invalid:p,error:y}})=>o(Ya,{step:1,size:"S",...g,isInvalid:p,children:[e(J,{children:"Number of Days"}),e(ge,{}),y?e(Ae,{children:y==null?void 0:y.message}):e(v,{slot:"description",children:"The number of days that will be kept"})]})}),e(H,{control:r,name:"numberOfTraces",rules:{min:{value:0,message:"Number of traces must be at least 0"}},render:({field:g,fieldState:{invalid:p,error:y}})=>o(Ya,{step:1,size:"S",value:g.value??void 0,onChange:g.onChange,onBlur:g.onBlur,isInvalid:p,children:[e(J,{children:"Number of Traces"}),e(ge,{}),y?e(Ae,{children:y==null?void 0:y.message}):e(v,{slot:"description",children:"The number of traces that will be kept"})]})}),e(H,{control:r,name:"schedule",rules:{required:"Schedule is required",validate:g=>{try{const p=KS.CronExpressionParser.parse(g);if(!p.fields.dayOfMonth.isWildcard)return"Cannot set day of month, must be *";if(!p.fields.month.isWildcard)return"Cannot set month, must be *";if(p.fields.minute.values.length>=1&&p.fields.minute.values[0]!==0)return"Cannot set minute, must be 0"}catch(p){return p instanceof Error?p.message:"Invalid cron expression"}}},render:({field:g,fieldState:p})=>o(Fe,{...g,size:"S",...g,isInvalid:!!p.error,children:[e(J,{children:"Schedule"}),e(ge,{}),p.error?e(Ae,{children:p.error.message}):e(v,{slot:"description",children:"A cron expression for the hour of the week"})]})})]}),o(C,{width:"300px",paddingX:"size-200",children:[e(Te,{level:2,children:"Retention Policy"}),e("br",{}),e(v,{color:"text-700",children:ju({numberOfDays:c,numberOfTraces:u??void 0})}),e("br",{}),e("br",{}),e(v,{color:"text-700",children:`Enforcement Schedule: ${Us({schedule:m})}`})]})]})]}),e(C,{paddingY:"size-100",paddingX:"size-200",borderTopWidth:"thin",borderColor:"dark",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{size:"S",slot:"close",onPress:n.onCancel,children:"Cancel"}),e(R,{size:"S",variant:"primary",type:"submit",isDisabled:t,children:t?"Submitting...":l==="create"?"Create":"Update"})]})})]})}function cF(n){const[a,l]=f.useState(null),t=Le(),[i,r]=T.useMutation(Ou);return o(te,{children:[a&&e(Ee,{variant:"danger",children:a}),e(Qu,{onSubmit:d=>{l(null);let c;if(d.numberOfDays&&d.numberOfTraces)c={maxDaysOrCount:{maxDays:d.numberOfDays,maxCount:d.numberOfTraces}};else if(d.numberOfDays)c={maxDays:{maxDays:d.numberOfDays}};else if(d.numberOfTraces)c={maxCount:{maxCount:d.numberOfTraces}};else if(d.numberOfDays===0)c={maxDays:{maxDays:0}};else{l("Invalid retention policy rule. Please enter a number of days or a number of traces, or both, to configure this policy.");return}const u=T.ConnectionHandler.getConnectionID("client:root","RetentionPoliciesTable_projectTraceRetentionPolicies");i({variables:{input:{cronExpression:d.schedule,rule:c,name:d.name},connectionId:u},onCompleted:()=>{t({title:"Retention policy created successfully",message:"The retention policy has been created. You can now add this policy to projects."}),n.onCreate()},onError:m=>{var g;l(((g=je(m))==null?void 0:g.join(`
`))??"An unknown error occurred while creating the retention policy. Please try again.")}})},isSubmitting:r,mode:"create"})]})}const Bu=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RetentionPoliciesTablePoliciesQuery",selections:[{args:a,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RetentionPoliciesTablePoliciesQuery",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[s,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],storageKey:null}],storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}]},params:{cacheID:"67d653235070dbcfe47baecdadd89b38",id:null,metadata:{},name:"RetentionPoliciesTablePoliciesQuery",operationKind:"query",text:`query RetentionPoliciesTablePoliciesQuery(
  $after: String = null
  $first: Int = 1000
) {
  ...RetentionPoliciesTable_policies_2HEEH6
}

fragment RetentionPoliciesTable_policies_2HEEH6 on Query {
  projectTraceRetentionPolicies(first: $first, after: $after) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}})();Bu.hash="8da56e8b5110f6f33602737458f4ab8b";const qu=(function(){var n=["projectTraceRetentionPolicies"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Bu}},name:"RetentionPoliciesTable_policies",selections:[{alias:"projectTraceRetentionPolicies",args:null,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"__RetentionPoliciesTable_projectTraceRetentionPolicies_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineDataFragmentSpread",name:"RetentionPoliciesTable_retentionPolicy",selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,{kind:"InlineFragment",selections:[i],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[r,i],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,a],storageKey:null}],storageKey:null}],storageKey:null}],args:null,argumentDefinitions:[]},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();qu.hash="8da56e8b5110f6f33602737458f4ab8b";const Uu={kind:"InlineDataFragment",name:"RetentionPoliciesTable_retentionPolicy"};Uu.hash="f4bc351137b27b6a15a8ebbf0cdd8447";const Hu=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"policyId"},l=[{fields:[{kind:"Variable",name:"id",variableName:"policyId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:1e3}],r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"RetentionPolicyActionMenuDeletePolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"deleteProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"RetentionPolicyActionMenuDeletePolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"deleteProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:i,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,r,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[s,{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[c,d],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[r,t],storageKey:null}],storageKey:null}],storageKey:null},s],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:i,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"id",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"}]}],storageKey:null}],storageKey:null}]},params:{cacheID:"25d6433327bd55427c59288866e3f402",id:null,metadata:{},name:"RetentionPolicyActionMenuDeletePolicyMutation",operationKind:"mutation",text:`mutation RetentionPolicyActionMenuDeletePolicyMutation(
  $policyId: ID!
) {
  deleteProjectTraceRetentionPolicy(input: {id: $policyId}) {
    query {
      ...RetentionPoliciesTable_policies
    }
    node {
      id
    }
  }
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}})();Hu.hash="8bcb6bc7271304d7bf45d4a661cee1ff";const Gu=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Literal",name:"first",value:1e3}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditRetentionPolicyMutation",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditRetentionPolicyMutation",selections:[{alias:null,args:a,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[r,{kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[d,s],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,t],storageKey:null}],storageKey:null}],storageKey:null},r],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:l,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}],storageKey:null}],storageKey:null}]},params:{cacheID:"33fe12216c505479e31745383b2089cb",id:null,metadata:{},name:"EditRetentionPolicyMutation",operationKind:"mutation",text:`mutation EditRetentionPolicyMutation(
  $input: PatchProjectTraceRetentionPolicyInput!
) {
  patchProjectTraceRetentionPolicy(input: $input) {
    query {
      ...RetentionPoliciesTable_policies
    }
  }
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}})();Gu.hash="9abcdadabb062864df4609df1e0448fd";const Wu=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},s={kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxCount",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},c={kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},u={kind:"InlineFragment",selections:[d,r],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null},m={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditRetentionPolicyQuery",selections:[{alias:"retentionPolicy",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[s,c,u],storageKey:null}],type:"ProjectTraceRetentionPolicy",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditRetentionPolicyQuery",selections:[{alias:"retentionPolicy",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[m,l,{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[m,s,c,u],storageKey:null}],type:"ProjectTraceRetentionPolicy",abstractKey:null}],storageKey:null}]},params:{cacheID:"3fe25e8ebefb19f49627fe187ba0eb5d",id:null,metadata:{},name:"EditRetentionPolicyQuery",operationKind:"query",text:`query EditRetentionPolicyQuery(
  $id: ID!
) {
  retentionPolicy: node(id: $id) {
    __typename
    ... on ProjectTraceRetentionPolicy {
      id
      name
      cronExpression
      rule {
        __typename
        ... on TraceRetentionRuleMaxCount {
          maxCount
        }
        ... on TraceRetentionRuleMaxDays {
          maxDays
        }
        ... on TraceRetentionRuleMaxDaysOrCount {
          maxDays
          maxCount
        }
      }
    }
    id
  }
}
`}}})();Wu.hash="3bf941d551e8fb7a6940d8774075be73";function uF(n){var c,u;const[a,l]=f.useState(null),t=Le(),i=T.useLazyLoadQuery(Wu,{id:n.policyId});if(!(i!=null&&i.retentionPolicy))throw new Error("Retention policy not found");const[r,s]=T.useMutation(Gu);return o(te,{children:[a&&e(Ee,{variant:"danger",children:a}),e(Qu,{onSubmit:m=>{l(null);let g;if(m.numberOfDays&&m.numberOfTraces)g={maxDaysOrCount:{maxDays:m.numberOfDays,maxCount:m.numberOfTraces}};else if(m.numberOfDays)g={maxDays:{maxDays:m.numberOfDays}};else if(m.numberOfTraces)g={maxCount:{maxCount:m.numberOfTraces}};else if(m.numberOfDays===0)g={maxDays:{maxDays:0}};else{l("Invalid retention policy rule. Please enter a number of days or a number of traces, or both, to configure this policy.");return}r({variables:{input:{id:n.policyId,cronExpression:m.schedule,rule:g,name:m.name}},onCompleted:()=>{t({title:"Retention policy updated successfully",message:"The retention policy has been updated successfully."}),n.onEditCompleted()},onError:p=>{var y;l(((y=je(p))==null?void 0:y.join(`
`))??"An unknown error occurred while updating the retention policy. Please try again.")}})},isSubmitting:s,mode:"edit",defaultValues:{name:i.retentionPolicy.name??"New Policy",schedule:i.retentionPolicy.cronExpression??"0 0 * * 0",numberOfDays:(c=i.retentionPolicy.rule)==null?void 0:c.maxDays,numberOfTraces:((u=i.retentionPolicy.rule)==null?void 0:u.maxCount)??null},onCancel:n.onCancel})]})}const mF="Default",gF=({policyId:n,policyName:a,projectNames:l,onPolicyEdit:t,onPolicyDelete:i})=>{const r=a!==mF,[s,d]=f.useState(!1),[c,u]=f.useState(!1),m=T.ConnectionHandler.getConnectionID("client:root","RetentionPoliciesTable_projectTraceRetentionPolicies"),[g,p]=T.useMutation(Hu);return o(ja,{children:[o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:o($n,{disabledKeys:r?[]:["deletePolicy"],onAction:y=>{switch(y){case"editPolicy":return d(!0);case"deletePolicy":return u(!0)}},children:[e(Oe,{id:"editPolicy",textValue:"Edit Policy",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Xl,{})}),e(v,{children:"Edit"})]})}),e(Oe,{id:"deletePolicy",textValue:"Delete Policy",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Tn,{})}),e(v,{children:"Delete"})]})})]})})]}),e(se,{isOpen:s,onOpenChange:d,children:e(oe,{children:e(ae,{size:"M",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Edit Retention Policy"}),e(ke,{children:e(be,{onPress:()=>d(!1),slot:"close"})})]}),e(f.Suspense,{fallback:e(me,{}),children:e(uF,{policyId:n,onEditCompleted:()=>{t(),d(!1)},onCancel:()=>{d(!1)}})})]})})})})}),e(se,{isOpen:c,onOpenChange:u,children:e(oe,{children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Retention Policy"}),e(ke,{children:e(be,{slot:"close"})})]}),o(C,{padding:"size-200",children:[e(v,{color:"danger",children:`Are you sure you want to delete retention policy "${a}"? This cannot be undone.`}),e("br",{}),l.length>0&&e(v,{color:"danger",children:`This policy is associated with the following projects: ${l.join(", ")}. These projects will fall back to the default policy.`})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{variant:"default",size:"S",slot:"close",isDisabled:p,children:"Cancel"}),e(R,{variant:"danger",size:"S",onPress:()=>{g({variables:{policyId:n,connectionId:m}}),u(!1),i()},isDisabled:p,leadingVisual:p?e(x,{svg:e(ta,{})}):void 0,children:p?"Deleting...":"Delete Policy"})]})})]})})})})})]})},pF=Uu,yF=({query:n})=>{"use no memo";const a=Le(),l=zd(),{data:t}=T.usePaginationFragment(qu,n),i=f.useMemo(()=>t.projectTraceRetentionPolicies.edges.map(c=>{const u=c.node;return T.readInlineData(pF,u)}),[t]),r=f.useMemo(()=>{const c=[{header:"Name",accessorKey:"name"},{header:"Schedule",accessorKey:"cronExpression",cell:({row:u})=>Us({schedule:u.original.cronExpression})},{header:"Rule",accessorKey:"rule",cell:({row:u})=>{const m=u.original.rule;if(m.__typename==="TraceRetentionRuleMaxCount")return`${m.maxCount} traces`;if(m.__typename==="TraceRetentionRuleMaxDays")return m.maxDays===0?"Infinite":`${m.maxDays} days`;if(m.__typename==="TraceRetentionRuleMaxDaysOrCount")return`${m.maxDays} days or ${m.maxCount} traces`;if(m.__typename==="%other")return"Unknown";Ne()}},{header:"Projects",accessorKey:"projects",cell:({row:u})=>e("ul",{css:K`
                li {
                  display: inline;
                }
                li:not(:first-child):before {
                  content: ", ";
                }
              `,children:u.original.projects.edges.map(m=>e("li",{children:e(Dn,{to:`/projects/${m.node.id}/config`,children:m.node.name})},m.node.id))})}];return l&&c.push({id:"actions",cell:({row:u})=>e(gF,{policyId:u.original.id,policyName:u.original.name,projectNames:u.original.projects.edges.map(m=>m.node.name),onPolicyEdit:()=>{a({title:"Policy Updated",message:`Policy "${u.original.name}" was updated and will take effect shortly.`})},onPolicyDelete:()=>{a({title:"Policy deleted",message:`Policy "${u.original.name}" was deleted`})}})}),c},[l,a]),s=Qe({columns:r,data:i,getCoreRowModel:Be(),getSortedRowModel:Vn()}),d=s.getRowModel().rows;return o("table",{css:Kn,children:[e("thead",{children:s.getHeaderGroups().map(c=>e("tr",{children:c.headers.map(u=>e("th",{colSpan:u.colSpan,children:u.isPlaceholder?null:e("div",{children:de(u.column.columnDef.header,u.getContext())})},u.id))},c.id))}),e("tbody",{children:d.map(c=>e("tr",{children:c.getVisibleCells().map(u=>e("td",{children:de(u.column.columnDef.cell,u.getContext())},u.id))},c.id))})]})},Ju=(function(){var n=[{kind:"Literal",name:"first",value:1e3}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsDataPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"RetentionPoliciesTable_policies"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsDataPageLoaderQuery",selections:[{alias:null,args:n,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,{kind:"InlineFragment",selections:[i],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[r],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[r,i],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,a],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"projectTraceRetentionPolicies(first:1000)"},{alias:null,args:n,filters:null,handle:"connection",key:"RetentionPoliciesTable_projectTraceRetentionPolicies",kind:"LinkedHandle",name:"projectTraceRetentionPolicies"}]},params:{cacheID:"f9f28f0c1f07a912207e1a17f4a46292",id:null,metadata:{},name:"settingsDataPageLoaderQuery",operationKind:"query",text:`query settingsDataPageLoaderQuery {
  ...RetentionPoliciesTable_policies
}

fragment RetentionPoliciesTable_policies on Query {
  projectTraceRetentionPolicies(first: 1000) {
    edges {
      node {
        ...RetentionPoliciesTable_retentionPolicy
        id
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment RetentionPoliciesTable_retentionPolicy on ProjectTraceRetentionPolicy {
  id
  name
  cronExpression
  rule {
    __typename
    ... on TraceRetentionRuleMaxCount {
      maxCount
    }
    ... on TraceRetentionRuleMaxDays {
      maxDays
    }
    ... on TraceRetentionRuleMaxDaysOrCount {
      maxDays
      maxCount
    }
  }
  projects {
    edges {
      node {
        name
        id
      }
    }
  }
}
`}}})();Ju.hash="5d39aac927106159abef842419b123ed";const Zu=Ju;function Q9(){return T.loadQuery(ze,Zu,{})}function B9(){const n=wn();Xe(n);const a=T.usePreloadedQuery(Zu,n);return e(ee,{title:"Retention Policies",extra:e($d,{children:o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Mn,{})}),children:"New Policy"}),e(oe,{children:e(ae,{children:e(re,{children:({close:l})=>o(ye,{children:[o(fe,{children:[e(he,{children:"New Retention Policy"}),e(ke,{children:e(be,{slot:"close"})})]}),e(cF,{onCreate:()=>{l()}})]})})})})]})}),children:e(yF,{query:a})})}const Xu=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"description"},a={defaultValue:null,kind:"LocalArgument",name:"expiresAt"},l={defaultValue:null,kind:"LocalArgument",name:"name"},t=[{fields:[{kind:"Variable",name:"description",variableName:"description"},{kind:"Variable",name:"expiresAt",variableName:"expiresAt"},{kind:"Variable",name:"name",variableName:"name"}],kind:"ObjectValue",name:"input"}],i={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[r],storageKey:null},d=[r,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],storageKey:null},s],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,a],kind:"Operation",name:"APIKeysCardCreateSystemAPIKeyMutation",selections:[{alias:null,args:t,concreteType:"CreateSystemApiKeyMutationPayload",kind:"LinkedField",name:"createSystemApiKey",plural:!1,selections:[i,{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:d,storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:d,storageKey:null},r],storageKey:null}],storageKey:null},s],storageKey:null}]},params:{cacheID:"8c8ce75c9f917911796042954e2dbd3b",id:null,metadata:{},name:"APIKeysCardCreateSystemAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysCardCreateSystemAPIKeyMutation(
  $name: String!
  $description: String = null
  $expiresAt: DateTime = null
) {
  createSystemApiKey(input: {name: $name, description: $description, expiresAt: $expiresAt}) {
    jwt
    query {
      ...SystemAPIKeysTableFragment
    }
    apiKey {
      id
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  viewer {
    ...APIKeysTableFragment
    id
  }
}
`}}})();Xu.hash="a6f84fa9e14f363d2e7317d3d6507590";const Yu=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},r=[n,a,l,t,i];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"APIKeysCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"},{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"APIKeysCardQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:r,storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:r,storageKey:null},n],storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,a,l,t,i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},n],storageKey:null}],storageKey:null}]},params:{cacheID:"dffededefc14bbb83fd2538c612b4e32",id:null,metadata:{},name:"APIKeysCardQuery",operationKind:"query",text:`query APIKeysCardQuery {
  ...SystemAPIKeysTableFragment
  ...UserAPIKeysTableFragment
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  viewer {
    ...APIKeysTableFragment
    id
  }
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      username
      id
    }
  }
}
`}}})();Yu.hash="ad967afd45af0d5976982c70eaadb330";const em=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteSystemApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SystemAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"a8c45c42b5becca8efa65334285a2f97",id:null,metadata:{},name:"SystemAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation SystemAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteSystemApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}})();em.hash="55ab8200b5bfda0aa73594ad5cfce96f";const nm=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a=[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SystemAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"SystemAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SystemAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:a,storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:a,storageKey:null},n],storageKey:null}]},params:{cacheID:"e74fe5502ea6e732c2aecb5cef899623",id:null,metadata:{},name:"SystemAPIKeysTableQuery",operationKind:"query",text:`query SystemAPIKeysTableQuery {
  ...SystemAPIKeysTableFragment
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment SystemAPIKeysTableFragment on Query {
  systemApiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  viewer {
    ...APIKeysTableFragment
    id
  }
}
`}}})();nm.hash="459f07f740e1b27f3839eedd3eff3083";const am={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:nm}},name:"SystemAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"SystemApiKey",kind:"LinkedField",name:"systemApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null};am.hash="459f07f740e1b27f3839eedd3eff3083";function fF({query:n}){"use no memo";const[a,l]=T.useRefetchableFragment(am,n),t=Ve(),i=Le(),[r]=T.useMutation(em),s=f.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"System key deleted",message:"The system key has been deleted and is no longer active."}),f.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:y=>{const h=je(y);t({title:"Error deleting system key",message:(h==null?void 0:h[0])??y.message})}})},[r,t,i,l]),d=f.useMemo(()=>[...a.systemApiKeys],[a]),c=f.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:In},{header:"Created At",accessorKey:"createdAt",cell:tn},{header:"Expires At",accessorKey:"expiresAt",cell:tn},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(ns,{handleDelete:()=>{s(y.original.id)}})}),meta:{textAlign:"right"}}],[s]),u=Qe({columns:c,data:d,getCoreRowModel:Be()}),m=u.getRowModel().rows,g=u.getRowModel().rows.length===0;return o("table",{css:Kn,children:[e("thead",{children:u.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:o("div",{className:y.column.getCanSort()?"sort":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[de(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(x,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},y.id))},p.id))}),g?e(Xn,{message:"No Keys"}):e("tbody",{children:m.map(p=>e("tr",{children:p.getVisibleCells().map(y=>e("td",{children:de(y.column.columnDef.cell,y.getContext())},y.id))},p.id))})]})}const lm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"apiKeyId",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserAPIKeysTableDeleteAPIKeyMutation",selections:a},params:{cacheID:"d137498515ff43864f5525b3c1847376",id:null,metadata:{},name:"UserAPIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation UserAPIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    __typename
    apiKeyId
  }
}
`}}})();lm.hash="9b1d898d1d9858016bed85000ce3906e";const tm=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UserAPIKeysTableQuery",selections:[{args:null,kind:"FragmentSpread",name:"UserAPIKeysTableFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UserAPIKeysTableQuery",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},n],storageKey:null}],storageKey:null}]},params:{cacheID:"86a98c02f3430470a286f0553511e8ed",id:null,metadata:{},name:"UserAPIKeysTableQuery",operationKind:"query",text:`query UserAPIKeysTableQuery {
  ...UserAPIKeysTableFragment
}

fragment UserAPIKeysTableFragment on Query {
  userApiKeys {
    id
    name
    description
    createdAt
    expiresAt
    user {
      username
      id
    }
  }
}
`}}})();tm.hash="720721b1409e41ca6fc2994af7784a18";const im={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:tm}},name:"UserAPIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"userApiKeys",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};im.hash="720721b1409e41ca6fc2994af7784a18";const Uo=70;function hF({query:n}){"use no memo";const[a,l]=T.useRefetchableFragment(im,n),t=Ve(),i=Le(),[r]=T.useMutation(lm),s=f.useCallback(p=>{r({variables:{input:{id:p}},onCompleted:()=>{i({title:"User key deleted",message:"The user key has been deleted and is no longer active."}),f.startTransition(()=>{l({},{fetchPolicy:"network-only"})})},onError:y=>{const h=je(y);t({title:"Error deleting user key",message:(h==null?void 0:h[0])??y.message})}})},[r,t,i,l]),d=f.useMemo(()=>[...a.userApiKeys],[a]),c=f.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:In},{header:"Description",accessorKey:"description",cell:In},{header:"Created At",accessorKey:"createdAt",size:Uo,cell:tn},{header:"Expires At",accessorKey:"expiresAt",size:Uo,cell:tn},{header:"User",size:120,accessorKey:"user.username",cell:In},{header:"",accessorKey:"id",size:10,cell:({row:y})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(ns,{handleDelete:()=>{s(y.original.id)}})}),meta:{textAlign:"right"}}],[s]),u=Qe({columns:c,data:d,getCoreRowModel:Be()}),m=u.getRowModel().rows,g=u.getRowModel().rows.length===0;return o("table",{css:Kn,children:[e("thead",{children:u.getHeaderGroups().map(p=>e("tr",{children:p.headers.map(y=>e("th",{colSpan:y.colSpan,children:y.isPlaceholder?null:o("div",{className:y.column.getCanSort()?"sort":"",onClick:y.column.getToggleSortingHandler(),style:{left:y.getStart(),width:y.getSize()},children:[de(y.column.columnDef.header,y.getContext()),y.column.getIsSorted()?e(x,{className:"sort-icon",svg:y.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},y.id))},p.id))}),g?e(Xn,{message:"No Keys"}):e("tbody",{children:m.map(p=>e("tr",{children:p.getVisibleCells().map(y=>e("td",{children:de(y.column.columnDef.cell,y.getContext())},y.id))},p.id))})]})}function kF({fetchKey:n}){const a=T.useLazyLoadQuery(Yu,{},{fetchPolicy:"network-only",fetchKey:n});return o(jn,{children:[o(On,{children:[e(ve,{id:"system",children:"System Keys"}),e(ve,{id:"user",children:"User Keys"})]}),e(Re,{id:"system",children:e(fF,{query:a})}),e(Re,{id:"user",children:e(hF,{query:a})})]})}function bF(){const[n,a]=f.useState(!1),[l,t]=f.useState(null),[i,r]=f.useState(0),s=Ve(),[d,c]=T.useMutation(Xu),u=f.useCallback(m=>{var g;d({variables:{...m,expiresAt:((g=m.expiresAt)==null?void 0:g.toDate(nt()).toISOString())||null},onCompleted:p=>{r(y=>y+1),a(!1),t(p.createSystemApiKey.jwt)},onError:p=>{s({title:"Error creating system key",message:p.message})}})},[d,s]);return o("div",{children:[e(ee,{titleSeparator:!1,title:"API Keys",extra:o(se,{isOpen:n,onOpenChange:()=>a(!1),children:[e(R,{size:"S",onPress:()=>a(!0),leadingVisual:e(x,{svg:e(xl,{})}),children:"System Key"}),e(oe,{children:e(ae,{size:"M",children:e(Od,{onSubmit:u,isCommitting:c,defaultName:"System"})})})]}),children:e(f.Suspense,{fallback:e(C,{padding:"size-100",children:e(me,{})}),children:e(kF,{fetchKey:i})})}),e(se,{isOpen:!!l,onOpenChange:()=>t(null),children:e(oe,{children:e(ae,{size:"L",children:e(jd,{jwt:l??""})})})})]})}const rm={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DBUsagePieChart_data",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}],type:"Query",abstractKey:null};rm.hash="922bf6de312a4be0c38025ffbb868d6d";function qr(n,a){const{si:l=!1,decimalPlaces:t=1}={},i=l?1e3:1024;if(Math.abs(n)<i)return n+" B";const r=l?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"];let s=-1;const d=10**t;do n/=i,++s;while(Math.round(Math.abs(n)*d)/d>=i&&s<r.length-1);return n.toFixed(t)+" "+r[s]}const Ho="remaining";function SF({active:n,payload:a}){return n&&a&&a.length?e(gn,{children:e(_e,{shape:"square",color:a[0].payload.fill||"transparent",name:a[0].name||"--",value:qr(a[0].value||0)})}):null}function vF({query:n}){const a=T.useFragment(rm,n),l=a.dbTableStats.reduce((r,s)=>r+((s==null?void 0:s.numBytes)??0),0),t=typeof a.dbStorageCapacityBytes=="number"?a.dbStorageCapacityBytes-l:null,i=f.useMemo(()=>{const r=[...a.dbTableStats];return t!==null&&t>0&&r.push({tableName:Ho,numBytes:t}),r},[a.dbTableStats,t]);return e(yn,{width:"100%",height:245,children:o(zs,{children:[e(Vs,{data:i,dataKey:"numBytes",nameKey:"tableName",cx:"50%",cy:"50%",innerRadius:70,outerRadius:110,strokeWidth:0,stroke:"transparent",children:i.map((r,s)=>e(Ns,{stroke:"0",fill:r.tableName===Ho?"var(--ac-global-color-grey-200)":`${No[s%No.length]}`},`cell-${s}`))}),e(pn,{content:SF}),e("text",{x:"50%",y:"50%",textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-xl)",children:`${typeof a.dbStorageCapacityBytes=="number"?$t(l/a.dbStorageCapacityBytes*100):qr(l)}`}),e("text",{x:"50%",y:"50%",dy:25,textAnchor:"middle",fill:"var(--ac-global-text-color-900",fontSize:"var(--ac-global-font-size-s)",children:"Used"}),o("g",{children:[typeof a.dbStorageCapacityBytes=="number"&&o(te,{children:[e("text",{x:"0%",y:"0%",dx:10,dy:15,textAnchor:"start",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:"Capacity:"}),e("text",{x:"0%",y:"0%",dx:10,dy:28,textAnchor:"start",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:qr(a.dbStorageCapacityBytes)})]}),e("text",{x:"100%",y:"100%",dx:-80,dy:-2,textAnchor:"end",fill:"var(--ac-global-text-color-500)",fontSize:"var(--ac-global-font-size-xs)",children:"* approximate"})]})]})})}const sm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null}],type:"TraceRetentionRuleMaxDays",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"GlobalRetentionPolicyCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"GlobalRetentionPolicyCardMutation",selections:a},params:{cacheID:"096e3d4c546229fc771e14be03b168a3",id:null,metadata:{},name:"GlobalRetentionPolicyCardMutation",operationKind:"mutation",text:`mutation GlobalRetentionPolicyCardMutation(
  $input: PatchProjectTraceRetentionPolicyInput!
) {
  patchProjectTraceRetentionPolicy(input: $input) {
    node {
      id
      rule {
        __typename
        ... on TraceRetentionRuleMaxDays {
          maxDays
        }
      }
    }
  }
}
`}}})();sm.hash="d1757c8159d448039635f1fe035803c4";const om=(function(){var n=[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"defaultProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null}],type:"TraceRetentionRuleMaxDays",abstractKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"GlobalRetentionPolicyCardQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"GlobalRetentionPolicyCardQuery",selections:n},params:{cacheID:"cc26cab6fcf5acfdf11abdb30f7f937f",id:null,metadata:{},name:"GlobalRetentionPolicyCardQuery",operationKind:"query",text:`query GlobalRetentionPolicyCardQuery {
  defaultProjectTraceRetentionPolicy {
    cronExpression
    id
    name
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
    }
  }
}
`}}})();om.hash="15a513ac6f9c30b739810e2e18d6f0ab";const FF=()=>{var m,g,p;const n=Le(),a=Ve(),l=T.useLazyLoadQuery(om,{}),[t]=T.useMutation(sm),{control:i,handleSubmit:r,formState:{isDirty:s},reset:d}=sn({defaultValues:{maxDays:((g=(m=l.defaultProjectTraceRetentionPolicy)==null?void 0:m.rule)==null?void 0:g.__typename)==="TraceRetentionRuleMaxDays"?l.defaultProjectTraceRetentionPolicy.rule.maxDays:0}}),c=(p=l.defaultProjectTraceRetentionPolicy)==null?void 0:p.id,u=f.useCallback(y=>{t({variables:{input:{id:c,rule:{maxDays:{maxDays:y.maxDays}}}},onCompleted:h=>{var S,F,I;const k=((I=(F=(S=h.patchProjectTraceRetentionPolicy)==null?void 0:S.node)==null?void 0:F.rule)==null?void 0:I.__typename)==="TraceRetentionRuleMaxDays"?h.patchProjectTraceRetentionPolicy.node.rule.maxDays:null;k!==null&&d({maxDays:k}),n(k===0?{title:"Default retention policy disabled",expireMs:5e3}:{title:`Default retention policy has been set to ${k} ${k===1?"day":"days"}`,expireMs:5e3})},onError:()=>{a({title:"Failed to update default retention policy",expireMs:5e3})}})},[c,a,n,t,d]);return o(ee,{title:"Default Project Retention Policy",children:[e(C,{padding:"size-200",children:o(b,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[e(C,{paddingTop:"size-100",children:e(v,{children:"The default retention policy for all projects that do not have their own custom retention policy. Traces that are older than the specified number of days will be deleted automatically in order to free up storage space."})}),e(C,{width:"1000px",children:e(bn,{onSubmit:r(u),children:o(b,{gap:"size-100",direction:"row",alignItems:"center",children:[e(H,{control:i,name:"maxDays",rules:{validate:y=>isNaN(y)?"Maximum trace retention is required. Set to 0 to disable.":!0,min:{value:0,message:"Maximum trace retention must be at least 0 days"},required:"Maximum trace retention is required. Set to 0 to disable."},render:({field:y,fieldState:h})=>{var k;return o(Ya,{...y,minValue:0,isInvalid:!!h.error,children:[e(J,{children:"Maximum Trace Retention in Days"}),e(ge,{}),h.error?e(Ae,{children:(k=h.error)==null?void 0:k.message}):e(v,{slot:"description",children:"0 days is equal to no policy."})]})}}),e("div",{css:K`
                    margin-top: 3px;
                  `,children:e(R,{type:"submit",isDisabled:!s,children:"Update"})})]})})})]})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(Dn,{to:"/settings/data",children:"All Retention Policies"})})})]})},dm={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsGeneralPageLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"DBUsagePieChart_data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsGeneralPageLoaderQuery",selections:[{alias:null,args:null,concreteType:"DbTableStats",kind:"LinkedField",name:"dbTableStats",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tableName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numBytes",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dbStorageCapacityBytes",storageKey:null}]},params:{cacheID:"b23054c72be2f3ddc335774d54407667",id:null,metadata:{},name:"settingsGeneralPageLoaderQuery",operationKind:"query",text:`query settingsGeneralPageLoaderQuery {
  ...DBUsagePieChart_data
}

fragment DBUsagePieChart_data on Query {
  dbTableStats {
    tableName
    numBytes
  }
  dbStorageCapacityBytes
}
`}};dm.hash="567b82d32463e4ba410f49c53bc9dcf2";const cm=dm;function q9(){return T.loadQuery(ze,cm,{})}const um=(function(){var n=[{kind:"Literal",name:"first",value:50}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UsersCardQuery",selections:[{args:null,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"UsersCardQuery",selections:[{alias:null,args:n,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"users(first:50)"},{alias:null,args:n,filters:null,handle:"connection",key:"UsersTable_users",kind:"LinkedHandle",name:"users"}]},params:{cacheID:"cf219c4e90184768fe95e1ab674036e0",id:null,metadata:{},name:"UsersCardQuery",operationKind:"query",text:`query UsersCardQuery {
  ...UsersTable_users
}

fragment UsersTable_users on Query {
  users(first: 50) {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
          id
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();um.hash="2b3e260c950dd1a6a1a6883ff6fb78c4";const mm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"createUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewUserDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewUserDialogMutation",selections:a},params:{cacheID:"e03311063b020f79a5ad0d89410dfc58",id:null,metadata:{},name:"NewUserDialogMutation",operationKind:"mutation",text:`mutation NewUserDialogMutation(
  $input: CreateUserInput!
) {
  createUser(input: $input) {
    user {
      id
      email
      username
    }
  }
}
`}}})();mm.hash="30cd721c401096c03fd7587053f35a21";function CF({onNewUserCreated:n,onNewUserCreationError:a,onDismiss:l}){const[t,i]=T.useMutation(mm),r=f.useCallback(p=>{t({variables:{input:{email:p.email,username:p.username,password:p.password,role:p.role,authMethod:"LOCAL",sendWelcomeEmail:!0}},onCompleted:y=>{n(y.createUser.user.username)},onError:y=>{a(y)}})},[t,n,a]),s=f.useCallback(p=>{t({variables:{input:{email:p.email,username:p.username,role:p.role,authMethod:"OAUTH2",sendWelcomeEmail:!0}},onCompleted:y=>{n(y.createUser.user.username)},onError:y=>{a(y)}})},[t,n,a]),d=f.useCallback(p=>{t({variables:{input:{email:p.email,username:p.username,role:p.role,authMethod:"LDAP",sendWelcomeEmail:!0}},onCompleted:y=>{n(y.createUser.user.username)},onError:y=>{a(y)}})},[t,n,a]),c=!window.Config.basicAuthDisabled,u=window.Config.oAuth2Idps.length>0,m=window.Config.ldapManualUserCreationEnabled;return e(oe,{isOpen:!0,onOpenChange:p=>{p||l()},children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Add User"}),e(be,{})]}),o(jn,{defaultSelectedKey:c?"local":u?"oauth2":m?"ldap":"local",children:[o(On,{children:[c&&e(ve,{id:"local",children:"Local"}),u&&e(ve,{id:"oauth2",children:"OAuth2"}),m&&e(ve,{id:"ldap",children:"LDAP"})]}),c&&e(ua,{id:"local",children:e(wk,{onSubmit:r,isSubmitting:i},"user-form")}),u&&e(ua,{id:"oauth2",children:e(Mk,{onSubmit:s,isSubmitting:i},"oauth-form")}),m&&e(ua,{id:"ldap",children:e(Rk,{onSubmit:d,isSubmitting:i},"ldap-form")})]})]})})})})}const gm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UsersTableQuery",selections:[{args:a,kind:"FragmentSpread",name:"UsersTable_users"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UsersTableQuery",selections:[{alias:null,args:a,concreteType:"UserConnection",kind:"LinkedField",name:"users",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"UsersTable_users",kind:"LinkedHandle",name:"users"}]},params:{cacheID:"989bed145551c10e1be0202ba01f29a6",id:null,metadata:{},name:"UsersTableQuery",operationKind:"query",text:`query UsersTableQuery(
  $after: String = null
  $first: Int = 50
) {
  ...UsersTable_users_2HEEH6
}

fragment UsersTable_users_2HEEH6 on Query {
  users(first: $first, after: $after) {
    edges {
      user: node {
        id
        email
        username
        createdAt
        authMethod
        profilePictureUrl
        role {
          name
          id
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();gm.hash="3e71021826f5285ec7804bb7637703fd";const pm=(function(){var n=["users"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:gm}},name:"UsersTable_users",selections:[{alias:"users",args:null,concreteType:"UserConnection",kind:"LinkedField",name:"__UsersTable_users_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"UserEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"user",args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();pm.hash="3e71021826f5285ec7804bb7637703fd";const ym=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionIds"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"userIds",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"DeleteUserDialogMutation",selections:[{alias:null,args:l,concreteType:"DeleteUsersPayload",kind:"LinkedField",name:"deleteUsers",plural:!1,selections:[t],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"DeleteUserDialogMutation",selections:[{alias:null,args:l,concreteType:"DeleteUsersPayload",kind:"LinkedField",name:"deleteUsers",plural:!1,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"userIds",handleArgs:[{kind:"Variable",name:"connections",variableName:"connectionIds"}]}],storageKey:null}]},params:{cacheID:"6104e51eeaa0e88341d600b9c8f2272a",id:null,metadata:{},name:"DeleteUserDialogMutation",operationKind:"mutation",text:`mutation DeleteUserDialogMutation(
  $input: DeleteUsersInput!
) {
  deleteUsers(input: $input) {
    userIds
  }
}
`}}})();ym.hash="3e3fce3704bc71d61dc41b274452060c";function KF({userId:n,connectionIds:a,onDeleted:l,onClose:t}){const[i,r]=T.useMutation(ym),s=Le(),d=Ve(),c=f.useCallback(()=>{i({variables:{input:{userIds:[n]},connectionIds:a},onCompleted:()=>{s({title:"User deleted",message:"User has been deleted."}),l(),t()},onError:u=>{const m=je(u);d({title:"Failed to delete user",message:(m==null?void 0:m[0])??u.message})}})},[i,a,d,s,t,l,n]);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete User"}),e(ke,{children:e(be,{onPress:t,slot:"close"})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this user? This action cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{variant:"default",onPress:t,children:"Cancel"}),e(R,{variant:"danger",onPress:()=>{c()},isDisabled:r,children:"Delete user"})]})})]})})}const fm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordDialogMutation",selections:a},params:{cacheID:"6ccff8dd53d97eeb41f656bcd2758da1",id:null,metadata:{},name:"ResetPasswordDialogMutation",operationKind:"mutation",text:`mutation ResetPasswordDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    __typename
  }
}
`}}})();fm.hash="85b22da61ec094c28e97db2759622b69";const _t=4;function TF({userId:n,onClose:a}){const l=Ve(),t=Le(),[i,r]=T.useMutation(fm),{control:s,handleSubmit:d,formState:{isDirty:c}}=sn({defaultValues:{newPassword:"",confirmPassword:""}}),u=f.useCallback(m=>{i({variables:{input:{userId:n,newPassword:m.newPassword}},onCompleted:()=>{t({title:"Password reset",message:"Users password has been reset."}),a()},onError:g=>{l({title:"Failed to reset password",message:g.message})}})},[i,l,t,a,n]);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Reset Password"}),e(ke,{children:e(be,{onPress:a,slot:"close"})})]}),e(bn,{children:o(C,{padding:"size-200",children:[o(b,{direction:"column",gap:"size-100",children:[e(H,{name:"newPassword",control:s,rules:{required:"Password is required",minLength:{value:_t,message:`Password must be at least ${_t} characters`}},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{isInvalid:h,onChange:g,name:m,onBlur:p,value:y.toString(),type:"password",id:"new-password",autoComplete:"new-password",children:[e(J,{children:"New Password"}),e(ge,{placeholder:"New password"}),k!=null&&k.message?e(Ae,{children:k.message}):o(v,{slot:"description",children:["Password must be at least ",_t," ","characters"]})]})}),e(H,{name:"confirmPassword",control:s,rules:{required:"Password is required",minLength:{value:_t,message:`Password must be at least ${_t} characters`},validate:(m,g)=>m===g.newPassword||"Passwords do not match"},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{isInvalid:h,onChange:g,name:m,onBlur:p,value:y.toString(),type:"password",children:[e(J,{children:"Confirm Password"}),e(ge,{placeholder:"Repeat new password"}),k!=null&&k.message?e(Ae,{children:k.message}):e(v,{slot:"description",children:"Repeat new password to confirm"})]})})]}),e(C,{paddingTop:"size-200",children:o(b,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(R,{variant:"default",size:"S",onPress:a,isDisabled:r,children:"Cancel"}),e(R,{variant:c?"primary":"default",type:"submit",isDisabled:r,onPress:()=>d(u)(),children:r?"Resetting...":"Reset Password"})]})})]})})]})})}function PF(n){return n==="LOCAL"}function IF(n){const{userId:a,authMethod:l,connectionIds:t}=n,[i,r]=f.useState(!1),[s,d]=f.useState(!1),c=f.useMemo(()=>{const u=e(Oe,{id:"deleteUser",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Tn,{})}),e(te,{children:"Delete"})]})},"deleteUser"),m=e(Oe,{id:"resetPassword",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Qd,{})}),e(te,{children:"Reset Password"})]})},"resetPassword"),g=[u];return PF(l)&&g.push(m),g},[l]);return o(ja,{children:[o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:e($n,{"aria-label":"User Actions",onAction:u=>{switch(u){case"deleteUser":r(!0);break;case"resetPassword":d(!0);break}},children:c})})]}),e(se,{isOpen:i,onOpenChange:r,children:e(oe,{children:e(ae,{children:e(KF,{userId:a,onClose:()=>r(!1),connectionIds:t,onDeleted:()=>{r(!1)}})})})}),e(se,{isOpen:s,onOpenChange:d,children:e(oe,{children:e(ae,{children:e(TF,{userId:a,onClose:()=>d(!1)})})})})]})}const hm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchUser",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[a,{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UserRoleChangeDialogMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UserRoleChangeDialogMutation",selections:l},params:{cacheID:"3c8547a2325c7e077c817ed32c43a051",id:null,metadata:{},name:"UserRoleChangeDialogMutation",operationKind:"mutation",text:`mutation UserRoleChangeDialogMutation(
  $input: PatchUserInput!
) {
  patchUser(input: $input) {
    user {
      id
      role {
        id
        name
      }
    }
  }
}
`}}})();hm.hash="81ae74aa52c4c2bcbe266d9adf18f725";function xF({userId:n,username:a,currentRole:l,newRole:t,onClose:i}){const[r,s]=T.useMutation(hm),d=Le(),c=Ve(),u=f.useCallback(()=>{r({variables:{input:{userId:n,newRole:t}},onCompleted:()=>{d({title:"Role Changed",message:"Users role has been changed."}),i()},onError:m=>{c({title:"Failed to delete user",message:m.message})}})},[r,t,c,d,i,n]);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Confirm role change"}),e(ke,{children:e(be,{onPress:i,slot:"close"})})]}),e(C,{padding:"size-200",children:o(v,{children:[`Are you sure you want to change the role for ${a} from `," ",e("b",{children:Er(l)})," to"," ",e("b",{children:Er(t)}),"?"]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{onPress:i,size:"S",children:"Cancel"}),e(R,{variant:"primary",size:"S",onPress:()=>{u()},isDisabled:s,children:"Change role"})]})})]})})}const LF=55,Go=50,DF=K`
  text-decoration: none;
  color: var(--ac-global-color-grey-600);
  font-size: 12px;
  &:hover {
    text-decoration: underline;
  }
`,_F=K`
  position: sticky;
  top: 0;
`,AF=K`
  height: ${LF}px;
`,EF=K`
  overflow: auto;
  max-height: var(--ac-global-dimension-size-6000);
`,Wo=n=>n.email==="admin@localhost"||n.username==="admin";function wF({query:n}){"use no memo";const[a,l]=f.useState(null),t=f.useRef(null),{data:i,loadNext:r,hasNext:s,isLoadingNext:d}=T.usePaginationFragment(pm,n),c=f.useMemo(()=>i.users.edges.map(({user:k})=>({id:k.id,email:k.email,username:k.username,profilePictureUrl:k.profilePictureUrl,createdAt:k.createdAt,role:k.role.name,authMethod:k.authMethod})),[i]),u=f.useCallback(k=>{if(k){const{scrollHeight:S,scrollTop:F,clientHeight:I}=k;S-F-I<300&&!d&&s&&r(Go)}},[s,d,r]),{viewer:m}=as(),g=f.useMemo(()=>[{header:"user",accessorKey:"username",cell:({row:k})=>o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(wi,{name:k.original.username,profilePictureUrl:k.original.profilePictureUrl,size:20}),e("span",{children:k.original.username}),k.original.email&&e("a",{href:`mailto:${k.original.email}`,css:DF,children:k.original.email})]})},{header:"method",accessorKey:"authMethod",size:10,cell:({row:k})=>k.original.authMethod.toLowerCase()},{header:"role",accessorKey:"role",cell:({row:k})=>Wo(k.original)||m&&m.id===k.original.id?Er(k.original.role):e(Nk,{includeLabel:!1,size:"S",onChange:S=>{S!==k.original.role&&l(e(xF,{onClose:()=>l(null),currentRole:k.original.role,newRole:S,username:k.original.username,userId:k.original.id}))},role:Vk(k.original.role)?k.original.role:void 0})},{header:"created at",accessorKey:"createdAt",cell:tn},{header:"",accessorKey:"id",size:10,cell:({row:k})=>Wo(k.original)?null:e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(IF,{userId:k.original.id,connectionIds:[T.ConnectionHandler.getConnectionID("client:root","UsersTable_users")],authMethod:k.original.authMethod})}),meta:{textAlign:"right"}}],[m]),p=Qe({columns:g,data:c,getCoreRowModel:Be(),getSortedRowModel:Vn()}),y=p.getRowModel().rows,h=p.getRowModel().rows.length===0;return e("div",{css:EF,ref:t,onScroll:k=>u(k.target),children:o("table",{css:Kn,children:[e("thead",{children:p.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(S=>e("th",{colSpan:S.colSpan,css:_F,children:S.isPlaceholder?null:o("div",{className:S.column.getCanSort()?"sort":"",onClick:S.column.getToggleSortingHandler(),style:{left:S.getStart(),width:S.getSize()},children:[de(S.column.columnDef.header,S.getContext()),S.column.getIsSorted()?e(x,{className:"sort-icon",svg:S.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},S.id))},k.id))}),h?e(Xn,{}):o("tbody",{children:[y.map(k=>e("tr",{css:AF,children:k.getVisibleCells().map(S=>e("td",{children:de(S.column.columnDef.cell,S.getContext())},S.id))},k.id)),s?e(ls,{onLoadMore:()=>r(Go),isLoadingNext:d},"load-more"):null]}),e(oe,{isOpen:a!==null,onOpenChange:k=>{k||l(null)},isDismissable:!0,children:e(ae,{size:"S",children:a})})]})})}function MF(){const[n,a]=f.useState(0),[l,t]=f.useState(null),i=Le(),r=Ve(),s=f.useMemo(()=>window.Config.basicAuthDisabled&&!window.Config.oAuth2Idps.length&&!window.Config.ldapManualUserCreationEnabled,[]),d=T.useLazyLoadQuery(um,{},{fetchKey:n,fetchPolicy:"store-and-network"});return o(ee,{title:"Users",extra:e(R,{onPress:()=>{t(e(CF,{onDismiss:()=>{t(null)},onNewUserCreated:c=>{t(null),i({title:"User added",message:`User ${c} has been added.`}),a(u=>u+1)},onNewUserCreationError:c=>{const u=je(c);r({title:"Error adding user",message:(u==null?void 0:u[0])??c.message})}}))},size:"S",leadingVisual:e(x,{svg:e(xl,{})}),isDisabled:s,children:"Add User"}),children:[e(f.Suspense,{fallback:e(C,{padding:"size-200",children:e(me,{})}),children:e(wF,{query:d})}),l]})}const RF=K`
  .ac-field {
    // Hacky solution to make the text fields fill the remaining space
    width: calc(100% - var(--ac-global-dimension-size-600));
  }
  padding: var(--ac-global-dimension-size-200);
`;function U9(){const n=wn();Xe(n);const a=T.usePreloadedQuery(cm,n);return o(b,{direction:"column",gap:"size-200",width:"100%",children:[o(b,{direction:"row",gap:"size-200",alignItems:"baseline",children:[e(C,{flex:"2",children:e(ee,{title:"Platform Settings",children:o("form",{css:RF,children:[o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(Fe,{value:Ko,isReadOnly:!0,children:[e(J,{children:"Hostname"}),e(ge,{}),e(v,{slot:"description",children:"Connect to Phoenix over HTTP"})]}),e(fr,{text:Ko})]}),o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(Fe,{value:oi,isReadOnly:!0,children:[e(J,{children:"Platform Version"}),e(ge,{}),e(v,{slot:"description",children:"The version of the Phoenix server"})]}),e(fr,{text:oi})]}),o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[o(Fe,{value:`pip install 'arize-phoenix==${oi}'`,isReadOnly:!0,children:[e(J,{children:"Python Version"}),e(ge,{}),e(v,{slot:"description",children:"The version of the Python client library to use to connect to this Phoenix"})]}),e(fr,{text:oi})]})]})})}),e(C,{flex:"1",minWidth:280,children:e(ee,{title:"Database Usage",children:e(C,{padding:"size-200",children:e(vF,{query:a})})})})]}),o(zk,{children:[e(bF,{}),e(MF,{})]}),e($d,{children:e(FF,{})})]})}function fr(n){return e(C,{paddingBottom:"20px",flex:"none",children:e(rn,{text:n.text,size:"M"})})}const km=(function(){var n=[{kind:"Literal",name:"first",value:1e3}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"settingsModelsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelsTable_generativeModels"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"settingsModelsLoaderQuery",selections:[{alias:null,args:n,concreteType:"GenerativeModelConnection",kind:"LinkedField",name:"generativeModels",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"generativeModel",args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},l,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"generativeModels(first:1000)"},{alias:null,args:n,filters:null,handle:"connection",key:"ModelsTable_generativeModels",kind:"LinkedHandle",name:"generativeModels"}]},params:{cacheID:"2561e105687af94ee14ba63f1a570f9b",id:null,metadata:{},name:"settingsModelsLoaderQuery",operationKind:"query",text:`query settingsModelsLoaderQuery {
  ...ModelsTable_generativeModels
}

fragment ModelsTable_generativeModels on Query {
  generativeModels(first: 1000) {
    edges {
      generativeModel: node {
        id
        name
        provider
        namePattern
        providerKey
        startTime
        createdAt
        updatedAt
        lastUsedAt
        kind
        tokenPrices {
          tokenType
          kind
          costPerMillionTokens
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();km.hash="a0f3a13e85b11b62ee06f77c3efabae7";const bm=km;function H9(){return T.loadQuery(ze,bm,{})}const Sm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelsTableGenerativeModelsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ModelsTable_generativeModels"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelsTableGenerativeModelsQuery",selections:[{alias:null,args:a,concreteType:"GenerativeModelConnection",kind:"LinkedField",name:"generativeModels",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"generativeModel",args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},t,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:null,handle:"connection",key:"ModelsTable_generativeModels",kind:"LinkedHandle",name:"generativeModels"}]},params:{cacheID:"d2c39f2a952d3a47ca39883bdff49cc4",id:null,metadata:{},name:"ModelsTableGenerativeModelsQuery",operationKind:"query",text:`query ModelsTableGenerativeModelsQuery(
  $after: String = null
  $first: Int = 1000
) {
  ...ModelsTable_generativeModels_2HEEH6
}

fragment ModelsTable_generativeModels_2HEEH6 on Query {
  generativeModels(first: $first, after: $after) {
    edges {
      generativeModel: node {
        id
        name
        provider
        namePattern
        providerKey
        startTime
        createdAt
        updatedAt
        lastUsedAt
        kind
        tokenPrices {
          tokenType
          kind
          costPerMillionTokens
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();Sm.hash="e067fb55e7a09f7237e0cc8eb1eb4c75";const vm=(function(){var n=["generativeModels"],a={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:1e3,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Sm}},name:"ModelsTable_generativeModels",selections:[{alias:"generativeModels",args:null,concreteType:"GenerativeModelConnection",kind:"LinkedField",name:"__ModelsTable_generativeModels_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"generativeModel",args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},a,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();vm.hash="e067fb55e7a09f7237e0cc8eb1eb4c75";const Fm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UpdateModelMutationPayload",kind:"LinkedField",name:"updateModel",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditModelButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditModelButtonMutation",selections:a},params:{cacheID:"527afcf6cbbf906d8ddc80b5a34cdb3a",id:null,metadata:{},name:"EditModelButtonMutation",operationKind:"mutation",text:`mutation EditModelButtonMutation(
  $input: UpdateModelMutationInput!
) {
  updateModel(input: $input) {
    model {
      id
      name
      provider
      namePattern
      providerKey
      startTime
      tokenPrices {
        tokenType
        kind
        costPerMillionTokens
      }
    }
    __typename
  }
}
`}}})();Fm.hash="ffba87369eaaf51ba050d13e4f417efa";const Cm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},c={alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditModelButtonQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,s,d,c],type:"GenerativeModel",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditModelButtonQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t,i,r,s,d,c],type:"GenerativeModel",abstractKey:null}],storageKey:null}]},params:{cacheID:"72a1442aa25a624a43220712bc801182",id:null,metadata:{},name:"EditModelButtonQuery",operationKind:"query",text:`query EditModelButtonQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ... on GenerativeModel {
      id
      name
      provider
      namePattern
      providerKey
      startTime
      tokenPrices {
        tokenType
        kind
        costPerMillionTokens
      }
    }
    id
  }
}
`}}})();Cm.hash="20d5b9316e7f67962f1480b7705015fb";const VF=[{tokenType:"input",kind:"PROMPT"},{tokenType:"audio",kind:"PROMPT"},{tokenType:"cache_read",kind:"PROMPT"},{tokenType:"cache_write",kind:"PROMPT"}],NF=[{tokenType:"output",kind:"COMPLETION"},{tokenType:"audio",kind:"COMPLETION"},{tokenType:"reasoning",kind:"COMPLETION"}];function zF({options:n,value:a,onChange:l,onBlur:t,invalid:i,isRequired:r,error:s}){const d=n.find(c=>c.tokenType===a);return e(Ma,{"aria-label":"Token type",placeholder:"Choose or enter a token type",selectedKey:(d==null?void 0:d.tokenType)??"",inputValue:a??"",onSelectionChange:c=>{const u=n.find(m=>m.tokenType===c);u&&l(u.tokenType)},onInputChange:c=>{const u=c.toLowerCase();l(u||null)},onBlur:t,isInvalid:i,isRequired:r,errorMessage:s,size:"M",allowsCustomValue:!0,children:n.map(c=>c.tokenType?e(qe,{textValue:c.tokenType,id:c.tokenType,children:e(b,{alignItems:"center",gap:"size-50",children:c.tokenType})},c.tokenType):null)})}function Jo({title:n,namePrefix:a,fields:l,control:t,tokenTypeOptions:i,onAppend:r,onRemove:s,appendKind:d}){return o(te,{children:[e(Te,{level:3,weight:"heavy",children:n}),o("table",{css:K`
          border-collapse: separate;
          border-spacing: 0 var(--ac-global-dimension-size-100);
          width: 100%;

          & th {
            text-align: left;
            font-weight: normal;
            color: var(--ac-global-color-grey-500);
          }

          & th:not(:last-child) {
            padding-right: var(--ac-global-dimension-size-100);
          }

          & td {
            vertical-align: top;
          }

          & tbody td:not(:last-child) {
            padding-right: var(--ac-global-dimension-size-100);
          }
        `,children:[e("thead",{children:o("tr",{children:[e("th",{children:"Token type"}),e("th",{children:"Cost / 1M"}),e("th",{})]})}),o("tbody",{children:[l.map((c,u)=>o("tr",{children:[e("td",{children:e(H,{name:`${a}.${u}.tokenType`,control:t,rules:{required:"Token type is required"},render:({fieldState:{invalid:m,error:g},field:p})=>e(zF,{options:i,...p,invalid:m,error:g==null?void 0:g.message})})}),e("td",{children:e(H,{name:`${a}.${u}.costPerMillionTokens`,control:t,rules:{required:"Cost per 1M tokens is required"},render:({fieldState:{invalid:m,error:g},field:p})=>o(Ya,{...p,isInvalid:m,minValue:0,isRequired:!0,size:"S",formatOptions:{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:6},children:[e(ge,{}),(g==null?void 0:g.message)&&e(Ae,{children:g.message})]})})}),e("td",{children:e(R,{leadingVisual:e(x,{svg:e(Tn,{})}),onPress:()=>{s(u)},size:"S",isDisabled:u===0})})]},c.id)),o("tr",{children:[e("td",{}),e("td",{children:e(b,{justifyContent:"end",alignItems:"start",children:e(R,{onPress:()=>{r({kind:d,tokenType:"",costPerMillionTokens:0})},size:"S",variant:"quiet",children:"Add row"})})}),e("td",{})]})]})]})]})}const hr=[{key:"OPENAI",value:zl("OPENAI"),label:Ia("OPENAI")},{key:"AZURE_OPENAI",value:zl("AZURE_OPENAI"),label:Ia("AZURE_OPENAI")},{key:"ANTHROPIC",value:zl("ANTHROPIC"),label:Ia("ANTHROPIC")},{key:"GOOGLE",value:zl("GOOGLE"),label:Ia("GOOGLE")},{key:"AWS",value:zl("AWS"),label:Ia("AWS")},{key:"DEEPSEEK",value:zl("DEEPSEEK"),label:Ia("DEEPSEEK")},{key:"XAI",value:zl("XAI"),label:Ia("XAI")}];function $F({value:n,onChange:a,onBlur:l,invalid:t,description:i}){var r;return e(Ma,{label:"Provider",placeholder:"Choose or enter a provider",selectedKey:((r=hr.find(s=>s.value===n))==null?void 0:r.key)||"",inputValue:n,onSelectionChange:s=>{const d=hr.find(c=>c.key===s);d&&a(d.value)},onInputChange:s=>{a(s==null?void 0:s.toLowerCase())},onBlur:l,isInvalid:t,size:"M",allowsCustomValue:!0,description:i,children:hr.map(s=>e(qe,{textValue:s.key,id:s.key,children:o(b,{alignItems:"center",gap:"size-50",children:[e(al,{provider:s.key,height:18}),s.label]})},s.key))})}function Hs({modelName:n,modelProvider:a,modelNamePattern:l,modelCost:t,onSubmit:i,isSubmitting:r,submitButtonText:s,formMode:d,startDate:c}){const u=f.useMemo(()=>Array.isArray(t)&&t.length>0?t:[{kind:"PROMPT",tokenType:"input",costPerMillionTokens:0},{kind:"COMPLETION",tokenType:"output",costPerMillionTokens:0}],[t]),m=f.useMemo(()=>u.filter(_=>_.kind==="PROMPT"),[u]),g=f.useMemo(()=>u.filter(_=>_.kind==="COMPLETION"),[u]),p=f.useMemo(()=>c?Rc(new Date(c).toISOString()):"",[c]),{control:y,handleSubmit:h,formState:{isDirty:k}}=sn({defaultValues:{name:n??"",provider:a||"",namePattern:l??"",promptCosts:m,completionCosts:g,startTime:p}}),{fields:S,append:F,remove:I}=jr({control:y,name:"promptCosts"}),{fields:L,append:M,remove:E}=jr({control:y,name:"completionCosts"}),P=$k({initialValue:l??""});return o(bn,{onSubmit:h(i),children:[e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(H,{name:"name",control:y,rules:{required:"Model name is required",minLength:{value:1,message:"Name must not be empty"}},render:({field:{onChange:_,onBlur:D,value:A},fieldState:{invalid:V,error:j}})=>o(Fe,{isInvalid:V,onChange:_,onBlur:D,value:A,size:"S",children:[e(J,{children:"Model name*"}),e(ge,{placeholder:"e.g. gpt-4, claude-3-sonnet"}),(j==null?void 0:j.message)&&e(Ae,{children:j.message})]})}),e(H,{name:"namePattern",control:y,rules:{required:"Name pattern is required"},render:({field:{onChange:_,onBlur:D,value:A},fieldState:{invalid:V,error:j}})=>e(Ok,{...P,value:A,isInvalid:V||P.isInvalid,error:(j==null?void 0:j.message)||P.error,onChange:ce=>{_(ce),P.onChange(ce)},size:"S",onBlur:D,placeholder:"e.g. ^gpt-4$, ^claude-3-sonnet$",description:"Regular expression to match model names during trace ingestion.",label:"Name pattern*"})}),e(H,{name:"provider",control:y,render:({field:{onChange:_,onBlur:D,value:A},fieldState:{invalid:V,error:j}})=>e($F,{value:A??"",onChange:_,onBlur:D,error:j==null?void 0:j.message,invalid:V,description:"Only models with this provider will be matched by the name pattern."})}),e(H,{name:"startTime",control:y,render:({field:{onChange:_,onBlur:D,value:A},fieldState:{invalid:V,error:j}})=>o(Bd,{value:A,onChange:_,onBlur:D,isInvalid:V,granularity:"day",hideTimeZone:!0,children:[e(J,{children:"Start date"}),e(Vc,{style:{width:"100%"},children:ce=>e(Nc,{segment:ce})}),j!=null&&j.message?e(Ae,{children:j.message}):e(v,{slot:"description",children:"Optional start date. If provided, traces ingested on or after this date will have this model's cost applied."})]})}),e(Jo,{title:"Prompt tokens",namePrefix:"promptCosts",fields:S,control:y,tokenTypeOptions:VF,onAppend:F,onRemove:I,appendKind:"PROMPT"}),e(Jo,{title:"Completion tokens",namePrefix:"completionCosts",fields:L,control:y,tokenTypeOptions:NF,onAppend:M,onRemove:E,appendKind:"COMPLETION"})]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",position:"sticky",bottom:0,backgroundColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{isDisabled:(d==="edit"?!k:!1)||r,variant:k?"primary":"default",size:"S",type:"submit",children:s})})})]})}const Km=Cm;function OF({queryReference:n,onModelEdited:a,onClose:l}){const{revalidate:t}=zc(),i=T.usePreloadedQuery(Km,n),[r,s]=T.useMutation(Fm),d=Le(),c=Ve(),u=i==null?void 0:i.node;return u?e(Hs,{modelName:u.name,modelProvider:u.provider,modelNamePattern:u.namePattern,modelCost:u.tokenPrices,startDate:u.startTime,onSubmit:m=>{r({variables:{input:{id:u.id,name:m.name,provider:m.provider,namePattern:m.namePattern,startTime:m.startTime?m.startTime.toDate(nt()).toISOString():null,costs:[...m.promptCosts,...m.completionCosts].map(g=>({tokenType:g.tokenType,costPerMillionTokens:g.costPerMillionTokens,kind:g.kind}))}},onCompleted:()=>{l(),a&&a(m),d({title:"Model Updated",message:`Model "${m.name}" updated successfully`}),t()},onError:g=>{const p=je(g);c({title:"Failed to update model",message:(p==null?void 0:p[0])??"Failed to update model"})}})},isSubmitting:s,submitButtonText:"Save Changes",formMode:"edit"}):e(Ee,{variant:"danger",children:"Model not found"})}function jF({modelId:n,onModelEdited:a}){const[l,t]=f.useState(!1),[i,r,s]=T.useQueryLoader(Km),d=()=>{r({id:n},{fetchPolicy:"network-only"}),t(!0)},c=()=>{t(!1),s()};return o(se,{isOpen:l,onOpenChange:u=>{u||c()},children:[e(R,{variant:"default",leadingVisual:e(x,{svg:e(Xl,{})}),"aria-label":"Edit model",onPress:d,size:"S"}),e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Edit Model"}),e(ke,{children:e(be,{slot:"close"})})]}),e(f.Suspense,{fallback:e(me,{}),children:i?e(OF,{queryReference:i,onModelEdited:a,onClose:c}):e(me,{})})]})})})})]})}const Tm=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null},i={alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},t,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"CloneModelButtonMutation",selections:[{alias:null,args:l,concreteType:"CreateModelMutationPayload",kind:"LinkedField",name:"createModel",plural:!1,selections:[i],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"CloneModelButtonMutation",selections:[{alias:null,args:l,concreteType:"CreateModelMutationPayload",kind:"LinkedField",name:"createModel",plural:!1,selections:[i,{alias:null,args:null,filters:null,handle:"prependNode",key:"",kind:"LinkedHandle",name:"model",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"},{kind:"Literal",name:"edgeTypeName",value:"GenerativeModelEdge"}]}],storageKey:null}]},params:{cacheID:"38d9fd18934c13a39750554ecbb30fb9",id:null,metadata:{},name:"CloneModelButtonMutation",operationKind:"mutation",text:`mutation CloneModelButtonMutation(
  $input: CreateModelMutationInput!
) {
  createModel(input: $input) {
    model {
      id
      name
      provider
      namePattern
      providerKey
      startTime
      createdAt
      updatedAt
      lastUsedAt
      kind
      tokenPrices {
        tokenType
        kind
        costPerMillionTokens
      }
    }
  }
}
`}}})();Tm.hash="74b3cb4e7feb2375336e29fc7745bc33";const Pm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},c={alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"CloneModelButtonQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,s,d,c],type:"GenerativeModel",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"CloneModelButtonQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t,i,r,s,d,c],type:"GenerativeModel",abstractKey:null}],storageKey:null}]},params:{cacheID:"c6375c02dea693149c710391a257a587",id:null,metadata:{},name:"CloneModelButtonQuery",operationKind:"query",text:`query CloneModelButtonQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ... on GenerativeModel {
      id
      name
      provider
      namePattern
      providerKey
      startTime
      tokenPrices {
        tokenType
        kind
        costPerMillionTokens
      }
    }
    id
  }
}
`}}})();Pm.hash="b0ce69ce5cc1eb1d694234678e1d6169";const Im=Pm;function QF({queryReference:n,onModelCloned:a,onClose:l}){const{revalidate:t}=zc(),i=T.usePreloadedQuery(Im,n),r=T.ConnectionHandler.getConnectionID("client:root","ModelsTable_generativeModels"),[s,d]=T.useMutation(Tm),c=Le(),u=Ve(),m=i==null?void 0:i.node;return m?e(Hs,{modelName:`${m.name} (override)`,modelProvider:m.provider,modelNamePattern:m.namePattern,modelCost:m.tokenPrices,startDate:m.startTime,onSubmit:g=>{s({variables:{input:{name:g.name,provider:g.provider,namePattern:g.namePattern,startTime:g.startTime?g.startTime.toDate(nt()).toISOString():null,costs:[...g.promptCosts,...g.completionCosts].map(p=>({tokenType:p.tokenType,costPerMillionTokens:p.costPerMillionTokens,kind:p.kind}))},connectionId:r},onCompleted:()=>{l(),a&&a(g),c({title:"Model Cloned",message:`Model "${g.name}" cloned successfully`}),t()},onError:p=>{const y=je(p);u({title:"Failed to clone model",message:(y==null?void 0:y[0])??"Failed to clone model"})}})},isSubmitting:d,submitButtonText:"Save Changes",formMode:"create"}):e(Ee,{variant:"danger",children:"Model not found"})}function BF({modelId:n,onModelCloned:a}){const[l,t]=f.useState(!1),[i,r,s]=T.useQueryLoader(Im),d=()=>{r({id:n},{fetchPolicy:"network-only"}),t(!0)},c=()=>{t(!1),s()};return o(se,{isOpen:l,onOpenChange:u=>{u||c()},children:[e(R,{variant:"default",leadingVisual:e(x,{svg:e(qd,{})}),"aria-label":"Clone model",onPress:d,size:"S"}),e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Clone Model"}),e(ke,{children:e(be,{slot:"close"})})]}),e(f.Suspense,{fallback:e(me,{}),children:i?e(QF,{queryReference:i,onModelCloned:a,onClose:c}):e(me,{})})]})})})})]})}const xm=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Literal",name:"first",value:1e3}],r={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"DeleteModelButtonMutation",selections:[{alias:null,args:l,concreteType:"DeleteModelMutationPayload",kind:"LinkedField",name:"deleteModel",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ModelsTable_generativeModels"}],storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"model",plural:!1,selections:[t],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"DeleteModelButtonMutation",selections:[{alias:null,args:l,concreteType:"DeleteModelMutationPayload",kind:"LinkedField",name:"deleteModel",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:i,concreteType:"GenerativeModelConnection",kind:"LinkedField",name:"generativeModels",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"generativeModel",args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},r,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"generativeModels(first:1000)"},{alias:null,args:i,filters:null,handle:"connection",key:"ModelsTable_generativeModels",kind:"LinkedHandle",name:"generativeModels"}],storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"model",plural:!1,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"id",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"}]}],storageKey:null}],storageKey:null}]},params:{cacheID:"9a76de4df54063431539cc40e9a64ce0",id:null,metadata:{},name:"DeleteModelButtonMutation",operationKind:"mutation",text:`mutation DeleteModelButtonMutation(
  $input: DeleteModelMutationInput!
) {
  deleteModel(input: $input) {
    query {
      ...ModelsTable_generativeModels
    }
    model {
      id
    }
  }
}

fragment ModelsTable_generativeModels on Query {
  generativeModels(first: 1000) {
    edges {
      generativeModel: node {
        id
        name
        provider
        namePattern
        providerKey
        startTime
        createdAt
        updatedAt
        lastUsedAt
        kind
        tokenPrices {
          tokenType
          kind
          costPerMillionTokens
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();xm.hash="71bdaad175a78f5b654a3c81422e43a9";function qF({modelId:n,modelName:a,onClose:l}){const t=T.ConnectionHandler.getConnectionID("client:root","ModelsTable_generativeModels"),[i,r]=T.useMutation(xm),s=Le(),d=Ve(),c=f.useCallback(()=>{i({variables:{input:{id:n},connectionId:t},onCompleted:()=>{s({title:"Model Deleted",message:`The "${a}" model has been deleted.`}),l()},onError:u=>{const m=je(u);d({title:"Failed to delete model",message:(m==null?void 0:m[0])||"Failed to delete model"})}})},[i,n,a,d,s,l,t]);return o("div",{children:[e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete the "${a}" model? This action cannot be undone and all services dependent on this model, including associated costs, will be affected.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{variant:"default",onPress:l,size:"S",children:"Cancel"}),e(R,{variant:"danger",onPress:()=>{c()},size:"S",isDisabled:r,children:"Delete Model"})]})})]})}function UF({modelId:n,modelName:a}){const[l,t]=f.useState(!1),i=()=>{t(!0)},r=()=>{t(!1)};return o(se,{isOpen:l,onOpenChange:s=>{s||r()},children:[e(R,{variant:"danger",leadingVisual:e(x,{svg:e(Tn,{})}),"aria-label":"Delete model",onPress:i,size:"S"}),e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Model"}),e(ke,{children:e(be,{slot:"close"})})]}),e(qF,{modelId:n,modelName:a,onClose:r})]})})})})]})}function ui(n){return n!=null?new Date(n).toISOString():void 0}function Ur(n,a){var t,i;return(i=(t=n.tokenPrices)==null?void 0:t.find(r=>r.tokenType===a))==null?void 0:i.costPerMillionTokens}function mi(n,a){const l=Ur(n,a);return l!=null?`${cn(l)}`:"--"}const Zo=(n,a,l)=>{const t=Ur(n.original,l),i=Ur(a.original,l);return t==null||i==null?0:t-i};function HF({modelsRef:n,kindFilter:a,search:l}){"use no memo";const t=T.useFragment(vm,n),i=f.useMemo(()=>t.generativeModels.edges.map(m=>m.generativeModel)??[],[t]),r=f.useMemo(()=>[{id:"kind",enableHiding:!0,accessorFn:g=>g.kind},{header:"name",accessorKey:"name",size:300,cell:({row:g})=>{const p=g.original;return o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"space-between",children:[e(mn,{maxWidth:"100%",title:p.name,children:p.name}),e(C,{flex:"none",children:g.original.kind==="CUSTOM"?e(nn,{children:"custom"}):e(nn,{color:"var(--ac-global-color-blue-500)",children:"built-in"})})]})}},{header:"provider",accessorFn:g=>g.provider??void 0,sortUndefined:"last",cell:({row:g})=>{const p=g.original.providerKey;return p?o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(al,{provider:p,height:18}),e("span",{children:Ia(p)})]}):e("span",{children:g.original.provider||"--"})}},{header:"match pattern",accessorKey:"namePattern",cell:({row:g})=>{const p=g.original.namePattern,y=g.original.provider,h=g.original.providerKey;return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:e(mn,{maxWidth:"100%",title:p,children:p})}),y&&o(Se,{delay:0,children:[e(Es,{children:e(nn,{role:"button",color:"var(--ac-global-color-grey-300)",children:e(b,{direction:"row",gap:"size-100",alignItems:"center",children:h?o(te,{children:[e(al,{provider:h,height:18}),e("span",{children:Ia(h)})]}):e("span",{children:y})})})}),o($e,{children:[e(ln,{}),'The preceding name pattern match will only be applied on incoming traces with "',y,'" set as the provider.']})]})]})}},{header:"prompt cost",id:"input",accessorFn:g=>mi(g,"input"),meta:{textAlign:"right"},sortingFn:Zo,sortUndefined:"last",cell:({row:g})=>{var y;const p=mi(g.original,"input");return o(b,{justifyContent:"end",alignItems:"center",gap:"size-100",children:[e("span",{children:p}),o(Se,{delay:0,children:[e(fn,{size:"S","aria-label":"Input cost details",children:e(x,{svg:e(ll,{})})}),o(fa,{children:[e(ln,{}),e(Te,{level:4,weight:"heavy",children:"Input Cost Breakdown"}),e(C,{paddingTop:"size-100",children:((y=g.original.tokenPrices)==null?void 0:y.filter(h=>h.kind==="PROMPT").map(h=>o(b,{direction:"row",gap:"size-100",justifyContent:"space-between",width:"100%",children:[e("span",{children:h.tokenType.toLocaleLowerCase()}),e("span",{children:h.costPerMillionTokens!=null?`${cn(h.costPerMillionTokens)} / 1M`:"--"})]},h.tokenType)))??null})]})]})]})}},{header:"completion cost",id:"output",accessorFn:g=>mi(g,"output"),meta:{textAlign:"right"},sortingFn:Zo,sortUndefined:"last",cell:({row:g})=>{var y;const p=mi(g.original,"output");return o(b,{justifyContent:"end",alignItems:"center",gap:"size-100",children:[e("span",{children:p}),o(Se,{delay:0,children:[e(fn,{size:"S","aria-label":"Output cost details",children:e(x,{svg:e(ll,{})})}),o(fa,{children:[e(ln,{}),e(Te,{level:4,weight:"heavy",children:"Output Cost Breakdown"}),e(C,{paddingTop:"size-100",children:((y=g.original.tokenPrices)==null?void 0:y.filter(h=>h.kind==="COMPLETION").map(h=>o(b,{direction:"row",gap:"size-100",justifyContent:"space-between",width:"100%",children:[e("span",{children:h.tokenType.toLocaleLowerCase()}),e("span",{children:h.costPerMillionTokens!=null?`${cn(h.costPerMillionTokens)} / 1M`:"--"})]},h.tokenType)))??null})]})]})]})}},{header:"start date",sortUndefined:"last",accessorFn:g=>ui(g.startTime),cell:tn},{header:"created at",accessorFn:g=>ui(g.createdAt),sortUndefined:"last",cell:tn},{header:"updated at",accessorFn:g=>ui(g.updatedAt),sortUndefined:"last",cell:tn},{header:"last used at",accessorFn:g=>ui(g.lastUsedAt),sortUndefined:"last",cell:tn},{id:"actions",header:"",accessorKey:"id",cell:({row:g})=>{const p=g.original.kind==="CUSTOM";return o(b,{direction:"row",gap:"size-50",width:"100%",justifyContent:"end",children:[p&&o(Se,{children:[e(jF,{modelId:g.original.id}),o($e,{children:[e(ln,{}),"Edit model"]})]}),o(Se,{children:[e(BF,{modelId:g.original.id}),o($e,{children:[e(ln,{}),"Clone model"]})]}),p&&o(Se,{children:[e(UF,{modelId:g.original.id,modelName:g.original.name}),o($e,{children:[e(ln,{}),"Delete model"]})]})]})}}],[]),s=f.useMemo(()=>[{id:"kind",value:a==="ALL"?"":a}],[a]),d=Qe({columns:r,data:i,state:{columnVisibility:{kind:!1,provider:!1},columnPinning:{left:["name"],right:["actions"]},globalFilter:l==null?void 0:l.trim(),columnFilters:s},getCoreRowModel:Be(),getSortedRowModel:Vn(),getFilteredRowModel:TS()}),c=d.getRowModel().rows;return c.length===0?e(b,{width:"100%",justifyContent:"center",alignItems:"center",children:e("p",{children:"No models found"})}):e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,children:o("table",{css:Kn,style:{width:d.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:d.getHeaderGroups().map(m=>e("tr",{children:m.headers.map(g=>{var p;return e("th",{colSpan:g.colSpan,style:{...To(g.column),boxSizing:"border-box",minWidth:g.column.getSize(),maxWidth:g.column.getSize()},children:g.isPlaceholder?null:o("div",{className:g.column.getCanSort()?"sort":"",onClick:g.column.getToggleSortingHandler(),style:{textWrap:"nowrap",textAlign:(p=g.column.columnDef.meta)==null?void 0:p.textAlign},children:[de(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(x,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},g.id)})},m.id))}),e("tbody",{children:c.map(m=>e("tr",{children:m.getVisibleCells().map(g=>{var p;return e("td",{align:(p=g.column.columnDef.meta)==null?void 0:p.textAlign,style:{...To(g.column)},children:de(g.column.columnDef.cell,g.getContext())},g.id)})},m.id))})]})})}const Lm=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connectionId"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"model",plural:!1,selections:[t],storageKey:null},r=[{kind:"Literal",name:"first",value:1e3}],s={alias:null,args:null,kind:"ScalarField",name:"kind",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"NewModelButtonCreateModelMutation",selections:[{alias:null,args:l,concreteType:"CreateModelMutationPayload",kind:"LinkedField",name:"createModel",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ModelsTable_generativeModels"}],storageKey:null},i],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"NewModelButtonCreateModelMutation",selections:[{alias:null,args:l,concreteType:"CreateModelMutationPayload",kind:"LinkedField",name:"createModel",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:r,concreteType:"GenerativeModelConnection",kind:"LinkedField",name:"generativeModels",plural:!1,selections:[{alias:null,args:null,concreteType:"GenerativeModelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"generativeModel",args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"provider",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"namePattern",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"providerKey",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"lastUsedAt",storageKey:null},s,{alias:null,args:null,concreteType:"TokenPrice",kind:"LinkedField",name:"tokenPrices",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenType",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"costPerMillionTokens",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"GenerativeModel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"generativeModels(first:1000)"},{alias:null,args:r,filters:null,handle:"connection",key:"ModelsTable_generativeModels",kind:"LinkedHandle",name:"generativeModels"}],storageKey:null},i,{alias:null,args:null,filters:null,handle:"prependNode",key:"",kind:"LinkedHandle",name:"model",handleArgs:[{items:[{kind:"Variable",name:"connections.0",variableName:"connectionId"}],kind:"ListValue",name:"connections"},{kind:"Literal",name:"edgeTypeName",value:"GenerativeModel"}]}],storageKey:null}]},params:{cacheID:"b7d1c660aba19c0f139e98bc064ac017",id:null,metadata:{},name:"NewModelButtonCreateModelMutation",operationKind:"mutation",text:`mutation NewModelButtonCreateModelMutation(
  $input: CreateModelMutationInput!
) {
  createModel(input: $input) {
    query {
      ...ModelsTable_generativeModels
    }
    model {
      id
    }
  }
}

fragment ModelsTable_generativeModels on Query {
  generativeModels(first: 1000) {
    edges {
      generativeModel: node {
        id
        name
        provider
        namePattern
        providerKey
        startTime
        createdAt
        updatedAt
        lastUsedAt
        kind
        tokenPrices {
          tokenType
          kind
          costPerMillionTokens
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();Lm.hash="8b084f3f34168edc39740e49846d7b05";function GF({onModelCreated:n}){const[a,l]=f.useState(null),[t,i]=f.useState(!1),r=Le(),s=Ve(),d=T.ConnectionHandler.getConnectionID("client:root","ModelsTable_generativeModels"),[c,u]=T.useMutation(Lm);return o(se,{isOpen:t,onOpenChange:m=>{l(null),i(m)},children:[e(R,{variant:"primary",size:"S",leadingVisual:e(x,{svg:e(xl,{})}),"aria-label":"Create a new model",onPress:()=>{l(null),i(!0)},isDisabled:u,children:u?"Adding Model...":"Add Model"}),e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Create New Model"}),e(ke,{children:e(be,{slot:"close"})})]}),a?e(Ee,{variant:"danger",children:a}):null,e(Hs,{onSubmit:m=>{l(null),i(!1),c({variables:{input:{name:m.name,provider:m.provider,namePattern:m.namePattern,startTime:m.startTime?m.startTime.toDate(nt()).toISOString():null,costs:[...m.promptCosts,...m.completionCosts].map(g=>({tokenType:g.tokenType,costPerMillionTokens:g.costPerMillionTokens,kind:g.kind}))},connectionId:d},onCompleted:()=>{n&&n(m),r({title:"Model Created",message:`Model "${m.name}" added successfully`})},onError:g=>{const p=je(g);s({title:"An error occurred",message:`Failed to add model: ${(p==null?void 0:p[0])??g.message}`})}})},isSubmitting:!1,submitButtonText:"Create Model",formMode:"create"})]})})})})]})}const WF=[{label:"All",id:"ALL"},{label:"Custom",id:"CUSTOM"},{label:"Built-in",id:"BUILT_IN"}];function G9(){const[n,a]=f.useState("ALL"),[l,t]=f.useState(""),i=wn();Xe(i);const r=T.usePreloadedQuery(bm,i);return o(b,{direction:"column",gap:"size-200",children:[o(b,{gap:"size-200",alignItems:"center",justifyContent:"space-between",children:[e(Ll,{"aria-label":"Search models",placeholder:"Search models",onChange:s=>{t(s)},defaultValue:l}),o(Dl,{"aria-label":"Model kind filter",value:n,onChange:s=>{f.startTransition(()=>{a(s)})},selectionMode:"single",children:[o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:e(Bn,{items:WF,children:s=>e(dn,{id:s.id,textValue:s.id,children:s.label})})})]})]}),e(ee,{title:"Models",extra:o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(v,{color:"text-500",size:"S",children:"All costs shown in USD per 1M tokens"}),e(GF,{})]}),children:e(HF,{modelsRef:r,kindFilter:n,search:l})})]})}const JF=K`
  display: flex;
  direction: row;
  height: 100vh;
  overflow: hidden;
`,ZF=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  height: 100%;
  overflow: hidden;
`,XF=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  border-left: 1px solid var(--ac-global-color-grey-200);
  border-top: 1px solid var(--ac-global-color-grey-200);
  border-radius: var(--ac-global-rounding-medium) 0 0 0;
  /* Fill the background of the content */
  box-shadow: 0 0 10px 10px var(--ac-global-color-grey-100);
`,YF=K`
  display: flex;
  flex-direction: column;
  margin: 0;
  list-style: none;
  gap: var(--ac-global-dimension-size-50);
  padding-inline-start: 0;
`,eC=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
`;function W9(){return o("div",{css:JF,"data-testid":"layout",children:[e(jk,{}),e(nC,{}),o("div",{css:ZF,children:[o(Qk,{children:[e(Bk,{}),e(qk,{})]}),e("div",{"data-testid":"content",css:XF,children:e(f.Suspense,{fallback:e(me,{}),children:e(Ue,{})})})]})]})}function nC(){const n=Cn(i=>i.isSideNavExpanded),a=f.useMemo(()=>window.Config.hasInferences,[]),{authenticationEnabled:l}=Yv(),t=f.useCallback(()=>{window.location.replace(ea("/auth/logout"))},[]);return o(a0,{isExpanded:n,children:[e(Uk,{}),o(b,{direction:"column",justifyContent:"space-between",flex:"1 1 auto",children:[o("ul",{css:eC,children:[a&&e("li",{children:e(Ja,{to:"/model",text:"Model",leadingVisual:e(x,{svg:e(Hk,{})}),isExpanded:n})},"model"),e("li",{children:e(Ja,{to:"/projects",text:"Projects",leadingVisual:e(x,{svg:e(Ud,{})}),isExpanded:n})}),e("li",{children:e(Ja,{to:"/datasets",text:"Datasets & Experiments",leadingVisual:e(x,{svg:e(Hd,{})}),isExpanded:n})},"datasets"),e("li",{children:e(Ja,{to:"/playground",text:"Playground",leadingVisual:e(x,{svg:e(Qa,{})}),isExpanded:n})},"playground"),e("li",{children:e(Ja,{to:"/prompts",text:"Prompts",leadingVisual:e(x,{svg:e(ts,{})}),isExpanded:n})},"prompts"),e("li",{children:e(Ja,{to:"/apis",text:"APIs",leadingVisual:e(x,{svg:e(is,{})}),isExpanded:n})},"apis")]}),o("ul",{css:YF,children:[e("li",{children:e(Gk,{isExpanded:n})},"github"),e("li",{children:e(Ja,{to:"/settings/general",text:"Settings",leadingVisual:e(x,{svg:e(rs,{})}),isExpanded:n})},"settings"),e("li",{children:e(Wk,{isExpanded:n})},"docs"),e("li",{children:e(Ja,{to:"/support",text:"Support",leadingVisual:e(x,{svg:e(Jk,{})}),isExpanded:n})},"support"),e("li",{children:e(Zk,{isExpanded:n})},"theme-toggle"),e("li",{children:e(Ja,{to:"/profile",text:"Profile",leadingVisual:e(x,{svg:e(Xk,{})}),isExpanded:n})},"profile"),l&&o(te,{children:[e(f.Suspense,{children:e(Yk,{isExpanded:n})}),e("li",{children:e(e0,{text:"Log Out",leadingVisual:e(x,{svg:e(n0,{})}),onClick:t})},"logout")]})]})]})]})}const Dm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectConfigPageProjectConfigCardQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"492e0693e4facc2052015087af2e9de5",id:null,metadata:{},name:"ProjectConfigPageProjectConfigCardQuery",operationKind:"query",text:`query ProjectConfigPageProjectConfigCardQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectConfigPage_projectConfigCard
    id
  }
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}
`}}})();Dm.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const _m={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Dm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectConfigPage_projectConfigCard",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null}],type:"Project",abstractKey:null};_m.hash="3bd54e77e19bb08ca53696b5fc9a5c22";const aC=["traces","spans","sessions","metrics"],Gs=30,Am=n=>aC.includes(n),Em=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationConfigId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{kind:"Variable",name:"annotationConfigId",variableName:"annotationConfigId"},{kind:"Variable",name:"projectId",variableName:"projectId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",selections:[{alias:null,args:l,concreteType:"RemoveAnnotationConfigFromProjectPayload",kind:"LinkedField",name:"removeAnnotationConfigFromProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",selections:[{alias:null,args:l,concreteType:"RemoveAnnotationConfigFromProjectPayload",kind:"LinkedField",name:"removeAnnotationConfigFromProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}]},params:{cacheID:"e4d29747630390022d08f376ad4c9d58",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation",operationKind:"mutation",text:`mutation ProjectAnnotationConfigCardContentRemoveAnnotationConfigFromProjectMutation(
  $projectId: ID!
  $annotationConfigId: ID!
) {
  removeAnnotationConfigFromProject(input: {projectId: $projectId, annotationConfigId: $annotationConfigId}) {
    project {
      ...ProjectAnnotationConfigCardContent_project_annotations
      id
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}})();Em.hash="26b991be7525781487a7a64abcbf7e50";const wm=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationConfigId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{kind:"Variable",name:"annotationConfigId",variableName:"annotationConfigId"},{kind:"Variable",name:"projectId",variableName:"projectId"}],kind:"ObjectValue",name:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",selections:[{alias:null,args:l,concreteType:"AddAnnotationConfigToProjectPayload",kind:"LinkedField",name:"addAnnotationConfigToProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",selections:[{alias:null,args:l,concreteType:"AddAnnotationConfigToProjectPayload",kind:"LinkedField",name:"addAnnotationConfigToProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}]},params:{cacheID:"e42b3ed6b172e28b34ecf4dd15c90da7",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation",operationKind:"mutation",text:`mutation ProjectAnnotationConfigCardContentAddAnnotationConfigToProjectMutation(
  $projectId: ID!
  $annotationConfigId: ID!
) {
  addAnnotationConfigToProject(input: {projectId: $projectId, annotationConfigId: $annotationConfigId}) {
    project {
      ...ProjectAnnotationConfigCardContent_project_annotations
      id
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}})();wm.hash="8ddedb3199b7bc0ad4ad95e2bcbbbb60";const Mm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"55ea4da3484ae5175d964a89d943e42b",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentProjectAnnotationsQuery",operationKind:"query",text:`query ProjectAnnotationConfigCardContentProjectAnnotationsQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectAnnotationConfigCardContent_project_annotations
    id
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}})();Mm.hash="f7049daf44d5f6a2e085c04cc187e86e";const Rm={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Mm,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectAnnotationConfigCardContent_project_annotations",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};Rm.hash="f7049daf44d5f6a2e085c04cc187e86e";const Vm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{kind:"Variable",name:"id",variableName:"projectId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[l],type:"Node",abstractKey:"__isNode"},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectAnnotationConfigCardContentQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ProjectAnnotationConfigCardContent_project_annotations"}],type:"Project",abstractKey:null}],storageKey:null},{alias:"allAnnotationConfigs",args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,r],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectAnnotationConfigCardContentQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,{kind:"InlineFragment",selections:[i],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},t],storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null},{alias:"allAnnotationConfigs",args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s,t,r],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"c276ca07c754114aa64bc34ec26f1174",id:null,metadata:{},name:"ProjectAnnotationConfigCardContentQuery",operationKind:"query",text:`query ProjectAnnotationConfigCardContentQuery(
  $projectId: ID!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      ...ProjectAnnotationConfigCardContent_project_annotations
    }
    id
  }
  allAnnotationConfigs: annotationConfigs {
    edges {
      node {
        __typename
        ... on Node {
          __isNode: __typename
          id
        }
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
          annotationType
        }
      }
    }
  }
}

fragment ProjectAnnotationConfigCardContent_project_annotations on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  id
}
`}}})();Vm.hash="57a24bc659f8d1c2e7e761194c83231d";const lC=n=>o(ee,{title:"Project Annotations",children:[e(Ee,{variant:"info",banner:!0,children:"Annotation Configs are configured globally and can be associated with multiple projects. Select the annotation configs you want to use for this project."}),e(f.Suspense,{fallback:e(l0,{}),children:e(iC,{projectId:n.projectId})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(Dn,{to:"/settings/annotations",children:"Configure Annotation Configs"})})})]}),tC=[{id:"select",maxSize:10,header:()=>null,cell:({row:n})=>e(Va,{isSelected:n.original.isEnabled,isDisabled:n.original.isLoading,onChange:a=>{const l=n.original.id;if(!l)throw new Error("Annotation config ID is required");a?n.original.onAdd(l):n.original.onRemove(l)}})},{id:"name",header:"Name",accessorKey:"name",cell:({row:n})=>e(es,{annotation:{name:n.original.name||""},annotationDisplayPreference:"none",css:K`
            width: fit-content;
          `},n.original.name)},{id:"type",header:"Type",accessorKey:"annotationType",cell:({row:n})=>{var a,l;return e(v,{children:((a=n.original.annotationType)==null?void 0:a.charAt(0).toUpperCase())+((l=n.original.annotationType)==null?void 0:l.slice(1).toLowerCase())})}}],iC=n=>{"use no memo";const{projectId:a}=n,[l,t]=f.useState({}),i=Le(),r=Ve(),s=T.useLazyLoadQuery(Vm,{projectId:a}),[d]=T.useRefetchableFragment(Rm,s.project),[c]=T.useMutation(wm),[u]=T.useMutation(Em),m=f.useCallback(k=>{t(S=>({...S,[k]:!0})),f.startTransition(()=>{c({variables:{projectId:a,annotationConfigId:k},onCompleted:()=>{t(S=>({...S,[k]:!1})),i({title:"Annotation config added",message:"The annotation config has been added to the project."})},onError:S=>{t(F=>({...F,[k]:!1})),r({title:"Failed to add annotation config",message:S.message||"An unknown error occurred"})}})})},[a,c,i,r]),g=f.useCallback(k=>{t(S=>({...S,[k]:!0})),u({variables:{projectId:a,annotationConfigId:k},onCompleted:()=>{t(S=>({...S,[k]:!1})),i({title:"Annotation config removed",message:"The annotation config has been removed from the project."})},onError:S=>{t(F=>({...F,[k]:!1})),r({title:"Failed to remove annotation config",message:S.message||"An unknown error occurred"})}})},[a,u,i,r]),{allAnnotationConfigs:p}=s,y=f.useMemo(()=>{var S;const k=((S=d==null?void 0:d.annotationConfigs)==null?void 0:S.edges.map(F=>{var I;return(I=F==null?void 0:F.node)==null?void 0:I.name}))||[];return p.edges.map(F=>({id:F.node.id||"",name:F.node.name||"",annotationType:F.node.annotationType||"",isEnabled:k.includes(F.node.name),isLoading:l[F.node.id||""],onAdd:m,onRemove:g}))},[p.edges,d,l,m,g]),h=Qe({data:y,columns:tC,getCoreRowModel:Be()});return p.edges.length===0?e(b,{direction:"row",justifyContent:"center",children:e(v,{children:"No annotation configurations available."})}):e("div",{css:K`
        overflow: auto;
      `,children:o("table",{css:Kn,style:{width:h.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:h.getHeaderGroups().map(k=>e("tr",{children:k.headers.map(S=>e("th",{colSpan:S.colSpan,children:S.isPlaceholder?null:e("div",{style:{left:S.getStart(),width:S.getSize()},children:de(S.column.columnDef.header,S.getContext())})},S.id))},k.id))}),e("tbody",{children:h.getRowModel().rows.map(k=>e("tr",{children:k.getVisibleCells().map(S=>e("td",{style:{width:S.column.getSize(),maxWidth:S.column.getSize()},children:de(S.column.columnDef.cell,S.getContext())},S.id))},k.id))})]})})},Nm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},d={kind:"InlineFragment",selections:[s],type:"TraceRetentionRuleMaxDays",abstractKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null},u={kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxCount",abstractKey:null},m={kind:"InlineFragment",selections:[s,c],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"ProjectConfigPage_projectConfigCard"},{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_policy"}],storageKey:null},{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_query"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesProjectConfigQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[l,i,r,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,d,u,m],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyConnection",kind:"LinkedField",name:"projectTraceRetentionPolicies",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicyEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"node",plural:!1,selections:[l,i,r,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[t,u,d,m],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"21b6f510ef6ac701854b1c2f750f30ad",id:null,metadata:{},name:"ProjectPageQueriesProjectConfigQuery",operationKind:"query",text:`query ProjectPageQueriesProjectConfigQuery(
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    id
    ...ProjectConfigPage_projectConfigCard
    ...ProjectRetentionPolicyCard_policy
  }
  ...ProjectRetentionPolicyCard_query
}

fragment ProjectConfigPage_projectConfigCard on Project {
  id
  name
  gradientStartColor
  gradientEndColor
}

fragment ProjectRetentionPolicyCard_policy on Project {
  id
  name
  traceRetentionPolicy {
    id
    name
    cronExpression
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
      ... on TraceRetentionRuleMaxCount {
        maxCount
      }
      ... on TraceRetentionRuleMaxDaysOrCount {
        maxDays
        maxCount
      }
    }
  }
}

fragment ProjectRetentionPolicyCard_query on Query {
  ...ProjectTraceRetentionPolicySelectFragment
}

fragment ProjectTraceRetentionPolicySelectFragment on Query {
  projectTraceRetentionPolicies {
    edges {
      node {
        id
        name
        cronExpression
        rule {
          __typename
          ... on TraceRetentionRuleMaxCount {
            maxCount
          }
          ... on TraceRetentionRuleMaxDays {
            maxDays
          }
          ... on TraceRetentionRuleMaxDaysOrCount {
            maxDays
            maxCount
          }
        }
      }
    }
  }
}
`}}})();Nm.hash="3d4a317421ae07c5ad4ddd7f22b99771";const zm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],s=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesSessionsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"sessionAnnotationNames",storageKey:null},{alias:null,args:r,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectSessionAnnotation",kind:"LinkedField",name:"sessionAnnotations",plural:!0,selections:[t,i,d,c,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"sessionAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},i],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[d,c],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:r,filters:["sort","filterIoSubstring","timeRange","sessionId"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"38f916d20070ce21c5e1221c063cdb98",id:null,metadata:{},name:"ProjectPageQueriesSessionsQuery",operationKind:"query",text:`query ProjectPageQueriesSessionsQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...SessionsTable_sessions
    id
  }
}

fragment SessionAnnotationSummaryGroup on ProjectSession {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  sessionAnnotations {
    id
    name
    label
    score
    annotatorKind
    user {
      username
      profilePictureUrl
      id
    }
  }
  sessionAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SessionColumnSelector_annotations on Project {
  sessionAnnotationNames
}

fragment SessionsTable_sessions on Project {
  name
  ...SessionColumnSelector_annotations
  sessions(first: 30, sort: {col: startTime, dir: desc}, timeRange: $timeRange) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
        costSummary {
          total {
            cost
          }
        }
        sessionAnnotations {
          id
          name
          label
          score
          annotatorKind
          user {
            username
            profilePictureUrl
            id
          }
        }
        sessionAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        project {
          id
          annotationConfigs {
            edges {
              node {
                __typename
                ... on AnnotationConfigBase {
                  __isAnnotationConfigBase: __typename
                  annotationType
                }
                ... on CategoricalAnnotationConfig {
                  id
                  name
                  optimizationDirection
                  values {
                    label
                    score
                  }
                }
                ... on Node {
                  __isNode: __typename
                  id
                }
              }
            }
          }
        }
        ...SessionAnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();zm.hash="f475282bbe180d5df7b013d618a4a7f7";const $m=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d=[{kind:"Literal",name:"first",value:30},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],u={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"ProjectPageQueriesSpansQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[s,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:d,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[r,s,u,m,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},u],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},s],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[r,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[r,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[u,m],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[r],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:d,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"5172e7e9cf43c4ce9b369a38de9416d5",id:null,metadata:{},name:"ProjectPageQueriesSpansQuery",operationKind:"query",text:`query ProjectPageQueriesSpansQuery(
  $id: ID!
  $timeRange: TimeRange!
  $orphanSpanAsRootSpan: Boolean!
) {
  project: node(id: $id) {
    __typename
    ...SpansTable_spans
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        cumulativeTokenCountTotal
        spanId
        trace {
          id
          traceId
          costSummary {
            total {
              cost
            }
          }
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        ...AnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();$m.hash="6c31b031cf07047b2f02307de192ee3c";const Om=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{kind:"Literal",name:"first",value:30},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Literal",name:"sort",value:{col:"startTime",dir:"desc"}},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],s={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},g=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],p={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:g,storageKey:null},y={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:g,storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},I={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,S,F,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},t],storageKey:null}],storageKey:null},L={alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},S],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},i],storageKey:null},M={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[S,F],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},E={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQueriesTracesQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:r,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,i,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},d,c,u,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},m,p,y,h,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,k,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},I,L,M,E,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,s,i,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},d,c,u,m,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},p,y,h,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,k],storageKey:null},I,M,L,E],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:r,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"c2d7db78ed889ec5545108b0bdb6cc8a",id:null,metadata:{},name:"ProjectPageQueriesTracesQuery",operationKind:"query",text:`query ProjectPageQueriesTracesQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...TracesTable_spans
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}

fragment TracesTable_spans on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: 30, sort: {col: startTime, dir: desc}, rootSpansOnly: true, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        endTime
        latencyMs
        cumulativeTokenCountTotal
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
          costSummary {
            total {
              cost
            }
          }
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        ...AnnotationSummaryGroup
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              endTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
                createdAt
              }
              ...AnnotationSummaryGroup
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
              ...TraceHeaderRootSpanAnnotationsFragment
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Om.hash="a11623d043c2945903dbd3fd179886cb";const jm=Om,Qm=$m,Bm=zm,qm=Nm,Um=f.createContext({spansQueryReference:null,sessionsQueryReference:null,tracesQueryReference:null,projectConfigQueryReference:null}),nr=()=>{const n=f.useContext(Um);if(!n)throw new Error("ProjectPageQueryReferenceContext not found");return n},Hm=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"policyId"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l=[{fields:[{items:[{kind:"Variable",name:"addProjects.0",variableName:"projectId"}],kind:"ListValue",name:"addProjects"},{kind:"Variable",name:"id",variableName:"policyId"}],kind:"ObjectValue",name:"input"}],t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"ProjectRetentionPolicyCard_policy"}],type:"Project",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",selections:[{alias:null,args:l,concreteType:"ProjectTraceRetentionPolicyMutationPayload",kind:"LinkedField",name:"patchProjectTraceRetentionPolicy",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[s,{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[r,s,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[i,{kind:"InlineFragment",selections:[d],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[c],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[d,c],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"a98d713987237f83deb503164dc5d9b2",id:null,metadata:{},name:"ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation",operationKind:"mutation",text:`mutation ProjectRetentionPolicyCardSetProjectRetentionPolicyMutation(
  $projectId: ID!
  $policyId: ID!
) {
  patchProjectTraceRetentionPolicy(input: {id: $policyId, addProjects: [$projectId]}) {
    query {
      node(id: $projectId) {
        __typename
        ... on Project {
          ...ProjectRetentionPolicyCard_policy
        }
        id
      }
    }
  }
}

fragment ProjectRetentionPolicyCard_policy on Project {
  id
  name
  traceRetentionPolicy {
    id
    name
    cronExpression
    rule {
      __typename
      ... on TraceRetentionRuleMaxDays {
        maxDays
      }
      ... on TraceRetentionRuleMaxCount {
        maxCount
      }
      ... on TraceRetentionRuleMaxDaysOrCount {
        maxDays
        maxCount
      }
    }
  }
}
`}}})();Hm.hash="7b5534147b50d4a3232a2d5d94705212";const Gm=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"maxDays",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"maxCount",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCard_policy",selections:[n,a,{alias:null,args:null,concreteType:"ProjectTraceRetentionPolicy",kind:"LinkedField",name:"traceRetentionPolicy",plural:!1,selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"cronExpression",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"rule",plural:!1,selections:[{kind:"InlineFragment",selections:[l],type:"TraceRetentionRuleMaxDays",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"TraceRetentionRuleMaxCount",abstractKey:null},{kind:"InlineFragment",selections:[l,t],type:"TraceRetentionRuleMaxDaysOrCount",abstractKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}})();Gm.hash="6069a92b50f5083a8c8fbeee6982b6b5";const Wm={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ProjectRetentionPolicyCard_query",selections:[{args:null,kind:"FragmentSpread",name:"ProjectTraceRetentionPolicySelectFragment"}],type:"Query",abstractKey:null};Wm.hash="ae8f95394a5ca83acf7326a90809b351";const rC=({project:n,query:a})=>{var g,p,y,h,k,S;const l=zd(),t=Le(),i=Ve(),r=T.useFragment(Wm,a),s=T.useFragment(Gm,n),[d,c]=T.useMutation(Hm),u=f.useMemo(()=>{var F;return Us({schedule:((F=s.traceRetentionPolicy)==null?void 0:F.cronExpression)||""})},[(g=s.traceRetentionPolicy)==null?void 0:g.cronExpression]),m=F=>{d({variables:{projectId:s.id,policyId:F},onCompleted:()=>{t({title:"Project retention policy updated",message:"The new policy will take effect at the configured schedule."})},onError:()=>{i({title:"Failed to update retention policy",message:"Please try again."})}})};return o(ee,{title:"Data Retention",children:[e(C,{paddingX:"size-200",paddingY:"size-100",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",children:[e("section",{children:e(t0,{defaultValue:(p=s.traceRetentionPolicy)==null?void 0:p.id,onChange:m,query:r,isDisabled:c||!l})}),e("section",{children:o(b,{direction:"column",gap:"size-100",children:[e(v,{children:ju({numberOfDays:(h=(y=s.traceRetentionPolicy)==null?void 0:y.rule)==null?void 0:h.maxDays,numberOfTraces:(S=(k=s.traceRetentionPolicy)==null?void 0:k.rule)==null?void 0:S.maxCount})}),o(v,{children:[e("b",{children:"Schedule:"})," ",u]})]})})]})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"dark",children:e(b,{direction:"row",justifyContent:"end",children:e(Dn,{to:"/settings/data",children:"Configure Retention Policies"})})})]})},sC=K`
  overflow-y: auto;
`,oC=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,dC=K`
  width: 75px;
  height: 75px;
  flex: none;
  border-radius: 50%;
  margin-top: var(--ac-global-dimension-size-100);
`,J9=()=>{const{projectConfigQueryReference:n}=nr();return n?e("main",{css:sC,children:e("div",{css:oC,children:e(f.Suspense,{fallback:e(me,{}),children:e(cC,{project:n})})})}):null},cC=({project:n})=>{const a=T.usePreloadedQuery(qm,n);return o(b,{direction:"column",gap:"size-200",children:[e(uC,{project:a.project}),e(lC,{projectId:a.project.id}),e(rC,{project:a.project,query:a})]})},uC=({project:n})=>{const[a]=T.useRefetchableFragment(_m,n),{defaultTab:l,setDefaultTab:t}=Ot(i=>({defaultTab:i.defaultTab,setDefaultTab:i.setDefaultTab}));return e(ee,{title:"Project Settings",children:e(C,{padding:"size-200",children:o(b,{direction:"row",gap:"size-200",children:[e("div",{css:[dC,{background:`linear-gradient(136.27deg, ${a.gradientStartColor} 14.03%, ${a.gradientEndColor} 84.38%)`}]}),e("div",{css:K`
              width: 100%;
              .ac-dropdown,
              .ac-dropdown-button {
                width: 100%;
              }
            `,children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[o(b,{direction:"row",gap:"size-100",alignItems:"end",width:"100%",children:[o(Fe,{value:a.name,isReadOnly:!0,css:K`
                    width: 100%;
                  `,children:[e(J,{children:"Project Name"}),e(ge,{})]}),e(rn,{text:a.name,size:"M"})]}),o(Dl,{value:l,onChange:i=>{typeof i=="string"&&Am(i)&&t(i)},placeholder:"Select a default tab",children:[e(J,{children:"Default Project Tab"}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:o(Bn,{children:[e(dn,{id:"spans",children:"Spans"},"spans"),e(dn,{id:"traces",children:"Traces"},"traces"),e(dn,{id:"sessions",children:"Sessions"},"sessions"),e(dn,{id:"metrics",children:"Metrics"},"metrics")]})})]})]})})]})})})};function Z9(){const{projectId:n}=on();return Xe(n),e(i0,{projectId:n,children:e(Ue,{})})}const Jm=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptConfigLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"bb3d56ec191577418a8de0eaf53b6bde",id:null,metadata:{},name:"promptConfigLoaderQuery",operationKind:"query",text:`query promptConfigLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      ...PromptVersionTagsConfigCard_data
    }
    id
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}})();Jm.hash="14c6b4bb4ca5f20cce70677746b16459";const X9=async({params:n})=>{const a=n.promptId;if(!a)throw new Error("Prompt ID is required");return await T.fetchQuery(ze,Jm,{id:a}).toPromise()},Zm={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__aside",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLatestVersionsListFragment"},{args:null,kind:"FragmentSpread",name:"EditPromptButton_data"},{args:null,kind:"FragmentSpread",name:"PromptLabels"}],type:"Prompt",abstractKey:null};Zm.hash="407e371e7602b5195f1061fef7705c23";const Xm={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptIndexPage__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptIndexPage__aside"}],type:"Prompt",abstractKey:null};Xm.hash="a883b83f574448623a2b02a60d899d41";const Ym=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"promptLabelIds"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"},{kind:"Variable",name:"promptLabelIds",variableName:"promptLabelIds"}],kind:"ObjectValue",name:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptLabelConfigButtonUnsetLabelsMutation",selections:[{alias:null,args:a,concreteType:"PromptLabelAssociationMutationPayload",kind:"LinkedField",name:"unsetPromptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelConfigButton_promptLabels"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptLabelConfigButtonUnsetLabelsMutation",selections:[{alias:null,args:a,concreteType:"PromptLabelAssociationMutationPayload",kind:"LinkedField",name:"unsetPromptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[t],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"61c8ef9cb3cf1be548144a198841df1f",id:null,metadata:{},name:"PromptLabelConfigButtonUnsetLabelsMutation",operationKind:"mutation",text:`mutation PromptLabelConfigButtonUnsetLabelsMutation(
  $promptId: ID!
  $promptLabelIds: [ID!]!
) {
  unsetPromptLabels(input: {promptId: $promptId, promptLabelIds: $promptLabelIds}) {
    query {
      node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptLabelConfigButton_promptLabels
        }
        id
      }
    }
  }
}

fragment PromptLabelConfigButton_promptLabels on Prompt {
  id
  labels {
    id
  }
}
`}}})();Ym.hash="e62fb77edf0bb2eccfbb2af2c85d6f82";const eg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"promptLabelIds"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"},{kind:"Variable",name:"promptLabelIds",variableName:"promptLabelIds"}],kind:"ObjectValue",name:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptLabelConfigButtonSetLabelsMutation",selections:[{alias:null,args:a,concreteType:"PromptLabelAssociationMutationPayload",kind:"LinkedField",name:"setPromptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelConfigButton_promptLabels"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptLabelConfigButtonSetLabelsMutation",selections:[{alias:null,args:a,concreteType:"PromptLabelAssociationMutationPayload",kind:"LinkedField",name:"setPromptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[t],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"0dee2c7f46c3544f59a4f7d1492703a9",id:null,metadata:{},name:"PromptLabelConfigButtonSetLabelsMutation",operationKind:"mutation",text:`mutation PromptLabelConfigButtonSetLabelsMutation(
  $promptId: ID!
  $promptLabelIds: [ID!]!
) {
  setPromptLabels(input: {promptId: $promptId, promptLabelIds: $promptLabelIds}) {
    query {
      node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptLabelConfigButton_promptLabels
        }
        id
      }
    }
  }
}

fragment PromptLabelConfigButton_promptLabels on Prompt {
  id
  labels {
    id
  }
}
`}}})();eg.hash="eb92a569b031b4a9bfbac8ae446cd13a";const ng={argumentDefinitions:[{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:null,direction:"forward",path:["promptLabels"]}]},name:"PromptLabelConfigButton_allLabels",selections:[{alias:"promptLabels",args:null,concreteType:"PromptLabelConnection",kind:"LinkedField",name:"__PromptLabelConfigButtonAllLabels_promptLabels_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};ng.hash="f7e56efc1063f0b5739b9b64f84be12c";const ag=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLabelConfigButton_promptLabels",selections:[n,{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[n],storageKey:null}],type:"Prompt",abstractKey:null}})();ag.hash="7d779bb41603b6c033aefa78571c9dd4";const lg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l=[{kind:"Literal",name:"first",value:100}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptLabelConfigButtonQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelConfigButton_allLabels"},{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelConfigButton_promptLabels"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptLabelConfigButtonQuery",selections:[{alias:null,args:l,concreteType:"PromptLabelConnection",kind:"LinkedField",name:"promptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"promptLabels(first:100)"},{alias:null,args:l,filters:null,handle:"connection",key:"PromptLabelConfigButtonAllLabels_promptLabels",kind:"LinkedHandle",name:"promptLabels"},{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[t],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"67960ced83d40c14dc1d3890f90f4bcb",id:null,metadata:{},name:"PromptLabelConfigButtonQuery",operationKind:"query",text:`query PromptLabelConfigButtonQuery(
  $promptId: ID!
) {
  ...PromptLabelConfigButton_allLabels
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      ...PromptLabelConfigButton_promptLabels
    }
    id
  }
}

fragment PromptLabelConfigButton_allLabels on Query {
  promptLabels(first: 100) {
    edges {
      node {
        id
        name
        color
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}

fragment PromptLabelConfigButton_promptLabels on Prompt {
  id
  labels {
    id
  }
}
`}}})();lg.hash="6132c2b2eddbfe35151799dd19505d7e";function mC(n){const{promptId:a}=n,[l,t]=f.useState(!1),[i,r]=f.useState(!1);return o(te,{children:[o(se,{isOpen:i&&!l,onOpenChange:s=>r(s),children:[e(R,{variant:"quiet",size:"S",leadingVisual:e(x,{svg:e(rs,{})}),"aria-label":"Edit prompt labels"}),o(we,{children:[e(_l,{}),e(re,{children:e(f.Suspense,{fallback:e(me,{}),children:e(gC,{promptId:a,onNewLabelPress:()=>{t(!0)}})})})]})]}),l?e(ws,{isOpen:!0,onOpenChange:s=>{s||t(!1)},children:e(ae,{size:"S",children:e(r0,{onCompleted:()=>t(!1)})})}):null]})}function gC(n){const{promptId:a}=n,l=T.useLazyLoadQuery(lg,{promptId:a});return e(pC,{query:l,prompt:l.prompt,...n})}function pC({query:n,prompt:a,onNewLabelPress:l}){var h;const t=T.useFragment(ag,a),i=T.useFragment(ng,n),r=((h=t==null?void 0:t.labels)==null?void 0:h.map(k=>k.id))||[],[s,d]=f.useState(""),[c,u]=f.useState(()=>new Set(r)),[m]=T.useMutation(eg),[g]=T.useMutation(Ym),p=i.promptLabels.edges.map(k=>k.node).filter(k=>k.name.toLowerCase().includes(s.toLowerCase()));return o(Fl,{children:[e(C,{padding:"size-100",paddingTop:"size-50",borderBottomWidth:"thin",borderColor:"dark",minWidth:300,children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(Te,{level:4,weight:"heavy",children:"Assign labels to this prompt"}),e(fn,{size:"S",onPress:l,children:e(x,{svg:e(Mn,{})})})]}),e(Ll,{autoFocus:!0,"aria-label":"Search labels",placeholder:"Search labels...",onChange:d})]})}),e(Bn,{"aria-label":"labels",items:p,selectionMode:"multiple",selectedKeys:c,onSelectionChange:k=>{if(k==="all")return;const S=[...k],F=S.filter(L=>!r.includes(L)),I=r.filter(L=>!S.includes(L));F.length&&m({variables:{promptId:t.id,promptLabelIds:F}}),I.length&&g({variables:{promptId:t.id,promptLabelIds:I}}),u(k)},css:K`
          height: 300px;
        `,renderEmptyState:()=>"No labels found",children:k=>e(yC,{item:k},k.id)}),e(C,{padding:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:e(qn,{variant:"quiet",size:"S",to:"/settings/prompts",children:"Edit Labels"})})]})}function yC({item:n}){return e(rl,{id:n.id,children:({isSelected:a})=>o(b,{direction:"row",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:n.color,size:"M",shape:"circle"}),n.name]}),a?e(x,{svg:e(s0,{})}):null]})},n.id)}const tg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLabels",selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};tg.hash="ab226cfebdec9e458000b1041eae54fa";const fC=K`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: var(--ac-global-dimension-size-50);
`;function hC({prompt:n}){const a=T.useFragment(tg,n);return a.labels.length===0?e(v,{color:"text-700",children:"No Labels"}):e("ul",{css:fC,children:a.labels.map(t=>e("li",{children:e(nn,{size:"M",color:t.color,children:t.name})},t.name))})}const ig={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptModelConfigurationCard__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptLLM__main"},{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptTools__main"},{args:null,kind:"FragmentSpread",name:"PromptResponseFormatFragment"}],type:"PromptVersion",abstractKey:null};ig.hash="1c4202299f1f881250b17b75244fac54";const rg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptInvocationParameters__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null}],type:"PromptVersion",abstractKey:null};rg.hash="4f00ab4f0396fffb81a1b068e544cfcf";function kC({keyName:n,value:a}){const{json:l,stringifyError:t}=Ra(a);return t?null:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:o(b,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:l})]})})}function bC({promptVersion:n}){const{invocationParameters:a}=T.useFragment(rg,n),l=f.useMemo(()=>PS(a)?Object.entries(a).map(([t,i])=>({key:t,value:i})):[],[a]);return l.length===0?e(C,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No parameters saved for this prompt"})})}):e(os,{size:"S",children:l.map(({key:t,value:i},r)=>e(ss,{children:e(kC,{keyName:t,value:i})},`${t}-${r}`))})}const sg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLLM__main",selections:[{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null}],type:"PromptVersion",abstractKey:null};sg.hash="acc90da43126218472d2fc19cd8d0512";const Xo=({keyName:n,children:a})=>e(ss,{children:e(C,{paddingStart:"size-100",paddingEnd:"size-100",children:o(b,{direction:"row",justifyContent:"space-between",children:[e(v,{size:"XS",color:"text-700",children:n}),e(v,{size:"XS",children:a})]})})});function SC({promptVersion:n}){const a=T.useFragment(sg,n);return o(We,{id:"llm",children:[e(He,{children:"LLM"}),e(Ge,{children:o(os,{size:"S",children:[e(Xo,{keyName:"Model",children:a.model}),e(Xo,{keyName:"Provider",children:Qr[a.provider]??a.provider})]})})]})}const og={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptResponseFormatFragment",selections:[{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};og.hash="154d745ec5e978e0dfc811ebfb9faa8c";function vC({promptVersion:n}){const{responseFormat:a}=T.useFragment(og,n),l=f.useMemo(()=>typeof(a==null?void 0:a.definition)=="string"?Ra(hn(a==null?void 0:a.definition).json||"",null,2).json||"":Ra(a==null?void 0:a.definition,null,2).json||"",[a==null?void 0:a.definition]);return l?o(We,{id:"response-format",children:[e(He,{children:"Response Format"}),e(Ge,{children:e(jl,{value:l})})]}):o(We,{id:"response-format",children:[e(He,{children:"Response Format"}),e(Ge,{children:e(C,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No response format specified for this prompt"})})})})]})}const dg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptTools__main",selections:[{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};dg.hash="aa512d962d83a58b70ae0e17f01242b3";function FC({promptVersion:n}){const{tools:a}=T.useFragment(dg,n),l=f.useMemo(()=>a.map((t,i)=>{const r=t.definition;return{name:D1(r)||`Tool ${i+1}`,description:_1(r)||void 0,definition:Ra(r,null,2).json||"{}"}}),[a]);return l.length===0?o(We,{id:"tools",children:[e(He,{children:"Tools"}),e(Ge,{children:e(C,{padding:"size-200",children:e(b,{justifyContent:"center",alignItems:"center",children:e(v,{color:"text-300",children:"No tools specified for this prompt"})})})})]}):o(b,{direction:"column",children:[e(o0,{bordered:!1,children:"Tools"}),e(ha,{css:K`
          & {
            > .ac-disclosure:last-child {
              &[data-expanded="true"] {
                border-bottom: 1px solid var(--ac-global-border-color-default);
              }
            }
          }
        `,children:l.map((t,i)=>o(We,{id:`tool-${i}`,children:[o(He,{arrowPosition:"start",justifyContent:"space-between",children:[e(v,{children:t.name}),e(v,{children:t.description})]}),e(Ge,{children:e(jl,{value:t.definition})})]},`${t.name}-${i}`))})]})}function cg({promptVersion:n}){const a=T.useFragment(ig,n);return e(ee,{title:"Model Configuration",collapsible:!0,children:o(ha,{defaultExpandedKeys:["llm","invocation-parameters","tools","response-format"],children:[e(SC,{promptVersion:a}),o(We,{id:"invocation-parameters",children:[e(He,{children:"Invocation Parameters"}),e(Ge,{children:e(bC,{promptVersion:a})})]}),e(FC,{promptVersion:a}),e(vC,{promptVersion:a})]})})}const ug=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditPromptButtonPatchPromptMutation",selections:[{alias:null,args:a,concreteType:"Prompt",kind:"LinkedField",name:"patchPrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:s,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},r,i,d,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[r,d,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[r,i],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},r],storageKey:null}],storageKey:null}]},params:{cacheID:"0e2053020de6310f9eb83bdfede13a1e",id:null,metadata:{},name:"EditPromptButtonPatchPromptMutation",operationKind:"mutation",text:`mutation EditPromptButtonPatchPromptMutation(
  $input: PatchPromptInput!
) {
  patchPrompt(input: $input) {
    ...PromptIndexPage__main
    id
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
  metadata
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  id
  name
  description
  metadata
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
  ...PromptLabels
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
        id
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLabels on Prompt {
  labels {
    name
    color
    id
  }
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}})();ug.hash="3ce25c8fbe5598ec1ee037a9778a6957";const mg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EditPromptButton_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],type:"Prompt",abstractKey:null};mg.hash="f1d8e195768db742eb9070b7ad56ce0f";function Yo(n){const[a,l]=f.useState(!1),t=Le(),i=Ve(),r=T.useFragment(mg,n.prompt),[s,d]=T.useMutation(ug),{control:c,handleSubmit:u,reset:m}=sn({defaultValues:{description:r.description??"",metadata:r.metadata?JSON.stringify(r.metadata,null,2):"{}"}}),g=f.useCallback(y=>{l(y),y&&m({description:r.description??"",metadata:r.metadata?JSON.stringify(r.metadata,null,2):"{}"})},[r,m]),p=f.useCallback(y=>{let h=null;if(y.metadata&&y.metadata.trim()!=="")try{h=JSON.parse(y.metadata)}catch{i({title:"Invalid metadata",message:"Failed to parse metadata as JSON"});return}s({variables:{input:{promptId:r.id,description:y.description,metadata:h}},onCompleted:()=>{l(!1),t({title:"Prompt updated",message:"The prompt has been updated successfully"})},onError:k=>{var S;i({title:"Error updating prompt",message:(S=je(k))==null?void 0:S[0]})}})},[r.id,s,i,t]);return o(se,{isOpen:a,onOpenChange:g,children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(rs,{})}),variant:"quiet","aria-label":"configure prompt"}),e(ae,{size:"M",isDismissable:!0,children:o(re,{children:[o(fe,{children:[e(he,{children:"Edit Prompt Details"}),e(ke,{children:e(be,{})})]}),o(bn,{children:[e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[e(H,{name:"description",control:c,render:({field:y})=>o(Fe,{value:y.value,onChange:y.onChange,children:[e(J,{children:"Prompt Description"}),e(Ha,{placeholder:"Enter a description for the prompt"}),e(v,{slot:"description",children:"A description of the prompt"})]})}),e(H,{name:"metadata",control:c,rules:{validate:y=>!y||y.trim()===""||ma(y)?!0:"metadata must be a valid JSON object"},render:({field:{onChange:y,onBlur:h,value:k},fieldState:{error:S}})=>e(ds,{label:"Metadata",errorMessage:S==null?void 0:S.message,description:"A JSON object containing metadata for the prompt",children:e(En,{value:k,onChange:y,onBlur:h})})})]})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",gap:"size-100",justifyContent:"end",children:[e(R,{slot:"close",size:"S",children:"Cancel"}),e(R,{variant:"primary",size:"S",isDisabled:d,onPress:()=>u(p)(),children:d?"Saving...":"Save"})]})})]})]})})]})}const gg=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptChatMessagesCard__main",selections:[{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[n,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[a,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null}],type:"PromptVersion",abstractKey:null}})();gg.hash="e0d9c12926330e5e774cbc64de158a82";const Ws=Y({text:Y({text:le()})}),Js=Y({toolCall:Y({toolCallId:le(),toolCall:Y({name:le(),arguments:le()})})}),Zs=Y({toolResult:Y({toolCallId:le(),result:Wl})}),ar=n=>{const a=Ws.safeParse(n);return a.success?a.data:null},pg=n=>{const a={text:{text:n}},l=Ws.safeParse(a);return l.success?l.data:null},Xs=n=>{const a=Js.safeParse(n);return a.success?a.data:null},yg=n=>{const a=O1(n),l=j1(n),t=Q1(n);if(!a)return null;const i=Ra(t).json||"",r={toolCall:{toolCallId:a,toolCall:{name:l||a,arguments:i}}},s=Js.safeParse(r);return s.success?s.data:null},Ys=n=>{const a=Zs.safeParse(n);return a.success?a.data:null},fg=(n,a)=>{const l={toolResult:{toolCallId:n,result:a}},t=Zs.safeParse(l);return t.success?t.data:null};function ti(n){return f.useMemo(()=>{const a=n.toLowerCase();return Fi.user.includes(a)?{backgroundColor:"grey-200",borderColor:"grey-500"}:Fi.ai.includes(a)?{backgroundColor:"blue-100",borderColor:"blue-700"}:Fi.system.includes(a)?{backgroundColor:"indigo-100",borderColor:"indigo-700"}:["function","tool"].includes(a)?{backgroundColor:"yellow-100",borderColor:"yellow-700"}:{backgroundColor:"grey-100",borderColor:"grey-700"}},[n])}const lr={text:"Text",toolCall:"Tool Call",toolResult:"Tool Result"},CC=Object.values(lr);function KC({toolResult:n,isOnlyChild:a}){const l=f.useMemo(()=>{const t=n.toolResult.result;return js(t)},[n]);return e(eo,{title:lr.toolResult,isOnlyChild:a,children:o(b,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:o(b,{direction:"column",justifyContent:"start",gap:"size-100",children:[e(v,{weight:"heavy",size:"XS",children:"Tool ID"}),e(C,{paddingX:"size-300",children:e(v,{size:"XS",children:n.toolResult.toolCallId})})]})}),o(b,{direction:"column",children:[e(C,{paddingX:"size-200",paddingTop:"size-100",children:e(v,{weight:"heavy",size:"XS",children:"Tool Result"})}),e(Mi,{readOnly:!0,children:e(Ri,{readOnly:!0,height:"100%",defaultValue:l,templateFormat:Yn.NONE})})]})]})})}function TC({provider:n,toolCall:a,isOnlyChild:l}){const t=f.useMemo(()=>{const i=au(a,n);return Ra(i,null,2).json||""},[n,a]);return e(eo,{title:lr.toolCall,isOnlyChild:l,children:e(Mi,{readOnly:!0,children:e(Ri,{readOnly:!0,height:"100%",defaultValue:t,templateFormat:Yn.NONE})})})}function PC(n){const{text:a,templateFormat:l,isOnlyChild:t}=n;return e(eo,{title:lr.text,isOnlyChild:t,children:e(Mi,{readOnly:!0,children:e(Ri,{readOnly:!0,height:"100%",defaultValue:a,templateFormat:l})})})}function eo({title:n,children:a,isOnlyChild:l}){return l?e(te,{children:a}):o(We,{id:n,children:[e(He,{children:e(v,{weight:"heavy",size:"S",children:n})}),e(Ge,{children:a})]})}function IC(n){const{role:a,children:l}=n,t=ti(a);return e(ee,{title:a,...t,collapsible:!0,children:e(ha,{defaultExpandedKeys:CC,children:l})})}function xC({promptVersion:n}){const{template:a,templateFormat:l,provider:t}=T.useFragment(gg,n);if(a.__typename==="PromptStringTemplate")return e(v,{children:a.template});if(a.__typename==="PromptChatTemplate")return e(DC,{template:a,templateFormat:l,provider:uu(t)||Ji});if(a.__typename==="%other")throw new Error("Unknown template type"+a.__typename)}function LC({part:n,templateFormat:a,provider:l,isOnlyChild:t}){let i=ar(n);return i?e(PC,{text:i.text.text,templateFormat:a,isOnlyChild:t}):(i=Xs(n),i?e(TC,{toolCall:i,provider:l,isOnlyChild:t}):(i=Ys(n),i?e(KC,{toolResult:i,isOnlyChild:t}):null))}function DC({template:n,templateFormat:a,provider:l}){const{messages:t}=n;return e(b,{direction:"column",gap:"size-100","data-testid":"chat-messages",children:t.map((i,r)=>{const s=i.content.length===1&&i.content.find(ar)!=null;return e(IC,{role:i.role,children:i.content.map((d,c)=>e(LC,{part:d,templateFormat:a,provider:l,isOnlyChild:s},`${c}-${d.__typename}`))},r)})})}function hg({title:n="Prompt",promptVersion:a}){return e(ee,{title:n,collapsible:!0,"data-testid":"prompt-chat-messages-card",children:e(C,{padding:"size-200",children:e(xC,{promptVersion:a})})})}const kg=(function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptCodeExportCard__main",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:n,storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[l,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null}],type:"PromptVersion",abstractKey:null}})();kg.hash="3fa95713c234bb0cfa4c36e8e4f9cea0";const _C=et(["system","user","assistant","developer","tool","function"]),ii=Y({role:_C,content:le().nullable(),name:le().optional(),tool_call_id:le().optional(),tool_calls:en(Kt).optional()}).passthrough(),AC=en(ii);ra(AC,{removeAdditionalStrategy:"passthrough"});const EC=Y({role:et(["user","assistant","tool"]),content:en(Tl()),tool_call_id:le().optional(),tool_calls:en(ni).optional()}).passthrough(),wC=en(EC);ra(wC,{removeAdditionalStrategy:"passthrough"});const MC=et(["user","assistant","tool"]),RC=ai.extend({type:le(),text:le().optional(),id:le().optional(),tool_use_id:le().optional(),name:le().optional(),input:Sa(Tl()).optional(),source:Y({type:le(),media_type:le().optional(),data:le().optional()}).optional()}),bg=Y({role:MC,content:El([le(),en(RC)])}),VC=en(bg);ra(VC,{removeAdditionalStrategy:"passthrough"});const NC=et(["SYSTEM","USER","AI","TOOL"]),zC=Y({image:Y({url:le()})}),$C=IS("__typename",[Ws.extend({__typename:ca("TextContentPart")}),zC.extend({__typename:ca("ImageContentPart")}),Js.extend({__typename:ca("ToolCallContentPart")}),Zs.extend({__typename:ca("ToolResultContentPart")})]),tr=Y({role:NC,content:en($C)}).passthrough(),OC=en(tr);ra(OC,{removeAdditionalStrategy:"passthrough"});const jC=ii.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[],tool_calls:n.tool_calls.map(l=>Xc.parse(l))}:a}),Sg=ii.transform(n=>{const a={role:n.role==="assistant"?"assistant":"user",content:n.content?[{type:"text",text:n.content}]:[]};return n.tool_calls?{...a,content:[...a.content,...n.tool_calls.map(l=>Yc.parse(l))]}:n.tool_call_id?{...a,content:[{type:"tool_result",tool_use_id:n.tool_call_id,content:n.content}]}:a}),vg=tr.transform(n=>{if(n.role==="TOOL"){const t=n.content.map(i=>Ys(i)).find(i=>!!i);if(!t)throw new Error("TOOL role message must have a ToolResultContentPart");return{role:"tool",content:js(t.toolResult.result),tool_call_id:t.toolResult.toolCallId}}const a={role:{SYSTEM:"system",USER:"user",AI:"assistant",TOOL:"tool"}[n.role],content:n.content.map(t=>ar(t)).filter(t=>!!t).map(t=>t.text.text).join(`
`)},l=n.content.map(t=>Xs(t)).filter(t=>!!t).map(t=>({id:t.toolCall.toolCallId,type:"function",function:{name:t.toolCall.toolCall.name,arguments:typeof t.toolCall.toolCall.arguments=="string"?JSON.parse(t.toolCall.toolCall.arguments):t.toolCall.toolCall.arguments}}));return l.length>0?{...a,tool_calls:l}:a});ii.transform(n=>{const a=[];if(n.role==="tool"&&n.tool_call_id){const t=fg(n.tool_call_id,n.content);return t&&a.push({__typename:"ToolResultContentPart",...t}),{role:"TOOL",content:a}}if(n.content){const t=pg(n.content);t&&a.push({__typename:"TextContentPart",...t})}return n.tool_calls&&n.tool_calls.forEach(t=>{const i=yg({id:t.id,name:t.function.name,arguments:t.function.arguments});i&&a.push({__typename:"ToolCallContentPart",...i})}),{role:{system:"SYSTEM",user:"USER",assistant:"AI",tool:"TOOL",developer:"SYSTEM",function:"TOOL"}[n.role],content:a}});const QC=({message:n,targetProvider:a})=>{switch(a){case"AZURE_OPENAI":case"OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return n;case"ANTHROPIC":return Sg.parse(n);case"AWS":return jC.parse(n);case"GOOGLE":return n;default:return Ne()}};El([ii,bg,tr,Wl]);tr.transform(n=>Sg.parse(vg.parse(n)));const Ea="  ",gi=({json:n,level:a,removeKeyQuotes:l=!1})=>{const t=Ea.repeat(a);let i=JSON.stringify(n,null,Ea);return i=i.split(`
`).map((r,s)=>s>0?t+r:r).join(`
`),l&&(i=i.replace(/"([a-zA-Z_$][a-zA-Z0-9_$]*)"\s*:/g,"$1:")),i},BC=va.template(`
from openai import OpenAI

client = OpenAI()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.chat.completions.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.choices[0].message)
`.trim()),qC=va.template(`
import OpenAI from "openai";

const openai = new OpenAI();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = openai.chat.completions.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

response.then((completion) => console.log(completion.choices[0].message));
`.trim()),UC=va.template(`
from openai import OpenAI
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")

# Format the prompt template with the appropriate variables
response = OpenAI().chat.completions.create(**prompt.format(variables={ "variable": "value" }))
print(response.choices[0].message.content)
  `.trim()),HC=va.template(`
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const openai = new OpenAI();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const openAIParams = toSDK({
  prompt,
  sdk: "openai",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await openai.chat.completions.create({
  ...openAIParams,
});

console.log(response.choices[0]?.message.content);
`.trim()),GC=va.template(`
from anthropic import Anthropic

client = Anthropic()

messages=<%= messages %>
# ^ apply additional templating to messages if needed

completion = client.messages.create(
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>)

print(completion.content)
`.trim()),WC=va.template(`
import Anthropic from "@anthropic-ai/sdk";

const client = new Anthropic();

const messages = <%= messages %>;
// ^ apply additional templating to messages if needed

const response = await client.messages.create({
<% _.forEach(args, function(arg) { %><%= tab %><%= arg %>,
<% }); %>});

console.log(response.content);
`.trim()),JC=va.template(`
from anthropic import Anthropic
from phoenix.client import Client

prompt = Client().prompts.get(prompt_version_id="<%= versionId %>")
# Format the prompt template with the appropriate variables
resp = Anthropic().messages.create(**prompt.format(variables={ "variable": "value" }))
  `.trim()),ZC=va.template(`
import Anthropic from "@anthropic-ai/sdk";
import { Client } from "@arizeai/phoenix-client";
import { toSDK, getPrompt } from "@arizeai/phoenix-client/prompts";

const client = new Client();
const anthropic = new Anthropic();

const prompt = await getPrompt({
  client,
  prompt: {
    versionId: "<%= versionId %>",
  },
});

const anthropicParams = toSDK({
  prompt,
  sdk: "anthropic",
  // Apply the prompt template variables
  variables: {
    key: "value",
  },
});

const response = await anthropic.messages.create({
  ...anthropicParams,
});

console.log(response.content);
`.trim()),Sl={python:{openai:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:BC,clientTemplate:UC},anthropic:{assignmentOperator:"=",removeKeyQuotes:!1,stringQuote:'"',sdkTemplate:GC,clientTemplate:JC}},typescript:{openai:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:qC,clientTemplate:HC},anthropic:{assignmentOperator:": ",removeKeyQuotes:!0,stringQuote:'"',sdkTemplate:WC,clientTemplate:ZC}}},pi=(n,a)=>{if(!("messages"in n.template))throw new Error("Prompt template does not contain messages");const l=[],{assignmentOperator:t,removeKeyQuotes:i,stringQuote:r}=a;if(n.modelName&&l.push(`model${t}${r}${n.modelName}${r}`),n.invocationParameters){const d=Object.entries(n.invocationParameters).map(([c,u])=>typeof u=="string"?`${c}${t}${r}${u}${r}`:xa(u)?`${c}${t}${gi({json:u,level:1,removeKeyQuotes:i})}`:`${c}${t}${u}`);l.push(...d)}let s="";if(n.template.messages.length>0&&(s=gi({json:n.template.messages,level:0,removeKeyQuotes:i}),l.push(t==="="?"messages=messages":"messages")),n.tools&&n.tools.length>0){const d=gi({json:n.tools.map(c=>c.definition),level:1,removeKeyQuotes:i});l.push(`tools${t}${d}`)}if(n.responseFormat&&"definition"in n.responseFormat){const d=gi({json:n.responseFormat.definition,level:1,removeKeyQuotes:i});l.push(`response_format${t}${d}`)}return{args:l,messages:s}},ed=n=>"tool_calls"in n&&n.tool_calls?{...n,tool_calls:n.tool_calls.map(a=>({...a,function:{...a.function,arguments:JSON.stringify(a.function.arguments)}}))}:n,XC={python:{openai:n=>{const a=Sl.python.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>ed(r))}},{args:t,messages:i}=pi(l,a);return a.sdkTemplate({tab:Ea,args:t,messages:i})},anthropic:n=>{const a=Sl.python.anthropic,{args:l,messages:t}=pi(n,a);return a.sdkTemplate({tab:Ea,args:l,messages:t})}},typescript:{openai:n=>{const a=Sl.typescript.openai,l={...n,template:{...n.template,messages:n.template.messages.map(r=>ed(r))}},{args:t,messages:i}=pi(l,a);return a.sdkTemplate({tab:Ea,args:t,messages:i})},anthropic:n=>{const a=Sl.typescript.anthropic,{args:l,messages:t}=pi(n,a);return a.sdkTemplate({tab:Ea,args:l,messages:t})}}},YC={python:{openai:n=>Sl.python.openai.clientTemplate({tab:Ea,versionId:n.versionId}),anthropic:n=>Sl.python.openai.clientTemplate({tab:Ea,versionId:n.versionId})},typescript:{openai:n=>Sl.typescript.openai.clientTemplate({tab:Ea,versionId:n.versionId}),anthropic:n=>Sl.typescript.anthropic.clientTemplate({tab:Ea,versionId:n.versionId})}},eK=({promptVersion:n,language:a})=>{var i;const l=XC[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l||!("messages"in n.template))return null;const t={...n,template:{...n.template,messages:n.template.messages.map(r=>{try{return QC({message:vg.parse(r),targetProvider:n.modelProvider})}catch(s){return console.warn("Cannot convert message"),console.error(s),null}}).filter(Boolean)}};return l(t)};function nK({promptVersion:n,language:a}){var i;const l=YC[a.toLocaleLowerCase()][(i=n.modelProvider)==null?void 0:i.toLocaleLowerCase()];if(!l)return null;const t={versionId:n.id};return l(t)}function Fg({promptVersion:n}){const{programmingLanguage:a,setProgrammingLanguage:l}=Cn(s=>({programmingLanguage:s.programmingLanguage,setProgrammingLanguage:s.setProgrammingLanguage})),t=T.useFragment(kg,n),i=f.useMemo(()=>eK({promptVersion:t,language:a}),[t,a]),r=f.useMemo(()=>nK({promptVersion:t,language:a}),[t,a]);return e(ee,{title:"Code",extra:e(b,{gap:"size-100",alignItems:"center",children:e(cs,{language:a,onChange:l,size:"S"})}),children:o(ha,{defaultExpandedKeys:["sdk-inline","client"],children:[o(We,{id:"sdk-inline",children:[e(He,{arrowPosition:"start",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",width:"100%",children:[e(v,{children:"SDK Inline"}),i?e(rn,{text:i}):null]})}),e(Ge,{children:i==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No code snippet available for this prompt"})}):e(nd,{language:a,value:i})})]}),o(We,{id:"client",children:[e(He,{arrowPosition:"start",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",gap:"size-100",children:[e(v,{children:"Using the Client"}),r?e(rn,{text:r}):null]})}),e(Ge,{children:r==null?e(C,{width:"100%",padding:"size-200",children:e(v,{color:"text-300",children:"No client code snippet available for this prompt"})}):e(nd,{language:a,value:r})})]})]})})}function nd({language:n,value:a}){switch(n){case"Python":return e(Gd,{value:a,basicSetup:{lineNumbers:!0}});case"TypeScript":return e(d0,{value:a,basicSetup:{lineNumbers:!0}});default:Ne()}}const Cg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLatestVersionsListFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"}],type:"Prompt",abstractKey:null};Cg.hash="a473a6f0d927379542694312449a4c63";const Kg=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionSummaryFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],type:"PromptVersion",abstractKey:null}})();Kg.hash="80901eff49852a413f643ee876638174";const Tg={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsList_data",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null};Tg.hash="25265fbc7ea915534615a56b4331236e";function Pg({promptVersion:n}){const a=T.useFragment(Tg,n);return e(b,{direction:"row",gap:"size-50",alignItems:"center",wrap:"wrap",children:a.tags.map(l=>e(Hr,{children:l.name},l.id))})}function Hr({children:n}){const a=f.useMemo(()=>{switch(n){case"production":return"var(--ac-global-color-green-1000)";case"staging":return"var(--ac-global-color-yellow-1000)";case"development":return"var(--ac-global-color-blue-1000)";default:return"var(--ac-global-color-grey-900)"}},[n]);return e(nn,{color:a,children:n})}function Ig(n){const{nowEpochMs:a}=Wd(),l=T.useFragment(Kg,n.promptVersion);return o(b,{direction:"column",gap:"size-50",children:[e(C,{width:"100%",children:e(b,{direction:"row",justifyContent:"space-between",alignItems:"center",width:"100%",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(nn,{color:"var(--ac-global-color-blue-900)",children:l.sequenceNumber}),e("span",{children:`${l.id}`})]})})}),e(C,{"data-testid":"prompt-version-item-description",paddingStart:"size-400",children:o(b,{direction:"column",gap:"size-100",children:[e(mn,{maxWidth:"100%",children:e(v,{color:"text-700",size:"XS",children:l.description||"No Description"})}),o(b,{justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(Pg,{promptVersion:l}),o(b,{direction:"row",gap:"size-100",alignItems:"center",flex:"none",children:[l.user&&o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(wi,{size:14,name:l.user.username,profilePictureUrl:l.user.profilePictureUrl}),e(v,{size:"XS",children:l.user.username})]}),e(v,{color:"text-300",size:"XS",children:xS(l.createdAt,a)})]})]})]})})]})}const aK=5,lK=K`
  padding-bottom: var(--ac-global-dimension-size-200);
  position: relative;
`;function tK(n){const{prompt:a}=n,l=T.useFragment(Cg,a),t=f.useMemo(()=>{var i,r;return(r=(i=l==null?void 0:l.latestVersions)==null?void 0:i.edges)==null?void 0:r.map(s=>s.version)},[l]);if(!t)throw new Error("Expected prompt versions to be defined");return o("div",{children:[e("ul",{children:t.map((i,r)=>{const s=r===aK-1;return o("li",{css:lK,children:[e(Ig,{promptVersion:i}),i.sequenceNumber!=1?e(rK,{isLastConnector:s}):null]},i.id)})}),e(b,{direction:"row",justifyContent:"end",children:e(Dn,{to:"versions",children:"View all versions"})})]})}const iK=K`
  position: absolute;
  top: 25px;
  left: 11px;
  height: calc(100% - 32px);
  width: 2px;
  --connector-color: var(--ac-global-color-grey-400);
  background:
    repeating-linear-gradient(
      to bottom,
      transparent 0 4px,
      var(--ac-global-color-grey-50) 4px 8px
    ),
    var(--connector-color);
  background-size: 4px 100%;
  background-position: 80%;
  background-repeat: no-repeat;
  &[data-last="true"] {
    background:
      repeating-linear-gradient(
        to bottom,
        transparent 0 4px,
        var(--ac-global-color-grey-50) 4px 8px
      ),
      linear-gradient(to bottom, var(--connector-color), transparent);
  }
`;function rK({isLastConnector:n}){return e("div",{css:iK,"data-last":n})}const xg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],d={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},m={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},g=[t,i],p={alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:g,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{args:null,kind:"FragmentSpread",name:"PromptIndexPage__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionsPageContent__main"},{args:null,kind:"FragmentSpread",name:"PromptLayout__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[r,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},i],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:s,storageKey:null},{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null}],storageKey:null},{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,c,u,m,p],storageKey:null}],storageKey:null}],storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:5}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,u,c,m,p],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:5)"},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},t],storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:g,storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"402a8d3c870d60d150906cc56449edac",id:null,metadata:{},name:"promptLoaderQuery",operationKind:"query",text:`query promptLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
      ...PromptIndexPage__main
      ...PromptVersionsPageContent__main
      ...PromptLayout__main
    }
  }
}

fragment EditPromptButton_data on Prompt {
  id
  description
  metadata
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptIndexPage__aside on Prompt {
  id
  name
  description
  metadata
  ...PromptLatestVersionsListFragment
  ...EditPromptButton_data
  ...PromptLabels
}

fragment PromptIndexPage__main on Prompt {
  promptVersions {
    edges {
      node {
        ...PromptInvocationParameters__main
        ...PromptChatMessagesCard__main
        ...PromptCodeExportCard__main
        ...PromptModelConfigurationCard__main
        id
      }
    }
  }
  ...PromptIndexPage__aside
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptLabels on Prompt {
  labels {
    name
    color
    id
  }
}

fragment PromptLatestVersionsListFragment on Prompt {
  latestVersions: promptVersions(first: 5) {
    edges {
      version: node {
        id
        description
        createdAt
        sequenceNumber
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptLayout__main on Prompt {
  id
  name
  description
  metadata
  sourcePrompt {
    id
    name
  }
  promptVersions {
    edges {
      node {
        id
      }
    }
  }
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}

fragment PromptVersionsPageContent__main on Prompt {
  ...PromptVersionsList__main
}
`}}})();xg.hash="c19209c9d3b9df985746493df3a97b49";const Lg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{alias:"prompt",args:[{kind:"Variable",name:"id",variableName:"id"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptLoader_PromptQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptLoader_PromptQuery",selections:a},params:{cacheID:"e2002360cae1a354ce5c0128989a0ecb",id:null,metadata:{},name:"promptLoader_PromptQuery",operationKind:"query",text:`query promptLoader_PromptQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    id
    ... on Prompt {
      name
    }
  }
}
`}}})();Lg.hash="933d252110e9044883a0cde91038d763";async function Y9(n){const{promptId:a}=n.params;Xe(a);const l=T.loadQuery(ze,ir,{id:a}),t=await T.fetchQuery(ze,Lg,{id:a}).toPromise();return{queryRef:l,prompt:t==null?void 0:t.prompt}}const ir=xg,no=()=>{const a=LS().find(l=>l.pathname.split("/prompts/").length===2);if(!a)throw new Error("usePromptIdLoader must be used within a /prompts/:promptId route");return DS(a.id)};function e5(){const n=no(),a=T.usePreloadedQuery(ir,n.queryRef);return e(sK,{prompt:a.prompt})}function sK({prompt:n}){var t,i,r;const a=T.useFragment(Xm,n),l=(r=(i=(t=a==null?void 0:a.promptVersions)==null?void 0:t.edges)==null?void 0:i[0])==null?void 0:r.node;return o(b,{direction:"row",height:"100%",children:[e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:[e(hg,{title:"Prompt Template",promptVersion:l}),e(cg,{promptVersion:l}),e(Fg,{promptVersion:l})]})})}),e(oK,{prompt:a})]})}function oK({prompt:n}){const a=T.useFragment(Zm,n),l=!!(a!=null&&a.description);return e(C,{flex:"none",width:400,borderStartColor:"dark",borderStartWidth:"thin",children:o(C,{padding:"size-200",children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(di,{level:3,children:"Description"}),e(Yo,{prompt:a})]}),e(v,{color:l?"text-900":"text-700",children:a.description||"No Description"}),o("section",{children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(di,{level:3,children:"Labels"}),e(mC,{promptId:a.id})]}),e(hC,{prompt:a})]}),o("section",{children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(di,{level:3,children:"Metadata"}),e(Yo,{prompt:a})]}),e(jl,{value:a.metadata?JSON.stringify(a.metadata,null,2):"{}"})]}),o("section",{children:[e(di,{level:3,children:"Latest Versions"}),e(tK,{prompt:a})]})]})})}const Dg=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLayout__main",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"sourcePrompt",plural:!1,selections:[n,a],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[n],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}})();Dg.hash="1778112f7fe3cd7c75472a1889cce0d9";const _g=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"clonePrompt",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ClonePromptDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ClonePromptDialogMutation",selections:a},params:{cacheID:"6ad0382f6acd0f00125307c887c0f4f2",id:null,metadata:{},name:"ClonePromptDialogMutation",operationKind:"mutation",text:`mutation ClonePromptDialogMutation(
  $input: ClonePromptInput!
) {
  clonePrompt(input: $input) {
    id
  }
}
`}}})();_g.hash="081b8cf05c35b46579fe5cbb85f7a761";const dK=/^[_a-z0-9-]*$/,cK=/^([a-z0-9](.*[a-z0-9])?)?$/;function ao(n){return n.trim()===""?"Cannot be empty":dK.test(n)?cK.test(n)?!0:"Must start and end with lowercase alphanumeric characters":"Must have only lowercase alphanumeric characters, dashes, and underscores"}const uK=({promptId:n,promptName:a,promptDescription:l,promptMetadata:t})=>{const i=Le(),r=Me(),[s,d]=T.useMutation(_g),c=sn({disabled:d,mode:"onChange",defaultValues:{name:`${a}-clone`,description:l,metadata:t?JSON.stringify(t,null,2):"{}"}}),{control:u,handleSubmit:m,formState:{isValid:g,errors:p},setError:y}=c,h=k=>m(S=>{let F=null;if(S.metadata&&S.metadata.trim()!=="")try{F=JSON.parse(S.metadata)}catch{y("metadata",{message:"Failed to parse metadata as JSON"});return}s({variables:{input:{promptId:n,name:S.name,description:S.description,metadata:F}},onCompleted:I=>{i({title:"Prompt cloned successfully",action:{text:"View Prompt",onClick:()=>{r(`/prompts/${I.clonePrompt.id}`)}}}),k()},onError:I=>{var M;const L=je(I);(M=L==null?void 0:L[0])!=null&&M.includes("already exists")?y("name",{message:L==null?void 0:L[0]}):y("root",{message:L==null?void 0:L[0]})}})});return e(re,{children:({close:k})=>{var S;return o(ye,{children:[o(fe,{children:[e(he,{children:"Clone Prompt"}),e(ke,{children:e(be,{slot:"close"})})]}),e(f.Suspense,{fallback:e(me,{}),children:e(C,{padding:"size-200",children:o("form",{onSubmit:h(k),children:[o(b,{direction:"column",gap:"size-100",children:[e(H,{control:u,name:"name",rules:{validate:{differsFromOriginalName:F=>F.trim()===a.trim()?"Name must be different from the original prompt name":!0,isValidIdentifier:ao}},render:({field:{onChange:F,onBlur:I,value:L,disabled:M},fieldState:{error:E}})=>o(Fe,{isInvalid:!!(E!=null&&E.message),children:[e(J,{children:"Name"}),e(ge,{name:"name",type:"text",onChange:F,onBlur:I,value:L,disabled:M}),!E&&e(v,{slot:"description",children:"A name for the cloned prompt."}),e(Ae,{children:E==null?void 0:E.message})]})}),e(H,{control:u,name:"description",render:({field:{onChange:F,onBlur:I,value:L,disabled:M},fieldState:{error:E}})=>o(Fe,{isInvalid:!!(E!=null&&E.message),isDisabled:M,value:L,onChange:F,onBlur:I,children:[e(J,{children:"Description"}),e(Ha,{name:"description"}),!E&&e(v,{slot:"description",children:"A description for the cloned prompt."}),e(Ae,{children:E==null?void 0:E.message})]})}),e(H,{control:u,name:"metadata",rules:{validate:F=>!F||F.trim()===""||ma(F)?!0:"metadata must be a valid JSON object"},render:({field:{onChange:F,onBlur:I,value:L},fieldState:{error:M}})=>e(ds,{label:"Metadata",errorMessage:M==null?void 0:M.message,description:"A JSON object containing metadata for the prompt",children:e(En,{value:L,onChange:F,onBlur:I})})})]}),(p==null?void 0:p.root)&&e(v,{color:"danger",children:(S=p==null?void 0:p.root)==null?void 0:S.message}),o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{slot:"close",variant:"default",isDisabled:d,children:"Cancel"}),e(R,{type:"submit",variant:"primary",isDisabled:!g,isPending:d,children:"Clone"})]})]})})})]})}})},mK=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function n5(){const n=no(),a=T.usePreloadedQuery(ir,n.queryRef),l=Me(),{pathname:t}=Ft();let i="prompt";t.includes("versions")?i="versions":t.includes("config")&&(i="config");const r=T.useFragment(Dg,a.prompt);return o("main",{css:mK,children:[e(Vi,{title:r.name,subTitle:r.sourcePrompt&&o(v,{color:"text-700",children:["cloned from"," ",e(Dn,{to:`/prompts/${r.sourcePrompt.id}`,children:r.sourcePrompt.name})]}),extra:o(b,{direction:"row",gap:"size-100",justifyContent:"end",children:[o(se,{children:[e(R,{size:"M",leadingVisual:e(x,{svg:e(qd,{})}),children:"Clone"}),e(oe,{children:e(ae,{size:"M",children:e(uK,{promptId:r.id,promptName:r.name,promptDescription:r.description??void 0,promptMetadata:r.metadata??void 0})})})]}),e(qn,{variant:"primary",leadingVisual:e(x,{svg:e(Qa,{})}),to:"playground",size:"M","aria-label":"Open this Prompt in Playground",children:"Playground"})]})}),o(jn,{defaultSelectedKey:i,onSelectionChange:s=>{let d;s==="versions"?d=`/prompts/${r.id}/versions`:s==="config"?d=`/prompts/${r.id}/config`:d=`/prompts/${r.id}`,l(d)},children:[o(On,{children:[e(ve,{id:"prompt",children:"Prompt"}),o(ve,{id:"versions",children:["Versions ",e(La,{children:r.promptVersions.edges.length})]}),e(ve,{id:"config",children:"Config"})]}),e(Re,{id:"prompt",children:e(Ue,{})}),e(Re,{id:"versions",children:e(Ue,{})}),e(Re,{id:"config",children:e(Ue,{})})]})]})}const Ag=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"modelsInput"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"modelsInput"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",selections:t},params:{cacheID:"530366c9a8cc3b47d685ca0600a39bb5",id:null,metadata:{},name:"fetchPlaygroundPromptSupportedInvocationParametersQuery",operationKind:"query",text:`query fetchPlaygroundPromptSupportedInvocationParametersQuery(
  $modelsInput: ModelsInput!
) {
  modelInvocationParameters(input: $modelsInput) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}})();Ag.hash="1138fb98386e86196eaa52c12a6bb27c";const Eg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"},{defaultValue:null,kind:"LocalArgument",name:"tagName"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},s=[{kind:"Variable",name:"tagName",variableName:"tagName"},{kind:"Variable",name:"versionId",variableName:"promptVersionId"}],d={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null},y=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],h={alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:y,storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null},F={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[k,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[k,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[S,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[S,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null}],storageKey:null},I={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:y,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r,{alias:null,args:s,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l,r,d,c,u,m,g,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,p],storageKey:null},h,F,I],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"fetchPlaygroundPromptQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[k,l,{kind:"InlineFragment",selections:[t,i,r,{alias:null,args:s,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[l,r,d,c,u,m,g,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,p,l],storageKey:null},h,F,I],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}]},params:{cacheID:"f8e02f8171c4f5fddbbe75291fd54510",id:null,metadata:{},name:"fetchPlaygroundPromptQuery",operationKind:"query",text:`query fetchPlaygroundPromptQuery(
  $promptId: ID!
  $promptVersionId: ID
  $tagName: Identifier
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      id
      name
      createdAt
      description
      version(versionId: $promptVersionId, tagName: $tagName) {
        id
        description
        modelName
        modelProvider
        invocationParameters
        templateType
        templateFormat
        tags {
          name
          promptVersionId
          id
        }
        responseFormat {
          definition
        }
        template {
          __typename
          ... on PromptChatTemplate {
            messages {
              role
              content {
                __typename
                ... on TextContentPart {
                  text {
                    text
                  }
                }
                ... on ToolCallContentPart {
                  toolCall {
                    toolCallId
                    toolCall {
                      name
                      arguments
                    }
                  }
                }
                ... on ToolResultContentPart {
                  toolResult {
                    toolCallId
                    result
                  }
                }
              }
            }
          }
        }
        tools {
          definition
        }
      }
    }
    id
  }
}
`}}})();Eg.hash="ea99afe1393df1f3dfd4ef97f8de2efa";const gK=n=>{switch(n){case"user":return"USER";case"ai":return"AI";case"system":return"SYSTEM";case"tool":return"TOOL";default:return"USER"}},pK=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>(i.invocationName&&(t[i.invocationName]=i),t),{}):{};return Object.entries(n).map(([t,i])=>{const r=l[t];return!r||!r.invocationInputField?{invocationName:t,valueJson:i}:{invocationName:t,canonicalName:r.canonicalName,[Tt(r.invocationInputField)]:i}})},yK=({promptId:n,promptName:a,promptVersion:l,promptVersionTag:t,supportedInvocationParameters:i})=>{var u,m;const r={...Fu(),prompt:{id:n,name:a,version:l.id,tag:t}},s=l.modelName,d=l.modelProvider,c=Ei({toolChoice:(u=l.invocationParameters)==null?void 0:u.tool_choice,targetProvider:d})??void 0;return{...r,model:{...r.model,modelName:s,provider:d,supportedInvocationParameters:i||[],invocationParameters:pK({...l.invocationParameters,...(m=l.responseFormat)!=null&&m.definition?{response_format:l.responseFormat.definition}:{}},i||[])},template:{__type:"chat",messages:"messages"in l.template?l.template.messages.map(g=>{const p=g.content.map(ar).filter(Boolean).map(F=>F.text.text).join(""),y=g.content.filter(Xs).filter(Boolean),k=g.content.filter(Ys).filter(Boolean).at(0),S=bl(g.role);return S==="tool"&&k?{id:pa(),role:bl(g.role),content:typeof k.toolResult.result=="string"?k.toolResult.result:Ra(k.toolResult.result,null,2).json||"",toolCallId:k.toolResult.toolCallId}:S==="ai"&&y.length>0?{id:pa(),role:bl(g.role),toolCalls:y.map(F=>au(F,d))}:{id:pa(),role:bl(g.role),content:p}}):[]},tools:l.tools.map(g=>({id:rt(),definition:g.definition})),toolChoice:c}},fK=(n,a)=>{const l=a.length>0?a.reduce((t,i)=>((i.canonicalName||i.invocationName)&&(t[i.canonicalName||i.invocationName]=i),t),{}):{};return n.reduce((t,i)=>{const r=l[i.canonicalName||i.invocationName];if(r)t[i.invocationName]=i[Tt(r.invocationInputField)];else{const s=i.valueString??i.valueInt??i.valueFloat??i.valueBool??i.valueBoolean??i.valueJson??i.valueStringList??null;s!==null&&(t[i.invocationName]=s)}return t},{})},hK=[{invocationName:dt,canonicalName:nl},{invocationName:Wn,canonicalName:Gn}],kK=n=>{if(n.template.__type==="text_completion")return console.warn("Instance to prompt version conversion not supported for text completion"),null;const a=n.template.messages.map(i=>{var c;let r=[i.content?pg(i.content):null];const s=((c=i.toolCalls)==null?void 0:c.map(yg))||[],d=i.toolCallId?[fg(i.toolCallId,i.content)]:[];return(s.length>0||d.length>0)&&(r=[]),{content:[...r,...s,...d].filter(u=>u!==null),role:gK(i.role)}}),l=fu(n.model.invocationParameters);return{modelName:n.model.modelName||Wc,modelProvider:n.model.provider,template:{messages:a},tools:n.tools.map(i=>({definition:i.definition})),responseFormat:l.filter(i=>i.canonicalName===Gn||i.invocationName===Wn).map(i=>({definition:i.valueJson})).at(0)||void 0,invocationParameters:fK(bu(l.filter(i=>!hK.some(r=>Oa(r,i))).concat(n.toolChoice?[{invocationName:dt,valueJson:n.toolChoice,canonicalName:nl}]:[]),n.model.provider,n.model.modelName),n.model.supportedInvocationParameters)}},bK=Eg,SK=Ag,vK=async({modelName:n,providerKey:a})=>{const l=await T.fetchQuery(ze,SK,{modelsInput:{modelName:n,providerKey:a}}).toPromise();return l==null?void 0:l.modelInvocationParameters},FK=async({promptId:n,promptVersionId:a,tagName:l})=>T.fetchQuery(ze,bK,{promptId:n,promptVersionId:a,tagName:l}).toPromise(),CK=n=>n?n==null?void 0:n.version:null,wg=async({promptId:n,promptVersionId:a,tagName:l})=>{var r;if(!n)return null;const t=await FK({promptId:n,promptVersionId:a,tagName:l}),i=CK(t==null?void 0:t.prompt);if(i&&i.templateType==="CHAT"){const s=await vK({modelName:i.modelName,providerKey:i.modelProvider}),d=(r=t==null?void 0:t.prompt)==null?void 0:r.name;if(!d)throw new Error("Prompt name is required");return{instance:yK({promptId:n,promptName:d,promptVersion:i,promptVersionTag:l||null,supportedInvocationParameters:s}),promptVersion:i}}return null},a5=async({params:n})=>{const{promptId:a,versionId:l}=n;if(!a)throw new Error("Prompt ID is required");const t=await wg({promptId:a,promptVersionId:l});if(!t)throw new Error("Prompt not found");return{instanceWithPrompt:t.instance,templateFormat:t.promptVersion.templateFormat,requestedVersion:l}},Mg=(function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundQuery",selections:n},params:{cacheID:"f19ebe151a3a9794fa2566c66751d259",id:null,metadata:{},name:"PlaygroundQuery",operationKind:"query",text:`query PlaygroundQuery {
  modelProviders {
    name
    dependenciesInstalled
    dependencies
  }
}
`}}})();Mg.hash="9802d9d44657ca300abc1be4d0938560";const lo=f.createContext(null);function KK({children:n,...a}){const[l]=f.useState(()=>Uv(a));return e(lo.Provider,{value:l,children:n})}function U(n,a){const l=f.useContext(lo);if(!l)throw new Error("Missing PlaygroundContext.Provider in the tree");return Jt(l,n,a)}function Pt(){const n=f.useContext(lo);if(!n)throw new Error("Missing PlaygroundContext.Provider in the tree");return n}const Rg=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},a={defaultValue:null,kind:"LocalArgument",name:"exampleId"},l=[{kind:"Variable",name:"id",variableName:"exampleId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},s={alias:null,args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"}],concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},i,r],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},c={alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"datasetSplits",plural:!0,selections:[t,d,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},m={alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,u,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p=[{kind:"Literal",name:"first",value:100}],y={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,u,{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,s,c,m],type:"DatasetExample",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ExampleDetailsDialogQuery",selections:[{alias:"example",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,t,{kind:"InlineFragment",selections:[s,c,m,{alias:null,args:p,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},i,y,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[t,d,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},y],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[g,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experimentRuns(first:100)"},{alias:null,args:p,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"01b5d9b615ac87b02a8166174a74de39",id:null,metadata:{},name:"ExampleDetailsDialogQuery",operationKind:"query",text:`query ExampleDetailsDialogQuery(
  $exampleId: ID!
  $datasetVersionId: ID
) {
  example: node(id: $exampleId) {
    __typename
    ... on DatasetExample {
      id
      revision(datasetVersionId: $datasetVersionId) {
        input
        output
        metadata
      }
      datasetSplits {
        id
        name
        color
      }
      span {
        id
        trace {
          id
          traceId
          project {
            id
          }
        }
      }
    }
    ...ExampleExperimentRunsTableFragment
    id
  }
}

fragment ExampleExperimentRunsTableFragment on DatasetExample {
  experimentRuns(first: 100) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              metadata
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Rg.hash="b25d8729689f6dada78cb41d032ca69c";const aa="selectedSpanNodeId",Vg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"SetDatasetExampleSplitsMutationPayload",kind:"LinkedField",name:"setDatasetExampleSplits",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"datasetSplits",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExamplesSplitMenuSetDatasetExampleSplitsMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExamplesSplitMenuSetDatasetExampleSplitsMutation",selections:l},params:{cacheID:"1e889bb8ef7a5895e99805253ee885bd",id:null,metadata:{},name:"ExamplesSplitMenuSetDatasetExampleSplitsMutation",operationKind:"mutation",text:`mutation ExamplesSplitMenuSetDatasetExampleSplitsMutation(
  $input: SetDatasetExampleSplitsInput!
) {
  setDatasetExampleSplits(input: $input) {
    example {
      id
      datasetSplits {
        id
        name
        color
      }
    }
  }
}
`}}})();Vg.hash="dcb82815c764b4e4f0636a7cfd8c7761";const Ng=(function(){var n=[{alias:null,args:null,concreteType:"DatasetSplitConnection",kind:"LinkedField",name:"datasetSplits",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetSplitEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"split",args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExamplesSplitMenuQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExamplesSplitMenuQuery",selections:n},params:{cacheID:"528039e9625c395b9721acbe60ff7a24",id:null,metadata:{},name:"ExamplesSplitMenuQuery",operationKind:"query",text:`query ExamplesSplitMenuQuery {
  datasetSplits {
    edges {
      split: node {
        id
        name
        color
      }
    }
  }
}
`}}})();Ng.hash="8154a68a8e77401911b3171986fc1a56";const kr=n=>n.length>0?"apply":"filter",zg=({onSelectionChange:n,onExampleSelectionChange:a,selectedSplitIds:l,selectedExampleIds:t,examplesCache:i,size:r})=>{const[s,d]=f.useState(()=>kr(t)),[c,u]=f.useState(!1),m=f.useRef(!1);f.useEffect(()=>{d(kr(t))},[t]);const g=f.useCallback(h=>{t.length>0&&a([]),n(h)},[n,a,t]),p=f.useMemo(()=>t.map(h=>i[h]).filter(Boolean),[t,i]),y=f.useCallback(()=>{m.current=!0},[]);return o(la,{isOpen:c,onOpenChange:h=>{if(!h&&m.current){m.current=!1,u(!0);return}m.current=!1,u(h),h||d(kr(t))},children:[o(R,{leadingVisual:e(x,{svg:e(Ql,{})}),size:r,children:["Splits",l.length>0?` (${l.length})`:""]}),e(wr,{children:o(f.Suspense,{fallback:e(me,{}),children:[(s==="filter"||s==="apply")&&e(TK,{selectedSplitIds:l,onSelectionChange:g,selectedExampleIds:t,onExampleSelectionChange:a,selectedPartialExamples:p,setMode:d,onRequestKeepMenuOpen:y}),s==="create"&&e(xK,{setMode:d,selectedExampleIds:t})]})})]})},TK=({selectedSplitIds:n,selectedExampleIds:a,onSelectionChange:l,selectedPartialExamples:t,setMode:i,onRequestKeepMenuOpen:r})=>{const{contains:s}=Zt({sensitivity:"base"}),d=T.useLazyLoadQuery(Ng,{},{fetchPolicy:"store-and-network"}),[c]=T.useMutation(Vg),u=f.useCallback(g=>{c({variables:{input:{exampleId:g.exampleId,datasetSplitIds:g.splitIds}}})},[c]),m=f.useMemo(()=>d.datasetSplits.edges.map(g=>g.split),[d]);return o(Fl,{filter:s,children:[o(zt,{children:[e(Jd,{trailingContent:e(fn,{size:"S",onPress:()=>{i("create")},children:e(x,{svg:e(Mn,{})})}),children:a.length>0?a.length===1?"Apply splits to example":"Apply splits to selected examples":"Filter examples by splits"}),e(st,{"aria-label":"Search",autoFocus:!0,children:e(ge,{placeholder:"Search splits"})})]}),a.length===0?e(PK,{selectedSplitIds:n,onSelectionChange:l,splits:m}):e(IK,{onSelectionChange:u,splits:m,selectedPartialExamples:t,onRequestKeepMenuOpen:r})]})},PK=({selectedSplitIds:n,onSelectionChange:a,splits:l})=>e($n,{items:l,selectionMode:"multiple",renderEmptyState:()=>"No splits found",selectedKeys:n,onSelectionChange:t=>{a(t==="all"?l.map(i=>i.id):Array.from(t))},children:({id:t,name:i,color:r})=>e(Oe,{id:t,textValue:i,children:e(nn,{color:r,children:i})})}),IK=({onSelectionChange:n,splits:a,selectedPartialExamples:l,onRequestKeepMenuOpen:t})=>{const i=f.useMemo(()=>a.reduce((s,d)=>(s[d.id]="unchecked",l.some(c=>c.datasetSplits.some(u=>u.id===d.id))&&(s[d.id]="indeterminate"),l.every(c=>c.datasetSplits.some(u=>u.id===d.id))&&(s[d.id]="checked"),s),{}),[a,l]),r=f.useCallback(s=>{t();for(const d of l){const c=d.datasetSplits.map(m=>m.id);let u;i[s]==="checked"?u=c.filter(m=>m!==s):u=c.includes(s)?c:[...c,s],n({exampleId:d.id,splitIds:u})}},[t,n,l,i]);return e($n,{items:a,renderEmptyState:()=>"No splits found",selectionMode:"none",dependencies:[i],onAction:s=>r(s),children:({id:s,name:d,color:c})=>e(Oe,{id:s,textValue:d,children:o(b,{alignItems:"center",gap:"size-200",children:[e(ut,{excludeFromTabOrder:!0,isSelected:i[s]==="checked",isIndeterminate:i[s]==="indeterminate"}),e(nn,{color:c,children:d})]})})})},xK=({setMode:n,selectedExampleIds:a})=>{const l=f.useCallback(()=>{a.length>0?n("apply"):n("filter")},[n,a]),{onSubmit:t,isCreatingDatasetSplit:i}=c0({exampleIds:a,onCompleted:l});return o(te,{children:[e(zt,{children:o(Jd,{leadingContent:e(fn,{onPress:()=>n("filter"),size:"S",children:e(x,{svg:e(Zd,{})})}),children:["Create Split",a.length>0?" for "+a.length+(a.length===1?" example":" examples"):""]})}),e(u0,{onSubmit:t,isSubmitting:i})]})},$g=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"patchDatasetExamples",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"EditExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"EditExampleDialogMutation",selections:a},params:{cacheID:"7217082d3d3796ecb60481d17133c351",id:null,metadata:{},name:"EditExampleDialogMutation",operationKind:"mutation",text:`mutation EditExampleDialogMutation(
  $input: PatchDatasetExamplesInput!
) {
  patchDatasetExamples(input: $input) {
    __typename
  }
}
`}}})();$g.hash="a5e0e601ed24ffaa37a99ba358f960d3";const br={backgroundColor:"light",borderColor:"light",collapsible:!0};function LK(n){const{exampleId:a,onCompleted:l}=n,[t,i]=f.useState(null),[r,s]=T.useMutation($g),{control:d,setError:c,handleSubmit:u,formState:{isValid:m}}=sn({defaultValues:n.currentRevision}),g=f.useCallback((p,y)=>{if(i(null),!ma(p==null?void 0:p.input))return c("input",{message:"Input must be a valid JSON object"});if(!ma(p==null?void 0:p.output))return c("output",{message:"Output must be a valid JSON object"});if(!ma(p==null?void 0:p.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{patches:[{exampleId:a,input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],versionDescription:p.description}},onCompleted:()=>{l(),y()},onError:h=>{i(h.message)}})},[r,a,c,l]);return e(re,{children:({close:p})=>o(ye,{children:[o(fe,{children:[o(he,{children:["Edit Example: ",a]}),o(ke,{children:[e(R,{variant:"primary",size:"S",isDisabled:!m||s,leadingVisual:e(x,{svg:s?e(ta,{}):e(us,{})}),onPress:()=>u(y=>g(y,p))(),children:"Save Changes"}),e(be,{})]})]}),e("div",{css:K`
              overflow-y: auto;
              padding: var(--ac-global-dimension-size-400);
              /* Make widths configurable */
              .dataset-picker {
                width: 100%;
                .ac-dropdown--picker,
                .ac-dropdown-button {
                  width: 100%;
                }
              }
            `,children:e(b,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[t?e(Ee,{variant:"danger",children:t}):null,e(H,{control:d,name:"input",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...br,children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"output",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...br,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"metadata",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...br,children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"description",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(Fe,{value:k,onChange:y,onBlur:h,isInvalid:S,children:[e(J,{children:"Revision Description"}),e(Ha,{}),F?e(Ae,{children:F==null?void 0:F.message}):e(v,{slot:"description",children:"A description of the changes made in this revision. Will be displayed in the version history."})]})})]})})})})]})})}function DK(n){const{onCompleted:a,...l}=n;return o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Xl,{})}),children:"Edit Example"}),e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(LK,{...l,onCompleted:()=>{a()}})})})]})}const Og=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExampleExperimentRunsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleExperimentRunsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"experimentRuns",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},r,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExampleExperimentRunsTable_experimentRuns",kind:"LinkedHandle",name:"experimentRuns"}],type:"DatasetExample",abstractKey:null}],storageKey:null}]},params:{cacheID:"fb9f9bd0ac0359a920eb76d9555e58dd",id:null,metadata:{},name:"ExampleExperimentRunsTableQuery",operationKind:"query",text:`query ExampleExperimentRunsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExampleExperimentRunsTableFragment_2HEEH6
    id
  }
}

fragment ExampleExperimentRunsTableFragment_2HEEH6 on DatasetExample {
  experimentRuns(first: $first, after: $after) {
    edges {
      run: node {
        id
        startTime
        endTime
        error
        output
        trace {
          id
          traceId
          projectId
        }
        annotations {
          edges {
            annotation: node {
              id
              name
              label
              score
              explanation
              metadata
              annotatorKind
              trace {
                id
                traceId
                projectId
              }
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Og.hash="5bb250cda11776bbac63021b8284fbca";const jg=(function(){var n=["experimentRuns"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Og,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExampleExperimentRunsTableFragment",selections:[{alias:"experimentRuns",args:null,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExampleExperimentRunsTable_experimentRuns_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},l,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"DatasetExample",abstractKey:null}})();jg.hash="5bb250cda11776bbac63021b8284fbca";const _K=100;function AK(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:"No experiments have been run for this example."})})})}const EK=K`
  display: flex;
  flex-direction: row;
  align-items: center;
  color: var(--ac-global-color-primary);
  gap: var(--ac-global-dimension-size-50);
`;function wK({example:n}){"use no memo";const a=f.useRef(null),l=Me(),{data:t,loadNext:i,hasNext:r,isLoadingNext:s}=T.usePaginationFragment(jg,n),d=f.useMemo(()=>t.experimentRuns.edges.map(y=>{let h=null;return y.run.startTime&&y.run.endTime&&(h=new Date(y.run.endTime).getTime()-new Date(y.run.startTime).getTime()),{...y.run,output:JSON.stringify(y.run.output),latencyMs:h}}),[t]),u=Qe({columns:[{header:"start time",accessorKey:"startTime",cell:tn},{header:"output",accessorKey:"output",cell:y=>{var k;const h=(k=y.row.original)==null?void 0:k.error;return h!==null?e(v,{color:"danger",children:h}):e(In,{...y})}},{header:"latency",accessorKey:"latencyMs",cell:({getValue:y})=>{const h=y();return h===null||typeof h!="number"?"--":e(Rn,{latencyMs:h})}},{header:"evaluations",accessorKey:"annotations",cell:({row:y})=>e(b,{direction:"row",gap:"size-50",wrap:"wrap",children:y.original.annotations.edges.map((h,k)=>{const S=h.annotation;return e(m0,{annotation:S,extra:S.trace&&e(C,{paddingTop:"size-100",children:o("div",{css:EK,children:[e(x,{svg:e(Qt,{})}),e("span",{children:"Click to view evaluator trace"})]})}),children:e(es,{annotation:S,onClick:()=>{S.trace&&l(`/projects/${S.trace.projectId}/traces/${S.trace.traceId}`)}},k)},k)})})},{id:"actions",cell:({row:y})=>{const h=y.original.trace;if(h)return e(R,{size:"S",leadingVisual:e(x,{svg:e(yt,{})}),onPress:()=>{l(`/projects/${h.projectId}/traces/${h.traceId}`)},"aria-label":"view trace"})}}],data:d,getCoreRowModel:Be()}),m=u.getRowModel().rows,g=m.length===0,p=f.useCallback(y=>{if(y){const{scrollHeight:h,scrollTop:k,clientHeight:S}=y;h-k-S<300&&!s&&r&&i(_K)}},[r,s,i]);return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:a,onScroll:y=>p(y.target),children:o("table",{css:Al,children:[e("thead",{children:u.getHeaderGroups().map(y=>e("tr",{children:y.headers.map(h=>e("th",{children:e("div",{children:de(h.column.columnDef.header,h.getContext())})},h.id))},y.id))}),g?e(AK,{}):e("tbody",{children:m.map(y=>e("tr",{children:y.getVisibleCells().map(h=>e("td",{children:de(h.column.columnDef.cell,h.getContext())},h.id))},y.id))})]})})}function to({exampleId:n,datasetVersionId:a}){const[l,t]=f.useState(0),i=T.useLazyLoadQuery(Rg,{exampleId:n,datasetVersionId:a},{fetchKey:l,fetchPolicy:"store-and-network"}),r=f.useMemo(()=>{const p=i.example.revision;return{input:JSON.stringify(p==null?void 0:p.input,null,2),output:JSON.stringify(p==null?void 0:p.output,null,2),metadata:JSON.stringify(p==null?void 0:p.metadata,null,2)}},[i]),s=f.useMemo(()=>{const p=i.example.span;return p?{id:p.id,traceId:p.trace.traceId,projectId:p.trace.project.id}:null},[i]),{input:d,output:c,metadata:u}=r,m=f.useMemo(()=>{const p=i.example;return p&&p.id?{[p.id]:{id:p.id,datasetSplits:p.datasetSplits??[]}}:{}},[i]),g=Le();return e(re,{children:o(ye,{children:[o(fe,{children:[o(he,{children:["Example: ",n]}),o(ke,{children:[s?e(qn,{size:"S",to:`/projects/${s.projectId}/traces/${s.traceId}?${aa}=${s.id}`,children:"View Source Span"}):null,e(zg,{onSelectionChange:()=>{},onExampleSelectionChange:()=>{},selectedSplitIds:[],selectedExampleIds:[n],examplesCache:m,size:"S"}),e(DK,{exampleId:n,currentRevision:r,onCompleted:()=>{g({title:"Example updated",message:`Example ${n} has been updated.`}),t(p=>p+1)}}),e(be,{})]})]}),o($a,{direction:"vertical",autoSaveId:"example-panel-group",children:[e(An,{defaultSize:65,children:e("div",{css:K`
                overflow-y: auto;
                height: 100%;
              `,children:e(b,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(ee,{title:"Input",...Sr,extra:e(rn,{text:d}),children:e(jl,{value:d})}),e(ee,{title:"Output",...Sr,extra:e(rn,{text:c}),children:e(jl,{value:c})}),e(ee,{title:"Metadata",...Sr,extra:e(rn,{text:u}),children:e(jl,{value:u})})]})})})})}),e(sl,{css:Bt}),e(An,{defaultSize:35,children:o(b,{direction:"column",height:"100%",children:[e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:e(Te,{level:3,children:"Experiment Runs"})}),e(wK,{example:i.example})]})})]})]})})}const Sr={backgroundColor:"light",borderColor:"light",collapsible:!0};function MK(){const[n,a]=_n(),l=n.get("exampleId"),t=n.get("datasetId");return!l||!t?null:e(se,{isOpen:!0,onOpenChange:i=>{i||a(r=>(r.delete("exampleId"),r))},children:e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(f.Suspense,{fallback:e(me,{}),children:e(to,{exampleId:l})})})})})}const RK=`
The playground is not available until an LLM provider client is installed on the server.
`,VK=n=>`
# Installing one or more of the clients will enable the playground
${Array.from(n.reduce((a,l)=>(l.dependencies.forEach(t=>a.add(t)),a),new Set)).map(a=>`pip install ${a}`).join(`
`)}
`,NK=n=>e(C,{height:"100%",width:"100%",children:o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:[e(Ti,{message:RK}),e(v,{children:"The following clients are supported:"}),e(Gd,{value:VK(n.availableProviders)})]})});function zK(){const n=U(s=>s.streaming),a=U(s=>s.repetitions),l=U(s=>s.setStreaming),t=U(s=>s.setRepetitions),i=Cn(s=>s.setPlaygroundStreamingEnabled),r=U(s=>s.instances.some(d=>d.activeRunId!=null));return o(se,{children:[e(R,{size:"S","aria-label":"Playground Settings",leadingVisual:e(x,{svg:e(Xd,{})}),isDisabled:r}),o(we,{children:[e(_l,{}),e(re,{children:o(C,{padding:"size-200",children:[e(Te,{level:2,weight:"heavy",children:"Settings"}),e(C,{paddingTop:"size-100",paddingBottom:"size-50",overflow:"visible",children:o(b,{direction:"column",gap:"size-200",children:[e(Yd,{defaultValue:1,label:"Repetitions",minValue:1,maxValue:30,value:a,onChange:t,children:e(ec,{})}),e(v,{color:"text-700",size:"XS",children:"Increase the number of repetitions to run each experiment task multiple times."}),e(b,{direction:"row",justifyContent:"start",children:e(Il,{labelPlacement:"start",isSelected:n,onChange:()=>{l(!n),i(!n)},isDisabled:r,children:e(v,{size:"M",children:"Streaming"})})}),e(v,{color:"text-700",size:"XS",children:"Enable streaming to view experiment task output as it is generated in real time."})]})})]})})]})]})}const Qg=(function(){var n=[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,concreteType:"GenerativeProviderCredentialConfig",kind:"LinkedField",name:"credentialRequirements",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"envVarName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isRequired",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"credentialsSet",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PlaygroundCredentialsDropdownQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PlaygroundCredentialsDropdownQuery",selections:n},params:{cacheID:"b2f9b2067f4b46cd6a570aca5156ba48",id:null,metadata:{},name:"PlaygroundCredentialsDropdownQuery",operationKind:"query",text:`query PlaygroundCredentialsDropdownQuery {
  modelProviders {
    key
    credentialRequirements {
      envVarName
      isRequired
    }
    credentialsSet
  }
}
`}}})();Qg.hash="06227c780cfcd0a1d7771fb53fddc803";function $K(){const n=U(i=>Array.from(new Set(i.instances.map(r=>r.model.provider)))),a=U(i=>i.instances.some(r=>r.activeRunId!=null)),[l,t]=f.useState("local");return e("div",{css:K`
        .ac-dropdown-button {
          min-width: 0px;
        }
      `,children:o(se,{children:[e(R,{size:"S",isDisabled:a,leadingVisual:e(x,{svg:e(g0,{})}),children:"API Keys"}),e(we,{style:{width:"500px"},children:e(re,{children:({close:i})=>e(C,{padding:"size-200",children:o(bn,{onSubmit:r=>{r.preventDefault(),i()},children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(Te,{level:2,weight:"heavy",children:"API Keys"}),o(qt,{selectedKeys:[l],size:"S","aria-label":"Credential Source",onSelectionChange:r=>{if(r.size===0)return;const s=r.keys().next().value;(s==="local"||s==="server")&&t(s)},children:[e(ga,{"aria-label":"Local",id:"local",children:"Local"}),e(ga,{"aria-label":"Server",id:"server",children:"Server"})]})]}),l==="local"?e(jK,{providers:n}):e(f.Suspense,{fallback:e(OK,{}),children:e(QK,{providers:n})}),e(C,{paddingTop:"size-100",children:e(b,{direction:"row",gap:"size-100",width:"100%",justifyContent:"end",children:e(tl,{href:"/settings/providers",children:"View all AI provider configurations"})})})]})})})})]})})}function OK(){return o(C,{paddingY:"size-100",children:[e(Ol,{width:"100%",height:20,animation:"wave"}),e(C,{paddingTop:"size-100",children:e(b,{direction:"column",gap:"size-100",children:o(C,{paddingY:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Ol,{width:24,height:24,borderRadius:"circle"}),e(Ol,{width:120,height:20,animation:"wave"})]}),e(C,{paddingTop:"size-100",children:o(b,{direction:"column",gap:"size-50",children:[e(Ol,{width:"80%",height:16,animation:"wave"}),e(Ol,{width:"70%",height:16,animation:"wave"})]})})]})})})]})}function jK({providers:n}){return o(te,{children:[e(C,{paddingY:"size-50",children:e(v,{color:"text-700",size:"XS",children:"Local API keys are stored in your browser and are not shared with other users."})}),e(b,{direction:"column",gap:"size-100",children:n.map(a=>ol[a].length?o(C,{paddingY:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(al,{provider:a}),e(Te,{level:3,weight:"heavy",children:Ia(a)})]}),e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:e(BK,{provider:a})})]},a):null)})]})}function QK({providers:n}){const a=T.useLazyLoadQuery(Qg,{},{fetchPolicy:"network-only"}),l=new Map;return a.modelProviders.forEach(t=>{li(t.key)&&l.set(t.key,t.credentialsSet)}),o(C,{paddingY:"size-100",children:[e(v,{color:"text-700",size:"S",children:"Server-side API keys are configured via environment variables and will be available to all users."}),e(C,{paddingTop:"size-100",children:e(b,{direction:"column",gap:"size-100",children:n.map(t=>{const i=ol[t];if(!i.length)return null;const r=l.get(t);return o(C,{paddingY:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(al,{provider:t}),e(Te,{level:3,weight:"heavy",children:Ia(t)})]}),r?o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(v,{color:"success",size:"S",children:"Configured"}),e(x,{color:"success",svg:e(p0,{})})]}):o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(v,{color:"text-700",size:"S",children:"Not Configured"}),e(x,{svg:e(y0,{})})]})]}),e(C,{paddingTop:"size-100",children:e(b,{direction:"column",gap:"size-50",children:i.map(s=>o(v,{color:"text-600",size:"S",children:[" ",s.envVarName,s.isRequired&&o(v,{color:"text-700",weight:"heavy",children:[" ","(required)"]})]},s.envVarName))})})]},t)})})})]})}function BK({provider:n}){const a=Jl(r=>r.setCredential),l=ol[n],t=Jl(r=>r[n]),i=U(r=>r.instances.some(s=>s.activeRunId!=null));return e(C,{children:l.map(r=>o(Vd,{size:"S",isRequired:r.isRequired,onChange:s=>{a({provider:n,envVarName:r.envVarName,value:s})},value:(t==null?void 0:t[r.envVarName])??"",isDisabled:i,children:[e(J,{children:r.envVarName}),e(Nd,{}),e(v,{slot:"description",children:`Alternatively, you can set the "${r.envVarName}" environment variable on the server.`})]},r.envVarName))})}const ad=30,qK=K`
  display: flex;
  direction: row;
  align-items: center;
  & .dataset-picker-button {
    height: ${ad}px;
    &[data-pressed],
    &:hover {
      // remove the bright hover border effect so that it matches the "clear" button
      // next to the dataset picker
      --button-border-color: var(--ac-global-input-field-border-color);
    }
  }
  & .dataset-clear-button {
    height: ${ad}px;
  }
  & .dataset-picker-button:has(+ .dataset-clear-button) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
  }
  & .dataset-picker-button + .dataset-clear-button {
    border-left: none;
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }
`;function Bg(){const[n,a]=_n(),l=n.get("datasetId"),t=n.getAll("splitId");return o("div",{css:qK,children:[e(f0,{size:"S",placeholder:"Test over a dataset",value:l?{datasetId:l,splitIds:t}:null,onSelectionChange:({datasetId:i,splitIds:r})=>{a(s=>(i?(s.set("datasetId",i),s.delete("splitId"),r.length>0&&r.forEach(d=>{s.append("splitId",d)})):(s.delete("datasetId"),s.delete("splitId")),s))}}),l?e(R,{className:"dataset-clear-button",size:"S",leadingVisual:e(x,{svg:e(mt,{})}),onPress:()=>{a(i=>(i.delete("datasetId"),i.delete("splitId"),i))}}):null]})}const qg=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},l={defaultValue:20,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"splitIds"},r=[{kind:"Variable",name:"id",variableName:"id"}],s=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"splitIds",variableName:"splitIds"}],d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i],kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:s,kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,t],kind:"Operation",name:"PlaygroundDatasetExamplesTableRefetchQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,c,{kind:"InlineFragment",selections:[{alias:null,args:s,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[c,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[d,c],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["datasetVersionId","splitIds"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"d1ad98fc50863a5054c66424fc70d51d",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableRefetchQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableRefetchQuery(
  $after: String = null
  $datasetVersionId: ID
  $first: Int = 20
  $splitIds: [ID!]
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_1eo2vI
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_1eo2vI on Dataset {
  examples(datasetVersionId: $datasetVersionId, splitIds: $splitIds, first: $first, after: $after) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();qg.hash="e6bde949dffba260d3af123877882200";const Ug=(function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:20,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"splitIds"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:qg,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"PlaygroundDatasetExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"splitIds",variableName:"splitIds"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__PlaygroundDatasetExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}})();Ug.hash="e6bde949dffba260d3af123877882200";const Hg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"splitIds"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={kind:"Variable",name:"splitIds",variableName:"splitIds"},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'},r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s=[{kind:"Literal",name:"first",value:20},l];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[l],kind:"FragmentSpread",name:"PlaygroundDatasetExamplesTableFragment"},{kind:"InlineFragment",selections:[i],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,t,{kind:"InlineFragment",selections:[{alias:null,args:s,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[r,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["datasetVersionId","splitIds"],handle:"connection",key:"PlaygroundDatasetExamplesTable_examples",kind:"LinkedHandle",name:"examples"},i],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"0eb9e2d6ec900fd20d2a5f082741dbf9",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableQuery",operationKind:"query",text:`query PlaygroundDatasetExamplesTableQuery(
  $datasetId: ID!
  $splitIds: [ID!]
) {
  dataset: node(id: $datasetId) {
    __typename
    ...PlaygroundDatasetExamplesTableFragment_1Csera
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
          }
        }
      }
    }
    id
  }
}

fragment PlaygroundDatasetExamplesTableFragment_1Csera on Dataset {
  examples(splitIds: $splitIds, first: 20) {
    edges {
      example: node {
        id
        revision {
          input
          output
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Hg.hash="23aeaec8a7e6744ee5bbbf129d3547c2";const Gg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[t],r=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},a,l],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[t,a,l,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"experiment",plural:!1,selections:i,storageKey:null}],type:"ChatCompletionSubscriptionExperiment",abstractKey:null},{kind:"InlineFragment",selections:[a,l,{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"experimentRun",plural:!1,selections:i,storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableSubscription",selections:r,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableSubscription",selections:r},params:{cacheID:"1697126f70ffbd0fe2ee6a7fff62312a",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableSubscription",operationKind:"subscription",text:`subscription PlaygroundDatasetExamplesTableSubscription(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    __typename
    ... on TextChunk {
      content
      datasetExampleId
      repetitionNumber
    }
    ... on ToolCallChunk {
      id
      datasetExampleId
      repetitionNumber
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionExperiment {
      experiment {
        id
      }
    }
    ... on ChatCompletionSubscriptionResult {
      datasetExampleId
      repetitionNumber
      span {
        id
        tokenCountTotal
        costSummary {
          total {
            cost
          }
        }
        latencyMs
        project {
          id
        }
        context {
          traceId
        }
      }
      experimentRun {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      datasetExampleId
      repetitionNumber
      message
    }
  }
}
`}}})();Gg.hash="6d877069d51002d0d4d21aa6d1d134fb";const Wg=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionOverDatasetMutationPayload",kind:"LinkedField",name:"chatCompletionOverDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionOverDatasetMutationExamplePayload",kind:"LinkedField",name:"examples",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"datasetExampleId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentRunId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionRepetition",kind:"LinkedField",name:"repetition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"SpanContext",kind:"LinkedField",name:"context",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundDatasetExamplesTableMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundDatasetExamplesTableMutation",selections:l},params:{cacheID:"bee68a0bafa6707aac3232533776ffe9",id:null,metadata:{},name:"PlaygroundDatasetExamplesTableMutation",operationKind:"mutation",text:`mutation PlaygroundDatasetExamplesTableMutation(
  $input: ChatCompletionOverDatasetInput!
) {
  chatCompletionOverDataset(input: $input) {
    experimentId
    examples {
      datasetExampleId
      experimentRunId
      repetitionNumber
      repetition {
        content
        errorMessage
        span {
          id
          tokenCountTotal
          costSummary {
            total {
              cost
            }
          }
          latencyMs
          project {
            id
          }
          context {
            traceId
          }
        }
        toolCalls {
          id
          function {
            name
            arguments
          }
        }
      }
    }
  }
}
`}}})();Wg.hash="5abf1a4f82966b238d6a6df113603b91";function Ci(n,a,l){const t=typeof a=="number"?a:0,i=typeof l=="number"?l:1;if(t===i&&i===n)return 100;const r=i-t||1;return(n-t)/r*100}const ld="j",td="k",UK=({currentExampleIndex:n,exampleIds:a,onExampleChange:l})=>{const t=n>0,i=n<a.length-1,r=()=>{i&&f.startTransition(()=>{l(n+1)})},s=()=>{t&&f.startTransition(()=>{l(n-1)})};return za(ld,()=>{r()}),za(td,()=>{s()}),o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[o(Se,{delay:100,children:[e(R,{size:"S","aria-label":"Next",isDisabled:!i,onPress:r,leadingVisual:e(x,{svg:e(nc,{})})}),e($e,{offset:4,css:K`
            background-color: var(--ac-global-background-color-dark);
            border-color: var(--ac-global-border-color-dark);
            border-radius: var(--ac-global-rounding-medium);
            padding: var(--ac-global-dimension-static-size-100);
          `,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Next"}),e(Hl,{children:ld})]})})]}),o(Se,{delay:100,children:[e(R,{size:"S","aria-label":"Previous",isDisabled:!t,onPress:s,leadingVisual:e(x,{svg:e(ac,{})})}),e($e,{offset:4,css:K`
            background-color: var(--ac-global-background-color-dark);
            border-color: var(--ac-global-border-color-dark);
            border-radius: var(--ac-global-rounding-medium);
            padding: var(--ac-global-dimension-static-size-100);
          `,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Previous"}),e(Hl,{children:td})]})})]})]})};function io({selectedExampleId:n,selectedExampleIndex:a,datasetId:l,datasetVersionId:t,baseExperimentId:i,compareExperimentIds:r,exampleIds:s,onExampleChange:d,repetitionNumber:c,openTraceDialog:u}){return e(re,{"aria-label":"Example Details",children:o(ye,{children:[o(fe,{children:[o(b,{gap:"size-150",children:[e(UK,{currentExampleIndex:a,exampleIds:s,onExampleChange:d}),e(he,{children:`Example: ${n}`})]}),o(ke,{children:[e(qn,{size:"S",to:`/datasets/${l}/examples/${n}`,children:"View Example"}),e(be,{})]})]}),e(f.Suspense,{children:e(h0,{datasetId:l,datasetExampleId:n,datasetVersionId:t,baseExperimentId:i,compareExperimentIds:r,defaultSelectedRepetitionNumber:c,openTraceDialog:u})})]})})}function ro({repetitionNumber:n,totalRepetitions:a,setRepetitionNumber:l}){const t=f.useMemo(()=>a.toString().length*2+2,[a]);return o(b,{direction:"row",alignItems:"center",children:[o(Se,{children:[e(Zn,{children:o(b,{direction:"row",alignItems:"center",children:[e(x,{svg:e(k0,{})}),e(v,{css:K`
                margin-inline-start: var(--ac-global-dimension-size-100);
                margin-inline-end: var(--ac-global-dimension-size-100);
                width: ${t}ch;
                text-align: center;
              `,children:`${n} / ${a}`})]})}),e($e,{children:`repetition ${n} of ${a}`})]}),e(fn,{size:"S",isDisabled:n===1,onPress:()=>l(i=>i-1),"aria-label":"Previous repetition",children:e(x,{svg:e(Zd,{})})}),e(fn,{size:"S",isDisabled:n===a,onPress:()=>l(i=>i+1),"aria-label":"Next repetition",children:e(x,{svg:e(b0,{})})})]})}const HK=()=>{const n=(a,l)=>({exampleResponsesMap:{},repetitions:1,updateExampleData:({instanceId:t,exampleId:i,repetitionNumber:r,patch:s})=>{const d=l().exampleResponsesMap,c=d[t]??{},u=c[i]??{},m=u[r]??{};a({exampleResponsesMap:{...d,[t]:{...c,[i]:{...u,[r]:{...m,...s}}}}})},appendExampleDataTextChunk:({instanceId:t,exampleId:i,repetitionNumber:r,textChunk:s})=>{var g;const d=l().exampleResponsesMap,c=d[t]??{},u=c[i]??{},m=((g=u[r])==null?void 0:g.content)??"";a({exampleResponsesMap:{...d,[t]:{...c,[i]:{...u,[r]:{content:m+s}}}}})},appendExampleDataToolCallChunk:({instanceId:t,exampleId:i,repetitionNumber:r,toolCallChunk:s})=>{var k,S;const d=l().exampleResponsesMap,c=d[t]??{},u=c[i]??{},m=((k=u[r])==null?void 0:k.toolCalls)??{},{id:g,function:p}=s,y=m[g],h={...y,id:g,function:{name:((S=y==null?void 0:y.function)==null?void 0:S.name)??p.name,arguments:(y==null?void 0:y.function.arguments)!=null?y.function.arguments+p.arguments:p.arguments}};a({exampleResponsesMap:{...d,[t]:{...c,[i]:{...u,[r]:{toolCalls:{...m,[g]:h}}}}}})},setExampleDataForInstance:({instanceId:t,data:i})=>{const r=l().exampleResponsesMap;a({exampleResponsesMap:{...r,[t]:i}})},resetData:()=>{a({exampleResponsesMap:{},repetitions:1})},setRepetitions:t=>{a({repetitions:t})}});return Wt()(n)},Jg=Da.createContext(null);function GK({children:n}){const[a]=f.useState(()=>HK());return e(Jg.Provider,{value:a,children:n})}function hl(n,a){const l=Da.useContext(Jg);if(!l)throw new Error("Missing PlaygroundDatasetExamplesTableContext.Provider in the tree");return Jt(l,n,a)}function so({children:n}){return e(C,{padding:"size-200",children:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(x,{svg:e(lc,{}),color:"danger"}),e(v,{color:"danger",children:n})]})})}const Zg=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"traceId"},l=[{kind:"Variable",name:"id",variableName:"id"}],t=[{kind:"Variable",name:"traceId",variableName:"traceId"}],i={alias:null,args:null,kind:"ScalarField",name:"projectSessionId",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},u={alias:"rootSpans",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"orphanSpanAsRootSpan",value:!0},{kind:"Literal",name:"rootSpansOnly",value:!0}],concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[r,s,d,c],storageKey:null}],storageKey:null}],storageKey:"spans(first:1,orphanSpanAsRootSpan:true,rootSpansOnly:true)"},m={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},g=[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],p={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:g,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:g,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:g,storageKey:null}],storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h=[{kind:"Literal",name:"first",value:1e3}],k={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{args:null,kind:"FragmentSpread",name:"ConnectedTraceTree"},u,m,p],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"TraceDetailsQuery",selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[y,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:null,args:h,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[s,d,k,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},c,m,{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"labels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"labelCount",storageKey:null},{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],storageKey:null},k,{alias:null,args:null,kind:"ScalarField",name:"scoreCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[y,s],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"spans(first:1000)"},{alias:null,args:h,filters:null,handle:"connection",key:"ConnectedTraceTree_spans",kind:"LinkedHandle",name:"spans"},s,u,m,p],storageKey:null}],type:"Project",abstractKey:null},s],storageKey:null}]},params:{cacheID:"8061bdefc692c0ac4ce8a3f3c62c89aa",id:null,metadata:{},name:"TraceDetailsQuery",operationKind:"query",text:`query TraceDetailsQuery(
  $traceId: ID!
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      trace(traceId: $traceId) {
        projectSessionId
        ...ConnectedTraceTree
        rootSpans: spans(first: 1, rootSpansOnly: true, orphanSpanAsRootSpan: true) {
          edges {
            span: node {
              statusCode
              id
              spanId
              parentId
            }
          }
        }
        latencyMs
        costSummary {
          prompt {
            cost
          }
          completion {
            cost
          }
          total {
            cost
          }
        }
        id
      }
    }
    id
  }
}

fragment ConnectedTraceTree on Trace {
  numSpans
  spans(first: 1000) {
    edges {
      span: node {
        id
        spanId
        name
        spanKind
        statusCode
        startTime
        endTime
        parentId
        latencyMs
        tokenCountTotal
        spanAnnotationSummaries {
          labels
          count
          labelCount
          labelFractions {
            fraction
            label
          }
          name
          scoreCount
          meanScore
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Zg.hash="b7f5952cd2183ab72fa53058e5c3dd98";const Xg=(function(){var n=[{defaultValue:1e3,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i=[{kind:"Variable",name:"after",variableName:"cursor"},{kind:"Variable",name:"first",variableName:"count"}],r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ConnectedTraceTreeQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[{kind:"Variable",name:"count",variableName:"count"},{kind:"Variable",name:"cursor",variableName:"cursor"}],kind:"FragmentSpread",name:"ConnectedTraceTree"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ConnectedTraceTreeQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:null,args:i,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"labels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"labelCount",storageKey:null},{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"scoreCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,filters:null,handle:"connection",key:"ConnectedTraceTree_spans",kind:"LinkedHandle",name:"spans"}],type:"Trace",abstractKey:null}],storageKey:null}]},params:{cacheID:"60d46420089ceb39426b8114eb3e8d5e",id:null,metadata:{},name:"ConnectedTraceTreeQuery",operationKind:"query",text:`query ConnectedTraceTreeQuery(
  $count: Int = 1000
  $cursor: String = null
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ConnectedTraceTree_1G22uz
    id
  }
}

fragment ConnectedTraceTree_1G22uz on Trace {
  numSpans
  spans(first: $count, after: $cursor) {
    edges {
      span: node {
        id
        spanId
        name
        spanKind
        statusCode
        startTime
        endTime
        parentId
        latencyMs
        tokenCountTotal
        spanAnnotationSummaries {
          labels
          count
          labelCount
          labelFractions {
            fraction
            label
          }
          name
          scoreCount
          meanScore
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Xg.hash="a795a35718b61f5ea864138d6b275046";const Yg=(function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[{defaultValue:1e3,kind:"LocalArgument",name:"count"},{defaultValue:null,kind:"LocalArgument",name:"cursor"}],kind:"Fragment",metadata:{connection:[{count:"count",cursor:"cursor",direction:"forward",path:n}],refetch:{connection:{forward:{count:"count",cursor:"cursor"},backward:null,path:n},fragmentPathInResult:["node"],operation:Xg,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ConnectedTraceTree",selections:[{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:"spans",args:null,concreteType:"SpanConnection",kind:"LinkedField",name:"__ConnectedTraceTree_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"labels",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"labelCount",storageKey:null},{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"scoreCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Trace",abstractKey:null}})();Yg.hash="a795a35718b61f5ea864138d6b275046";const WK=1e3;function JK(n){const{data:a,hasNext:l,loadNext:t}=T.usePaginationFragment(Yg,n.trace),i=f.useMemo(()=>((a==null?void 0:a.spans.edges)||[]).map(c=>c.span),[a]),r=a==null?void 0:a.numSpans,s=i.length;return o(b,{direction:"column",flex:"1 1 auto",height:"100%",children:[l?o(Ee,{variant:"warning",banner:!0,extra:e(R,{size:"S",variant:"primary",onPress:()=>{t(WK)},children:"Load More"}),children:["Viewing ",s," of ",r," spans."]}):null,e(S0,{spans:i,...n})]})}const ep=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},r={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},c={alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"statusMessage",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},k=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}],S={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:k,storageKey:null},F={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:k,storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},L={alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},M={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"documentPosition",storageKey:null},P={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},A={kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"},V={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},j={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},ce={alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[P,_],storageKey:null},W={alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},Pe={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},W],type:"ContinuousAnnotationConfig",abstractKey:null},ne={kind:"InlineFragment",selections:[s],type:"FreeformAnnotationConfig",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,s,d,c,u,m,g,p,y,h,S,F,I,{kind:"RequiredField",field:L,action:"THROW"},M,{alias:null,args:null,concreteType:"DocumentAnnotation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[E,s,P,_,D],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,s],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanHeader_span"},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"},{args:null,kind:"FragmentSpread",name:"SpanAside_span"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanDetailsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,r,s,d,c,u,m,g,p,y,h,S,F,I,L,M,{alias:null,args:null,concreteType:"DocumentAnnotation",kind:"LinkedField",name:"documentEvaluations",plural:!0,selections:[E,s,P,_,D,t],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,s,P,_,D,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,A,{kind:"InlineFragment",selections:[s,V,j],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[ce,t,s,W],type:"CategoricalAnnotationConfig",abstractKey:null},Pe,ne],storageKey:null}],storageKey:null},{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,A,{kind:"InlineFragment",selections:[s,j,V],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[ce],type:"CategoricalAnnotationConfig",abstractKey:null},Pe,ne],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},P],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},s],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"d584ef7b838f7eab0b19837e4a134d93",id:null,metadata:{},name:"SpanDetailsQuery",operationKind:"query",text:`query SpanDetailsQuery(
  $id: ID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      id
      spanId
      trace {
        id
        traceId
      }
      name
      spanKind
      statusCode: propagatedStatusCode
      statusMessage
      startTime
      parentId
      latencyMs
      tokenCountTotal
      endTime
      input {
        value
        mimeType
      }
      output {
        value
        mimeType
      }
      attributes
      events {
        name
        message
        timestamp
      }
      documentRetrievalMetrics {
        evaluationName
        ndcg
        precision
        hit
      }
      documentEvaluations {
        documentPosition
        name
        label
        score
        explanation
        id
      }
      spanAnnotations {
        id
        name
      }
      ...SpanHeader_span
      ...SpanFeedback_annotations
      ...SpanAside_span
    }
    id
  }
}

fragment AnnotationConfigListProjectAnnotationConfigFragment on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on Node {
          __isNode: __typename
          id
        }
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          name
          annotationType
          description
        }
        ... on CategoricalAnnotationConfig {
          values {
            label
            score
          }
        }
        ... on ContinuousAnnotationConfig {
          lowerBound
          upperBound
          optimizationDirection
        }
        ... on FreeformAnnotationConfig {
          name
        }
      }
    }
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanAsideAnnotationList_span on Span {
  project {
    id
    annotationConfigs {
      configs: edges {
        config: node {
          __typename
          ... on Node {
            __isNode: __typename
            id
          }
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            name
          }
        }
      }
    }
  }
  spanAnnotations {
    id
  }
  ...AnnotationSummaryGroup
}

fragment SpanAside_span on Span {
  id
  project {
    id
    ...AnnotationConfigListProjectAnnotationConfigFragment
    annotationConfigs {
      configs: edges {
        config: node {
          __typename
          ... on Node {
            __isNode: __typename
            id
          }
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            name
            description
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            values {
              label
              score
            }
          }
          ... on ContinuousAnnotationConfig {
            lowerBound
            upperBound
            optimizationDirection
          }
          ... on FreeformAnnotationConfig {
            name
          }
        }
      }
    }
  }
  code: statusCode
  startTime
  endTime
  tokenCountTotal
  ...TraceHeaderRootSpanAnnotationsFragment
  ...SpanAsideAnnotationList_span
  ...AnnotationSummaryGroup
}

fragment SpanFeedback_annotations on Span {
  id
  spanAnnotations {
    id
    name
    label
    score
    explanation
    metadata
    annotatorKind
    identifier
    source
    createdAt
    updatedAt
    user {
      id
      username
      profilePictureUrl
    }
  }
}

fragment SpanHeader_span on Span {
  id
  name
  spanKind
  code: statusCode
  latencyMs
  startTime
  tokenCountTotal
  costSummary {
    total {
      cost
    }
  }
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}
`}}})();ep.hash="e2fbe3f1daee23ca2ad099cc7c5f0d90";function id(n){return Array.isArray(n)&&n.every(a=>typeof a=="object"&&Je.message in a&&ZK(a[Je.message]))}function ZK(n){return typeof n=="object"&&n!==null}const vr=K`
  display: flex;
  align-items: center;
  .ac-text {
    display: inline-block;
    max-width: 9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`;function ya(n){const{name:a,metric:l,k:t,score:i}=n,r=typeof t=="number"?`${l}@${t}`:l,s=f.useMemo(()=>l==="hit"?i?"true":"false":typeof i=="number"&&Bl(i)||"--",[i,l]);return o(Se,{delay:500,children:[e(Zn,{children:e("div",{css:v0,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:"var(--ac-global-color-seafoam-1000)"}),a?e("div",{css:vr,children:e(v,{weight:"heavy",size:"XS",color:"inherit",children:a})}):null,e("div",{css:vr,children:e(v,{size:"XS",color:"inherit",children:r})}),e("div",{css:vr,children:e(v,{size:"XS",children:s})})]})})}),e($e,{offset:3,placement:"bottom",children:o(b,{direction:"row",gap:"size-100",children:[o(v,{weight:"heavy",color:"inherit",children:[a," ",r]}),e(v,{color:"inherit",children:s})]})})]})}const np={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanHeader_span",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};np.hash="2ba518744a1e825cf02818bfbf16b7a5";function XK(n){var i,r;const{fullTimeFormatter:a}=kn(),l=T.useFragment(np,n.span),t=f.useMemo(()=>new Date(l.startTime),[l.startTime]);return e(b,{direction:"row",gap:"size-100",width:"100%",height:"100%",alignItems:"center",children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(ms,{spanKind:l.spanKind}),e(v,{size:"L",children:l.name}),e(Ni,{statusCode:l.code,css:K`
              font-size: var(--ac-global-font-size-m);
            `})]}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[typeof l.latencyMs=="number"?e(Rn,{latencyMs:l.latencyMs,size:"S"}):null,o(v,{color:"text-500",size:"S",children:["at ",a(t)]}),l.tokenCountTotal?e(zi,{tokenCountTotal:l.tokenCountTotal,nodeId:l.id,size:"S"}):null,(r=(i=l.costSummary)==null?void 0:i.total)!=null&&r.cost?e($i,{totalCost:l.costSummary.total.cost,spanNodeId:l.id,size:"S"}):null]})]})})}function YK(n){const{spanId:a,traceId:l}=n,t=Le();return o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:e(re,{children:({close:i})=>o(Bn,{style:{minHeight:"auto"},onAction:r=>{switch(r){case"COPY_SPAN_ID":{zo(a),t({title:"Span ID Copied",message:`The Span ID ${a} has been copied to your clipboard`});break}case"COPY_TRACE_ID":{zo(l),t({title:"Trace ID Copied",message:`The Trace ID ${l} has been copied to your clipboard`});break}default:Ne()}i()},children:[e(rl,{id:"COPY_SPAN_ID",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Mr,{})}),e(v,{children:"Copy Span ID"})]})}),e(rl,{id:"COPY_TRACE_ID",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Mr,{})}),e(v,{children:"Copy Trace ID"})]})})]})})})]})}const ap=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a=[n];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanAsideAnnotationList_span",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[n,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:a,type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:a,storageKey:null},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null}})();ap.hash="8db090103425204eda8bf8e16580f622";const lp=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanAside_span",selections:[n,{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[n,{args:null,kind:"FragmentSpread",name:"AnnotationConfigListProjectAnnotationConfigFragment"},{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:"configs",args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"config",args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n],type:"Node",abstractKey:"__isNode"},{kind:"InlineFragment",selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"lowerBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"upperBound",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null}],type:"ContinuousAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[a],type:"FreeformAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:"code",args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"},{args:null,kind:"FragmentSpread",name:"SpanAsideAnnotationList_span"},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null}})();lp.hash="eddd0b1c2288899c1d97948a29207944";const tp=f.createContext(null);function rr(){const n=f.useContext(tp);if(n===null)throw new Error("useSpanFilterCondition must be used within a SpanFilterConditionProvider");return n}function oo(n){const[a,l]=f.useState(""),t=f.useCallback(r=>{f.startTransition(()=>{l(r)})},[]),i=f.useCallback(r=>{f.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(tp.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}function l5(n){const{appendFilterCondition:a}=rr(),{annotation:l,className:t}=n,{name:i,label:r,score:s}=l,d=f.useMemo(()=>{const c=[];return typeof s=="number"?(c.push({filterName:"greater than",filterCondition:`annotations['${i}'].score > ${s}`}),c.push({filterName:"less than",filterCondition:`annotations['${i}'].score < ${s}`}),c.push({filterName:"equals",filterCondition:`annotations['${i}'].score == ${s}`})):r!=null&&(c.push({filterName:"match",filterCondition:`annotations['${i}'].label == "${r}"`}),c.push({filterName:"exclude",filterCondition:`annotations['${i}'].label != "${r}"`})),c},[i,r,s]);return d.length===0?null:e("ul",{className:t,css:K`
        display: flex;
        height: 100%;
        flex-direction: row;
        gap: var(--ac-global-dimension-size-100);

        flex-wrap: wrap;
      `,children:d.map(c=>e("li",{children:e(nn,{onPress:()=>{a(c.filterCondition)},children:c.filterName})},c.filterName))})}const ip=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"AnnotationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,{kind:"InlineFragment",selections:[d],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[d,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},c,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[c,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"c867c2c9c74b0c472ca6763b8fc50752",id:null,metadata:{},name:"AnnotationSummaryValueQuery",operationKind:"query",text:`query AnnotationSummaryValueQuery(
  $annotationName: String!
  $timeRange: TimeRange!
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          annotationType
        }
        ... on CategoricalAnnotationConfig {
          annotationType
          id
          optimizationDirection
          name
          values {
            label
            score
          }
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    name
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}})();ip.hash="5d114f6c3ea85467bd6c915907c07d87";const rp=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"annotationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:ip,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"AnnotationSummaryValueFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},l,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[l,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},a],type:"Project",abstractKey:null}})();rp.hash="5d114f6c3ea85467bd6c915907c07d87";const sp=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"annotationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"annotationName",variableName:"annotationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],r={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"AnnotationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n,l],kind:"Operation",name:"AnnotationSummaryQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,{kind:"InlineFragment",selections:[d],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[d,s,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},c,{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:i,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummary",plural:!1,selections:[c,{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"b3fefe401db2ed0b6c2b65edec511205",id:null,metadata:{},name:"AnnotationSummaryQuery",operationKind:"query",text:`query AnnotationSummaryQuery(
  $id: ID!
  $annotationName: String!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...AnnotationSummaryValueFragment_4BTVrq
    id
  }
}

fragment AnnotationSummaryValueFragment_4BTVrq on Project {
  annotationConfigs {
    edges {
      node {
        __typename
        ... on AnnotationConfigBase {
          __isAnnotationConfigBase: __typename
          annotationType
        }
        ... on CategoricalAnnotationConfig {
          annotationType
          id
          optimizationDirection
          name
          values {
            label
            score
          }
        }
        ... on Node {
          __isNode: __typename
          id
        }
      }
    }
  }
  spanAnnotationSummary(annotationName: $annotationName, timeRange: $timeRange) {
    name
    labelFractions {
      label
      fraction
    }
    meanScore
  }
  id
}
`}}})();sp.hash="3853ce97f7a810755cb61812e309942d";const op=f.createContext(null);function Nl(){const n=f.useContext(op);if(n===null)throw new Error("useStreamState must be used within a StreamStateProvider");return n}function eT({initialFetchKey:n="initial",children:a}){const l=Cn(d=>d.traceStreamingEnabled),t=Cn(d=>d.setTraceStreamingEnabled),[i,r]=f.useState(n),s=f.useCallback(d=>{f.startTransition(()=>{r(d)})},[r]);return e(op.Provider,{value:{isStreaming:l,setIsStreaming:t,fetchKey:i,setFetchKey:s},children:a})}function nT({annotationName:n}){var i,r;const{projectId:a}=on(),{timeRange:l}=Ut(),t=T.useLazyLoadQuery(sp,{annotationName:n,id:a,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return e(lT,{name:n,children:e(aT,{annotationName:n,project:t.project})})}function aT(n){var s,d,c,u;const{project:a,annotationName:l}=n,{fetchKey:t}=Nl(),[i,r]=T.useRefetchableFragment(rp,a);return f.useEffect(()=>{f.startTransition(()=>{r({},{fetchPolicy:"store-and-network"})})},[t,r]),e(tT,{name:l,meanScore:(s=i==null?void 0:i.spanAnnotationSummary)==null?void 0:s.meanScore,labelFractions:(d=i==null?void 0:i.spanAnnotationSummary)==null?void 0:d.labelFractions,annotationConfig:(u=(c=i==null?void 0:i.annotationConfigs)==null?void 0:c.edges.find(m=>m.node.name===l))==null?void 0:u.node})}function lT({children:n,name:a}){return o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:e(mn,{maxWidth:"120px",children:a})}),e(f.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:n})]})}const rd={M:{chart:{width:24,height:24},pie:{innerRadius:8,outerRadius:11}},S:{chart:{width:16,height:16},pie:{innerRadius:6,outerRadius:8}},L:{chart:{width:32,height:32},pie:{innerRadius:10,outerRadius:13}}};function dp(n,a,l,t){if(!t||t.annotationType!=="CATEGORICAL"||!t.values)return n[a%n.length];const r=[...t.values].sort((s,d)=>{const c=s.score??0,u=d.score??0;return(t.optimizationDirection==="MAXIMIZE"?-1:1)*(c-u)}).map(s=>s.label).indexOf(l);return n[r%n.length]}function cp(n){const a=Un();return[gs(n),a.grey300,a.grey400,a.grey500,a.grey600]}function tT({name:n,meanScore:a,labelFractions:l,size:t="M",disableAnimation:i=!1,meanScoreFallback:r,annotationConfig:s}){const d=typeof a=="number",c=Array.isArray(l)&&l.length>0;return!d&&!c?e(v,{size:"L",children:"--"}):o(Se,{delay:0,children:[e(Zn,{children:e(iT,{name:n,meanScore:a,labelFractions:l,size:t,disableAnimation:i,meanScoreFallback:r,annotationConfig:s})}),e(fa,{placement:"bottom",children:e(up,{annotationName:n,labelFractions:l,meanScore:a,annotationConfig:s})})]})}function iT({name:n,meanScore:a,labelFractions:l,size:t="M",disableAnimation:i,meanScoreFallback:r,annotationConfig:s}){const d=cp(n),c=typeof a=="number",u=l&&l.length>0;if(!c&&!u)return e(v,{size:"L",children:"--"});const m=rd[t].chart,g=rd[t].pie;return o(b,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:"size-100",children:[u?e(zs,{...m,children:e(Vs,{data:l,dataKey:"fraction",nameKey:"label",cx:"50%",cy:"50%",...g,strokeWidth:0,stroke:"transparent",animationDuration:i?0:void 0,children:l.map((p,y)=>e(Ns,{fill:dp(d,y,p.label,s)},`cell-${y}`))})}):null,e(Ht,{fallback:r,value:a,size:t==="S"?t:"L"})]})}function up({annotationName:n,labelFractions:a,meanScore:l,annotationConfig:t}){const i=cp(n),r=typeof l=="number"&&!isNaN(l),s=a&&a.length>0;return e(C,{width:"size-2400",children:o(b,{direction:"column",gap:"size-50",children:[s&&e("ul",{children:a.map((d,c)=>e("li",{children:e(_e,{color:dp(i,c,d.label,t),name:d.label,shape:"square",value:Rr(d.fraction*100)})},d.label))}),s&&r?e(Oi,{}):null,r?o(b,{direction:"row",justifyContent:"space-between",children:[e(v,{children:"mean score"}),e(Ht,{value:l})]}):null]})})}function co({name:n,labelFractions:a,annotationConfig:l}){var d;const t=a.reduce((c,u)=>Math.max(c,u.fraction),0),i=(d=a.find(c=>c.fraction===t))==null?void 0:d.label,r=a.length-1,s=r>0;return i?o(Se,{delay:0,children:[e(Zn,{children:o(b,{direction:"row",alignItems:"center",gap:"size-50",maxWidth:s?"80%":"99%",children:[e(nn,{style:{maxWidth:"100%"},children:e(mn,{maxWidth:"100%",children:i})}),s&&o(nn,{children:["+ ",r]})]})}),e(fa,{placement:"bottom",children:e(up,{annotationName:n,labelFractions:a,annotationConfig:l})})]}):null}const t5=n=>Object.values(n.reduce((a,l)=>(a[l.name]?new Date(a[l.name].createdAt)<new Date(l.createdAt)&&(a[l.name]=l):a[l.name]=l,a),{})),mp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"annotationInput",variableName:"input"}],concreteType:"SpanAnnotationMutationPayload",kind:"LinkedField",name:"createSpanNote",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanNotesEditorAddNoteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanNotesEditorAddNoteMutation",selections:a},params:{cacheID:"855aa00f68b36e86f375e7765413ac81",id:null,metadata:{},name:"SpanNotesEditorAddNoteMutation",operationKind:"mutation",text:`mutation SpanNotesEditorAddNoteMutation(
  $input: CreateSpanNoteInput!
) {
  createSpanNote(annotationInput: $input) {
    __typename
  }
}
`}}})();mp.hash="fc7452182db44527c3f68ba81dd53e58";const gp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanNodeId"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[a,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],t={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:l,storageKey:null},i=[{kind:"Variable",name:"id",variableName:"spanNodeId"}],r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},c={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:l,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanNotesEditorQuery",selections:[t,{alias:"span",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,r,s,d,c],storageKey:null},{args:null,kind:"FragmentSpread",name:"SpanFeedback_annotations"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanNotesEditorQuery",selections:[t,{alias:"span",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[a,r,s,d,c,{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"1ee3e2486d1f2ef0b65f6f2fbbb82ec1",id:null,metadata:{},name:"SpanNotesEditorQuery",operationKind:"query",text:`query SpanNotesEditorQuery(
  $spanNodeId: ID!
) {
  viewer {
    id
    username
    profilePictureUrl
  }
  span: node(id: $spanNodeId) {
    __typename
    ... on Span {
      spanAnnotations {
        id
        name
        explanation
        createdAt
        user {
          id
          username
          profilePictureUrl
        }
      }
      ...SpanFeedback_annotations
    }
    id
  }
}

fragment SpanFeedback_annotations on Span {
  id
  spanAnnotations {
    id
    name
    label
    score
    explanation
    metadata
    annotatorKind
    identifier
    source
    createdAt
    updatedAt
    user {
      id
      username
      profilePictureUrl
    }
  }
}
`}}})();gp.hash="5ef72854a1deefb62cd963735947309d";const Gr="n",rT=K`
  width: 100%;
  height: 100%;
  max-height: 100%;
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  padding: var(--ac-global-dimension-size-100);
  box-sizing: border-box;
  li {
    width: 100%;
  }
`;function sT(n){var m;const[a,l]=f.useState(0),t=f.useRef(null),i=T.useLazyLoadQuery(gp,{spanNodeId:n.spanNodeId},{fetchKey:a,fetchPolicy:"store-and-network"}),[r,s]=T.useMutation(mp),d=g=>{f.startTransition(()=>{r({variables:{input:{note:g,spanId:n.spanNodeId}}}),l(a+1)})},u=(((m=i.span)==null?void 0:m.spanAnnotations)||[]).filter(g=>g.name==="note");return f.useEffect(()=>{t.current&&t.current.scrollIntoView({behavior:"smooth"})},[u]),o(b,{direction:"column",height:"100%",justifyContent:"space-between",children:[o("ul",{css:rT,children:[u.map(g=>{var p,y,h,k;return e("li",{children:e(F0,{text:g.explanation||"",timestamp:new Date(g.createdAt),userName:((p=g.user)==null?void 0:p.username)||"system",userPicture:(y=g.user)==null?void 0:y.profilePictureUrl,isOutgoing:((h=g.user)==null?void 0:h.id)===((k=i.viewer)==null?void 0:k.id)})},g.id)}),e("div",{ref:t,"aria-hidden":"true"})]}),o($c,{restoreFocus:!0,children:[e(tc,{hotkey:Gr}),e(ic,{onSendMessage:d,placeholder:"Add a note",isSending:s})]})]})}function oT(){return o(b,{direction:"column",height:"100%",justifyContent:"space-between",children:[e(C,{padding:"size-100",children:o(b,{direction:"column",gap:"size-100",height:"100%",children:[e(Po,{isOutgoing:!1,height:70}),e(Po,{isOutgoing:!0,height:40})]})}),e(ic,{onSendMessage:()=>{},placeholder:"Add a note"})]})}const Fr="s";function dT(n){const a=T.useFragment(lp,n.span),l=f.useRef(null),t=f.useRef(null);return za(Io,()=>{l.current&&l.current.isCollapsed()&&l.current.expand(50)}),za(Gr,()=>{t.current&&t.current.isCollapsed()&&t.current.expand(50)}),o($a,{direction:"vertical",autoSaveId:"span-aside-layout",children:[e(f.Suspense,{children:e(cT,{span:a})}),e(Vr,{ref:l,resizable:!0,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Edit Annotations"}),e(Hl,{children:Io})]}),panelProps:{order:2,minSize:10},children:e(C,{height:"100%",maxHeight:"100%",children:e(C0,{projectId:a.project.id,spanNodeId:a.id},a.id)})}),e(Vr,{ref:t,resizable:!0,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Notes"}),e(Hl,{children:Gr})]}),panelProps:{order:3,minSize:10},children:e(C,{height:"100%",maxHeight:"100%",padding:"size-100",children:e(f.Suspense,{fallback:e(oT,{}),children:e(sT,{spanNodeId:a.id})})})})]})}function cT(n){const a=T.useFragment(ap,n.span),l=f.useRef(null);za(Fr,()=>{l.current&&l.current.isCollapsed()&&l.current.expand(50)});const t=a.spanAnnotations.length>0;return e(Vr,{ref:l,title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Annotation Summary"}),e(Hl,{children:Fr})]}),disabled:!t,panelProps:{order:1,defaultSize:t?20:0,minSize:t?20:0},children:o($c,{children:[e(tc,{hotkey:Fr}),e(C,{paddingY:"size-200",paddingX:"size-200",overflow:"auto",maxHeight:"100%",children:e(ji,{span:a})})]})})}const pp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"SpanEvent",kind:"LinkedField",name:"events",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanEventsListQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanEventsListQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"2150fcc2cd81d17b248b32d95dbfb63f",id:null,metadata:{},name:"SpanEventsListQuery",operationKind:"query",text:`query SpanEventsListQuery(
  $id: ID!
) {
  span: node(id: $id) {
    __typename
    ... on Span {
      events {
        name
        message
        timestamp
        attributes
      }
    }
    id
  }
}
`}}})();pp.hash="da4db9f03c1de68590ebab7a4f543127";function uT({spanId:n}){var t;const l=((t=T.useLazyLoadQuery(pp,{id:n}).span)==null?void 0:t.events)??[];return e(mT,{events:l})}function mT({events:n}){const{fullTimeFormatter:a}=kn();return n.length===0?e(C,{padding:"size-200",children:e(v,{color:"text-700",children:"No events"})}):e(ha,{css:K`
        .react-aria-Button[slot="trigger"] {
          padding: var(--ac-global-dimension-static-size-200);
        }
      `,children:n.map((l,t)=>{const i=l.name==="exception",r=l.attributes&&typeof l.attributes=="object"&&Object.keys(l.attributes).length>0,s=o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(C,{flex:"none",children:e(v,{color:"text-700",children:a(new Date(l.timestamp))})}),i&&e(C,{flex:"none",children:e(x,{svg:e(rc,{}),color:"danger"})}),o(b,{direction:"row",gap:"size-100",children:[e(v,{weight:"heavy",children:l.name}),e(mn,{maxWidth:"200px",title:l.message,children:l.message&&e(v,{color:"text-700",children:l.message})})]})]});return o(We,{isDisabled:!r,children:[e(He,{arrowPosition:"start",children:s}),r?e(Ge,{children:e(Zl,{basicSetup:{lineNumbers:!1,foldGutter:!1},children:JSON.stringify(l.attributes,null,2)})}):null]},t)})})}const yp=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanFeedback_annotations",selections:[n,{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"identifier",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"source",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"updatedAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null}],storageKey:null}],type:"Span",abstractKey:null}})();yp.hash="9a73b57370acadba7a0398c1439e9893";function gT(){return e(C,{padding:"size-400",children:o(b,{direction:"column",gap:"size-100",alignItems:"center",children:[e(v,{size:"L",children:"No annotations for this span"}),e(gt,{leadingVisual:e(x,{svg:e(ps,{})}),href:"https://arize.com/docs/phoenix/tracing/how-to-tracing/feedback-and-annotations/annotating-in-the-ui",size:"S",children:"How to Annotate"})]})})}const pT=K`
  overflow: auto;
`;function yT({annotations:n,spanNodeId:a}){const l=f.useMemo(()=>n.map(g=>({...g,spanNodeId:a})),[n,a]),t=Le(),i=Ve(),r=f.useMemo(()=>[{header:"name",accessorKey:"name",size:100},{header:"annotator kind",accessorKey:"annotatorKind",size:100,cell:({row:g})=>{const p=g.original.annotatorKind;return e(T0,{kind:p})}},{header:"user",accessorKey:"user",size:100,cell:({row:g})=>{const p=g.original.user,y=(p==null?void 0:p.username)||"system";return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(wi,{name:y,profilePictureUrl:(p==null?void 0:p.profilePictureUrl)||null,size:18}),e("span",{children:y})]})}},{header:"label",accessorKey:"label",size:100},{header:"score",accessorKey:"score",size:100},{header:"explanation",accessorKey:"explanation",cell:K0,size:400},{header:"source",accessorKey:"source",size:100},{header:"identifier",accessorKey:"identifier",size:100},{header:"metadata",accessorKey:"metadata",minSize:100,cell:({row:g})=>{const p=g.original.metadata;return p?e(il,{json:p,collapseSingleKey:!1}):"--"}},{header:"created at",accessorKey:"createdAt",size:100,cell:tn},{header:"updated at",accessorKey:"updatedAt",size:100,cell:tn},{header:"",accessorKey:"actions",size:100,cell:({row:g})=>e(P0,{annotationId:g.original.id,spanNodeId:g.original.spanNodeId,annotationName:g.original.name,onSpanAnnotationActionSuccess:t,onSpanAnnotationActionError:p=>{i({title:"Failed to update span annotation",message:p.message})}})}],[i,t]),[s,d]=f.useState([{id:"createdAt",desc:!0}]),c=Qe({columns:r,data:l,getCoreRowModel:Be(),getSortedRowModel:Vn(),onSortingChange:d,state:{sorting:s}}),m=c.getRowModel().rows.length===0;return e("div",{css:pT,children:o("table",{css:Kn,"data-testid":"span-annotations-table",children:[e("thead",{children:c.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:e(te,{children:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{display:"flex",alignItems:"center",left:p.getStart(),width:p.getSize()},children:[e(mn,{maxWidth:"100%",children:de(p.column.columnDef.header,p.getContext())}),p.column.getIsSorted()?e(x,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})})},p.id))},g.id))}),m?e(Xn,{}):e("tbody",{children:c.getRowModel().rows.map(g=>e("tr",{children:g.getVisibleCells().map(p=>e("td",{style:{width:p.column.getSize()},children:de(p.column.columnDef.cell,p.getContext())},p.id))},g.id))})]})})}function fT({span:n}){"use no memo";const a=T.useFragment(yp,n),l=a.spanAnnotations;return a.spanAnnotations.length>0?e(yT,{annotations:l,spanNodeId:a.id}):e(gT,{})}function hT(n){return n==="__REDACTED__"}const kT=K`
  position: relative;
  overflow: hidden;
  width: 200px;
  height: 200px;
  border-radius: var(--ac-global-rounding-small);
  border: 1px solid var(--ac-global-color-grey-500);
  background-color: var(--ac-global-color-grey-200);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  transition:
    width 0.1s ease-in-out,
    height 0.1s ease-in-out opacity 0.1s ease-in-out;
  button {
    position: absolute;
    right: var(--ac-global-dimension-size-100);
    top: var(--ac-global-dimension-size-100);
    z-index: 1;
    opacity: 0;
  }
  &:hover button {
    opacity: 1;
  }
  img {
    width: inherit;
    height: inherit;
    object-fit: contain;
  }

  &.is-expanded {
    width: 100%;
    height: 100%;
    img {
      object-fit: cover;
    }
  }
`;function bT(n){const[a,l]=f.useState(!1);let t;const i=hT(n.url);return i?t=e(ST,{}):t=e("img",{src:n.url}),o("div",{className:_S({"is-expanded":a}),css:kT,children:[!i&&e(R,{variant:"default",size:"S",onPress:()=>l(!a),leadingVisual:e(x,{svg:a?e(I0,{}):e(ft,{})}),"aria-label":"Expand / Collapse Image"}),t]})}const ST=()=>o("svg",{width:"130",height:"130",viewBox:"0 0 130 130",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("rect",{x:"1.5",y:"1.5",width:"127",height:"127",rx:"6.5",strokeOpacity:"0.8",strokeWidth:"3"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M40 27.5H90C96.8917 27.5 102.5 33.1083 102.5 40V90C102.5 96.8917 96.8917 102.5 90 102.5H40C33.1083 102.5 27.5 96.8917 27.5 90V40C27.5 33.1083 33.1083 27.5 40 27.5ZM40 35.8333H90C92.3 35.8333 94.1667 37.7 94.1667 40V74.85L80.8208 63.4667C76.6958 59.9583 70.2417 59.9583 66.1542 63.4417L35.8333 88.7417V40C35.8333 37.7 37.7 35.8333 40 35.8333ZM54.5833 50.4167C54.5833 53.8667 51.7833 56.6667 48.3333 56.6667C44.8833 56.6667 42.0833 53.8667 42.0833 50.4167C42.0833 46.9667 44.8833 44.1667 48.3333 44.1667C51.7833 44.1667 54.5833 46.9667 54.5833 50.4167ZM42.3375 94.1667H90C92.3 94.1667 94.1667 92.3 94.1667 90V85.8083L75.4125 69.8083C74.4083 68.9458 72.55 68.9417 71.525 69.8125L42.3375 94.1667Z",fill:"var(--ac-global-color-grey-300)"})]}),fp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",selections:a},params:{cacheID:"d93c9d47668fc266ba09ecb14c2b72ae",id:null,metadata:{},name:"SpanToDatasetExampleDialogAddExampleToDatasetMutation",operationKind:"mutation",text:`mutation SpanToDatasetExampleDialogAddExampleToDatasetMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}})();fp.hash="75120065d239f28304e9dd91fc34bec9";const hp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={kind:"InlineFragment",selections:[{alias:"revision",args:null,concreteType:"SpanAsExampleRevision",kind:"LinkedField",name:"asExampleRevision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanToDatasetExampleDialogQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"48a0d4811a4c4fd2cf3c7114f1b04fc9",id:null,metadata:{},name:"SpanToDatasetExampleDialogQuery",operationKind:"query",text:`query SpanToDatasetExampleDialogQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      revision: asExampleRevision {
        input
        output
        metadata
      }
    }
    id
  }
}
`}}})();hp.hash="9ff195bb3e4302feb10eb48b22dfdcb1";const Cr={backgroundColor:"light",borderColor:"light",collapsible:!0};function vT({spanId:n,onCompleted:a}){const[l,t]=f.useState(null),i=T.useLazyLoadQuery(hp,{spanId:n},{fetchPolicy:"store-and-network"}),{span:{revision:r}}=i,[s,d]=T.useMutation(fp),{control:c,setError:u,handleSubmit:m,formState:{isValid:g}}=sn({defaultValues:{input:JSON.stringify(r==null?void 0:r.input,null,2),output:JSON.stringify(r==null?void 0:r.output,null,2),metadata:JSON.stringify(r==null?void 0:r.metadata,null,2),datasetId:""}}),p=f.useCallback(y=>{if(t(null),!ma(y==null?void 0:y.input))return u("input",{message:"Input must be a valid JSON object"});if(!ma(y==null?void 0:y.output))return u("output",{message:"Output must be a valid JSON object"});if(!ma(y==null?void 0:y.metadata))return u("metadata",{message:"Metadata must be a valid JSON object"});if(!(y!=null&&y.datasetId))return u("datasetId",{message:"Dataset is required"});s({variables:{input:{datasetId:y.datasetId,examples:[{input:JSON.parse(y.input),output:JSON.parse(y.output),metadata:JSON.parse(y.metadata),spanId:n}]}},onCompleted:()=>{a(y.datasetId)},onError:h=>{const k=je(h);t((k==null?void 0:k[0])??h.message)}})},[s,u,n,a]);return e(re,{children:({close:y})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Add Example to Dataset"}),o(ke,{children:[e(R,{variant:"primary",size:"S",isDisabled:!g||d,onPress:()=>{m(p)(),y()},leadingVisual:e(x,{svg:d?e(ta,{}):e(Mn,{})}),children:"Add Example"}),e(be,{slot:"close"})]})]}),e("div",{css:K`
              overflow-y: auto;
              padding: var(--ac-global-dimension-size-400);
              /* Make widths configurable */
              .dataset-picker {
                width: 100%;
              }
            `,children:e(b,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[l?e(Ee,{variant:"danger",children:l}):null,e(H,{control:c,name:"datasetId",render:({field:{onChange:h,onBlur:k},fieldState:{invalid:S,error:F}})=>o(b,{direction:"row",gap:"size-100",alignItems:"end",children:[e(x0,{isRequired:!0,onChange:h,onBlur:k,validationState:S?"invalid":"valid",errorMessage:F==null?void 0:F.message,label:"Dataset"}),e(L0,{})]})}),e(H,{control:c,name:"input",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:F,error:I}})=>o(ee,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Cr,children:[F?e(Ee,{variant:"danger",banner:!0,children:I==null?void 0:I.message}):null,e(En,{value:S,onChange:h,onBlur:k})]})}),e(H,{control:c,name:"output",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:F,error:I}})=>o(ee,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Cr,backgroundColor:"green-100",borderColor:"green-700",children:[F?e(Ee,{variant:"danger",banner:!0,children:I==null?void 0:I.message}):null,e(En,{value:S,onChange:h,onBlur:k})]})}),e(H,{control:c,name:"metadata",render:({field:{onChange:h,onBlur:k,value:S},fieldState:{invalid:F,error:I}})=>o(ee,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Cr,children:[F?e(Ee,{variant:"danger",banner:!0,children:I==null?void 0:I.message}):null,e(En,{value:S,onChange:h,onBlur:k})]})})]})})})})]})})}const FT=n=>f.useMemo(()=>hn(n),[n]),CT=n=>n.events.some(a=>a.name==="exception"),un={backgroundColor:"light",borderColor:"light",collapsible:!0},KT=900,Kr=33,sd="e";function TT({spanNodeId:n}){const a=Cn(u=>u.isAnnotatingSpans),l=Cn(u=>u.setIsAnnotatingSpans),t=f.useRef(null),i=f.useRef(null),r=D0(i),s=r!=null&&r.width?r.width<KT:!0,{span:d}=T.useLazyLoadQuery(ep,{id:n});if(d.__typename!=="Span")throw new Error("Expected a span, but got a different type"+d.__typename);za(sd,()=>{a||l(!0)},{preventDefault:!0});const c=f.useMemo(()=>CT(d),[d]);return o($a,{direction:"horizontal",autoSaveId:"span-details-layout",children:[e(An,{order:1,children:o(b,{direction:"column",flex:"1 1 auto",height:"100%",ref:i,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-50",paddingStart:"size-150",paddingEnd:"size-200",flex:"none",children:o(b,{direction:"row",alignItems:"center","data-testid":"span-header-row",children:[e(XK,{span:d}),o(b,{flex:"none",direction:"row",alignItems:"center",gap:"size-100",children:[e(qn,{variant:d.spanKind!=="llm"?"default":"primary",leadingVisual:e(x,{svg:e(Qa,{})}),isDisabled:d.spanKind!=="llm",to:`/playground/spans/${d.id}`,size:"S","aria-label":"Prompt Playground",children:s?null:"Playground"}),e(xT,{span:d,buttonText:s?null:"Add to Dataset"}),e(ga,{size:"S",isSelected:a,onPress:()=>{l(!a);const u=t.current;u&&u.getSize()<Kr&&u.resize(Kr)},leadingVisual:e(x,{svg:e(ps,{})}),trailingVisual:!s&&!a&&e(sc,{children:sd}),children:s?null:"Annotate"}),e(YK,{traceId:d.trace.traceId,spanId:d.spanId})]})]})}),o(jn,{children:[o(On,{children:[e(ve,{id:"info",children:"Info"}),o(ve,{id:"annotations",children:["Annotations ",e(La,{children:d.spanAnnotations.length})]}),e(ve,{id:"attributes",children:"Attributes"}),o(ve,{id:"events",children:["Events"," ",e(La,{variant:c?"danger":"default",children:d.events.length})]})]}),e(Re,{id:"info",children:e(b,{direction:"row",height:"100%",children:e(IT,{children:e(ht,{children:e(LT,{span:d})})})})}),e(Re,{id:"annotations",children:e(fT,{span:d})}),e(Re,{id:"attributes",children:e(C,{padding:"size-200",height:"100%",maxHeight:"100%",overflow:"auto",children:e(ee,{title:"All Attributes",...un,titleExtra:Sp,children:e(oc,{attributes:d.attributes})})})}),e(Re,{id:"events",children:e(C,{overflow:"auto",children:e(f.Suspense,{fallback:e(me,{}),children:e(uT,{spanId:d.id})})})})]})]})}),a&&e(sl,{css:Qi}),a&&e(An,{order:2,ref:t,defaultSize:Kr,minSize:10,collapsible:!0,onCollapse:()=>{l(!1)},children:e(dT,{span:d})})]})}const PT=K`
  flex: 1 1 auto;
  overflow-y: auto;
  // Overflow fails to take into account padding
  & > *:after {
    content: "";
    display: block;
    height: var(--ac-global-dimension-static-size-400);
  }
`;function IT({children:n}){return e("div",{css:PT,"data-testid":"span-info-wrap",children:n})}function xT({span:n,buttonText:a}){const l=Le(),t=Me();return o(se,{children:[e(R,{variant:"default",size:"S",leadingVisual:e(x,{svg:e(Hd,{})}),children:a}),e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(f.Suspense,{fallback:e(me,{}),children:e(vT,{spanId:n.id,onCompleted:i=>{l({title:"Span Added to Dataset",message:"Successfully added span to dataset",action:{text:"View Dataset",onClick:()=>{t(`/datasets/${i}/examples`)}}})}})})})})]})}function LT({span:n}){const{spanKind:a,attributes:l}=n,{json:t,parseError:i}=FT(l),r=f.useMemo(()=>n.statusMessage?e(Ee,{variant:"danger",title:"Status Description",children:n.statusMessage}):null,[n]);if(i||!t)return e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[r,e(Ee,{variant:"warning",title:"Un-parsable attributes",children:`Failed to parse span attributes. ${i instanceof Error?i.message:""}`}),e(ee,{...un,title:"Attributes",children:e(C,{padding:"size-100",children:l})})]})});let s;switch(a){case"llm":{s=e(DT,{span:n,spanAttributes:t});break}case"retriever":{s=e(_T,{span:n,spanAttributes:t});break}case"reranker":{s=e(AT,{span:n,spanAttributes:t});break}case"embedding":{s=e(ET,{span:n,spanAttributes:t});break}case"tool":{s=e(wT,{span:n,spanAttributes:t});break}default:s=e(kp,{span:n})}return e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[r,s,t!=null&&t.metadata?e(ee,{...un,title:"Metadata",children:e(Zl,{children:JSON.stringify(t.metadata)})}):null]})})}function DT(n){const{spanAttributes:a,span:l}=n,{input:t,output:i}=l,r=f.useMemo(()=>a[Je.llm]||null,[a]),s=r==null?void 0:r[zn.provider],d=f.useMemo(()=>{if(r==null)return null;const D=r[zn.model_name];return typeof D=="string"?D:null},[r]),c=f.useMemo(()=>{if(r==null)return[];const D=r[zn.input_messages];return id(D)?(D==null?void 0:D.map(A=>A[Je.message]).filter(Boolean))||[]:[]},[r]),u=f.useMemo(()=>{if(r==null)return[];const D=r[zn.tools];return Array.isArray(D)?D==null?void 0:D.map(V=>V[Je.tool]).filter(Boolean):[]},[r]),m=f.useMemo(()=>u.reduce((D,A)=>(A!=null&&A.json_schema&&D.push(A.json_schema),D),[]),[u]),g=f.useMemo(()=>{if(r==null)return[];const D=r[zn.output_messages];return id(D)?D.map(A=>A[Je.message]).filter(Boolean)||[]:[]},[r]),p=f.useMemo(()=>{if(r==null)return[];const D=r[zn.prompts];return dc(D)?D:[]},[r]),y=f.useMemo(()=>{if(r==null)return null;const D=r[zn.prompt_template];return D??null},[r]),h=f.useMemo(()=>r==null?"{}":r[zn.invocation_parameters]||"{}",[r]),k=f.useMemo(()=>{if(d==null)return null;let D=e(ys,{spanKind:"llm"});const A=s==null?void 0:s.toUpperCase();return typeof A=="string"&&li(A)&&(D=e(al,{provider:A})),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[D,e(v,{size:"M",weight:"heavy",children:d})]})},[d,s]),S=t!=null&&t.value!=null,F=c.length>0,I=m.length>0,L=i!=null&&i.value!=null,M=g.length>0,E=p.length>0,P=Object.keys(hn(h).json||{}).length>0,_=y!=null;return o(b,{direction:"column",gap:"size-200",children:[e(ee,{collapsible:!0,backgroundColor:"light",borderColor:"light",titleSeparator:!1,title:k,children:o(jn,{children:[o(On,{children:[F&&e(ve,{id:"input-messages",children:"Input Messages"}),I&&e(ve,{id:"tools",children:"Tools"}),S&&e(ve,{id:"input",children:"Input"}),_&&e(ve,{id:"prompt-template",children:"Prompt Template"}),E&&e(ve,{id:"prompts",children:"Prompts"}),P&&e(ve,{id:"invocation-params",children:"Invocation Params"})]}),F&&e(Re,{id:"input-messages",children:e(od,{messages:c})}),I&&e(Re,{id:"tools",children:e(NT,{toolSchemas:m})}),S&&e(Re,{id:"input",children:e(C,{padding:"size-200",children:e(ka,{children:e(ee,{...un,title:"LLM Input",extra:o(b,{direction:"row",gap:"size-100",children:[e(Na,{}),e(rn,{text:t.value})]}),children:e(dl,{...t})})})})}),_&&e(Re,{id:"prompt-template",children:e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[y.template!=null&&e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Ki,{text:y.template,children:[e(v,{color:"text-700",fontStyle:"italic",children:"prompt template"}),e(bp,{children:y.template})]})}),y.variables!=null&&e(C,{borderRadius:"medium",borderColor:"light",backgroundColor:"light",borderWidth:"thin",padding:"size-200",children:o(Ki,{text:JSON.stringify(y.variables),children:[e(v,{color:"text-700",fontStyle:"italic",children:"template variables"}),e(Zl,{children:JSON.stringify(y.variables)})]})})]})})}),E&&e(Re,{id:"prompts",children:e(zT,{prompts:p})}),P&&e(Re,{id:"invocation-params",children:e(Ki,{text:h,padding:"size-100",children:e(Zl,{children:h})})})]})}),L||M?e(ee,{...un,title:"Output",titleSeparator:!1,children:o(jn,{children:[o(On,{children:[M&&e(ve,{id:"output-messages",children:"Output Messages"}),L&&e(ve,{id:"output",children:"Output"})]}),M&&e(Re,{id:"output-messages",children:e(od,{messages:g})}),L&&e(Re,{id:"output",children:e(C,{padding:"size-200",children:e(ka,{children:e(ee,{...un,title:"LLM Output",extra:o(b,{direction:"row",gap:"size-100",children:[e(Na,{}),e(rn,{text:i.value})]}),children:e(dl,{...i})})})})})]})}):null]})}function _T(n){const{spanAttributes:a,span:l}=n,{input:t}=l,i=f.useMemo(()=>a[Je.retrieval]||null,[a]),r=f.useMemo(()=>{var g;return i==null?[]:((g=i[AS.documents])==null?void 0:g.map(p=>p[Je.document]).filter(Boolean))||[]},[i]),s=f.useMemo(()=>l.documentEvaluations.reduce((p,y)=>{const h=y.documentPosition,k=p[h]||[];return{...p,[h]:[...k,y]}},{}),[l.documentEvaluations]),d=t!=null&&t.value!=null,c=d&&t.mimeType==="text",u=r.length>0,m=l.documentRetrievalMetrics.length>0;return o(b,{direction:"column",gap:"size-200",children:[d?e(ka,{children:e(ee,{title:"Input",...un,extra:e(b,{direction:"row",gap:"size-100",alignItems:"center",children:c?e(Na,{}):e(rn,{text:t.value})}),children:e(dl,{...t})})}):null,u?e(ka,{children:e(ee,{title:"Documents",...un,titleExtra:m&&e(b,{direction:"row",alignItems:"center",gap:"size-100",children:l.documentRetrievalMetrics.map(g=>o(te,{children:[e(ya,{name:g.evaluationName,metric:"ndcg",score:g.ndcg},"ndcg"),e(ya,{name:g.evaluationName,metric:"precision",score:g.precision},"precision"),e(ya,{name:g.evaluationName,metric:"hit",score:g.hit},"hit")]}))}),extra:e(Na,{}),children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:r.map((g,p)=>e("li",{children:e(Wr,{document:g,documentEvaluations:s[p],borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},p))})})}):null]})}function AT(n){const{spanAttributes:a}=n,l=f.useMemo(()=>a[Je.reranker]||null,[a]),t=f.useMemo(()=>l==null?null:l[mr.query]||null,[l]),i=f.useMemo(()=>{var c;return l==null?[]:((c=l[mr.input_documents])==null?void 0:c.map(u=>u[Je.document]).filter(Boolean))||[]},[l]),r=f.useMemo(()=>{var c;return l==null?[]:((c=l[mr.output_documents])==null?void 0:c.map(u=>u[Je.document]).filter(Boolean))||[]},[l]),s=i.length,d=r.length;return o(b,{direction:"column",gap:"size-200",children:[e(ka,{children:t&&e(ee,{title:"Query",...un,children:e(C,{padding:"size-200",children:e(Cl,{children:t})})})}),e(ee,{title:"Input Documents",titleExtra:e(La,{children:s}),...un,defaultOpen:!1,children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:i.map((c,u)=>e("li",{children:e(Wr,{document:c,borderColor:"seafoam-700",backgroundColor:"seafoam-100",tokenColor:"var(--ac-global-color-seafoam-1000)"})},u))})}),e(ee,{title:"Output Documents",titleExtra:e(La,{children:d}),...un,children:e("ul",{css:K`
              padding: var(--ac-global-dimension-static-size-200);
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-static-size-200);
            `,children:r.map((c,u)=>e("li",{children:e(Wr,{document:c,borderColor:"celery-700",backgroundColor:"celery-100",tokenColor:"var(--ac-global-color-celery-1000)"})},u))})})]})}function ET(n){const{spanAttributes:a}=n,l=f.useMemo(()=>a[Je.embedding]||null,[a]),t=f.useMemo(()=>{var s;return l==null?[]:((s=l[gr.embeddings])==null?void 0:s.map(d=>d[Je.embedding]).filter(Boolean))||[]},[l]),i=t.length>0,r=l==null?void 0:l[gr.model_name];return e(b,{direction:"column",gap:"size-200",children:i?e(ee,{title:"Embeddings"+(typeof r=="string"?`: ${r}`:""),...un,children:e("ul",{css:K`
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-static-size-200);
                padding: var(--ac-global-dimension-static-size-200);
              `,children:t.map((s,d)=>e("li",{children:e(ka,{children:e(ee,{...un,backgroundColor:"purple-100",borderColor:"purple-700",title:"Embedded Text",children:e(Cl,{children:s[gr.text]||""})})})},d))})}):e(kp,{span:n.span})})}function wT(n){const{span:a,spanAttributes:l}=n,{input:t,output:i}=a,r=typeof(t==null?void 0:t.value)=="string",s=typeof(i==null?void 0:i.value)=="string",d=(t==null?void 0:t.mimeType)==="text",c=(i==null?void 0:i.mimeType)==="text",u=f.useMemo(()=>l[Je.tool]||{},[l]),m=Object.keys(u).length>0,g=u[vi.name],p=u[vi.description],y=u[vi.parameters];return!r&&!s&&!m?null:o(b,{direction:"column",gap:"size-200",children:[r?e(ka,{children:e(ee,{title:"Input",...un,extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[d?e(Na,{}):null,e(rn,{text:t.value})]}),children:e(dl,{...t})})}):null,s?e(ka,{children:e(ee,{title:"Output",...un,backgroundColor:"green-100",borderColor:"green-700",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[c?e(Na,{}):null,e(rn,{text:i.value})]}),children:e(dl,{...i})})}):null,m?e(ee,{title:"Tool"+(typeof g=="string"?`: ${g}`:""),...un,children:o(b,{direction:"column",children:[p!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"light",children:o(b,{direction:"column",alignItems:"start",gap:"size-50",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Description"}),e(v,{children:p})]})}):null,y!=null?e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderBottomColor:"dark",borderBottomWidth:"thin",children:o(b,{direction:"column",alignItems:"start",width:"100%",children:[e(v,{color:"text-700",fontStyle:"italic",children:"Parameters"}),e("div",{css:K`
                      .cm-editor {
                        background-color: transparent !important;
                      }
                    `,children:e(Zl,{basicSetup:{lineNumbers:!1,foldGutter:!1},children:JSON.stringify(y)})})]})}):null]})}):null]})}const MT=["irrelevant","unrelated"];function Wr({document:n,documentEvaluations:a,backgroundColor:l,borderColor:t,tokenColor:i}){const r=n[Dt.metadata],s=a&&a.length,d=n[Dt.content];return e(ee,{...un,backgroundColor:l,borderColor:t,title:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(x,{svg:e(cc,{})}),o(Te,{level:4,children:["document ",n[Dt.id]]})]}),extra:typeof n[Dt.score]=="number"&&e(nn,{color:i,children:`score ${el(n[Dt.score])}`}),children:o(b,{direction:"column",children:[d&&e(Cl,{children:d}),r&&e(te,{children:o(C,{borderColor:t,borderTopWidth:"thin",children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:t,borderBottomWidth:"thin",children:e(Te,{level:4,children:"Document Metadata"})}),e(Zl,{basicSetup:{lineNumbers:!1},children:JSON.stringify(r)})]})}),s&&e(C,{borderColor:t,borderTopWidth:"thin",padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[e(Te,{level:3,weight:"heavy",children:"Evaluations"}),e("ul",{children:a.map((c,u)=>{const m=c.label&&MT.includes(c.label)?"var(--ac-global-color-danger)":i;return e("li",{children:e(C,{padding:"size-200",borderWidth:"thin",borderColor:t,borderRadius:"medium",children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",children:[e(v,{weight:"heavy",elementType:"h5",children:c.name}),c.label&&e(nn,{color:m,children:c.label}),typeof c.score=="number"&&e(nn,{color:m,children:o(b,{direction:"row",gap:"size-50",children:[e(v,{size:"XS",weight:"heavy",color:"inherit",children:"score"}),e(v,{size:"XS",children:Bl(c.score)})]})})]}),c.explanation?e("p",{css:K`
                                margin-top: var(
                                  --ac-global-dimension-static-size-100
                                );
                                margin-bottom: 0;
                              `,children:c.explanation}):null]})})},u)})})]})})]})})}function RT({message:n}){var u;const a=n[Nn.content],l=n[Nn.contents],t=(u=n[Nn.tool_calls])==null?void 0:u.map(m=>m[Je.tool_call]).filter(Boolean),i=n[Nn.function_call_arguments_json]&&n[Nn.function_call_name],r=n[Nn.role]||"unknown",s=ti(r),d=f.useMemo(()=>(t==null?void 0:t.map((m,g)=>`tool-call-${g}`))||[],[t]),c=n[Nn.tool_call_id];return e(ka,{children:o(ee,{...un,...s,title:r+(n[Nn.name]?`: ${n[Nn.name]}`:""),extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Na,{}),e(rn,{text:a||JSON.stringify(n)})]}),children:[e(ht,{children:l?e(OT,{messageContents:l}):null}),e(b,{direction:"column",alignItems:"start",children:o(ha,{css:K`
              width: 100%;
              // when any .ac-disclosure-trigger is hovered, show the child .copy-to-clipboard-button
              .ac-disclosure-trigger {
                width: 100%;
                .copy-to-clipboard-button {
                  visibility: hidden;
                }
              }
              .ac-disclosure-trigger:hover,
              .ac-disclosure-trigger:focus-within,
              .ac-disclosure-trigger:focus-visible {
                .copy-to-clipboard-button {
                  visibility: visible;
                }
              }
            `,defaultExpandedKeys:["tool-content",...d,"function-call"],children:[r.toLowerCase()==="tool"?o(We,{id:"tool-content",children:[o(He,{arrowPosition:a?"start":"none",justifyContent:"space-between",children:[o(v,{children:["Tool Result",c?`: ${c}`:""]}),c?e(rn,{text:c}):null]}),e(Ge,{children:a?e(C,{width:"100%",children:e(Cl,{children:a})}):null})]}):a?e(C,{width:"100%",children:e(Cl,{children:a})}):null,((t==null?void 0:t.length)??0)>0?t==null?void 0:t.map((m,g)=>{var h,k,S;if(!m)return null;const p=m.id,y=hn((h=m==null?void 0:m.function)==null?void 0:h.arguments);return o(We,{id:d[g],css:g===0?K`
                              border-top: 1px solid
                                var(--ac-global-border-color-default);
                            `:null,children:[o(He,{arrowPosition:"start",justifyContent:"space-between",children:[o("span",{children:["Tool Call",p?`: ${p}`:""]}),p?e(rn,{text:p}):null]}),e(Ge,{children:o("pre",{css:K`
                            text-wrap: wrap;
                            margin: 0;
                            padding: var(--ac-global-dimension-static-size-200);
                          `,children:[(k=m==null?void 0:m.function)==null?void 0:k.name,"(",y.json?JSON.stringify(y.json,null,2):`${(S=m==null?void 0:m.function)==null?void 0:S.arguments}`,")"]},g)})]},g)}):null,i?o(We,{id:"function-call",children:[e(He,{children:e(v,{children:"Function Call"})}),e(Ge,{children:o("pre",{css:K`
                      text-wrap: wrap;
                      margin: var(--ac-global-dimension-static-size-100) 0;
                    `,children:[n[Nn.function_call_name],"(",JSON.stringify(JSON.parse(n[Nn.function_call_arguments_json]),null,2),")"]})})]}):null]})})]})})}function VT({toolSchema:n,index:a}){return e(ee,{title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(ys,{spanKind:"tool"}),e(v,{weight:"heavy",children:"Tool"})]}),titleExtra:o(La,{children:["#",a+1]}),...un,backgroundColor:"yellow-100",borderColor:"yellow-700",extra:e(rn,{text:n}),children:e(dl,{value:n,mimeType:"json"})})}function od({messages:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(RT,{message:a})},l))})}function NT({toolSchemas:n}){return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-100);
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n.map((a,l)=>e("li",{children:e(VT,{toolSchema:a,index:l})},l))})}function zT({prompts:n}){return e("ul",{"data-testid":"llm-prompts-list",css:K`
        padding: var(--ac-global-dimension-size-200);
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-100);
      `,children:n.map((a,l)=>e("li",{children:e(C,{backgroundColor:"grey-100",borderColor:"grey-500",borderWidth:"thin",borderRadius:"medium",padding:"size-100",children:e(Ki,{text:a,children:e(dl,{value:a,mimeType:"text"})})})},l))})}const $T=K`
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-size-200);
  flex-wrap: wrap;
`;function OT({messageContents:n}){return e("ul",{css:$T,"data-testid":"message-content-list",children:n.map((a,l)=>e(QT,{messageContentAttribute:a},l))})}const jT=K`
  flex: 1 1 100%;
  padding: var(--ac-global-dimension-static-size-200);
`;function QT({messageContentAttribute:n}){var r;const{message_content:a}=n,l=a==null?void 0:a.text,t=a==null?void 0:a.image,i=(r=t==null?void 0:t.image)==null?void 0:r.url;return o("li",{css:l?jT:null,children:[l?e(Cl,{margin:"none",children:l}):null,i?e(bT,{url:i}):null]})}function kp({span:n}){const{input:a,output:l}=n,t=a==null&&l==null,i=(a==null?void 0:a.mimeType)==="text",r=(l==null?void 0:l.mimeType)==="text";return o(b,{direction:"column",gap:"size-200",children:[a&&a.value!=null?e(ka,{children:e(ee,{title:"Input",...un,extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[i?e(Na,{}):null,e(rn,{text:a.value})]}),children:e(dl,{...a})})}):null,l&&l.value!=null?e(ka,{children:e(ee,{title:"Output",...un,backgroundColor:"green-100",borderColor:"green-700",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[r?e(Na,{}):null,e(rn,{text:l.value})]}),children:e(dl,{...l})})}):null,t?e(ee,{title:"All Attributes",titleExtra:Sp,...un,children:e(oc,{attributes:n.attributes})}):null]})}const BT=K`
  width: 100%;
  .cm-editor,
  .cm-gutters {
    background-color: transparent;
  }
`;function Ki({text:n,children:a,padding:l}){const t=l?`var(--ac-global-dimension-${l})`:"0";return o("div",{css:K`
        position: relative;
        .copy-to-clipboard-button {
          transition: opacity 0.2s ease-in-out;
          opacity: 0;
          position: absolute;
          right: ${t};
          top: ${t};
          z-index: 1;
        }
        &:hover .copy-to-clipboard-button {
          opacity: 1;
        }
      `,children:[e(rn,{text:n}),a]})}function Zl({children:n,basicSetup:a={}}){const{theme:l}=ia(),t=l==="light"?Ml:Rl,{value:i,mimeType:r}=f.useMemo(()=>{try{return{value:JSON.stringify(JSON.parse(n),null,2),mimeType:"json"}}catch{return{value:n,mimeType:"text"}}},[n]);return r==="json"?e(Vl,{value:i,basicSetup:{lineNumbers:!0,foldGutter:!0,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,...a},extensions:[XS(),qc.lineWrapping],editable:!1,theme:t,css:BT}):e(bp,{children:i})}function bp({children:n}){return e("pre",{"data-testid":"pre-block",css:K`
        white-space: pre-wrap;
        padding: var(--ac-global-dimension-static-size-200);
        font-size: var(--ac-global-font-size-s);
      `,children:n})}function dl({value:n,mimeType:a}){let l;switch(a){case"json":l=e(Zl,{children:n});break;case"text":l=e(Cl,{children:n});break;default:Ne()}return l}const Sp=o(kt,{children:[e(Te,{weight:"heavy",level:4,children:"Span Attributes"}),e(v,{children:"Attributes are key-value pairs that represent metadata associated with a span. For detailed descriptions of specific attributes, consult the semantic conventions section of the OpenInference tracing specification."}),e("footer",{children:e(tl,{href:"https://github.com/Arize-ai/openinference/blob/main/spec/semantic_conventions.md",children:"Semantic Conventions"})})]}),vp={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsFragment",selections:[{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],type:"Span",abstractKey:null};vp.hash="1926def8a20ce2131c00ccd01efe9fb6";const Fp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"}],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TraceHeaderRootSpanAnnotationsQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[r,s],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[t],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[t,i,r,s,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},r],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},i],storageKey:null}],type:"Span",abstractKey:null},t],storageKey:null}]},params:{cacheID:"e9ed5ba3e066bebd2161b440786fb0b9",id:null,metadata:{},name:"TraceHeaderRootSpanAnnotationsQuery",operationKind:"query",text:`query TraceHeaderRootSpanAnnotationsQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      ...TraceHeaderRootSpanAnnotationsFragment
    }
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}
`}}})();Fp.hash="1b00ac674154cf26ad588b2f17f82305";function qT({spanId:n}){const a=T.useLazyLoadQuery(Fp,{spanId:n},{fetchPolicy:"store-and-network"}),l=T.useFragment(vp,a.span);return e(_0,{span:l,renderEmptyState:()=>null})}function uo(n){var p,y,h,k;const{traceId:a,projectId:l}=n,[t,i]=_n(),r=T.useLazyLoadQuery(Zg,{traceId:a,id:l},{fetchPolicy:"store-and-network"});Xe(r.project.trace);const s=((p=r.project.trace)==null?void 0:p.latencyMs)!=null?r.project.trace.latencyMs:null,d=(h=(y=r==null?void 0:r.project)==null?void 0:y.trace)==null?void 0:h.costSummary,c=f.useMemo(()=>{var F;return(((F=r.project.trace)==null?void 0:F.rootSpans.edges)||[]).map(I=>I.span)},[r]),u=t.get(aa);Xe(c.length>0);const m=c[0],g=u??m.id;return o("main",{css:K`
        flex: 1 1 auto;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      `,children:[e(UT,{rootSpan:m,latencyMs:s,costSummary:d,sessionId:(k=r.project.trace)==null?void 0:k.projectSessionId}),o($a,{direction:"horizontal",autoSaveId:"trace-panel-group",css:K`
          flex: 1 1 auto;
          overflow: hidden;
        `,children:[e(An,{defaultSize:30,minSize:5,children:e(GT,{children:e(JK,{trace:r.project.trace,selectedSpanNodeId:g,onSpanClick:S=>{i(F=>(F.set(aa,S.id),F),{replace:!0})}})})}),e(sl,{css:Qi}),e(An,{children:e(HT,{children:g?e(f.Suspense,{fallback:e(me,{}),children:e(TT,{spanNodeId:g})}):null})})]})]})}function UT({rootSpan:n,latencyMs:a,costSummary:l,sessionId:t}){var d,c,u,m;const{projectId:i}=on(),{statusCode:r}=n??{statusCode:"UNSET"},s=A0(r);return e(C,{paddingTop:"size-100",paddingBottom:"size-150",paddingX:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",css:K`
          box-sizing: content-box;
        `,children:[o(b,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Trace Status"}),e(v,{size:"XL",children:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(Ni,{statusCode:r}),e(v,{size:"L",color:s,children:r})]})})]}),o(b,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Cost"}),o(Se,{delay:0,children:[e(Es,{children:e(v,{size:"L",role:"button",children:cn(((d=l==null?void 0:l.total)==null?void 0:d.cost)??0)})}),o(fa,{placement:"bottom",children:[e(ln,{}),e(C,{width:"size-3600",children:e(uc,{valueLabel:"cost",totalValue:((c=l==null?void 0:l.total)==null?void 0:c.cost)??0,formatter:cn,segments:[{name:"Prompt",value:((u=l==null?void 0:l.prompt)==null?void 0:u.cost)??0,color:"rgba(254, 119, 99, 1)"},{name:"Completion",value:((m=l==null?void 0:l.completion)==null?void 0:m.cost)??0,color:"rgba(98, 104, 239, 1)"}]})})]})]})]}),o(b,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency"}),e(v,{size:"XL",children:typeof a=="number"?e(Rn,{latencyMs:a,size:"L"}):"--"})]}),n?e(qT,{spanId:n.id}):null,t&&e("span",{css:K`
              margin-left: auto;
            `,children:e(qn,{size:"S",variant:"primary",to:`/projects/${i}/sessions/${t}`,children:"View Session"})})]})})}function HT({children:n}){return e("div",{"data-testid":"scrolling-tabs-wrapper",css:K`
        height: 100%;
        overflow: hidden;
        .ac-tabs {
          height: 100%;
          overflow: hidden;
          .ac-tabs__extra {
            width: 100%;
            padding-right: var(--ac-global-dimension-size-200);
            padding-bottom: var(--ac-global-dimension-size-50);
          }
          .ac-tabs__pane-container {
            min-height: 100%;
            height: 100%;
            overflow-y: auto;
            div[role="tabpanel"] {
              height: 100%;
            }
          }
        }
      `,children:n})}function GT({children:n}){return e("div",{"data-testid":"scrolling-panel-content",css:K`
        height: 100%;
        overflow-y: auto;
      `,children:n})}const sr=()=>{const{projectId:n}=on();if(!n)throw new Error("projectId is required");const l=Ft().pathname.split("/"),t=l.indexOf(n);if(t===-1)throw new Error("projectId not found in path");const i=l.slice(0,t+1).join("/"),r=l[t+1];return{rootPath:i,tab:r}},Cp=f.createContext(null),mo=()=>f.useContext(Cp),Kp=(n,a)=>{const l=n.findIndex(({traceId:d,spanId:c})=>a&&(d===a||c===a)),t=l-1,i=l+1,r=n[t],s=n[i];return{nextTraceId:s==null?void 0:s.traceId,nextSpanId:s==null?void 0:s.spanId,previousTraceId:r==null?void 0:r.traceId,previousSpanId:r==null?void 0:r.spanId}},dd=(n,a,l)=>{const{nextTraceId:t,previousTraceId:i,nextSpanId:r,previousSpanId:s}=Kp(a,l),[d,c,u]=n.pathname.split("/").filter(y=>y!==""),m=(y,h)=>{let k=`/${d}/${c}/${u}/${y}`;return h&&(k+=`?${aa}=${h}`),k},g=!!t,p=!!i;return{nextTracePath:g?m(t,r):null,previousTracePath:p?m(i,s):null}},Tp=({children:n})=>{const a=Me(),l=Ft(),[t,i]=f.useState([]),r=f.useCallback(d=>{const{nextTracePath:c}=dd(l,t,d);c&&a(c)},[a,l,t]),s=f.useCallback(d=>{const{previousTracePath:c}=dd(l,t,d);c&&a(c)},[a,l,t]);return e(Cp.Provider,{value:{traceSequence:t,next:r,previous:s,setTraceSequence:i},children:n})},cd="j",ud="k",WT=({currentId:n})=>{const a=mo();if(za(cd,()=>{a&&a.next(n)}),za(ud,()=>{a&&a.previous(n)}),!a||!a.traceSequence.length)return null;const{previous:l,next:t,traceSequence:i}=a,{nextTraceId:r,previousTraceId:s}=Kp(i,n),d=!!s,c=!!r;return e(b,{gap:"size-50",css:K`
        button {
          // either the icons or the trigger wrap are making the buttons slightly too small
          // so just spot adjust the min height here
          min-height: 31px;
        }
      `,children:o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[o(Se,{delay:100,children:[e(R,{size:"S",id:"next",leadingVisual:e(x,{svg:e(nc,{})}),"aria-label":"Next trace",isDisabled:!c,onPress:()=>{f.startTransition(()=>{t(n)})}}),e(Ii,{offset:4,children:e(C,{backgroundColor:"dark",borderWidth:"thin",borderColor:"dark",borderRadius:"medium",padding:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Next trace"}),e(Hl,{children:cd})]})})})]}),o(Se,{delay:100,children:[e(R,{size:"S",id:"previous",leadingVisual:e(x,{svg:e(ac,{})}),"aria-label":"Previous trace",isDisabled:!d,onPress:()=>{f.startTransition(()=>{l(n)})}}),e(Ii,{offset:4,children:e(C,{backgroundColor:"dark",borderWidth:"thin",borderColor:"dark",borderRadius:"medium",padding:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{children:"Previous trace"}),e(Hl,{children:ud})]})})})]})]})})};function i5(){const{traceId:n,projectId:a}=on(),[l]=_n(),t=Me(),{rootPath:i,tab:r}=sr(),d=l.get(aa)||n;return e(oe,{isOpen:!0,onOpenChange:c=>{c||t(`${i}/${r}`)},children:e(ae,{variant:"slideover",size:"fullscreen",children:e(re,{children:({close:c})=>o(ye,{children:[o(fe,{children:[o(b,{direction:"row",gap:"size-200",justifyContent:"center",children:[e(WT,{currentId:d}),e(he,{children:"Trace Details"})]}),o(ke,{children:[e(E0,{preserveSearchParams:!0,buttonText:"Share",tooltipText:"Copy trace link to clipboard",successText:"Trace link copied to clipboard"}),e(be,{close:c})]})]}),e(f.Suspense,{fallback:e(me,{}),children:e(uo,{traceId:n,projectId:a})})]})})})})}const Pp=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"first"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},i={alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null},s=[r,{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null}],d={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:s,storageKey:null}],storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},u={alias:"latencyP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},m=[{kind:"Variable",name:"first",variableName:"first"}],g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},S=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"SessionDetailsQuery",selections:[{alias:"session",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[t,i,d,c,u,{args:m,kind:"FragmentSpread",name:"SessionDetailsTraceList_traces"}],type:"ProjectSession",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"SessionDetailsQuery",selections:[{alias:"session",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,p,{kind:"InlineFragment",selections:[t,i,d,c,u,{alias:null,args:m,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[p,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[p,{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[r],storageKey:null}],storageKey:null}],storageKey:null},p,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[p,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[p,y,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[h,k],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[p],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:S,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:S,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[p,y,h,k,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},p],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},h],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},y],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[g,p],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:m,filters:null,handle:"connection",key:"SessionDetailsTraceList_traces",kind:"LinkedHandle",name:"traces"}],type:"ProjectSession",abstractKey:null}],storageKey:null}]},params:{cacheID:"e7508c7163171cb5f99aee3c360197a0",id:null,metadata:{},name:"SessionDetailsQuery",operationKind:"query",text:`query SessionDetailsQuery(
  $id: ID!
  $first: Int
) {
  session: node(id: $id) {
    __typename
    ... on ProjectSession {
      numTraces
      tokenUsage {
        total
      }
      costSummary {
        total {
          cost
          tokens
        }
        prompt {
          cost
          tokens
        }
        completion {
          cost
          tokens
        }
      }
      sessionId
      latencyP50: traceLatencyMsQuantile(probability: 0.5)
      ...SessionDetailsTraceList_traces_3ASum4
    }
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SessionDetailsTraceList_traces_3ASum4 on ProjectSession {
  traces(first: $first) {
    edges {
      trace: node {
        id
        traceId
        rootSpan {
          trace {
            id
            costSummary {
              total {
                cost
              }
            }
          }
          id
          attributes
          project {
            id
          }
          input {
            value
            mimeType
          }
          output {
            value
            mimeType
          }
          cumulativeTokenCountTotal
          latencyMs
          startTime
          spanId
          ...AnnotationSummaryGroup
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Pp.hash="7864de925d1bbe62afca48f309f5529b";const Ip=50,xp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SessionDetailsTraceListRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"SessionDetailsTraceList_traces"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SessionDetailsTraceListRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"TraceConnection",kind:"LinkedField",name:"traces",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[i,{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[s,d],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[i,r,s,d,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},s],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"SessionDetailsTraceList_traces",kind:"LinkedHandle",name:"traces"}],type:"ProjectSession",abstractKey:null}],storageKey:null}]},params:{cacheID:"550751bcd714574722b837b722d9e91f",id:null,metadata:{},name:"SessionDetailsTraceListRefetchQuery",operationKind:"query",text:`query SessionDetailsTraceListRefetchQuery(
  $after: String = null
  $first: Int = 50
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...SessionDetailsTraceList_traces_2HEEH6
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SessionDetailsTraceList_traces_2HEEH6 on ProjectSession {
  traces(first: $first, after: $after) {
    edges {
      trace: node {
        id
        traceId
        rootSpan {
          trace {
            id
            costSummary {
              total {
                cost
              }
            }
          }
          id
          attributes
          project {
            id
          }
          input {
            value
            mimeType
          }
          output {
            value
            mimeType
          }
          cumulativeTokenCountTotal
          latencyMs
          startTime
          spanId
          ...AnnotationSummaryGroup
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();xp.hash="d93b35659e600ca4438d4c1da87a24d5";const Lp=(function(){var n=["traces"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mimeType",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:xp,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionDetailsTraceList_traces",selections:[{alias:"traces",args:null,concreteType:"TraceConnection",kind:"LinkedField",name:"__SessionDetailsTraceList_traces_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"trace",args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"rootSpan",plural:!1,selections:[{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[a,{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:l,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"ProjectSession",abstractKey:null}})();Lp.hash="d93b35659e600ca4438d4c1da87a24d5";function JT({spanNodeId:n,projectId:a,size:l="M",buttonText:t="Annotate"}){return o(se,{children:[e(R,{size:l,"aria-label":"Edit Span Annotations",leadingVisual:e(x,{svg:e(Xl,{})}),children:t}),e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(mc,{spanNodeId:n,projectId:a})})})]})}const ZT=n=>{const{json:a}=hn(n);if(a==null||!wa(a))return null;const l=a[Je.user];if(l==null||!wa(l))return null;const t=l[ES.id];return va.isString(t)||va.isNumber(t)?t:null};function md({role:n,value:a,mimeType:l}){const t=f.useMemo(()=>{if(l!=="json")return String(a);const r=hn(a);return r.json==null?"--":JSON.stringify(r.json,null,2)},[a,l]),i=ti(n==="HUMAN"?"user":"assistant");return e(C,{alignSelf:n==="HUMAN"?"start":"end",borderRadius:"medium",borderColor:"dark",borderWidth:"thin",padding:"size-200",maxWidth:"70%",...i,children:o(b,{direction:"column",gap:"size-50",children:[e(v,{color:"text-700",children:n}),l==="json"?e(jl,{value:t}):e(v,{children:t})]})})}function XT({traceId:n,rootSpan:a,index:l}){var s,d;const{fullTimeFormatter:t}=kn(),i=f.useMemo(()=>new Date(a.startTime),[a.startTime]),r=f.useMemo(()=>ZT(a.attributes),[a.attributes]);return e(C,{height:"100%",children:o(b,{direction:"column",justifyContent:"space-between",height:"100%",children:[o(b,{direction:"column",gap:"size-200",children:[o(b,{direction:"row",justifyContent:"space-between",children:[o(v,{children:["Trace #",l+1]}),e(Dn,{to:`/projects/${a.project.id}/traces/${n}?${aa}=${a.id}`,children:o(b,{alignItems:"center",children:["View Trace",e(x,{svg:e(w0,{})})]})})]}),o(b,{direction:"row",justifyContent:"space-between",children:[r!=null?o(v,{color:"text-700",children:["user: ",r]}):null,e(v,{color:"text-700",flex:"end",marginStart:"auto",children:t(i)})]}),o(b,{direction:"row",gap:"size-100",children:[e(gc,{tokenCountTotal:a.cumulativeTokenCountTotal||0,nodeId:a.id}),((d=(s=a.trace.costSummary)==null?void 0:s.total)==null?void 0:d.cost)!=null&&e(fs,{totalCost:a.trace.costSummary.total.cost,nodeId:a.trace.id}),a.latencyMs!=null?e(Rn,{latencyMs:a.latencyMs}):"--"]})]}),o(b,{direction:"row",justifyContent:"space-between",alignItems:"end",children:[o(b,{direction:"column",gap:"size-100",maxWidth:"50%",children:[e(v,{children:"Feedback"}),e(b,{gap:"size-50",direction:"column",children:e(ji,{span:a,renderEmptyState:()=>"--"})})]}),e("span",{children:e(JT,{size:"S",spanNodeId:a.id,projectId:a.project.id,buttonText:"Annotate"})})]})]})})}function YT({rootSpan:n}){var a,l,t,i;return o(b,{direction:"column",gap:"size-100",children:[e(md,{role:"HUMAN",value:(a=n.input)==null?void 0:a.value,mimeType:(l=n.input)==null?void 0:l.mimeType}),e(md,{role:"AI",value:(t=n.output)==null?void 0:t.value,mimeType:(i=n.output)==null?void 0:i.mimeType})]})}function e2({tracesRef:n}){const{data:a,loadNext:l,isLoadingNext:t,hasNext:i}=T.usePaginationFragment(Lp,n),r=f.useMemo(()=>{var c;return(c=a.traces)==null?void 0:c.edges.filter(u=>u.trace.rootSpan!==null).map(({trace:u})=>u)},[a]),s=f.useCallback(c=>{if(c){const{scrollHeight:u,scrollTop:m,clientHeight:g}=c;u-m-g<1024&&!t&&i&&l(Ip)}},[i,t,l]),d=f.useMemo(()=>va.throttle(s,100),[s]);return o("div",{css:K`
        height: 100%;
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:c=>d(c.target),children:[r.map(({traceId:c,rootSpan:u},m)=>e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:o(b,{direction:"row",children:[e(C,{borderRightWidth:"thin",borderEndColor:"dark",padding:"size-200",flex:"1 1 auto",children:e(YT,{rootSpan:u})}),e(C,{width:350,padding:"size-200",flex:"none",children:e(XT,{traceId:c,rootSpan:u,index:m})})]})},u.spanId)),t&&e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",padding:"size-200",children:e(me,{})})]})}function n2({traceCount:n,costSummary:a,tokenUsage:l,latencyP50:t,sessionId:i}){var r,s,d,c;return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",gap:"size-400",children:[o(b,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Traces Count"}),e(v,{size:"L",children:n})]}),l!=null?o(b,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Total Tokens"}),e(pc,{tokenCountTotal:l.total,nodeId:i,size:"L"})]}):null,a!=null?o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Cost"}),o(Se,{delay:0,children:[e(Zn,{children:e(v,{size:"L",children:cn(((r=a.total)==null?void 0:r.cost)??0)})}),e(fa,{placement:"bottom",children:e(C,{width:"size-2400",children:o(b,{direction:"column",children:[o(b,{justifyContent:"space-between",children:[e(v,{children:"Prompt Cost"}),e(v,{children:cn(((s=a.prompt)==null?void 0:s.cost)??0)})]}),o(b,{justifyContent:"space-between",children:[e(v,{children:"Completion Cost"}),e(v,{children:cn(((d=a.completion)==null?void 0:d.cost)??0)})]}),o(b,{justifyContent:"space-between",children:[e(v,{children:"Total Cost"}),e(v,{children:cn(((c=a.total)==null?void 0:c.cost)??0)})]})]})})})]})]}):null,t!=null?o(b,{direction:"column",children:[e(v,{elementType:"h3",color:"text-700",children:"Latency P50"}),e(Rn,{latencyMs:t,size:"L"})]}):null]})})}function a2(n){const{sessionId:a}=n,l=T.useLazyLoadQuery(Pp,{id:a,first:Ip},{fetchPolicy:"store-and-network"});if(l.session==null)throw new Error("Session not found");return o("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        height: 100%;
        overflow: hidden;
      `,children:[e(n2,{traceCount:l.session.numTraces??0,costSummary:l.session.costSummary,tokenUsage:l.session.tokenUsage,latencyP50:l.session.latencyP50,sessionId:a}),e(e2,{tracesRef:l.session})]})}function r5(){var r;const n=wn();Xe(n);const{sessionId:a}=on(),l=Me(),{rootPath:t,tab:i}=sr();return e(oe,{isOpen:!0,onOpenChange:s=>{s||l(`${t}/${i}`)},children:e(ae,{variant:"slideover",size:"fullscreen",onOpenChange:s=>{s||l(`${t}/${i}`)},children:e(re,{children:o(ye,{children:[o(fe,{children:[o(he,{children:["Session ID: ",((r=n.session)==null?void 0:r.sessionId)??"--"]}),e(ke,{children:e(be,{slot:"close"})})]}),e(ht,{children:e(a2,{sessionId:a})})]})})})})}function Dp({traceId:n,projectId:a,title:l}){return e(re,{children:({close:t})=>o(ye,{children:[o(fe,{children:[e(he,{children:l}),o(ke,{children:[e(qn,{size:"S",to:`/projects/${a}/traces/${n}`,children:"View Trace in Project"}),e(be,{close:t})]})]}),e(f.Suspense,{fallback:e(me,{}),children:e(uo,{traceId:n,projectId:a})})]})})}const l2=n=>{const a=n;return wa(a.function)?typeof a.function.arguments=="string":!1};function _p({toolCall:n}){const a=f.useMemo(()=>{const{provider:l,validatedToolCall:t}=nu(n);switch(l){case"OPENAI":case"AZURE_OPENAI":return{name:t.function.name,input:t.function.arguments};case"ANTHROPIC":return{name:t.name,input:t.input};case"AWS":return{name:t.toolUse.name,input:t.toolUse.input};case"UNKNOWN":{if(!l2(n))return null;const{json:i}=hn(n.function.arguments);return{name:n.function.name??"",input:wa(i)?i:n.function.arguments}}default:return Ne()}},[n]);return a==null?o(v,{children:["Invalid tool call format: ",JSON.stringify(n)]}):o("pre",{css:K`
        text-wrap: wrap;
        margin: var(--ac-global-dimension-static-size-100) 0;
        margin-block: 0;
      `,children:[a.name,"(",typeof a.input=="string"?a.input:JSON.stringify(a.input,null,2),")"]})}const gd=10,t2=n=>n.examples.reduce((a,l)=>{var g;const{datasetExampleId:t,repetitionNumber:i,experimentRunId:r}=l,{errorMessage:s,content:d,span:c,toolCalls:u}=l.repetition;return{...a,[t]:{...a[t],[i]:{...(g=a[t])==null?void 0:g[i],experimentRunId:r,span:c,content:d,errorMessage:s,toolCalls:u.reduce((p,y)=>(p[y.id]=y,p),{})}}}},{});K`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  height: 100%;
  min-height: 75px;
  .controls {
    transition: opacity 0.2s ease-in-out;
    opacity: 0;
    display: none;
    z-index: 1;
  }
  &:hover .controls {
    opacity: 1;
    display: flex;
    // make them stand out
    button {
      border-color: var(--ac-global-color-primary);
    }
  }
`;K`
  position: absolute;
  top: calc(-1 * var(--ac-global-dimension-static-size-200));
  right: var(--ac-global-dimension-static-size-100);
  display: flex;
  flex-direction: row;
  gap: var(--ac-global-dimension-static-size-100);
`;function go({children:n}){return e("div",{"data-testid":"large-text-wrap",css:K`
        height: 200px;
        overflow-y: auto;
        padding: var(--ac-global-dimension-static-size-200);
      `,children:n})}function i2({getValue:n,collapseSingleKey:a}){const l=n();return e(go,{children:e(il,{json:l,space:2,collapseSingleKey:a})})}function r2({isRunning:n,instanceVariables:a,datasetExampleInput:l}){const t=f.useMemo(()=>wa(l)?l:{},[l]),i=f.useMemo(()=>a.filter(d=>t[d]==null),[t,a]);let r=e(v,{color:"text-500",children:"Ready"}),s=e(v,{color:"text-500",children:"Press run to generate"});return n&&(s=e(M0,{lines:4}),r=e(v,{color:"text-500",children:"Queued"})),i.length>0&&(r=e(v,{color:"danger",children:"Missing variables"}),s=e(so,{children:`Dataset is missing input for variable${i.length>1?"s":""}: ${i.join(", ")}.${Object.keys(t).length>0?` Possible inputs are: ${Object.keys(t).join(", ")}`:" No inputs found in dataset example."}`})),o(te,{children:[e(Gl,{children:r}),e(C,{padding:"size-200",children:s},"content-wrap")]})}function s2({exampleData:n,repetitionNumber:a,setRepetitionNumber:l,totalRepetitions:t,onViewExperimentRunDetailsPress:i,onViewExperimentRunTracePress:r}){var h,k;const{span:s,content:d,toolCalls:c,errorMessage:u,experimentRunId:m}=n,g=s!=null,p=m!=null,y=f.useMemo(()=>o(te,{children:[t>1&&e(ro,{repetitionNumber:a,totalRepetitions:t,setRepetitionNumber:l}),o(Se,{isDisabled:!p,children:[e(fn,{size:"S","aria-label":"View experiment run details",isDisabled:!p,onPress:i,children:e(x,{svg:e(ft,{})})}),o($e,{children:[e(ln,{}),"view experiment run"]})]}),o(Se,{isDisabled:!g,children:[e(fn,{size:"S","aria-label":"View run trace",isDisabled:!g,onPress:()=>{s&&r(s.context.traceId,s.project.id)},children:e(x,{svg:e(yt,{})})}),o($e,{children:[e(ln,{}),"view run trace"]})]})]}),[p,g,a,l,s,t,i,r]);return o(b,{direction:"column",height:"100%",children:[e(Gl,{extra:y,children:s?o(b,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(Rn,{latencyMs:s.latencyMs||0,size:"S"}),e(zi,{tokenCountTotal:s.tokenCountTotal||0,nodeId:s.id}),e($i,{totalCost:((k=(h=s.costSummary)==null?void 0:h.total)==null?void 0:k.cost)||0,spanNodeId:s.id})]}):e(v,{color:"text-500",fontStyle:"italic",children:"Generating..."})}),o(b,{direction:"column",gap:"size-100",children:[u!=null?e(C,{padding:"size-200",children:e(so,{children:u},"error-message")},"error-message-wrap"):null,d!=null?e(go,{children:d},"content"):null,c!=null?e(C,{padding:"size-200",children:Object.values(c).map(S=>S==null?null:e(_p,{toolCall:S},S.id))},"tool-calls-wrap"):null]},"content-wrap")]})}const o2=f.memo(function({isRunning:a,instanceId:l,exampleId:t,instanceVariables:i,datasetExampleInput:r,onViewExperimentRunDetailsPress:s,onViewExperimentRunTracePress:d}){const[c,u]=f.useState(1),m=hl(y=>y.repetitions),g=hl(y=>{var h;return(h=y.exampleResponsesMap[l])==null?void 0:h[t]}),p=f.useMemo(()=>g==null?void 0:g[c],[g,c]);return p==null?e(r2,{isRunning:a,instanceVariables:i,datasetExampleInput:r}):e(s2,{exampleData:p,repetitionNumber:c,totalRepetitions:m,setRepetitionNumber:u,onViewExperimentRunDetailsPress:s,onViewExperimentRunTracePress:d})});function Ap({table:n,virtualizer:a}){const l=n.getRowModel().rows,t=a.getVirtualItems(),i=a.getTotalSize(),r=f.useMemo(()=>i-t.reduce((s,d)=>s+d.size,0),[i,t]);return o("tbody",{children:[t.map((s,d)=>{const c=l[s.index];return e("tr",{style:{height:`${s.size}px`,transform:`translateY(${s.start-d*s.size}px)`},children:c.getVisibleCells().map(u=>e("td",{style:{padding:0,verticalAlign:"top",width:`calc(var(--col-${u.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${u.column.id}-size) * 1px)`,minWidth:0,wordBreak:"break-all"},children:de(u.column.columnDef.cell,u.getContext())},u.id))},c.id)}),e("tr",{children:e("td",{style:{height:`${r}px`,padding:0},colSpan:n.getAllColumns().length})})]})}const d2=f.memo(Ap,(n,a)=>n.table.options.data===a.table.options.data);function c2({datasetId:n,splitIds:a}){var gl;const l=T.useRelayEnvironment(),t=U(z=>z.instances),{baseExperimentId:i,compareExperimentIds:r}=f.useMemo(()=>{const z=t.map(Ie=>Ie.experimentId),[O,...G]=z;return{baseExperimentId:O,compareExperimentIds:G}},[t]),[s,d]=f.useState(null),[c,u]=f.useState(null),m=U(z=>z.allInstanceMessages),g=U(z=>z.templateFormat),p=U(z=>z.updateInstance),y=hl(z=>z.updateExampleData),h=hl(z=>z.setExampleDataForInstance),k=hl(z=>z.resetData),S=hl(z=>z.appendExampleDataToolCallChunk),F=hl(z=>z.appendExampleDataTextChunk),I=hl(z=>z.setRepetitions),L=U(z=>z.repetitions),[,M]=_n(),E=t.some(z=>z.activeRunId!==null),P=Jl(z=>z),_=U(z=>z.markPlaygroundInstanceComplete),D=Pt(),A=Ve(),V=f.useCallback(z=>O=>{var Ie;if(O==null)return;const G=O.chatCompletionOverDataset;switch(G.__typename){case"ChatCompletionSubscriptionExperiment":p({instanceId:z,patch:{experimentId:G.experiment.id},dirty:null});break;case"ChatCompletionSubscriptionResult":if(G.datasetExampleId==null)return;y({instanceId:z,exampleId:G.datasetExampleId,repetitionNumber:G.repetitionNumber??1,patch:{span:G.span,experimentRunId:(Ie=G.experimentRun)==null?void 0:Ie.id}});break;case"ChatCompletionSubscriptionError":if(G.datasetExampleId==null)return;y({instanceId:z,exampleId:G.datasetExampleId,repetitionNumber:G.repetitionNumber??1,patch:{errorMessage:G.message}});break;case"TextChunk":if(G.datasetExampleId==null)return;F({instanceId:z,exampleId:G.datasetExampleId,repetitionNumber:G.repetitionNumber??1,textChunk:G.content});break;case"ToolCallChunk":{if(G.datasetExampleId==null)return;S({instanceId:z,exampleId:G.datasetExampleId,repetitionNumber:G.repetitionNumber??1,toolCallChunk:G});break}case"%other":return;default:return Ne()}},[F,S,y,p]),[j]=T.useMutation(Wg),ce=f.useCallback(z=>(O,G)=>{if(_(z),I(L),G){A({title:"Chat completion failed",message:G[0].message});return}p({instanceId:z,patch:{experimentId:O.chatCompletionOverDataset.experimentId},dirty:null}),h({instanceId:z,data:t2(O.chatCompletionOverDataset)})},[_,A,L,h,I,p]);f.useEffect(()=>{if(!E)return;const{instances:z,streaming:O,updateInstance:G}=D.getState();if(k(),O){const Ie=[];for(const De of z){const{activeRunId:Hn}=De;if(G({instanceId:De.id,patch:{experimentId:null},dirty:null}),Hn===null)continue;const _a={input:Bo({credentials:P,instanceId:De.id,playgroundStore:D,datasetId:n,splitIds:a})},pl={subscription:Gg,variables:_a,onNext:V(De.id),onCompleted:()=>{_(De.id)},onError:yl=>{_(De.id);const It=yc(yl);It!=null&&It.length>0?A({title:"Failed to get output",message:It.join(`
`),expireMs:1e4}):A({title:"Failed to get output",message:yl.message,expireMs:1e4})}};I(L);const Aa=Xt.requestSubscription(l,pl);Ie.push(Aa)}return()=>{for(const De of Ie)De.dispose()}}else{const Ie=[];for(const De of z){const{activeRunId:Hn}=De;if(Hn===null)continue;G({instanceId:De.id,patch:{experimentId:null},dirty:null});const _a={input:Bo({credentials:P,instanceId:De.id,playgroundStore:D,datasetId:n,splitIds:a})},pl=j({variables:_a,onCompleted:ce(De.id),onError(Aa){_(De.id);const yl=je(Aa);yl!=null&&yl.length>0?A({title:"Failed to get output",message:yl.join(`
`),expireMs:1e4}):A({title:"Failed to get output",message:Aa.message,expireMs:1e4})}});Ie.push(pl)}return()=>{for(const De of Ie)De.dispose()}}},[P,n,a,l,j,E,_,A,ce,V,D,L,k,I]);const{dataset:W}=T.useLazyLoadQuery(Hg,{datasetId:n,splitIds:a??null}),Pe=f.useRef(null),{data:ne,loadNext:N,hasNext:B,isLoadingNext:Q}=T.usePaginationFragment(Ug,W),q=f.useMemo(()=>ne.examples.edges.map(z=>{const O=z.example,G=O.revision;return{id:O.id,input:G.input,output:G.output}}),[ne]),ie=f.useMemo(()=>q.map(z=>z.id),[q]),Z=f.useMemo(()=>{var z;return((z=W.latestVersions)==null?void 0:z.edges[0].version.id)??""},[(gl=W.latestVersions)==null?void 0:gl.edges]),ue=f.useMemo(()=>t.map((z,O)=>{const G=er(z,m),Ie=mu({instance:G,templateFormat:g});return{id:`instance-${z.id}`,header:()=>o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(hs,{index:O,size:"XS"}),e("span",{children:"Output"})]}),cell:({row:De})=>e(o2,{instanceId:z.id,exampleId:De.original.id,isRunning:E,instanceVariables:Ie,datasetExampleInput:De.original.input,onViewExperimentRunDetailsPress:()=>{d(De.index)},onViewExperimentRunTracePress:(Hn,_a)=>{u({traceId:Hn,projectId:_a})}}),size:500}}),[E,t,g,m,d]),Ke=[{header:"input",accessorKey:"input",cell:({row:z})=>o(te,{children:[e(Gl,{extra:o(Se,{children:[e(fn,{size:"S","aria-label":"View example details",onPress:()=>{M(O=>(O.set("exampleId",z.original.id),O))},children:e(x,{svg:e(ft,{})})}),o($e,{children:[e(ln,{}),"view example"]})]}),children:e(v,{color:"text-500",css:K`
                  white-space: nowrap;
                `,children:`Example ${z.original.id}`})}),e(go,{children:e(il,{json:z.original.input,disableTitle:!0,space:2,collapseSingleKey:!1})})]}),size:200},{header:"reference output",accessorKey:"output",cell:z=>o(te,{children:[e(Gl,{children:e(v,{color:"text-500",children:"reference output"})}),e(i2,{...z,collapseSingleKey:!0})]}),size:200},...ue],Ce=Qe({columns:Ke,data:q,getCoreRowModel:Be(),columnResizeMode:"onChange"}),w=Ce.getRowModel().rows,$=w.length===0,X=Ms({count:w.length,getScrollElement:()=>Pe.current,estimateSize:()=>310,overscan:5}),pe=f.useCallback(z=>{if(z){const{scrollHeight:O,scrollTop:G,clientHeight:Ie}=z;O-G-Ie<300&&!Q&&B&&N(gd)}},[B,Q,N]),Pn=f.useMemo(()=>{const z=Ce.getFlatHeaders(),O={};for(let G=0;G<z.length;G++){const Ie=z[G];O[`--header-${Ie.id}-size`]=Ie.getSize(),O[`--col-${Ie.column.id}-size`]=Ie.column.getSize()}return O},[Ce.getState().columnSizingInfo,Ce.getState().columnSizing,Ke.length]);return o("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
        height: 100%;
      `,ref:Pe,onScroll:z=>pe(z.target),children:[o("table",{css:K(Kn,ks),style:{...Pn,width:Ce.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:Ce.getHeaderGroups().map(z=>e("tr",{children:z.headers.map(O=>o("th",{style:{width:`calc(var(--header-${O==null?void 0:O.id}-size) * 1px)`},children:[e("div",{children:de(O.column.columnDef.header,O.getContext())}),e("div",{onMouseDown:O.getResizeHandler(),onTouchStart:O.getResizeHandler(),className:`resizer ${O.column.getIsResizing()?"isResizing":""}`})]},O.id))},z.id))}),$?e(Xn,{}):Ce.getState().columnSizingInfo.isResizingColumn?e(d2,{table:Ce,virtualizer:X}):e(Ap,{table:Ce,virtualizer:X})]}),e(oe,{isOpen:s!==null,onOpenChange:z=>{z||d(null)},children:e(ae,{variant:"slideover",size:"fullscreen",children:s!==null&&ie[s]&&i!=null&&dc(r)&&e(io,{datasetId:n,datasetVersionId:Z,selectedExampleIndex:s,selectedExampleId:ie[s],baseExperimentId:i,compareExperimentIds:r,exampleIds:ie,onExampleChange:z=>{z===ie.length-1&&!Q&&B&&N(gd),z>=0&&z<ie.length&&d(z)},openTraceDialog:(z,O)=>{u({traceId:z,projectId:O})}})})}),e(oe,{isOpen:c!==null,onOpenChange:z=>{z||(u(null),M(O=>{const G=new URLSearchParams(O);return G.delete(aa),G},{replace:!0}))},children:e(ae,{variant:"slideover",size:"fullscreen",children:c&&e(Dp,{traceId:c.traceId,projectId:c.projectId,title:"Experiment Run Trace"})})})]})}function u2({datasetId:n,splitIds:a}){const l=U(r=>r.instances),t=l.some(r=>r.activeRunId!=null),i=f.useMemo(()=>l.map(r=>r.experimentId).filter(r=>r!=null),[l]);return o(b,{direction:"column",height:"100%",children:[e(C,{flex:"none",backgroundColor:"dark",paddingX:"size-200",paddingY:"size-100",borderBottomColor:"light",borderBottomWidth:"thin",height:50,children:o(b,{justifyContent:"space-between",alignItems:"center",height:"100%",children:[o(b,{gap:"size-100",alignItems:"center",children:[e(v,{children:"Experiment"}),i.length>0?o(qn,{size:"S",isDisabled:t,leadingVisual:e(x,{svg:t?e(ta,{}):e(R0,{})}),to:`/datasets/${n}/compare?${i.map(r=>`experimentId=${r}`).join("&")}`,children:["View Experiment",l.length>1?"s":""]}):null]}),e(b,{direction:"row",gap:"size-100",alignItems:"center",children:e(Bg,{})})]})}),e(GK,{children:e(c2,{datasetId:n,splitIds:a})})]})}const m2=()=>{const n=U(d=>d.input),a=U(d=>d.instances),l=U(d=>d.allInstanceMessages),t=U(d=>d.templateFormat),i=f.useMemo(()=>a.map(d=>er(d,l)),[a,l]),{variableKeys:r,variablesMap:s}=f.useMemo(()=>gu({instances:i,templateFormat:t,input:n}),[n,i,t]);return{variableKeys:r,variablesMap:s}},g2={lineNumbers:!1,highlightActiveLine:!1,foldGutter:!1,highlightActiveLineGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,defaultKeymap:!1},p2=[qc.lineWrapping,Rs.of([...YS.filter(n=>n.key!=="Mod-Enter")])],y2=({label:n,defaultValue:a,onChange:l})=>{const{theme:t}=ia(),i=f.useRef(a),[r,s]=f.useState(0),[d,c]=f.useState(()=>a);return f.useEffect(()=>{a==null&&(c(""),s(m=>m+1)),i.current=a},[a]),f.useEffect(()=>{c(i.current),s(m=>m+1)},[n]),o("div",{css:ba,children:[e(J,{children:n}),e(Kl,{width:"100%",children:e(Vl,{theme:t==="light"?Ml:Rl,basicSetup:g2,value:d,extensions:p2,onChange:l},r)})]})};function f2(){const{variableKeys:n,variablesMap:a}=m2(),l=U(i=>i.setVariableValue),t=U(i=>i.templateFormat);if(n.length===0){let i="";switch(t){case Yn.FString:{i="{input name}";break}case Yn.Mustache:{i="{{input name}}";break}case Yn.NONE:return null;default:Ne()}return e(C,{padding:"size-100",children:e(b,{direction:"column",justifyContent:"center",alignItems:"center",children:o(v,{color:"text-700",children:["Add variable inputs to your prompt using"," ",e(v,{color:"text-900",children:i})," within your prompt template."]})})})}return e(b,{direction:"column",gap:"size-200",width:"100%",children:n.map((i,r)=>e(y2,{label:i,defaultValue:a[i]??"",onChange:s=>l(i,s)},r))})}const Ep=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ChatCompletionMutationPayload",kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionRepetition",kind:"LinkedField",name:"repetitions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"ChatCompletionToolCall",kind:"LinkedField",name:"toolCalls",plural:!0,selections:[a,{alias:null,args:null,concreteType:"ChatCompletionFunctionCall",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputMutation",selections:l},params:{cacheID:"259654f688f4618f00b667c0a75b02dd",id:null,metadata:{},name:"PlaygroundOutputMutation",operationKind:"mutation",text:`mutation PlaygroundOutputMutation(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    repetitions {
      repetitionNumber
      content
      errorMessage
      span {
        id
      }
      toolCalls {
        id
        function {
          name
          arguments
        }
      }
    }
  }
}
`}}})();Ep.hash="4d687fac3a1b0a13292c96cb6827c1bc";const wp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"chatCompletion",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"content",storageKey:null}],type:"TextChunk",abstractKey:null},{kind:"InlineFragment",selections:[a,{alias:null,args:null,concreteType:"FunctionCallChunk",kind:"LinkedField",name:"function",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null}],storageKey:null}],type:"ToolCallChunk",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"span",plural:!1,selections:[a],storageKey:null}],type:"ChatCompletionSubscriptionResult",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"message",storageKey:null}],type:"ChatCompletionSubscriptionError",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PlaygroundOutputSubscription",selections:l,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PlaygroundOutputSubscription",selections:l},params:{cacheID:"e74612af0887018cc61d185ed2105c5c",id:null,metadata:{},name:"PlaygroundOutputSubscription",operationKind:"subscription",text:`subscription PlaygroundOutputSubscription(
  $input: ChatCompletionInput!
) {
  chatCompletion(input: $input) {
    __typename
    repetitionNumber
    ... on TextChunk {
      content
    }
    ... on ToolCallChunk {
      id
      function {
        name
        arguments
      }
    }
    ... on ChatCompletionSubscriptionResult {
      span {
        id
      }
    }
    ... on ChatCompletionSubscriptionError {
      message
    }
  }
}
`}}})();wp.hash="964992cecd018dc17131050b7553a3d1";const h2=({instance:n,output:a,toolCalls:l,cleanupOutput:t,isDisabled:i})=>{const r=n.id,s=U(d=>d.addMessage);return o(Se,{delay:500,children:[e(R,{size:"S",isDisabled:i,leadingVisual:e(x,{svg:e(xl,{})}),"aria-label":"Move the output message to the end of the prompt",onPress:()=>{if(n.template.__type!=="chat")return;const d=Array.isArray(a)?a:a?[{id:pa(),role:bl("ai"),content:a}]:[];l.length>0&&d.push({id:pa(),role:bl("ai"),toolCalls:Qs({provider:n.model.provider,toolCalls:l.map(c=>{var u;return{...c,function:{...c.function,arguments:((u=hn(c.function.arguments))==null?void 0:u.json)??c.function.arguments}}})})}),s({playgroundInstanceId:r,messages:d}),t()},children:"Prompt"}),o($e,{children:[e(ln,{}),"Move the output message to the end of the prompt"]})]})},Mp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],type:"Span",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RunMetadataFooterQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"5f0974276186eb5032c3aadb289adbe3",id:null,metadata:{},name:"RunMetadataFooterQuery",operationKind:"query",text:`query RunMetadataFooterQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    id
    ... on Span {
      spanId
      trace {
        id
        traceId
        project {
          id
        }
      }
      tokenCountTotal
      latencyMs
      costSummary {
        total {
          cost
        }
      }
    }
  }
}
`}}})();Mp.hash="ea9edc5ec856a42e5e53663d6a570de1";function k2({spanId:n}){var r,s;const[,a]=_n(),l=T.useLazyLoadQuery(Mp,{spanId:n},{fetchPolicy:"store-and-network"});if(!l.span||!l.span.trace||!l.span.trace.project)return null;const{trace:t}=l.span,i=(s=(r=l.span.costSummary)==null?void 0:r.total)==null?void 0:s.cost;return e(C,{borderTopColor:"light",borderTopWidth:"thin",paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:o(b,{direction:"row",gap:"size-200",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Rn,{size:"S",latencyMs:l.span.latencyMs||0}),e(zi,{tokenCountTotal:l.span.tokenCountTotal||0,nodeId:l.span.id,size:"S"}),i!=null&&e($i,{totalCost:i,spanNodeId:l.span.id,size:"S"})]}),o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Xl,{})}),children:"Annotate"}),e(oe,{children:e(ae,{variant:"slideover",size:"S",children:e(mc,{spanNodeId:n,projectId:t.project.id})})})]}),o(se,{onOpenChange:d=>{d||a(c=>(c.delete(aa),c))},children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(yt,{})}),children:"View Trace"}),e(oe,{children:e(ae,{variant:"slideover",size:"fullscreen",children:e(f.Suspense,{fallback:e(me,{}),children:e(Dp,{traceId:t.traceId,projectId:t.project.id,title:"Playground Trace"})})})})]})]})]})})}function b2({index:n,title:a}){return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(hs,{index:n}),e("span",{children:a})]})}const pd=n=>wa(n)&&"id"in n&&(typeof n.id=="string"||typeof n.id=="number")?n.id:wa(n)&&"toolUse"in n&&wa(n.toolUse)&&"toolUseId"in n.toolUse&&(typeof n.toolUse.toolUseId=="string"||typeof n.toolUse.toolUseId=="number")?n.toolUse.toolUseId:JSON.stringify(n);function yd({message:n}){const{role:a,content:l,toolCalls:t}=n,i=ti(a);return o(ee,{title:a,...i,extra:e(Na,{}),children:[l!=null&&!Array.isArray(l)&&e(Cl,{children:l}),t&&t.length>0?t.map(r=>e(C,{paddingX:"size-200",paddingY:"size-200",borderTopWidth:"thin",borderTopColor:"blue-500",children:e(_p,{toolCall:r},pd(r))},`tool-call-${pd(r)}`)):null]})}function S2({output:n,partialToolCalls:a}){return kv(n)?n.map((l,t)=>e(yd,{message:l},t)):typeof n=="string"||a.length>0?e(yd,{message:{id:pa(),content:n??void 0,role:"ai",toolCalls:a}}):"click run to see output"}function v2(n){const a=n.playgroundInstanceId,l=U(N=>N.instances),t=l.find(N=>N.id===a);if(!t)throw new Error(`No instance found for id ${a}`);if(t.template.__type!=="chat")throw new Error("We only support chat templates for now");const i=U(N=>N.streaming),r=Jl(N=>N),s=U(N=>N.instances.findIndex(B=>B.id===a)),{appendRepetitionOutput:d,setSelectedRepetitionNumber:c,setRepetitionSpanId:u,setRepetitionError:m,setRepetitionStatus:g,setRepetitionToolCalls:p,addRepetitionPartialToolCall:y,clearRepetitions:h,markPlaygroundInstanceComplete:k}=U(N=>({appendRepetitionOutput:N.appendRepetitionOutput,setSelectedRepetitionNumber:N.setSelectedRepetitionNumber,setRepetitionSpanId:N.setRepetitionSpanId,setRepetitionError:N.setRepetitionError,setRepetitionStatus:N.setRepetitionStatus,setRepetitionToolCalls:N.setRepetitionToolCalls,addRepetitionPartialToolCall:N.addRepetitionPartialToolCall,clearRepetitions:N.clearRepetitions,markPlaygroundInstanceComplete:N.markPlaygroundInstanceComplete})),S=T.useRelayEnvironment(),F=Pt(),I=Object.keys(t.repetitions).length,L=Object.values(t.repetitions).filter(N=>(N==null?void 0:N.error)!=null).length,M=t.selectedRepetitionNumber,E=t.repetitions[M],P=(E==null?void 0:E.error)??null,_=Object.values((E==null?void 0:E.toolCalls)??{}),D=E==null?void 0:E.spanId,A=(E==null?void 0:E.status)==="finished"&&(E==null?void 0:E.error)==null,[V]=T.useMutation(Ep),j=l.some(N=>N.activeRunId!=null),ce=Ve(),W=f.useCallback(({title:N,message:B,...Q})=>{ce({title:N,message:B,...Q})},[ce]),Pe=f.useCallback(({chatCompletion:N})=>{if(N.__typename==="TextChunk"){const B=N.content;if(B==null||N.repetitionNumber==null)return;g(a,N.repetitionNumber,"streamInProgress"),d(a,N.repetitionNumber,B);return}else if(N.__typename==="ToolCallChunk"){const B=N.id,Q=N.function;if(Q==null||B==null||N.repetitionNumber==null)return;g(a,N.repetitionNumber,"streamInProgress"),y(a,N.repetitionNumber,{id:B,function:{name:Q.name,arguments:Q.arguments}})}if(N.__typename==="ChatCompletionSubscriptionResult"){if(N.repetitionNumber==null)return;g(a,N.repetitionNumber,"finished"),N.span!=null&&u(a,N.repetitionNumber,N.span.id);return}if(N.__typename==="ChatCompletionSubscriptionError"){if(N.repetitionNumber==null)return;g(a,N.repetitionNumber,"finished"),m(a,N.repetitionNumber,{title:"Chat completion failed",message:N.message})}},[y,a,d,u,g,m]),ne=f.useCallback((N,B)=>{if(k(n.playgroundInstanceId),B!=null&&B.length>0){W({title:"Chat completion failed",message:B[0].message});return}F.getState().instances.find(q=>q.id===a)!=null&&N.chatCompletion.repetitions.forEach(q=>{const ie=q.repetitionNumber;g(a,ie,"finished"),q.content!=null&&d(a,ie,q.content),q.toolCalls.length>0&&p(a,ie,[...q.toolCalls]),q.span!=null&&u(a,ie,q.span.id),q.errorMessage!=null&&m(a,ie,{title:"Chat completion failed",message:q.errorMessage})})},[a,k,W,p,F,n.playgroundInstanceId,d,u,g,m]);return f.useEffect(()=>{if(!j)return;const N=Pv({playgroundStore:F,instanceId:a,credentials:r});if(i){const Q={subscription:wp,variables:{input:N},onNext:ie=>{ie&&Pe(ie)},onCompleted:()=>{k(n.playgroundInstanceId)},onError:ie=>{k(n.playgroundInstanceId);const Z=F.getState().instances.find(Ke=>Ke.id===a);Z!=null&&Object.keys(Z.repetitions).forEach(Ke=>{g(a,parseInt(Ke),"finished")});const ue=yc(ie);ue!=null&&ue.length>0?W({title:"Failed to get output",message:ue.join(`
`)}):W({title:"Failed to get output",message:ie.message})}};return Xt.requestSubscription(S,Q).dispose}return V({variables:{input:N},onCompleted:ne,onError(Q){k(n.playgroundInstanceId),h(a);const q=je(Q);q!=null&&q.length>0?W({title:"Failed to get output",message:q.join(`
`)}):W({title:"Failed to get output",message:Q.message})}}).dispose},[r,S,V,a,h,k,W,ne,Pe,j,F,n.playgroundInstanceId,g,i]),e(ee,{title:e(b2,{index:s,title:"Output"}),extra:o(b,{direction:"row",gap:"size-150",alignItems:"center",children:[I>1&&L>0&&o(Se,{children:[e(Zn,{children:e(x,{svg:e(rc,{}),color:"danger"})}),e($e,{children:e(v,{children:`${L} repetition ${L>1?"s":""} failed`})})]}),I>1&&e(ro,{repetitionNumber:M,totalRepetitions:I,setRepetitionNumber:N=>{let B;typeof N=="function"?B=N(M):B=N,c(a,B)}}),e(h2,{isDisabled:!A,output:E==null?void 0:E.output,toolCalls:_,instance:t,cleanupOutput:()=>{h(a)}})]}),children:(()=>{switch(!0){case(E==null?void 0:E.status)==="pending":return e(C,{padding:"size-200",children:e(me,{message:"Running..."})});case P!=null:return e(C,{padding:"size-200",children:e(so,{children:P.message})});default:return o(te,{children:[e(C,{padding:"size-200",children:e(ka,{children:e(S2,{output:(E==null?void 0:E.output)??null,partialToolCalls:_})})}),e(f.Suspense,{children:D?e(k2,{spanId:D}):null})]})}})()})}function F2(){return f.useMemo(()=>window.navigator.userAgent.toLowerCase().includes("mac")?"Cmd":"Ctrl",[])}function C2(){const n=F2(),{runPlaygroundInstances:a,cancelPlaygroundInstances:l}=U(r=>({runPlaygroundInstances:r.runPlaygroundInstances,cancelPlaygroundInstances:r.cancelPlaygroundInstances})),t=U(r=>r.instances.some(s=>s.activeRunId!=null)),i=f.useCallback(()=>{t?l():a()},[t,l,a]);return za("mod+enter",r=>{r.preventDefault(),r.stopPropagation(),i()},{enableOnFormTags:!0,enableOnContentEditable:!0,preventDefault:!0}),e(R,{variant:"primary",leadingVisual:e(x,{svg:t?e(ta,{}):e(Qa,{})}),size:"S",onPress:()=>{i()},trailingVisual:o(sc,{children:[e(Nr,{children:n}),e("span",{"aria-hidden":"true",children:n==="Cmd"?"":"Ctrl"}),e(Nr,{children:"enter"}),e("span",{"aria-hidden":"true",children:""})]}),children:t?"Cancel":"Run"})}const Rp=(function(){var n=[{kind:"Literal",name:"first",value:200}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i=[t],r={alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},d=[t,l];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptMenuQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,t,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:i,storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:"versions",args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,s,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:i,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptMenuQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,t,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:d,storageKey:null},{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:"versions",args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,r,s,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:d,storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}]},params:{cacheID:"528cfb72f1c787b0a4c9ce3696523cd0",id:null,metadata:{},name:"PromptMenuQuery",operationKind:"query",text:`query PromptMenuQuery {
  prompts(first: 200) {
    edges {
      prompt: node {
        __typename
        id
        name
        versionTags {
          name
          id
        }
        promptVersions {
          versions: edges {
            version: node {
              id
              createdAt
              description
              tags {
                name
                id
              }
            }
          }
        }
      }
    }
  }
}
`}}})();Rp.hash="a739bf4cee03ddc8be384fad0ec18af7";const K2=n=>n.map(({prompt:a})=>{var l;return{type:"prompt",id:a.id,name:a.name,tags:((a==null?void 0:a.versionTags)??[]).map(t=>({type:"tag",id:t.name,name:t.name}))||[],versions:(((l=a==null?void 0:a.promptVersions)==null?void 0:l.versions)??[]).map(({version:t})=>({type:"version",id:t.id,name:t.id,createdAt:t.createdAt,description:t.description||void 0,tags:t.tags.map(i=>({type:"tag",id:i.name,name:i.name}))||[]}))}}),T2=({value:n,onChange:a,...l})=>{const{fullTimeFormatter:t}=kn(),{promptId:i,promptVersionId:r,promptTagName:s}=n||{},d=r?`PromptMenu:${i}:${r}`:i??void 0,c=T.useLazyLoadQuery(Rp,{},{fetchPolicy:"store-and-network",fetchKey:d}),{contains:u}=Zt({sensitivity:"base"}),m=c.prompts.edges,g=f.useMemo(()=>m.flatMap(({prompt:F})=>F.promptVersions.versions.map(({version:I})=>({promptId:F.id,promptName:F.name,versionId:I.id,tags:I.tags.map(L=>L.name)||[]}))),[m]),p=f.useMemo(()=>K2(m),[m]),y=f.useMemo(()=>s?g.find(F=>F.promptId===i&&F.versionId===r&&F.tags.includes(s)):r?g.find(F=>F.versionId===r&&F.promptId===i):g.find(F=>F.promptId===i),[i,r,g,s]),h=y!=null&&y.promptId?[y.promptId]:void 0,k=y!=null&&y.versionId?[y.versionId]:void 0,S=y!=null&&y.tags.includes(s)?[s]:void 0;return o(la,{children:[e(R,{trailingVisual:e(na,{}),size:"S",children:y?o(b,{alignItems:"center",children:[y.promptName,S?o(v,{color:"text-300",children:["@"," ",e(Hr,{children:S[0]})]}):o(v,{color:"text-300",children:["@ ",e(fd,{id:y.versionId})]})]}):e(v,{color:"text-300",children:"Select a prompt"})}),e(wr,{children:o(Fl,{filter:u,children:[e(zt,{children:o(st,{"aria-label":"Search",autoFocus:!0,children:[e(cr,{}),e(ge,{placeholder:"Search prompts"})]})}),e($n,{...l,selectionMode:"single",selectedKeys:h,items:p,renderEmptyState:()=>"No prompts found",children:function({id:I,name:L,versions:M,tags:E}){return o(Oc,{children:[e(Oe,{children:L}),e(wr,{placement:"end top",shouldFlip:!0,offset:4,children:o(jn,{defaultSelectedKey:S&&((E==null?void 0:E.length)??0)>0?"tags":"versions",children:[o(On,{children:[e(ve,{id:"versions",children:"Versions"}),e(ve,{id:"tags",children:"Tags"})]}),e(Re,{id:"versions",children:o(Fl,{filter:u,children:[e(zt,{children:o(st,{"aria-label":"Search",autoFocus:!0,children:[e(cr,{}),e(ge,{placeholder:"Search prompt versions"})]})}),e($n,{items:M,renderEmptyState:()=>e(C,{padding:"size-200",children:e(v,{color:"text-700",children:"No prompt versions found"})}),selectionMode:"single",selectedKeys:k,onSelectionChange:P=>{const _=P instanceof Set?P.values().next().value:null;a(_==null?{promptId:null,promptVersionId:null,promptTagName:null}:{promptId:I,promptVersionId:_,promptTagName:null})},children:({createdAt:P,name:_,description:D})=>e(Oe,{textValue:`${_}
${D}
${P}`,children:o(b,{direction:"column",gap:"size-100",children:[e(mn,{maxWidth:"100%",children:D?e(v,{children:D}):e(v,{fontStyle:"italic",color:"text-300",children:"No change description"})}),o(b,{alignItems:"center",gap:"size-100",children:[e(fd,{id:_,textProps:{size:"S"}}),P&&e(v,{size:"XS",color:"text-300",children:t(new Date(P))})]})]})})})]})}),e(Re,{id:"tags",children:o(Fl,{filter:u,children:[e(zt,{children:o(st,{"aria-label":"Search",autoFocus:!0,children:[e(cr,{}),e(ge,{placeholder:"Search prompt tags"})]})}),e($n,{items:E,renderEmptyState:()=>e(C,{padding:"size-200",children:e(v,{color:"text-700",children:"No prompt tags found"})}),selectionMode:"single",selectedKeys:(y==null?void 0:y.promptId)===I?S:void 0,onSelectionChange:P=>{const _=P instanceof Set?P.values().next().value:null;a(_==null?{promptId:null,promptVersionId:null,promptTagName:null}:{promptId:I,promptTagName:_,promptVersionId:null})},children:({name:P})=>e(Oe,{textValue:P,children:e(Hr,{children:P})})})]})})]})})]})}})]})})]})};function fd({id:n,length:a=6,textProps:l}){const t=f.useMemo(()=>n.length<=a?n:n.slice(a*-1),[n,a]);return e(v,{title:n,css:K`
        text-decoration: underline;
        text-underline-offset: 4px;
        font-family: monospace;
      `,...l,children:t})}const Vp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPromptVersion",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogUpdateMutation",selections:l},params:{cacheID:"fcdfc8d4bea005817cf45298e5122ee8",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogUpdateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogUpdateMutation(
  $input: CreateChatPromptVersionInput!
) {
  createChatPromptVersion(input: $input) {
    id
    name
    version {
      id
    }
  }
}
`}}})();Vp.hash="0a15550cdbc5a206561a299196c7aacb";const Np=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Prompt",kind:"LinkedField",name:"createChatPrompt",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[a],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"UpsertPromptFromTemplateDialogCreateMutation",selections:l,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"UpsertPromptFromTemplateDialogCreateMutation",selections:l},params:{cacheID:"ed384aa4423c1f5fccce6611d269d532",id:null,metadata:{},name:"UpsertPromptFromTemplateDialogCreateMutation",operationKind:"mutation",text:`mutation UpsertPromptFromTemplateDialogCreateMutation(
  $input: CreateChatPromptInput!
) {
  createChatPrompt(input: $input) {
    id
    name
    version {
      id
    }
  }
}
`}}})();Np.hash="80098dd0b05cefab137107fe4c143c02";const zp=(function(){var n=[{alias:null,args:[{kind:"Literal",name:"first",value:200}],concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SavePromptFormQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SavePromptFormQuery",selections:n},params:{cacheID:"f58ec0bbc09a5d215619bb7bd5c9b2e2",id:null,metadata:{},name:"SavePromptFormQuery",operationKind:"query",text:`query SavePromptFormQuery {
  prompts(first: 200) {
    edges {
      prompt: node {
        id
        name
      }
    }
  }
}
`}}})();zp.hash="f06c29d4c5318f96e838ba5f392cccf3";const $p=(function(){var n=[{alias:null,args:[{kind:"Literal",name:"first",value:200}],concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"prompts(first:200)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptComboBoxQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptComboBoxQuery",selections:n},params:{cacheID:"8dddcd4c6c884248b53dbaf0a625c335",id:null,metadata:{},name:"PromptComboBoxQuery",operationKind:"query",text:`query PromptComboBoxQuery {
  prompts(first: 200) {
    edges {
      prompt: node {
        __typename
        id
        name
      }
    }
  }
}
`}}})();$p.hash="42af63a75d1f1b2184518e94395121cd";function P2({onChange:n,promptId:a,...l}){const i=T.useLazyLoadQuery($p,{},{fetchPolicy:"store-and-network",fetchKey:a??void 0}).prompts.edges,r=f.useMemo(()=>i.map(s=>s.prompt),[i]);return e(Ma,{size:"M","data-testid":"prompt-picker",selectedKey:a??null,"aria-label":"prompt picker",width:"100%",menuTrigger:"focus",stopPropagation:!0,defaultItems:r,placeholder:"Select a prompt...",renderEmptyState:()=>e("div",{children:"No prompts found"}),onSelectionChange:s=>{if(!(typeof s!="string"&&s!=null)){if(s===a){n(null);return}n(s)}},...l,children:s=>e(qe,{textValue:s.name,id:s.id,children:s.name},s.id)})}function I2({onCreate:n,onUpdate:a,isSubmitting:l=!1,defaultSelectedPromptId:t,onClose:i}){var I,L,M,E;const r=T.useLazyLoadQuery(zp,{},{fetchPolicy:"network-only"}),[s,d]=f.useState(t??null),c=(L=(I=r==null?void 0:r.prompts)==null?void 0:I.edges)==null?void 0:L.find(P=>{var _;return((_=P==null?void 0:P.prompt)==null?void 0:_.id)===s}),[u,m]=f.useState(((M=c==null?void 0:c.prompt)==null?void 0:M.name)??""),g=c?"update":"create",p=g==="create"?"Create Prompt":"Update Prompt",{control:y,handleSubmit:h,formState:{isDirty:k,isValid:S}}=sn({values:{promptId:s??void 0,name:g==="update"&&c?(E=c==null?void 0:c.prompt)==null?void 0:E.name:u},defaultValues:{description:"",metadata:"{}"},mode:"onChange",resetOptions:{keepDefaultValues:!0}}),F=f.useCallback(P=>{g==="create"?n(P,i):a(P,i)},[n,a,g,i]);return o(b,{direction:"column",gap:"size-100",children:[e(C,{paddingX:"size-200",paddingTop:"size-200",children:e(H,{name:"name",control:y,rules:{validate:ao},render:({field:{onBlur:P,onChange:_},fieldState:D})=>{var A;return e(P2,{label:"Prompt",description:"The prompt to update, or prompt name to create",placeholder:"Select or enter new prompt name",isRequired:!0,onBlur:P,defaultInputValue:u,onInputChange:V=>{m(V),_(V)},errorMessage:(A=D.error)==null?void 0:A.message,allowsCustomValue:!0,onChange:V=>{_(V),d(V)},promptId:s})}})}),o(bn,{onSubmit:h(F),children:[e(C,{paddingX:"size-200",paddingBottom:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[e(H,{name:"description",control:y,render:({field:{onChange:P,onBlur:_,value:D},fieldState:{invalid:A,error:V}})=>o(Fe,{isInvalid:A,onChange:P,onBlur:_,value:D,size:"S",children:[e(J,{children:g==="create"?"Prompt Description":"Change Description"}),e(Ha,{}),V?e(Ae,{children:V.message}):e(v,{slot:"description",children:g==="create"?"A description of your prompt (optional)":"A description of your changes to the prompt (optional)"})]})}),g==="create"&&e(H,{name:"metadata",control:y,rules:{validate:P=>!P||P.trim()===""||ma(P)?!0:"metadata must be a valid JSON object"},render:({field:{onChange:P,onBlur:_,value:D},fieldState:{error:A}})=>e(ds,{label:"Metadata",errorMessage:A==null?void 0:A.message,description:"A JSON object containing metadata for the prompt (optional)",children:e(En,{value:D,onChange:P,onBlur:_})})})]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{variant:k?"primary":"default",size:"S",isDisabled:l||!S,type:"submit",children:p})})})]})]})}const hd=(n,a)=>{const l=a.getState(),t=l.allInstanceMessages,i=l.instances.find(c=>c.id===n);if(!i)throw new Error(`Instance ${n} not found`);const r=er(i,t),s=kK(r);if(!s)throw new Error(`Could not convert instance ${n} to prompt`);const d=l.templateFormat;return{promptInput:s,templateFormat:d}},x2=({instanceId:n,selectedPromptId:a})=>{const l=Me(),t=Le(),i=Ve(),r=Pt(),[s,d]=T.useMutation(Np),[c,u]=T.useMutation(Vp),m=f.useCallback((y,h,k)=>{const S=r.getState();S.instances.find(I=>I.id===n)&&S.updateInstance({instanceId:n,patch:{prompt:{id:y,name:h,version:k,tag:null}},dirty:!1})},[r,n]),g=f.useCallback((y,h)=>{const{promptInput:k,templateFormat:S}=hd(n,r);let F=null;if(y.metadata&&y.metadata.trim()!=="")try{F=JSON.parse(y.metadata)}catch{i({title:"Invalid metadata",message:"Failed to parse metadata as JSON"});return}s({variables:{input:{name:y.name,description:y.description,metadata:F,promptVersion:{...k,templateFormat:S}}},onCompleted:I=>{t({title:"Prompt successfully created",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${I.createChatPrompt.id}`)}}}),m(I.createChatPrompt.id,I.createChatPrompt.name,I.createChatPrompt.version.id),h()},onError:I=>{const L=je(I);i({title:"Error creating prompt",message:L==null?void 0:L[0]})}})},[s,n,l,i,t,m,r]),p=f.useCallback((y,h)=>{if(!y.promptId)throw new Error("Prompt ID is required");const{promptInput:k,templateFormat:S}=hd(n,r);c({variables:{input:{promptId:y.promptId,promptVersion:{...k,templateFormat:S,description:y.description}}},onCompleted:F=>{t({title:"Prompt successfully updated",action:{text:"View Prompt",onClick:()=>{l(`/prompts/${F.createChatPromptVersion.id}`)}}}),m(F.createChatPromptVersion.id,F.createChatPromptVersion.name,F.createChatPromptVersion.version.id),h()},onError:F=>{const I=je(F);i({title:"Error updating prompt",message:I==null?void 0:I[0]})}})},[n,l,i,t,r,c,m]);return e(re,{children:({close:y})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Create Prompt from Template"}),e(ke,{children:e(be,{})})]}),e(f.Suspense,{fallback:e(me,{}),children:e(I2,{onClose:y,onCreate:g,onUpdate:p,isSubmitting:d||u,defaultSelectedPromptId:a})})]})})},Op={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelConfigButtonDialogQuery",selections:[{args:null,kind:"FragmentSpread",name:"ModelProviderSelectFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelConfigButtonDialogQuery",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}]},params:{cacheID:"f6e033b9adc17b674922615d30065fbc",id:null,metadata:{},name:"ModelConfigButtonDialogQuery",operationKind:"query",text:`query ModelConfigButtonDialogQuery {
  ...ModelProviderSelectFragment
}

fragment ModelProviderSelectFragment on Query {
  modelProviders {
    key
    name
    dependenciesInstalled
    dependencies
  }
}
`}};Op.hash="83e31e404724e5fcdf80a5361325f537";function L2(n){const a=n.trim();if(!a.startsWith("{")||!a.endsWith("}")||/[{}[\]]/.test(a.slice(1,-1)))return null;const t=a.match(/"([^"\\]|\\.)*"\s*:/g);if(!t)return null;const i=t.map(d=>{const c=d.slice(0,d.indexOf(":"));try{return JSON.parse(c)}catch{return c}}),r=new Set;for(const d of i){if(r.has(d))return"Duplicate keys found in JSON object";r.add(d)}const s=new Set;for(const d of i){const c=d.toLowerCase();if(s.has(c))return"Duplicate header names found (header names are case-insensitive)";s.add(c)}return null}const D2=/^[A-Za-z0-9!#$%&'*+\-.^_`|~]+$/,_2=/^[\x20-\x7E\t]*$/,A2=["","{}",`{
  
}`],E2=le().min(1,"Header name cannot be empty").regex(D2,"Header name must only contain valid HTTP header characters (letters, numbers, and !#$%&'*+-.^_`|~)"),w2=le().refine(n=>_2.test(n),"Header value must only contain visible ASCII characters"),jp=Sa(E2,w2).describe("HTTP headers as key-value pairs"),M2=ra(jp,{name:"HttpHeaders",definitions:{}}),R2=le().transform((n,a)=>{var i;const l=n.trim();if(A2.includes(l))return null;const t=L2(l);if(t)return a.addIssue({code:Za.custom,message:t}),Xa;try{const r=JSON.parse(l);if(!xa(r))return a.addIssue({code:Za.custom,message:"Must be a valid JSON object"}),Xa;const s=jp.safeParse(r);return s.success?Object.keys(s.data).length>0?s.data:null:(a.addIssue({code:Za.custom,message:((i=s.error.errors[0])==null?void 0:i.message)||"Invalid HTTP headers format"}),Xa)}catch{return a.addIssue({code:Za.custom,message:"Invalid JSON format"}),Xa}}),Nt=1024,V2=Y({type:ca("enabled"),budget_tokens:Ds().min(Nt)}),N2=({onChange:n,value:a})=>{const[l,t]=f.useState(0),r=V2.safeParse(a).data,s=f.useRef(r==null?void 0:r.budget_tokens),d=u=>{n(u?{type:"enabled",budget_tokens:s.current||Nt}:null)},c=u=>{const m=u!=null&&!isNaN(u);s.current=m?u:Nt,n({type:"enabled",budget_tokens:s.current}),m||t(g=>g+1)};return o(te,{children:[e(Il,{onChange:d,isSelected:(r==null?void 0:r.type)==="enabled",children:"Thinking Enabled"}),(r==null?void 0:r.type)==="enabled"&&o(Ya,{value:r==null?void 0:r.budget_tokens,onChange:c,isDisabled:(r==null?void 0:r.type)!=="enabled",isRequired:!0,defaultValue:Nt,minValue:Nt,children:[e(J,{children:"Budget Tokens"}),e(ge,{}),e(v,{slot:"description",children:"Determines how many tokens Claude can use for its internal reasoning process. Must be 1024 and less than max_tokens."})]},l)]})},Tr="__unset__",z2=({value:n,onChange:a,label:l="Thinking Level"})=>o(Dl,{value:typeof n=="string"?n:Tr,onChange:t=>{a(t===Tr?void 0:t)},"aria-label":l,children:[e(J,{children:l}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:o(Bn,{children:[e(dn,{id:Tr,children:e(v,{color:"text-500",fontStyle:"italic",children:"unset"})}),e(dn,{id:"low",children:"low"}),e(dn,{id:"medium",children:"medium"}),e(dn,{id:"high",children:"high"})]})})]}),Pr="__unset__",$2=({value:n,onChange:a,label:l="Reasoning Effort"})=>o(Dl,{value:typeof n=="string"?n:Pr,onChange:t=>{a(t===Pr?void 0:t)},"aria-label":l,children:[e(J,{children:l}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:o(Bn,{children:[e(dn,{id:Pr,children:e(v,{color:"text-500",fontStyle:"italic",children:"unset"})}),e(dn,{id:"none",children:"none"}),e(dn,{id:"minimal",children:"minimal"}),e(dn,{id:"low",children:"low"}),e(dn,{id:"medium",children:"medium"}),e(dn,{id:"high",children:"high"}),e(dn,{id:"xhigh",children:"xhigh"})]})})]});function O2({defaultValue:n,onChange:a,label:l,errorMessage:t}){const[i,r]=f.useState(n==null?"":Ra(n).json??""),s=f.useCallback(d=>{r(d);const{json:c}=hn(d);c==null&&d!==""||a(c)},[a]);return e("div",{css:K`
        & .ac-view {
          width: 100%;
        }
      `,children:o("div",{css:ba,children:[e(J,{children:l}),e(Kl,{children:e(En,{value:i,onChange:s,optionalLint:!0})}),t?e(v,{slot:"errorMessage",color:"danger",children:t}):null]})})}const j2=({field:n,value:a,onChange:l,errors:t,control:i})=>{var g;const r=n.invocationName;if(!r)throw new Error("Invocation name is required");const s=(g=t[r])==null?void 0:g.message,d=n.required?`${n.label||r} is required`:void 0,c=n.minValue!=null?`${n.label||r} must be at least ${n.minValue}`:void 0,u=n.maxValue!=null?`${n.label||r} must be at most ${n.maxValue}`:void 0;if(n.canonicalName==="ANTHROPIC_EXTENDED_THINKING")return e(N2,{onChange:l,value:a});if(n.canonicalName==="REASONING_EFFORT")return n.invocationName==="thinking_level"?e(z2,{onChange:l,value:a??null,label:n.label??void 0}):e($2,{onChange:l,value:a??null,label:n.label??void 0});const{__typename:m}=n;switch(m){case"InvocationParameterBase":return null;case"BoundedFloatInvocationParameter":{const y=typeof a=="number"?a:void 0;return e(Yd,{label:n.label,defaultValue:y,step:.1,minValue:n.minValue,maxValue:n.maxValue,onChange:h=>{if(Array.isArray(h)&&h.length>0)return l(h[0]);l(h)},children:e(ec,{defaultValue:y})})}case"FloatInvocationParameter":case"IntInvocationParameter":return e(H,{control:i,name:r,rules:{required:d,min:c,max:u},render:({field:{onBlur:p}})=>o(Ya,{isRequired:n.required,value:Number(a),onBlur:p,onChange:y=>{l(y)},children:[e(J,{children:n.label}),e(ge,{}),s?e(Ae,{children:s}):null]})});case"StringListInvocationParameter":return!Array.isArray(a)&&a!==void 0?null:e(H,{control:i,name:r,rules:{required:d},render:({field:{onBlur:p}})=>o(Fe,{isRequired:n.required,defaultValue:(a==null?void 0:a.join(", "))??"",onBlur:p,onChange:y=>{if(y===""){l(void 0);return}l(y.split(/, */g))},children:[e(J,{children:n.label}),e(ge,{}),s?e(Ae,{children:s}):e(v,{slot:"description",children:"A comma separated list of strings"})]})});case"StringInvocationParameter":return e(H,{control:i,name:r,rules:{required:d},render:({field:{onBlur:p}})=>o(Fe,{isRequired:n.required,defaultValue:(a==null?void 0:a.toString())||"",type:"text",onBlur:p,onChange:y=>{if(y===""){l(void 0);return}l(y)},children:[e(J,{children:n.label}),e(ge,{}),s?e(Ae,{children:s}):null]})});case"BooleanInvocationParameter":return e(Il,{onChange:l,defaultSelected:!!a,children:n.label});case"JSONInvocationParameter":return e(H,{control:i,name:r,rules:{required:d},render:()=>e(O2,{defaultValue:a,onChange:l,label:n.label??n.invocationName??"",errorMessage:s})});default:return null}},Q2=(n,a)=>{if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return a[Tt(n.invocationInputField)]},B2=(n,a)=>{if(n.invocationName===void 0)throw new Error("Invocation name is required");if(n.invocationInputField===void 0)throw new Error("Invocation input field is required");return{invocationName:n.invocationName,canonicalName:n.canonicalName,dirty:!0,[Tt(n.invocationInputField)]:a}},q2=({instanceId:n})=>{const a=U(y=>y.instances.find(h=>h.id===n));if(!a)throw new Error("Instance not found");const{model:l}=a,t=U(y=>y.upsertInvocationParameterInput),i=U(y=>y.deleteInvocationParameterInput),r=a.model.supportedInvocationParameters,s=a.model.invocationParameters,d=f.useCallback((y,h)=>{if(!y.invocationName)throw new Error("Invocation name is required");h===void 0?i({instanceId:n,invocationParameterInputInvocationName:y.invocationName}):t({instanceId:n,invocationParameterInput:B2(y,h)})},[n,t,i]),c=f.useMemo(()=>r.filter(y=>!(y.canonicalName!=null&&p1.includes(y.canonicalName))).reduce((y,h)=>{const k=s.find(F=>Oa(F,h)),S=k?Q2(h,k):void 0;return{...y,[h.invocationName]:S??null}},{}),[s,r]),u=sn({values:c,mode:"onBlur",delayError:0,shouldFocusError:!1,resetOptions:{keepErrors:!0}}),m=u.trigger,g=f.useMemo(()=>va.debounce(m,250),[m]);return f.useEffect(()=>{g()},[c,g]),l.provider!=="AZURE_OPENAI"&&l.modelName===null?null:Object.entries(c).map(([y,h])=>{const k=r.find(F=>F.invocationName===y);if(!k)return null;const S=`${l.provider??"model"}-${k.invocationName}`;return e(j2,{field:k,value:h,onChange:F=>d(k,F),control:u.control,errors:u.formState.errors},S)})},po=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"providerKey"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"providerKey",variableName:"providerKey"}],kind:"ObjectValue",name:"input"}],concreteType:"PlaygroundModel",kind:"LinkedField",name:"playgroundModels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelComboBoxQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelComboBoxQuery",selections:a},params:{cacheID:"67fe753e1bc2ede814f616699bf7f3bb",id:null,metadata:{},name:"ModelComboBoxQuery",operationKind:"query",text:`query ModelComboBoxQuery(
  $providerKey: GenerativeProviderKey!
) {
  playgroundModels(input: {providerKey: $providerKey}) {
    name
  }
}
`}}})();po.hash="1e812293e1547b594275780290b294be";function U2({onChange:n,modelName:a,queryReference:l,...t}){const i=T.usePreloadedQuery(po,l),r=f.useMemo(()=>i.playgroundModels.map(m=>({name:m.name,id:m.name})),[i.playgroundModels]),[s,d]=f.useState({selectedKey:a??null,inputValue:a??""}),c=m=>{if(typeof m=="string"){const g=r.find(p=>p.id===m);(g==null?void 0:g.name)!=null&&n(g.name)}},u=m=>{d(g=>({inputValue:m,selectedKey:g.selectedKey}))};return f.useEffect(()=>{d({selectedKey:a??null,inputValue:a??""})},[a]),e(Ma,{size:"L",label:"Model",isRequired:!0,"data-testid":"model-picker",selectedKey:s.selectedKey,"aria-label":"model picker",onInputChange:u,inputValue:s.inputValue,onSelectionChange:c,width:"100%",allowsCustomValue:!0,onBlur:()=>{s.inputValue!==""&&n(s.inputValue)},onKeyUp:m=>{m.key==="Enter"&&n(s.inputValue)},menuTrigger:"focus",description:"Choose a model from the list, or enter a custom model name",defaultItems:r,...t,children:m=>e(qe,{textValue:m.name,id:m.id,children:m.name},m.id)})}function Qp(n){const[a,l,t]=T.useQueryLoader(po);return f.useEffect(()=>(l({providerKey:n.provider}),()=>t()),[t,l,n.provider]),a!=null?e(U2,{queryReference:a,...n}):null}const Bp={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelProviderSelectFragment",selections:[{alias:null,args:null,concreteType:"GenerativeProvider",kind:"LinkedField",name:"modelProviders",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"key",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependenciesInstalled",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dependencies",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Bp.hash="fa50b98980c4687ef0574fa47c3ef4be";function H2({onChange:n,query:a,...l}){const t=T.useFragment(Bp,a),i=t.modelProviders.filter(s=>s.dependenciesInstalled),r=l.provider&&!i.some(s=>s.key===l.provider);return wS(Dl,{...l,key:"model-provider-select","data-testid":"model-provider-picker",selectionMode:"single",value:l.provider??void 0,isInvalid:r,"aria-label":"Model Provider",placeholder:"Select a provider",onChange:s=>{const d=s;li(d)&&n(d)}},e(J,{children:"Provider"}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:e(Bn,{children:t.modelProviders.map(s=>e(dn,{id:s.key,textValue:s.name,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(al,{provider:s.key,height:16}),e(v,{children:s.name})]})},s.key))})}),r?e(v,{slot:"errorMessage",color:"danger",children:"Provider not installed"}):null)}const G2=150,W2=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-200);
  .ac-field,
  .ac-dropdown,
  .ac-dropdown-button,
  .ac-slider {
    width: 100%;
  }
  .ac-slider-controls > .ac-slider-track:first-child::before {
    background: var(--ac-global-color-primary);
  }
  padding: var(--ac-global-dimension-size-200);
  overflow: auto;
`;function J2(n){return n==="OPENAI"||n==="OLLAMA"}function Z2({instance:n}){const a=U(r=>r.updateModel),l=f.useCallback(({configKey:r,value:s})=>{a({instanceId:n.id,patch:{...n.model,[r]:s}})},[n.id,n.model,a]),t=f.useMemo(()=>xi(r=>{l({configKey:"modelName",value:r})},250),[l]),i=f.useMemo(()=>xi(r=>{l({configKey:"baseUrl",value:r})},250),[l]);return o(te,{children:[e(Qp,{modelName:n.model.modelName,provider:n.model.provider,onChange:r=>{t(r)}}),o(Fe,{defaultValue:n.model.baseUrl??"",onChange:r=>{i(r)},children:[e(J,{children:"Base URL"}),e(ge,{placeholder:"e.x. https://my-llm.com/v1"})]},"base-url")]})}function X2({instance:n}){const a=U(r=>r.updateModel),l=f.useCallback(({configKey:r,value:s})=>{a({instanceId:n.id,patch:{...n.model,[r]:s}})},[n.id,n.model,a]),t=f.useMemo(()=>xi(r=>{l({configKey:"modelName",value:r})},250),[l]),i=f.useMemo(()=>xi(r=>{l({configKey:"endpoint",value:r})},250),[l]);return o(te,{children:[o(Fe,{defaultValue:n.model.modelName??"",onChange:r=>{t(r)},children:[e(J,{children:"Deployment Name"}),e(ge,{placeholder:"e.x. azure-openai-deployment-name"})]},"model-name"),o(Fe,{defaultValue:n.model.endpoint??"",onChange:r=>{i(r)},children:[e(J,{children:"Endpoint"}),e(ge,{placeholder:"e.x. https://my.openai.azure.com"})]},"endpoint"),e(Ma,{size:"L",label:"API Version","data-testid":"azure-api-version-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api version picker",placeholder:"Select an AzureOpenAI API Version",inputValue:n.model.apiVersion??"",onInputChange:r=>{l({configKey:"apiVersion",value:r})},onSelectionChange:r=>{typeof r=="string"&&l({configKey:"apiVersion",value:r})},allowsCustomValue:!0,children:l1.map(r=>e(qe,{textValue:r,id:r,children:r},r))})]})}function Y2({instance:n}){const a=U(t=>t.updateModel),l=f.useCallback(({configKey:t,value:i})=>{a({instanceId:n.id,patch:{...n.model,[t]:i}})},[n.id,n.model,a]);return o(te,{children:[o(Ma,{size:"L",label:"Region","data-testid":"bedrock-region-combobox",selectedKey:n.model.region??"us-east-1","aria-label":"region picker",isRequired:!0,placeholder:"Select an Amazon Region",inputValue:n.model.region??"us-east-1",onInputChange:t=>{l({configKey:"region",value:t})},onSelectionChange:t=>{typeof t=="string"&&l({configKey:"region",value:t})},allowsCustomValue:!0,children:[e(qe,{textValue:"us-east-1",id:"us-east-1",children:"N. Virginia (us-east-1)"},"us-east-1"),e(qe,{textValue:"us-east-2",id:"us-east-2",children:"Ohio (us-east-2)"},"us-east-2"),e(qe,{textValue:"us-west-1",id:"us-west-1",children:"N. California (us-west-1)"},"us-west-1"),e(qe,{textValue:"us-west-2",id:"us-west-2",children:"Oregon (us-west-2)"},"us-west-2"),e(qe,{textValue:"ap-south-1",id:"ap-south-1",children:"Asia Pacific (Mumbai) (ap-south-1)"},"ap-south-1"),e(qe,{textValue:"ap-northeast-3",id:"ap-northeast-3",children:"Asia Pacific (Osaka) (ap-northeast-3)"},"ap-northeast-3"),e(qe,{textValue:"ap-northeast-2",id:"ap-northeast-2",children:"Asia Pacific (Seoul) (ap-northeast-2)"},"ap-northeast-2"),e(qe,{textValue:"ap-southeast-1",id:"ap-southeast-1",children:"Asia Pacific (Singapore) (ap-southeast-1)"},"ap-southeast-1"),e(qe,{textValue:"ap-southeast-2",id:"ap-southeast-2",children:"Asia Pacific (Sydney) (ap-southeast-2)"},"ap-southeast-2"),e(qe,{textValue:"ap-east-2",id:"ap-east-2",children:"Asia Pacific (Taipei) (ap-east-2)"},"ap-east-2"),e(qe,{textValue:"ap-northeast-1",id:"ap-northeast-1",children:"Asia Pacific (Tokyo) (ap-northeast-1)"},"ap-northeast-1"),e(qe,{textValue:"ca-central-1",id:"ca-central-1",children:"Canada (Central) (ca-central-1)"},"ca-central-1"),e(qe,{textValue:"eu-central-1",id:"eu-central-1",children:"Europe (Frankfurt) (eu-central-1)"},"eu-central-1"),e(qe,{textValue:"eu-west-1",id:"eu-west-1",children:"Europe (Ireland) (eu-west-1)"},"eu-west-1"),e(qe,{textValue:"eu-west-2",id:"eu-west-2",children:"Europe (London) (eu-west-2)"},"eu-west-2"),e(qe,{textValue:"eu-west-3",id:"eu-west-3",children:"Europe (Paris) (eu-west-3)"},"eu-west-3"),e(qe,{textValue:"eu-north-1",id:"eu-north-1",children:"Europe (Stockholm) (eu-north-1)"},"eu-north-1"),e(qe,{textValue:"sa-east-1",id:"sa-east-1",children:"South America (So Paulo) (sa-east-1)"},"sa-east-1")]}),e(Ma,{size:"L",label:"API","data-testid":"bedrock-api-combobox",selectedKey:n.model.apiVersion??void 0,"aria-label":"api picker",isDisabled:!0,placeholder:"Select an Bedrock API",inputValue:"converse",children:e(qe,{textValue:"converse",id:"converse",children:"Converse"},"converse")})]})}const eP=n=>n&&Object.keys(n).length>0?JSON.stringify(n,null,2):`{
  
}`;function nP({instance:n,onErrorChange:a}){const l=U(u=>u.updateModel),{customHeaders:t}=n.model,[i,r]=f.useState(()=>eP(t)),[s,d]=f.useState();f.useEffect(()=>()=>a==null?void 0:a(!1),[a]);const c=f.useCallback(u=>{var g;r(u);const m=R2.safeParse(u);if(m.success)d(void 0),a==null||a(!1),l({instanceId:n.id,patch:{customHeaders:m.data}});else{const p=m.error.errors[0];d((p==null?void 0:p.message)??((g=p==null?void 0:p.path)==null?void 0:g.join("."))??"Invalid headers format"),a==null||a(!0)}},[n.id,l,a]);return e("div",{css:aP,children:o("div",{css:ba,children:[e(J,{children:"Custom Headers"}),e(Kl,{children:e(En,{value:i,onChange:c,jsonSchema:M2,optionalLint:!0,placeholder:'{"X-Custom-Header": "custom-value"}'})}),s?e(v,{slot:"errorMessage",color:"danger",children:s}):null,s?null:e(v,{slot:"description",children:"Custom HTTP headers to send with requests to the LLM provider"})]})})}const aP=K`
  & .ac-view {
    width: 100%;
  }
`;function lP(n){const a=U(r=>r.instances.find(s=>s.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=a.model.supportedInvocationParameters,t=a.model.invocationParameters,i=ku(t,l);return o(se,{children:[e(R,{size:"S",leadingVisual:e(al,{provider:a.model.provider,height:16}),children:o(b,{direction:"row",gap:"size-100",alignItems:"center",height:"100%",children:[e(mn,{maxWidth:G2,children:e(v,{children:a.model.modelName||"--"})}),i?null:o(Se,{delay:0,children:[e("span",{children:e(x,{color:"danger",svg:e(Qt,{})})}),e($e,{children:"Some required invocation parameters are not configured."})]})]})}),e(oe,{children:e(ae,{variant:"slideover",size:"S",children:e(tP,{...n})})})]})}function tP(n){const a=U(d=>d.instances.find(c=>c.id===n.playgroundInstanceId));if(!a)throw new Error(`Playground instance ${n.playgroundInstanceId} not found`);const l=Cn(d=>d.setModelConfigForProvider),t=Le(),[i,r]=f.useState(!1),s=f.useCallback(()=>{const{supportedInvocationParameters:d,...c}=a.model;l({provider:a.model.provider,modelConfig:c}),t({title:"Model Configuration Saved",message:`${Qr[a.model.provider]} model configuration saved as default for later use.`,expireMs:3e3})},[a.model,t,l]);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Model Configuration"}),o(ke,{children:[o(Se,{delay:0,closeDelay:0,children:[e(R,{size:"S",variant:"default",onPress:s,isDisabled:i,leadingVisual:e(x,{svg:e(us,{})}),children:"Save as Default"}),e($e,{placement:"bottom",offset:5,children:i?"Fix custom headers validation errors before saving":`Saves the current configuration as the default for ${Qr[a.model.provider]??"this provider"}.`})]}),e(be,{})]})]}),e(f.Suspense,{children:e(rP,{...n,onCustomHeadersErrorChange:r})})]})})}const iP=f.memo(lP);function rP(n){const{playgroundInstanceId:a,onCustomHeadersErrorChange:l}=n,t=U(p=>p.instances.find(y=>y.id===a));if(!t)throw new Error(`Playground instance ${a} not found`);const i=Cn(p=>p.modelConfigByProvider),r=U(p=>p.updateProvider),s=U(p=>p.updateModel),d=t.model.supportedInvocationParameters,c=t.model.invocationParameters,u=ku(c,d),m=T.useLazyLoadQuery(Op,{}),g=f.useCallback(p=>{s({instanceId:a,patch:{modelName:p}})},[a,s]);return o("form",{css:W2,children:[u?null:o(b,{direction:"row",gap:"size-100",children:[e(x,{color:"danger",svg:e(Qt,{})}),e(v,{color:"danger",children:"Some required invocation parameters are not configured."})]}),e(H2,{provider:t.model.provider,query:m,onChange:p=>{r({instanceId:a,provider:p,modelConfigByProvider:i})}}),J2(t.model.provider)?e(Z2,{instance:t}):t.model.provider==="AZURE_OPENAI"?e(X2,{instance:t}):e(Qp,{modelName:t.model.modelName,provider:t.model.provider,onChange:g}),t.model.provider==="AWS"?e(Y2,{instance:t}):null,e(f.Suspense,{children:e(q2,{instanceId:a})}),t.model.provider!=="GOOGLE"&&e(nP,{instance:t,onErrorChange:l},t.model.provider)]})}const qp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null},l={alias:"floatDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:null,kind:"LinkedField",name:"modelInvocationParameters",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"required",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:[{alias:"booleanDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"minValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxValue",storageKey:null}],type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[l,a],type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"intDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"jsonDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:[{alias:"stringListDefaultValue",args:null,kind:"ScalarField",name:"defaultValue",storageKey:null},a],type:"StringListInvocationParameter",abstractKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ModelSupportedParamsFetcherQuery",selections:t,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ModelSupportedParamsFetcherQuery",selections:t},params:{cacheID:"8f18509b17f3f97c2413ef8b6557d972",id:null,metadata:{},name:"ModelSupportedParamsFetcherQuery",operationKind:"query",text:`query ModelSupportedParamsFetcherQuery(
  $input: ModelsInput!
) {
  modelInvocationParameters(input: $input) {
    __typename
    ... on InvocationParameterBase {
      __isInvocationParameterBase: __typename
      invocationName
      canonicalName
      required
      label
    }
    ... on BooleanInvocationParameter {
      booleanDefaultValue: defaultValue
      invocationInputField
    }
    ... on BoundedFloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
      minValue
      maxValue
    }
    ... on FloatInvocationParameter {
      floatDefaultValue: defaultValue
      invocationInputField
    }
    ... on IntInvocationParameter {
      intDefaultValue: defaultValue
      invocationInputField
    }
    ... on JSONInvocationParameter {
      jsonDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringInvocationParameter {
      stringDefaultValue: defaultValue
      invocationInputField
    }
    ... on StringListInvocationParameter {
      stringListDefaultValue: defaultValue
      invocationInputField
    }
  }
}
`}}})();qp.hash="8bf1a32724929bdc4a02d32809ba59d7";const sP=({instanceId:n})=>{var u;const l=U(m=>m.instances).find(m=>m.id===n);if(!l)throw new Error("Instance not found");const t=l.model.provider,i=l.model.modelName,r=Cn(m=>m.modelConfigByProvider),s=U(m=>m.updateModelSupportedInvocationParameters),{modelInvocationParameters:d}=T.useLazyLoadQuery(qp,{input:{providerKey:t,modelName:i}}),c=(u=l.prompt)==null?void 0:u.id;return f.useEffect(()=>{s({instanceId:n,supportedInvocationParameters:d,modelConfigByProvider:r})},[d,n,s,r,c]),null},Up=n=>a=>a.instances.find(l=>l.id===n),Jr=n=>a=>a.allInstanceMessages[n];function oP({playgroundInstanceId:n,messageId:a}){const l=f.useMemo(()=>Up(n),[n]),t=U(l);if(t==null)throw new Error(`Instance ${n} not found`);const i=t.model.provider,r=Pt(),s=f.useMemo(()=>Jr(a),[a]),d=U(s);if(d==null)throw new Error(`Message ${a} not found`);const c=d.toolCalls,u=U(h=>h.updateMessage),[m,g]=f.useState(()=>JSON.stringify(c,null,2));f.useEffect(()=>{const h=r.getState();if(h.instances.find(L=>L.id===n)==null)return;const S=Jr(a)(h);if(S==null)return;const F=S.toolCalls,I=JSON.stringify(F,null,2);bs({str:I,excludeNull:!0})&&g(I)},[i,r,n,a]);const p=f.useCallback(h=>{const{json:k}=hn(h);u({instanceId:n,messageId:a,patch:{toolCalls:k}})},[n,a,u]),y=f.useMemo(()=>{switch(t.model.provider){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return E1;case"ANTHROPIC":return N1;case"AWS":return M1;case"GOOGLE":return null}},[t.model.provider]);return e(En,{value:m,jsonSchema:y,onChange:p})}function dP(n){return n==="text"||n==="toolCalls"}function cP({messageMode:n,onChange:a}){return o(qt,{selectedKeys:[n],size:"S","aria-label":"Message Mode",onSelectionChange:l=>{if(l.size===0)return;const t=l.keys().next().value;dP(t)&&a(t)},children:[o(Se,{delay:0,children:[e(ga,{"aria-label":"text input",id:"text",children:e(x,{svg:e(ts,{})})}),o($e,{placement:"top",children:[e(ln,{}),"Text input"]})]}),o(Se,{delay:0,children:[e(ga,{"aria-label":"tool calling",id:"toolCalls",children:e(x,{svg:e(is,{})})}),o($e,{placement:"top",children:[e(ln,{}),"Tool calling"]})]})]})}const uP=K`
  .ac-field-label {
    display: none;
  }
`;function mP({role:n,includeLabel:a=!0,onChange:l}){return o(Dl,{value:n,css:a?void 0:uP,"data-testid":"messages-role-picker","aria-label":"Role for the chat message",size:"S",onChange:t=>{if(!du(t))throw new Error(`Invalid chat message role: ${t}`);l(t)},children:[a&&e(J,{children:"Role"}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{placement:"bottom start",offset:4,shouldFlip:!0,containerPadding:8,children:o(Bn,{children:[e(dn,{id:"system",children:"System"}),e(dn,{id:"user",children:"User"}),e(dn,{id:"ai",children:"AI"}),e(dn,{id:"tool",children:"Tool"})]})})]})}const gP=32;function pP({instanceId:n,hasResponseFormat:a}){const l=U(g=>g.instances),t=U(g=>g.updateInstance),i=U(g=>g.addMessage),r=U(g=>g.upsertInvocationParameterInput),s=l.find(g=>g.id===n);if(!s)throw new Error(`Playground instance ${n} not found`);const{template:d}=s;if(d.__type!=="chat")throw new Error(`Invalid template type ${d.__type}`);const c=s.model.supportedInvocationParameters,u=c==null?void 0:c.some(g=>Oa(g,{canonicalName:Gn,invocationName:Wn})),m=c==null?void 0:c.some(g=>Oa(g,{canonicalName:nl,invocationName:dt}));return o(b,{direction:"row",justifyContent:"end",gap:"size-100",minHeight:gP,children:[u?e(R,{size:"S","aria-label":"response format",leadingVisual:e(x,{svg:e(Mn,{})}),isDisabled:a,onPress:()=>{r({instanceId:n,invocationParameterInput:{valueJson:Bv(),invocationName:Wn,canonicalName:Gn}})},children:"Response Format"}):null,m?e(R,{"aria-label":"add tool",size:"S",leadingVisual:e(x,{svg:e(Mn,{})}),onPress:()=>{const g={tools:[...s.tools,vv({provider:s.model.provider,toolNumber:s.tools.length+1})]};if(s.tools.length===0){const p=Ei({toolChoice:"auto",targetProvider:s.model.provider});p&&(g.toolChoice=p)}t({instanceId:n,patch:g,dirty:!0})},children:"Tool"}):null,e(R,{"aria-label":"add message",size:"S",leadingVisual:e(x,{svg:e(Mn,{})}),onPress:()=>{i({playgroundInstanceId:n,messages:[{id:pa(),role:"user",content:""}]})},children:"Message"})]})}const yP=400;function fP({playgroundInstanceId:n}){const a=U(g=>g.deleteInvocationParameterInput),l=U(g=>g.instances.find(p=>p.id===n)),t=l==null?void 0:l.model.provider,i=U(g=>g.upsertInvocationParameterInput);if(!l)throw new Error(`Instance ${n} not found`);const r=l.model.invocationParameters.find(g=>g.invocationName===Wn||g.canonicalName===Gn),[s,d]=f.useState(()=>JSON.stringify((r==null?void 0:r.valueJson)??{},null,2)),c=f.useRef(s),u=Pt();f.useEffect(()=>{const p=u.getState().instances.find(k=>k.id===n);if(p==null)return;const y=p.model.invocationParameters.find(k=>k.invocationName===Wn||k.canonicalName===Gn);if(y==null)return;const h=JSON.stringify(y.valueJson,null,2);bs({str:h,excludeNull:!0})&&d(h)},[t,u,n]);const m=f.useCallback(g=>{c.current=g;const{json:p}=hn(g);i({instanceId:n,invocationParameterInput:{invocationName:Wn,valueJson:p,canonicalName:Gn}})},[n,i]);return e(ee,{title:"Response Format",collapsible:!0,extra:o(b,{direction:"row",gap:"size-100",children:[e(rn,{text:c}),e(R,{"aria-label":"Delete Response Format",leadingVisual:e(x,{svg:e(Tn,{})}),size:"S",onPress:()=>{a({instanceId:n,invocationParameterInputInvocationName:Wn})}})]}),children:e(fc,{preInitializationMinHeight:yP,children:e(En,{value:s,onChange:m,jsonSchema:av})})})}const hP=400;function kP({playgroundInstanceId:n,toolId:a}){const l=Pt(),t=U(h=>h.updateInstance),i=U(h=>h.instances.find(k=>k.id===n));if(i==null)throw new Error(`Playground instance ${n} not found`);const r=i.model.provider,s=i.tools,d=s.find(h=>h.id===a);if(d==null)throw new Error(`Tool ${a} not found`);const[c,u]=f.useState(()=>JSON.stringify(d.definition,null,2)),m=f.useRef(c);f.useEffect(()=>{const k=l.getState().instances.find(I=>I.id===n);if(k==null)return;const S=k.tools.find(I=>I.id===a);if(S==null)return;const F=JSON.stringify(S.definition,null,2);bs({str:F,excludeNull:!0})&&u(F)},[r,l,n,a]);const g=f.useCallback(h=>{m.current=h;const{json:k}=hn(h);t({instanceId:n,patch:{tools:s.map(S=>S.id===d.id?{...S,definition:k}:S)},dirty:!0})},[s,n,d.id,t]),p=f.useMemo(()=>yu(d),[d]),y=f.useMemo(()=>{switch(i.model.provider){case"OPENAI":case"AZURE_OPENAI":case"DEEPSEEK":case"XAI":case"OLLAMA":return f1;case"ANTHROPIC":return h1;case"AWS":return k1;case"GOOGLE":return b1}},[i.model.provider]);return e(ee,{collapsible:!0,backgroundColor:"yellow-100",borderColor:"yellow-700",title:o(b,{direction:"row",gap:"size-100",children:[e(ys,{spanKind:"tool"}),e(v,{children:p??"Tool"})]}),extra:o(b,{direction:"row",gap:"size-100",children:[e(rn,{text:m}),e(R,{"aria-label":"Delete tool",leadingVisual:e(x,{svg:e(Tn,{})}),size:"S",onPress:()=>{const h=s.filter(F=>F.id!==d.id),k=typeof i.toolChoice=="object"&&p!=null&&V0(i.toolChoice)===p;let S=i.toolChoice;h.length===0?S=void 0:k&&(S="auto"),t({instanceId:n,patch:{tools:h,toolChoice:S},dirty:!0})}})]}),children:e(fc,{preInitializationMinHeight:hP,children:e(En,{value:c,onChange:g,jsonSchema:y})})})}function bP(n){const a=n.playgroundInstanceId,l=U(d=>d.instances.find(c=>c.id===n.playgroundInstanceId)),t=U(d=>d.updateInstance);if(l==null)throw new Error(`Playground instance ${a} not found`);const{tools:i}=l;if(i==null)throw new Error(`Playground instance ${a} does not have tools`);const r=f.useMemo(()=>i.map(d=>yu(d)).filter(d=>d!=null),[i]),s=l.model.provider;return N0(s)?e(ee,{title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:["Tools",e(La,{children:i.length})]}),collapsible:!0,children:e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(z0,{provider:s,choice:l.toolChoice,onChange:d=>{t({instanceId:a,patch:{toolChoice:d},dirty:!0})},toolNames:r}),e(b,{direction:"column",gap:"size-200",children:i.map(d=>e(kP,{playgroundInstanceId:a,toolId:d.id},d.id))})]})})}):null}const Hp=1,SP=Hp+1;function vP(n){const a=n.playgroundInstanceId,l=U(g=>g.templateFormat),t=U(g=>g.updateInstance),i=f.useMemo(()=>Up(a),[a]),r=U(i);if(!r)throw new Error(`Playground instance ${a} not found`);const s=r.tools.length>0,d=r.model.invocationParameters.find(g=>Oa(g,{canonicalName:Gn,invocationName:Wn}))!=null,{template:c}=r;if(c.__type!=="chat")throw new Error(`Invalid template type ${c.__type}`);const u=c.messageIds,m=MS($o(OS),$o($S,{coordinateGetter:zS}));return o(NS,{sensors:m,onDragEnd:({active:g,over:p})=>{if(!p||g.id===p.id)return;const y=u.findIndex(S=>S===g.id),h=u.findIndex(S=>S===p.id),k=VS(u,y,h);t({instanceId:a,patch:{template:{__type:"chat",messageIds:k}},dirty:!0})},children:[e(RS,{items:u,children:e("ul",{css:K`
            display: flex;
            flex-direction: column;
            gap: var(--ac-global-dimension-size-100);
          `,children:u.map(g=>e(CP,{playgroundInstanceId:a,templateFormat:l,messageId:g},g))})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",children:e(pP,{instanceId:a,hasResponseFormat:d})}),s||d?o(b,{direction:"column",gap:"size-100",children:[s?e(bP,{...n}):null,d?e(fP,{...n}):null]}):null]})}function FP({message:n,updateMessage:a,templateFormat:l,playgroundInstanceId:t,messageMode:i}){const r=f.useCallback(s=>{a({content:s})},[a]);return i==="toolCalls"?e(C,{paddingTop:"size-100",paddingStart:"size-250",paddingEnd:"size-250",paddingBottom:"size-200",children:o("div",{css:ba,children:[e(J,{children:"Tool Calls"}),e(Kl,{width:"100%",children:e(oP,{playgroundInstanceId:t,messageId:n.id})})]})}):n.role==="tool"?o(bn,{onSubmit:s=>{s.preventDefault()},children:[e(C,{paddingX:"size-200",paddingY:"size-100",borderColor:"yellow-700",borderBottomWidth:"thin",children:e(Fe,{value:n.toolCallId,onChange:s=>a({toolCallId:s}),"aria-label":"Tool Call ID",size:"S",children:e(ge,{placeholder:"Tool Call ID"})})}),e(En,{value:n.content??'""',"aria-label":"tool message content",height:"100%",onChange:s=>a({content:s})})]}):e(Mi,{children:e(Ri,{height:"100%",defaultValue:n.content||"","aria-label":"Message content",templateFormat:l,onChange:r})})}function CP({playgroundInstanceId:n,templateFormat:a,messageId:l}){const t=U(V=>V.updateMessage),i=U(V=>V.deleteMessage),{attributes:r,listeners:s,setNodeRef:d,transform:c,transition:u,setActivatorNodeRef:m,isDragging:g}=jS({id:l}),p=f.useMemo(()=>V=>{var j;return(j=V.instances.find(ce=>ce.id===n))==null?void 0:j.model},[n]),y=U(p);if(!y)throw new Error(`Instance model not found for instance ${n}`);const h=f.useMemo(()=>Jr(l),[l]),k=U(h),S=ti(k.role),F={transform:QS.Translate.toString(c),transition:u,zIndex:g?SP:Hp},I=k.toolCalls!=null&&k.toolCalls.length>0,[L,M]=f.useState(I?"toolCalls":"text"),[E,P]=f.useState(k.content),[_,D]=f.useState(k.toolCalls),A=f.useCallback(V=>{t({instanceId:n,messageId:l,patch:V})},[n,l,t]);return e("li",{ref:d,style:F,children:e(ee,{collapsible:!0,...S,title:e(mP,{includeLabel:!1,role:k.role,onChange:V=>{let j=k.content,ce=k.toolCalls;V!=="ai"&&(ce=void 0,M("text")),V==="tool"&&(j='""'),t({instanceId:n,messageId:l,patch:{role:V,toolCalls:ce,content:j}})}}),extra:o(b,{direction:"row",gap:"size-100",children:[k.role==="ai"?e(cP,{messageMode:L,onChange:V=>{switch(M(V),V){case"text":D(k.toolCalls),t({instanceId:n,messageId:l,patch:{content:E,toolCalls:void 0}});break;case"toolCalls":P(k.content),t({instanceId:n,messageId:l,patch:{content:"",toolCalls:_!=null?Qs({toolCalls:_,provider:y.provider}):[Fv(y.provider)]}});break;default:Ne()}}}):null,e(rn,{text:L==="toolCalls"?Ra(k.toolCalls).json??"":k.content??""}),e(R,{"aria-label":"Delete message",leadingVisual:e(x,{svg:e(Tn,{})}),size:"S",onPress:()=>{i({instanceId:n,messageId:l})}}),e($0,{ref:m,listeners:s,attributes:r})]}),children:e("div",{children:e(FP,{message:k,messageMode:L,playgroundInstanceId:n,templateFormat:a,updateMessage:A})})})})}function KP(n){const a=n.playgroundInstanceId,l=U(S=>S.updateInstance),t=U(S=>S.addMessage),i=U(S=>S.setDirty),r=U(S=>S.instances),s=r.find(S=>S.id===a),d=r.findIndex(S=>S.id===a),c=s==null?void 0:s.prompt,u=c==null?void 0:c.id,m=c==null?void 0:c.version,g=(c==null?void 0:c.tag)??null,p=U(S=>S.dirtyInstances[a]),y=f.useCallback(async({promptId:S,promptVersionId:F,promptTagName:I})=>{if(!S&&!F&&!I){l({instanceId:a,patch:{prompt:null},dirty:!1});return}const L=await wg({promptId:S,promptVersionId:F,tagName:I});L&&(l({instanceId:a,patch:{...L.instance,template:{__type:"chat",messageIds:[]}},dirty:!1}),t({playgroundInstanceId:a,messages:L.instance.template.messages}),i(a,!1))},[a,l,t,i]);if(!s)throw new Error(`Playground instance ${a} not found`);const{template:h}=s,k=f.useMemo(()=>!u||!m?null:{promptId:u,promptVersionId:m,promptTagName:g},[u,m,g]);return o(te,{children:[o(b,{direction:"row",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",marginEnd:"size-100",children:[e(hs,{index:d}),e(T2,{value:k,onChange:y})]}),o(b,{direction:"row",gap:"size-100",children:[e(f.Suspense,{fallback:e("div",{children:e(me,{size:"S"})}),children:e(sP,{instanceId:a})}),e(iP,{...n}),e(PP,{instanceId:a,dirty:p}),r.length>1?e(TP,{...n}):null]})]}),e(C,{paddingY:"size-100",children:h.__type==="chat"?e(f.Suspense,{children:e(vP,{...n})}):"Completion Template"})]})}function TP(n){const a=U(l=>l.deleteInstance);return o(Se,{children:[e(R,{size:"S","aria-label":"Delete this instance of the playground",leadingVisual:e(x,{svg:e(Tn,{})}),onPress:()=>{a(n.playgroundInstanceId)}}),o($e,{children:[e(ln,{}),"Delete this instance of the playground"]})]})}function PP({instanceId:n,dirty:a}){var t;const l=U(i=>i.instances.find(r=>r.id===n));if(!l)throw new Error(`Instance ${n} not found`);return o(se,{children:[e(R,{variant:a?"primary":void 0,size:"S",leadingVisual:e(x,{svg:e(us,{})}),"aria-label":"Save prompt",children:"Save Prompt"}),e(oe,{children:e(ae,{children:e(x2,{instanceId:n,selectedPromptId:(t=l.prompt)==null?void 0:t.id})})})]})}function IP({size:n}){const a=U(t=>t.templateFormat),l=U(t=>t.setTemplateFormat);return e("div",{css:K`
        & * {
          white-space: nowrap;
        }
      `,children:o(qt,{size:n,defaultSelectedKeys:[a],"aria-label":"Template Format",onSelectionChange:t=>{if(t.size===0)return;const i=t.keys().next().value;typeof i=="string"&&O0(i)&&l(i)},children:[e(ga,{"aria-label":"None",id:Yn.NONE,children:"None"}),e(ga,{"aria-label":"Mustache",id:Yn.Mustache,children:"Mustache"}),e(ga,{"aria-label":"F-String",id:Yn.FString,children:"F-String"})]})})}const xP=K`
  display: flex;
  overflow: hidden;
  flex-direction: column;
  height: 100%;
`;function yo(n){const{modelProviders:a}=T.useLazyLoadQuery(Mg,{}),l=Cn(r=>r.modelConfigByProvider),t=Cn(r=>r.playgroundStreamingEnabled);return a.some(r=>r.dependenciesInstalled)?o(KK,{...n,streaming:t,modelConfigByProvider:l,children:[o("div",{css:xP,children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:e(Vi,{title:"Playground",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e($K,{}),e(zK,{}),e(C2,{})]})})}),e(RP,{})]}),e(f.Suspense,{children:e(MK,{})})]}):e(NK,{availableProviders:a})}function LP(){const n=U(i=>i.addInstance),a=U(i=>i.instances),l=a.length,t=a.some(i=>i.activeRunId!=null);return e(R,{size:"S","aria-label":"add prompt",leadingVisual:e(x,{svg:e(xl,{})}),isDisabled:l>=t1||t,onPress:()=>{n()},children:"Compare"})}const DP=K`
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  & > .ac-disclosure-group {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    flex: 1 1 auto;
    & > .ac-disclosure {
      height: 100%;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      overflow-y: hidden;
      flex: 1 1 auto;
      // prevent the accordion item header from growing to fill the accordion item
      // using two selectors as fallback just incase the component lib changes subtly
      & > [role="button"],
      & > #prompts-heading {
        flex: 0 0 auto;
      }
      .ac-disclosure-panel {
        height: 100%;
        overflow: hidden;
        flex: 1 1 auto;
      }
    }
  }
`,_P=K`
  padding: var(--ac-global-dimension-size-200);
  scrollbar-gutter: stable;
  height: 100%;
  flex: 1 1 auto;
  overflow: auto;
  box-sizing: border-box;
`,AP=K`
  height: 100%;
  overflow: auto;
`,EP=632,wP=["prompts"],MP=["input","output"];function RP(){const n=U(g=>g.templateFormat),[a]=_n(),l=a.get("datasetId"),t=a.getAll("splitId"),i=t.length>0?t:void 0,r=l!=null,s=U(g=>g.instances.some(p=>p.activeRunId!=null)),d=U(g=>Object.values(g.dirtyInstances).some(p=>p)),c=U(g=>g.instances.map(p=>p.id),(g,p)=>g.length===p.length&&g.every((y,h)=>y===p[h])),u=f.useCallback(({currentLocation:g,nextLocation:p})=>{const y=g.pathname!==p.pathname;return(s||d)&&y},[s,d]),m=BS(u);return f.useEffect(()=>{const g=s,p=y=>{y.preventDefault(),y.returnValue=!0};if(g)return window.addEventListener("beforeunload",p),()=>{window.removeEventListener("beforeunload",p)}},[s]),o(f.Fragment,{children:[o($a,{direction:"vertical",autoSaveId:"playground-panels",children:[e(An,{children:e("div",{css:DP,children:e(ha,{defaultExpandedKeys:wP,children:o(We,{id:"prompts",size:"L",children:[o(He,{arrowPosition:"start",justifyContent:"space-between",children:["Prompts",e(ja,{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(IP,{size:"S"}),e(LP,{})]})})]}),e(Ge,{children:e("div",{css:_P,children:e(b,{direction:"row",gap:"size-200",maxWidth:"100%",children:c.map(g=>e(C,{flex:"1 1 0px",minWidth:EP,children:e(KP,{playgroundInstanceId:g})},`${g}-prompt`))})})})]})})})}),e(sl,{css:Qi}),e(An,{children:r?e(f.Suspense,{fallback:e(me,{}),children:e(u2,{datasetId:l,splitIds:i})}):e("div",{css:AP,children:o(ha,{defaultExpandedKeys:MP,children:[n!==Yn.NONE?o(We,{id:"input",size:"L",children:[e(He,{arrowPosition:"start",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"space-between",width:"100%",children:["Inputs",e(Bg,{})]})}),e(Ge,{children:e(C,{padding:"size-200",height:"100%",children:e(f2,{})})})]}):null,o(We,{id:"output",size:"L",children:[e(He,{arrowPosition:"start",children:"Output"}),e(Ge,{children:e(C,{padding:"size-200",height:"100%",children:e(b,{direction:"row",gap:"size-200",children:c.map(g=>e(C,{flex:"1 1 0px",children:e(v2,{playgroundInstanceId:g})},`${g}-output`))})})})]})]})})})]}),e(j0,{blocker:m,message:s?"Playground run is still in progress, leaving the page may result in incomplete runs. Are you sure you want to leave?":"You have unsaved changes. Are you sure you want to leave?"})]},"playground-content")}function s5(){const{instanceWithPrompt:n,templateFormat:a}=wn(),{instance:l}=f.useMemo(()=>{const{instance:t}=qs();return{instance:{...t,...n,template:n.template}}},[n]);return e(yo,{instances:[l],templateFormat:a})}const Gp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonSetTagMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:"prompt",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"991a6a38de992c1261cceafe9b2c6850",id:null,metadata:{},name:"TagPromptVersionButtonSetTagMutation",operationKind:"mutation",text:`mutation TagPromptVersionButtonSetTagMutation(
  $input: SetPromptVersionTagInput!
  $promptId: ID!
) {
  setPromptVersionTag(input: $input) {
    query {
      prompt: node(id: $promptId) {
        __typename
        ... on Prompt {
          ...PromptVersionsList__main
        }
        id
      }
    }
  }
}

fragment PromptVersionSummaryFragment on PromptVersion {
  id
  description
  sequenceNumber
  createdAt
  user {
    id
    username
    profilePictureUrl
  }
  ...PromptVersionTagsList_data
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}

fragment PromptVersionsList__main on Prompt {
  promptVersions {
    edges {
      version: node {
        id
        ...PromptVersionSummaryFragment
      }
    }
  }
}
`}}})();Gp.hash="e6cca3095cc459928e5d7ff1e7137a43";const Wp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"},{defaultValue:null,kind:"LocalArgument",name:"versionId"}],a=[{kind:"Variable",name:"id",variableName:"promptId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],i={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:t,storageKey:null}],type:"Prompt",abstractKey:null},r=[{kind:"Variable",name:"id",variableName:"versionId"}],s={kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:t,storageKey:null}],type:"PromptVersion",abstractKey:null},d={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[s],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TagPromptVersionButtonTagsQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,i,l],storageKey:null},{alias:"promptVersion",args:r,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[d,s,l],storageKey:null}]},params:{cacheID:"07290a8880ce785c72cb316417da40f0",id:null,metadata:{},name:"TagPromptVersionButtonTagsQuery",operationKind:"query",text:`query TagPromptVersionButtonTagsQuery(
  $promptId: ID!
  $versionId: ID!
) {
  prompt: node(id: $promptId) {
    __typename
    ... on Prompt {
      versionTags {
        id
        name
      }
    }
    id
  }
  promptVersion: node(id: $versionId) {
    __typename
    ... on PromptVersion {
      tags {
        id
        name
      }
    }
    id
  }
}
`}}})();Wp.hash="6f96cbb8864a597a74d85547a9b49ed0";const Jp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptVersionId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptVersionId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"NewPromptVersionTagDialogMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"setPromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],type:"PromptVersion",abstractKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"bfc7b301944fc8273b56810aa777401c",id:null,metadata:{},name:"NewPromptVersionTagDialogMutation",operationKind:"mutation",text:`mutation NewPromptVersionTagDialogMutation(
  $input: SetPromptVersionTagInput!
  $promptVersionId: ID!
) {
  setPromptVersionTag(input: $input) {
    query {
      node(id: $promptVersionId) {
        __typename
        ...PromptVersionTagsList_data
        id
      }
    }
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}})();Jp.hash="a6e4352854be2ab5fd0c10368a3469ad";function VP({onNewTagCreated:n,promptVersionId:a,onDismiss:l}){const{control:t,handleSubmit:i,formState:{isDirty:r}}=sn({defaultValues:{name:"",description:""},mode:"onChange"}),[s,d]=f.useState(null),[c,u]=T.useMutation(Jp);return e(oe,{children:e(ae,{size:"M",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"New Prompt Tag"}),e(ke,{children:e(be,{onPress:l,slot:"close"})})]}),s?e(Ee,{variant:"danger",banner:!0,children:s}):null,o(bn,{onSubmit:i(g=>{d(null),c({variables:{input:{name:g.name,description:g.description,promptVersionId:a},promptVersionId:a},onCompleted:()=>{n(g),l()},onError:p=>{d(p.message)}})}),children:[o(C,{padding:"size-200",children:[e(H,{name:"name",control:t,rules:{validate:ao},render:({field:{name:g,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,name:g,value:h,children:[e(J,{children:"Tag Name"}),e(ge,{placeholder:"e.x. prod"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The identifier of the tag"})]})}),e(H,{name:"description",control:t,render:({field:{name:g,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,name:g,onBlur:y,value:h,children:[e(J,{children:"Description"}),e(Ha,{placeholder:"A description of the tag"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"A description of the tag (optional)"})]})})]}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopColor:"dark",borderTopWidth:"thin",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(R,{variant:"default",size:"S",onPress:l,isDisabled:u,children:"Cancel"}),e(R,{variant:r?"primary":"default",size:"S",type:"submit",isDisabled:u,children:"Create Tag"})]})})]})]})})})})}function NP(){const[n,a]=f.useState(!1),[l,t]=f.useState(!1),[i,r]=f.useState(0),s=Le(),{promptId:d,versionId:c}=on();if(!d)throw new Error("Expected promptId to be defined");if(!c)throw new Error("Expected versionId to be defined");return o("div",{children:[o(se,{isOpen:n,onOpenChange:a,children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Ql,{})}),css:K`
            text-wrap: nowrap;
          `,children:"Tag Version"}),o(we,{placement:"bottom end",children:[e(_l,{}),o(re,{children:[e(f.Suspense,{fallback:e(C,{padding:"size-100",children:e(me,{size:"S"})}),children:e(zP,{promptId:d,versionId:c,fetchKey:i,onTagSet:u=>{r(m=>m+1),s({title:"Tag Set",message:`The tag ${u} has been set on the version`})}})}),e(C,{padding:"size-100",width:"250px",children:e(R,{leadingVisual:e(x,{svg:e(Mn,{})}),size:"S",css:K`
                  width: 100%;
                `,onPress:()=>{a(!1),t(!0)},children:"New Tag"})})]})]})]}),e(se,{isOpen:l,onOpenChange:u=>{t(u)},children:e(VP,{promptVersionId:c,onDismiss:()=>t(!1),onNewTagCreated:u=>{r(m=>m+1),s({title:"Tag Created",message:`The tag ${u.name} has been created and set on the prompt version`})}})})]})}function zP({promptId:n,versionId:a,fetchKey:l,onTagSet:t}){var m,g;const i=T.useLazyLoadQuery(Wp,{promptId:n,versionId:a},{fetchKey:l,fetchPolicy:"store-and-network"}),r=f.useMemo(()=>{var p,y;return((y=(p=i==null?void 0:i.prompt)==null?void 0:p.versionTags)==null?void 0:y.map(h=>h.name))||[]},[(m=i==null?void 0:i.prompt)==null?void 0:m.versionTags]),s=f.useMemo(()=>{var p,y;return((y=(p=i==null?void 0:i.promptVersion)==null?void 0:p.tags)==null?void 0:y.map(h=>h.name))||[]},[(g=i==null?void 0:i.promptVersion)==null?void 0:g.tags]),d=f.useMemo(()=>Array.from(new Set([...xo.map(p=>p.name),...r])),[r]),[c,u]=T.useMutation(Gp);return e("ul",{children:d.map(p=>{const y=s.includes(p);return e("li",{children:e(C,{paddingY:"size-100",paddingX:"size-200",borderBottomColor:"light",borderBottomWidth:"thin",children:e(ut,{name:p,isSelected:y,isDisabled:y||u,onChange:h=>{if(h){const k=!s.includes(p);let S="";if(k){const F=xo.find(I=>I.name===p);S=(F==null?void 0:F.description)||""}c({variables:{input:{name:p,promptVersionId:a,description:S},promptId:n},onCompleted:()=>{t(p)}})}},children:p})})},p)})})}function o5(){const n=wn();return Xe(n),e($P,{promptVersion:n.promptVersion})}function $P({promptVersion:n}){return e(C,{width:"100%",overflow:"auto",elementType:"section",children:e(C,{padding:"size-200",width:"100%",overflow:"auto",children:o(b,{direction:"column",gap:"size-200",maxWidth:900,marginStart:"auto",marginEnd:"auto",children:[o(b,{direction:"row",justifyContent:"space-between",children:[o(b,{direction:"row",gap:"size-100",children:[o(Te,{level:2,children:["Version:",e("span",{css:K`
                    user-select: all;
                  `,children:n.id})]}),e(Pg,{promptVersion:n})]}),o(b,{direction:"row",gap:"size-100",children:[e(rn,{text:n.id,children:"Version ID"}),e(NP,{}),o(Se,{delay:0,children:[e(Zn,{children:e(qn,{variant:"primary",leadingVisual:e(x,{svg:e(Qa,{})}),to:"playground",size:"S","data-testid":"open-prompt-version-in-playground-button","aria-label":"Open this Prompt version in Playground",children:"Playground"})}),o($e,{children:[e(ln,{}),"Open this Prompt version in Playground"]})]})]})]}),e(hg,{promptVersion:n}),e(cg,{promptVersion:n}),e(Fg,{promptVersion:n})]})})})}const Zp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"invocationParameters",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"modelName",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"definition",storageKey:null}],c={alias:null,args:null,concreteType:"ToolDefinition",kind:"LinkedField",name:"tools",plural:!0,selections:d,storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"toolCallId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptInvocationParameters__main"},{args:null,kind:"FragmentSpread",name:"PromptChatMessagesCard__main"},{args:null,kind:"FragmentSpread",name:"PromptCodeExportCard__main"},{args:null,kind:"FragmentSpread",name:"PromptModelConfigurationCard__main"},{args:null,kind:"FragmentSpread",name:"PromptVersionTagsList_data"},i,r,s,c,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[u],storageKey:null}],type:"PromptVersion",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionLoaderQuery",selections:[{alias:"promptVersion",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[r,{alias:"provider",args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"template",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptMessage",kind:"LinkedField",name:"messages",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"role",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"content",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextContentValue",kind:"LinkedField",name:"text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null}],type:"TextContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolCallContentValue",kind:"LinkedField",name:"toolCall",plural:!1,selections:[m,{alias:null,args:null,concreteType:"ToolCallFunction",kind:"LinkedField",name:"toolCall",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"arguments",storageKey:null},u],storageKey:null}],storageKey:null}],type:"ToolCallContentPart",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"ToolResultContentValue",kind:"LinkedField",name:"toolResult",plural:!1,selections:[m,{alias:null,args:null,kind:"ScalarField",name:"result",storageKey:null}],storageKey:null}],type:"ToolResultContentPart",abstractKey:null}],storageKey:null}],storageKey:null}],type:"PromptChatTemplate",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"template",storageKey:null}],type:"PromptStringTemplate",abstractKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"templateFormat",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"modelProvider",storageKey:null},{alias:null,args:null,concreteType:"ResponseFormat",kind:"LinkedField",name:"responseFormat",plural:!1,selections:d,storageKey:null},c,{alias:"model",args:null,kind:"ScalarField",name:"modelName",storageKey:null},{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"tags",plural:!0,selections:[t,u],storageKey:null},i],type:"PromptVersion",abstractKey:null}],storageKey:null}]},params:{cacheID:"4f37a4d04a5a5999d2f9f42875519473",id:null,metadata:{},name:"promptVersionLoaderQuery",operationKind:"query",text:`query promptVersionLoaderQuery(
  $id: ID!
) {
  promptVersion: node(id: $id) {
    __typename
    id
    ... on PromptVersion {
      ...PromptInvocationParameters__main
      ...PromptChatMessagesCard__main
      ...PromptCodeExportCard__main
      ...PromptModelConfigurationCard__main
      ...PromptVersionTagsList_data
      description
      invocationParameters
      modelName
      tools {
        definition
      }
      tags {
        name
        id
      }
    }
  }
}

fragment PromptChatMessagesCard__main on PromptVersion {
  provider: modelProvider
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            toolCall {
              toolCallId
              toolCall {
                arguments
                name
              }
            }
          }
          ... on ToolResultContentPart {
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateType
  templateFormat
}

fragment PromptCodeExportCard__main on PromptVersion {
  id
  invocationParameters
  modelName
  modelProvider
  responseFormat {
    definition
  }
  tools {
    definition
  }
  template {
    __typename
    ... on PromptChatTemplate {
      messages {
        role
        content {
          __typename
          ... on TextContentPart {
            __typename
            text {
              text
            }
          }
          ... on ToolCallContentPart {
            __typename
            toolCall {
              toolCallId
              toolCall {
                name
                arguments
              }
            }
          }
          ... on ToolResultContentPart {
            __typename
            toolResult {
              toolCallId
              result
            }
          }
        }
      }
    }
    ... on PromptStringTemplate {
      template
    }
  }
  templateFormat
  templateType
}

fragment PromptInvocationParameters__main on PromptVersion {
  invocationParameters
}

fragment PromptLLM__main on PromptVersion {
  model: modelName
  provider: modelProvider
}

fragment PromptModelConfigurationCard__main on PromptVersion {
  model: modelName
  provider: modelProvider
  ...PromptLLM__main
  ...PromptInvocationParameters__main
  ...PromptTools__main
  ...PromptResponseFormatFragment
}

fragment PromptResponseFormatFragment on PromptVersion {
  responseFormat {
    definition
  }
}

fragment PromptTools__main on PromptVersion {
  tools {
    definition
  }
}

fragment PromptVersionTagsList_data on PromptVersion {
  tags {
    id
    name
  }
}
`}}})();Zp.hash="df4fcaf877c81b47d2b61098c91e6771";async function d5(n){const{versionId:a}=n.params;return await T.fetchQuery(ze,Zp,{id:a}).toPromise().catch(()=>{throw new Error("Prompt version not found")})}const Xp=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Literal",name:"first",value:1}],concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"promptVersion",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],storageKey:null}],storageKey:"promptVersions(first:1)"}],type:"Prompt",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"promptVersionsLoaderQuery",selections:[{alias:"prompt",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,l],storageKey:null}]},params:{cacheID:"72451f81ebdef0195b7338c67ae5f327",id:null,metadata:{},name:"promptVersionsLoaderQuery",operationKind:"query",text:`query promptVersionsLoaderQuery(
  $id: ID!
) {
  prompt: node(id: $id) {
    __typename
    ... on Prompt {
      promptVersions(first: 1) {
        edges {
          promptVersion: node {
            id
          }
        }
      }
    }
    id
  }
}
`}}})();Xp.hash="82115f75fbd5968bbe774fb7e006718f";async function c5({params:n}){var r,s,d;if(n.versionId)return null;const l=n.promptId,t=await Xt.fetchQuery(ze,Xp,{id:l}).toPromise();if(!((d=(s=(r=t==null?void 0:t.prompt)==null?void 0:r.promptVersions)==null?void 0:s.edges)!=null&&d.length))throw new Error("Prompt does not have any versions");const i=t.prompt.promptVersions.edges[0].promptVersion;return Pl(`/prompts/${l}/versions/${i.id}`)}const Yp={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsPageContent__main",selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionsList__main"}],type:"Prompt",abstractKey:null};Yp.hash="994c1d93ccbab49fef121d5d73cd2b62";const ey={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionsList__main",selections:[{alias:null,args:null,concreteType:"PromptVersionConnection",kind:"LinkedField",name:"promptVersions",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"PromptVersionSummaryFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null};ey.hash="30cac642c3466fa8405eb71f29d27be3";const OP=K`
  border-bottom: 1px solid var(--ac-global-color-grey-300);
  transition: background-color 0.1s ease-in;

  &[data-active="true"],
  &:hover {
    background-color: var(--ac-global-color-grey-200);
  }

  & > a {
    text-decoration: none;
    color: inherit;
  }
`,jP=({version:n,active:a})=>e("div",{css:OP,"data-active":a,children:e(qS,{to:`${n.id}`,children:e(C,{width:"100%",paddingY:"size-100",paddingX:"size-200",children:e(Ig,{promptVersion:n})})})}),kd=400,QP=({prompt:n,itemActive:a})=>{const{promptVersions:l}=T.useFragment(ey,n);return e(C,{height:"100%",overflow:"auto",width:kd,minWidth:kd,borderRightWidth:"thin",borderColor:"grey-300",children:e(b,{direction:"column",children:l.edges.map(({version:t})=>e(jP,{version:t,active:a==null?void 0:a(t)},t.id))})})};function u5(){const n=no(),l=T.usePreloadedQuery(ir,n.queryRef).prompt,{versionId:t}=on();return e(BP,{prompt:l,promptVersionId:t})}function BP({prompt:n,promptVersionId:a}){const l=T.useFragment(Yp,n),t=f.useCallback(i=>i.id===a,[a]);return e(C,{height:"100%",children:o(b,{direction:"row",height:"100%",children:[e(QP,{prompt:l,itemActive:t}),e(Ue,{})]})})}const ny=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"sessionId"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l=[{alias:"session",args:[{kind:"Variable",name:"sessionId",variableName:"sessionId"}],concreteType:"ProjectSession",kind:"LinkedField",name:"getProjectSessionById",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null},a],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionRedirectLoaderQuery",selections:l,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionRedirectLoaderQuery",selections:l},params:{cacheID:"a29a29b9a8b67c409b791500981cc75d",id:null,metadata:{},name:"sessionRedirectLoaderQuery",operationKind:"query",text:`query sessionRedirectLoaderQuery(
  $sessionId: String!
) {
  session: getProjectSessionById(sessionId: $sessionId) {
    project {
      id
    }
    id
  }
}
`}}})();ny.hash="a47554737ec41a895924c241c035078d";async function m5({params:n}){const{session_id:a}=n;if(!a)throw new Error("Session redirect requires a session ID");const l=await T.fetchQuery(ze,ny,{sessionId:a}).toPromise();if(l!=null&&l.session){const{project:t,id:i}=l.session;return Pl(`/projects/${t.id}/sessions/${i}`)}else throw new Error(`Session with id "${a}" not found`)}const ay=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanOtelId"}],a=[{kind:"Variable",name:"spanId",variableName:"spanOtelId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanRedirectLoaderQuery",selections:[{alias:"span",args:a,concreteType:"Span",kind:"LinkedField",name:"getSpanByOtelId",plural:!1,selections:[l,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t],storageKey:null},i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanRedirectLoaderQuery",selections:[{alias:"span",args:a,concreteType:"Span",kind:"LinkedField",name:"getSpanByOtelId",plural:!1,selections:[l,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,l],storageKey:null},i],storageKey:null}]},params:{cacheID:"2985bb05472ca7556d8aa675123a98e3",id:null,metadata:{},name:"spanRedirectLoaderQuery",operationKind:"query",text:`query spanRedirectLoaderQuery(
  $spanOtelId: String!
) {
  span: getSpanByOtelId(spanId: $spanOtelId) {
    id
    trace {
      traceId
      id
    }
    project {
      id
    }
  }
}
`}}})();ay.hash="a80ec47ffd0bc1b23a4641393a324120";async function g5({params:n}){const{span_otel_id:a}=n;if(!a)throw new Error("Span redirect requires a span ID");const l=await T.fetchQuery(ze,ay,{spanOtelId:a}).toPromise();if(l!=null&&l.span){const{id:t,trace:i,project:r}=l.span;return Pl(`/projects/${r.id}/spans/${i.traceId}?selectedSpanNodeId=${t}`)}else throw new Error(`Span with id "${a}" not found`)}const ly=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"traceOtelId"}],a=[{kind:"Variable",name:"traceId",variableName:"traceOtelId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"traceRedirectLoaderQuery",selections:[{alias:"trace",args:a,concreteType:"Trace",kind:"LinkedField",name:"getTraceByOtelId",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"traceRedirectLoaderQuery",selections:[{alias:"trace",args:a,concreteType:"Trace",kind:"LinkedField",name:"getTraceByOtelId",plural:!1,selections:[t,l],storageKey:null}]},params:{cacheID:"6e8acff3fd035f125c0a261b55f43015",id:null,metadata:{},name:"traceRedirectLoaderQuery",operationKind:"query",text:`query traceRedirectLoaderQuery(
  $traceOtelId: String!
) {
  trace: getTraceByOtelId(traceId: $traceOtelId) {
    project {
      id
    }
    id
  }
}
`}}})();ly.hash="4453100bcd3c636081232e19ee101eb9";async function p5({params:n}){const{trace_otel_id:a}=n;if(!a)throw new Error("Trace redirect requires a trace ID");const l=await T.fetchQuery(ze,ly,{traceOtelId:a}).toPromise();if(l!=null&&l.trace){const{project:t}=l.trace;return Pl(`/projects/${t.id}/traces/${a}`)}else throw new Error(`Trace with id "${a}" not found`)}const ty=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null}],type:"ProjectSession",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"sessionLoaderQuery",selections:[{alias:"session",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"e24902c01f282294437ffeec0084a2af",id:null,metadata:{},name:"sessionLoaderQuery",operationKind:"query",text:`query sessionLoaderQuery(
  $id: ID!
) {
  session: node(id: $id) {
    __typename
    id
    ... on ProjectSession {
      sessionId
    }
  }
}
`}}})();ty.hash="ddb30651beeea59f8543ce916b705810";async function y5(n){const{sessionId:a}=n.params;return await T.fetchQuery(ze,ty,{id:a}).toPromise()}const iy=(function(){var n=[{alias:null,args:null,concreteType:"Functionality",kind:"LinkedField",name:"functionality",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"modelInferences",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"homeLoaderQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"homeLoaderQuery",selections:n},params:{cacheID:"8bfba02258509f0b645b86f3322838d8",id:null,metadata:{},name:"homeLoaderQuery",operationKind:"query",text:`query homeLoaderQuery {
  functionality {
    modelInferences
  }
}
`}}})();iy.hash="a248736e236c8d5348e0ecfbe9440ca2";async function f5(n){const a=await T.fetchQuery(ze,iy,{}).toPromise();return a!=null&&a.functionality.modelInferences?Pl("/model"):Pl("/projects")}const h5=()=>{const n=Ot(a=>a.defaultTab);return e(jc,{to:n,replace:!0})},ry=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l],i=[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"},{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectPageQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:t,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:i,storageKey:null}],storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"bf0392b6f20783d10af768eb720d4918",id:null,metadata:{},name:"ProjectPageQuery",operationKind:"query",text:`query ProjectPageQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    ...StreamToggle_data
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  costSummary(timeRange: $timeRange) {
    total {
      cost
    }
    prompt {
      cost
    }
    completion {
      cost
    }
  }
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}})();ry.hash="f940b0d4a1ccd3cfc8bb67f22cd7ccc2";const sy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"id"},a={defaultValue:null,kind:"LocalArgument",name:"timeRange"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={kind:"Variable",name:"timeRange",variableName:"timeRange"},i=[t],r=[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"ProjectPageHeader_stats"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ProjectPageHeaderQuery",selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:i,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:r,storageKey:null}],storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},t],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"49e1a282fb57987bad425bccba3a60db",id:null,metadata:{},name:"ProjectPageHeaderQuery",operationKind:"query",text:`query ProjectPageHeaderQuery(
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ProjectPageHeader_stats
    id
  }
}

fragment ProjectPageHeader_stats on Project {
  traceCount(timeRange: $timeRange)
  costSummary(timeRange: $timeRange) {
    total {
      cost
    }
    prompt {
      cost
    }
    completion {
      cost
    }
  }
  latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
  latencyMsP99: latencyMsQuantile(probability: 0.99, timeRange: $timeRange)
  spanAnnotationNames
  documentEvaluationNames
  id
}
`}}})();sy.hash="a82020736a81365c539d7d9a31318fa1";const oy=(function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"},a=[n],l=[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{argumentDefinitions:[{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:sy,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ProjectPageHeader_stats",selections:[{alias:null,args:a,kind:"ScalarField",name:"traceCount",storageKey:null},{alias:null,args:a,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:l,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:l,storageKey:null}],storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:"latencyMsP99",args:[{kind:"Literal",name:"probability",value:.99},n],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentEvaluationNames",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null}})();oy.hash="a82020736a81365c539d7d9a31318fa1";const dy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"evaluationName"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"id"}],i=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:i,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DocumentEvaluationSummaryValueQuery",selections:[{alias:null,args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"129953ba27b24f48a92cca26e4b7c447",id:null,metadata:{},name:"DocumentEvaluationSummaryValueQuery",operationKind:"query",text:`query DocumentEvaluationSummaryValueQuery(
  $evaluationName: String!
  $timeRange: TimeRange!
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}})();dy.hash="15d0652aa260c80f62acec943f615d93";const cy={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:dy,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DocumentEvaluationSummaryValueFragment",selections:[{alias:null,args:[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};cy.hash="15d0652aa260c80f62acec943f615d93";const uy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"evaluationName"},{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"evaluationName",variableName:"evaluationName"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DocumentEvaluationSummaryValueFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DocumentEvaluationSummaryQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DocumentEvaluationSummary",kind:"LinkedField",name:"documentEvaluationSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"averageNdcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averagePrecision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanReciprocalRank",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hitRate",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"6f74fa682304c8e322329ebe91d73bf2",id:null,metadata:{},name:"DocumentEvaluationSummaryQuery",operationKind:"query",text:`query DocumentEvaluationSummaryQuery(
  $evaluationName: String!
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ...DocumentEvaluationSummaryValueFragment_1dJL9N
    id
  }
}

fragment DocumentEvaluationSummaryValueFragment_1dJL9N on Project {
  documentEvaluationSummary(evaluationName: $evaluationName, timeRange: $timeRange) {
    averageNdcg
    averagePrecision
    meanReciprocalRank
    hitRate
  }
  id
}
`}}})();uy.hash="6ec982057cc21ad195aa215a2118c5bc";function qP({evaluationName:n}){var i,r;const{projectId:a}=on(),{timeRange:l}=Ut(),t=T.useLazyLoadQuery(uy,{id:a,evaluationName:n,timeRange:{start:(i=l==null?void 0:l.start)==null?void 0:i.toISOString(),end:(r=l==null?void 0:l.end)==null?void 0:r.toISOString()}});return o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:n}),e(f.Suspense,{fallback:e(v,{size:"L",children:"--"}),children:e(UP,{evaluationName:n,project:t==null?void 0:t.project})})]})}function UP(n){var c,u,m;const{project:a}=n,{fetchKey:l}=Nl(),[t,i]=T.useRefetchableFragment(cy,a);f.useEffect(()=>{f.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=(c=t==null?void 0:t.documentEvaluationSummary)==null?void 0:c.averageNdcg,s=(u=t==null?void 0:t.documentEvaluationSummary)==null?void 0:u.averagePrecision,d=(m=t==null?void 0:t.documentEvaluationSummary)==null?void 0:m.hitRate;return e(b,{direction:"row",alignItems:"center",gap:"size-50",height:"28px",children:o(te,{children:[e(ya,{metric:"ndcg",score:r},"ndcg"),e(ya,{metric:"precision",score:s},"precision"),e(ya,{metric:"hit rate",score:d},"hit")]})})}function HP(n){var m,g,p,y,h,k,S,F,I;const{extra:a}=n,{fetchKey:l}=Nl(),[t,i]=T.useRefetchableFragment(oy,n.project);f.useEffect(()=>{f.startTransition(()=>{i({},{fetchPolicy:"store-and-network"})})},[l,i]);const r=t==null?void 0:t.latencyMsP50,s=t==null?void 0:t.latencyMsP99,d=(m=t==null?void 0:t.spanAnnotationNames)==null?void 0:m.filter(L=>L!=="note"),c=t==null?void 0:t.documentEvaluationNames,u=cl();return e(C,{paddingStart:"size-200",paddingEnd:"size-200",paddingTop:"size-200",paddingBottom:"size-50",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e("div",{css:K`
            overflow-x: auto;
            overflow-y: hidden;
            flex: 1 1 auto;
            background-image:
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                var(--ac-global-color-grey-75),
                var(--ac-global-color-grey-75)
              ),
              linear-gradient(
                to right,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              ),
              linear-gradient(
                to left,
                rgba(var(--ac-global-color-grey-300-rgb), 0.9),
                rgba(var(--ac-global-color-grey-300-rgb), 0)
              );
            background-repeat: no-repeat;
            background-size:
              32px 100%,
              32px 100%,
              32px 100%,
              32px 100%;
            background-position:
              left center,
              right center,
              left center,
              right center;
            background-attachment: local, local, scroll, scroll;
          `,children:o(b,{direction:"row",gap:"size-400",alignItems:"center",children:[o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",fontFamily:"mono",children:Ye(t==null?void 0:t.traceCount)})]}),o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Cost"}),o(Se,{delay:0,children:[e(Es,{children:e(v,{size:"L",role:"button",fontFamily:"mono",children:cn(((p=(g=t==null?void 0:t.costSummary)==null?void 0:g.total)==null?void 0:p.cost)??0)})}),o(fa,{placement:"bottom",children:[e(ln,{}),e(C,{width:"size-3600",children:e(uc,{valueLabel:"cost",totalValue:((h=(y=t==null?void 0:t.costSummary)==null?void 0:y.total)==null?void 0:h.cost)??0,formatter:cn,segments:[{name:"Prompt",value:((S=(k=t==null?void 0:t.costSummary)==null?void 0:k.prompt)==null?void 0:S.cost)??0,color:u.category1},{name:"Completion",value:((I=(F=t==null?void 0:t.costSummary)==null?void 0:F.completion)==null?void 0:I.cost)??0,color:u.category2}]})})]})]})]}),o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),r!=null?e(Rn,{latencyMs:r,size:"L"}):e(v,{size:"L",children:"--"})]}),o(b,{direction:"column",flex:"none",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P99"}),s!=null?e(Rn,{latencyMs:s,size:"L"}):e(v,{size:"L",children:"--"})]}),d.map(L=>e(ht,{fallback:Q0,children:e(nT,{annotationName:L},L)},L)),c.map(L=>e(qP,{evaluationName:L},`document-${L}`))]})}),e(C,{flex:"none",paddingStart:"size-100",children:a})]})})}const my=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"StreamToggle_data"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"StreamToggleRefetchQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"70bebe4abe808b13c94decf17c7cd90d",id:null,metadata:{},name:"StreamToggleRefetchQuery",operationKind:"query",text:`query StreamToggleRefetchQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...StreamToggle_data
    id
  }
}

fragment StreamToggle_data on Project {
  streamingLastUpdatedAt
  id
}
`}}})();my.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const gy={argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:my,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"StreamToggle_data",selections:[{alias:null,args:null,kind:"ScalarField",name:"streamingLastUpdatedAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Project",abstractKey:null};gy.hash="30a8f0bcf1aa6021b2c9a47866f5dc49";const GP=2e3,WP=["spans","traces","sessions"];function JP(n){const{isStreaming:a,setIsStreaming:l,setFetchKey:t}=Nl(),r=Ft().pathname.split("/").pop()||"",s=WP.includes(r)&&a,[d,c]=T.useRefetchableFragment(gy,n.project),u=f.useRef(d.streamingLastUpdatedAt),m=f.useCallback(()=>{s&&f.startTransition(()=>{c({},{fetchPolicy:"store-and-network"})})},[s,c]),g=d.streamingLastUpdatedAt;return f.useEffect(()=>{g!=null&&(u.current==null||u.current<g)&&(u.current=g,t(`fetch-traces-${g}`))},[t,g]),B0(m,GP),e(Il,{labelPlacement:"start",isSelected:a,onChange:()=>{l(!a)},children:"Stream"})}const ZP=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`;function k5(){const{projectId:n}=on(),{timeRange:a}=Ut();return e(f.Suspense,{fallback:e(me,{}),children:e(YP,{projectId:n,timeRange:a})})}const XP=["spans","traces","sessions","config","metrics"],bd=n=>XP.includes(n),lt={spans:0,traces:1,sessions:2,metrics:3,config:4};function YP({projectId:n,timeRange:a}){const l=Ot(P=>P.treatOrphansAsRoots),t=f.useMemo(()=>{var P,_;return{start:(P=a==null?void 0:a.start)==null?void 0:P.toISOString(),end:(_=a==null?void 0:a.end)==null?void 0:_.toISOString()}},[a]),i=Me(),{rootPath:r,tab:s}=sr(),d=T.useLazyLoadQuery(ry,{id:n,timeRange:t},{fetchPolicy:"store-and-network",fetchKey:`${n}-${t.start}-${t.end}`}),[c,u,m]=T.useQueryLoader(jm),[g,p,y]=T.useQueryLoader(Qm),[h,k,S]=T.useQueryLoader(Bm),[F,I,L]=T.useQueryLoader(qm),M=bd(s)?lt[s]:0;f.useEffect(()=>(M===lt.spans?p({id:n,timeRange:t,orphanSpanAsRootSpan:l}):M===lt.traces?u({id:n,timeRange:t}):M===lt.sessions?k({id:n,timeRange:t}):M===lt.config&&I({id:n}),()=>{y(),S(),m(),L()}),[u,n,t,M,y,S,m,p,k,I,L,l]);const E=f.useCallback(P=>{f.startTransition(()=>{i(P===1?`${r}/traces`:P===2?`${r}/sessions`:P===3?`${r}/metrics`:P===4?`${r}/config`:`${r}/spans`)})},[i,r]);return e(eT,{children:o("main",{css:ZP,children:[e(HP,{project:d.project,extra:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(JP,{project:d.project}),e(hc,{})]})}),e(Um.Provider,{value:{spansQueryReference:g??null,sessionsQueryReference:h??null,tracesQueryReference:c??null,projectConfigQueryReference:F??null},children:o(jn,{onSelectionChange:P=>{typeof P=="string"&&bd(P)&&E(lt[P])},selectedKey:s,children:[o(On,{children:[e(ve,{id:"spans",children:"Spans"}),e(ve,{id:"traces",children:"Traces"}),e(ve,{id:"sessions",children:"Sessions"}),e(ve,{id:"metrics",children:"Metrics"}),e(ve,{id:"config",children:"Config"})]}),e(Re,{padded:!1,id:"spans",children:e(Ue,{})}),e(Re,{padded:!1,id:"traces",children:e(Ue,{})}),e(Re,{padded:!1,id:"sessions",children:e(Ue,{})}),e(Re,{padded:!1,id:"metrics",children:e(Ue,{})}),e(Re,{padded:!1,id:"config",children:e(Ue,{})})]})})]})})}const py=f.createContext(null);function yy(){const n=f.useContext(py);if(n===null)throw new Error("useSessionSubstring must be used within a SessionSubstringProvider");return n}function eI(n){const[a,l]=f.useState(""),t=f.useCallback(i=>{f.startTransition(()=>{l(i)})},[]);return e(py.Provider,{value:{filterIoSubstringOrSessionId:a,setFilterIoSubstringOrSessionId:t},children:n.children})}const fy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"sessionId"},r={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},s={defaultValue:null,kind:"LocalArgument",name:"timeRange"},d=[{kind:"Variable",name:"id",variableName:"id"}],c={kind:"Variable",name:"after",variableName:"after"},u={kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},m={kind:"Variable",name:"first",variableName:"first"},g={kind:"Variable",name:"sessionId",variableName:"sessionId"},p={kind:"Variable",name:"sort",variableName:"sort"},y={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},S=[c,u,m,g,p,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],F=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],I={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s],kind:"Fragment",metadata:null,name:"SessionsTableQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[c,u,m,g,p],kind:"FragmentSpread",name:"SessionsTable_sessions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,s,t],kind:"Operation",name:"SessionsTableQuery",selections:[{alias:null,args:d,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[y,h,{kind:"InlineFragment",selections:[k,{alias:null,args:null,kind:"ScalarField",name:"sessionAnnotationNames",storageKey:null},{alias:null,args:S,concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"sessions",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[h,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:F,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:F,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectSessionAnnotation",kind:"LinkedField",name:"sessionAnnotations",plural:!0,selections:[h,k,I,L,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},h],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"sessionAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},k],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[h,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[y,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[h,k,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[I,L],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[h],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[y,h],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:S,filters:["sort","filterIoSubstring","timeRange","sessionId"],handle:"connection",key:"SessionsTable_sessions",kind:"LinkedHandle",name:"sessions"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"60c8994f30bf52decf0058d7f3ec3647",id:null,metadata:{},name:"SessionsTableQuery",operationKind:"query",text:`query SessionsTableQuery(
  $after: String = null
  $filterIoSubstring: String = null
  $first: Int = 30
  $sessionId: String = null
  $sort: ProjectSessionSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...SessionsTable_sessions_371pAD
    id
  }
}

fragment SessionAnnotationSummaryGroup on ProjectSession {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  sessionAnnotations {
    id
    name
    label
    score
    annotatorKind
    user {
      username
      profilePictureUrl
      id
    }
  }
  sessionAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SessionColumnSelector_annotations on Project {
  sessionAnnotationNames
}

fragment SessionsTable_sessions_371pAD on Project {
  name
  ...SessionColumnSelector_annotations
  sessions(first: $first, after: $after, sort: $sort, filterIoSubstring: $filterIoSubstring, timeRange: $timeRange, sessionId: $sessionId) {
    edges {
      session: node {
        id
        sessionId
        numTraces
        startTime
        endTime
        firstInput {
          value
        }
        lastOutput {
          value
        }
        tokenUsage {
          total
        }
        traceLatencyMsP50: traceLatencyMsQuantile(probability: 0.5)
        traceLatencyMsP99: traceLatencyMsQuantile(probability: 0.99)
        costSummary {
          total {
            cost
          }
        }
        sessionAnnotations {
          id
          name
          label
          score
          annotatorKind
          user {
            username
            profilePictureUrl
            id
          }
        }
        sessionAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        project {
          id
          annotationConfigs {
            edges {
              node {
                __typename
                ... on AnnotationConfigBase {
                  __isAnnotationConfigBase: __typename
                  annotationType
                }
                ... on CategoricalAnnotationConfig {
                  id
                  name
                  optimizationDirection
                  values {
                    label
                    score
                  }
                }
                ... on Node {
                  __isNode: __typename
                  id
                }
              }
            }
          }
        }
        ...SessionAnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();fy.hash="5b3f781dd578f1b1198e7de5a5daf95d";const hy=(function(){var n=["sessions"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],i={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterIoSubstring"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sessionId"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:fy,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SessionsTable_sessions",selections:[a,{args:null,kind:"FragmentSpread",name:"SessionColumnSelector_annotations"},{alias:"sessions",args:[{kind:"Variable",name:"filterIoSubstring",variableName:"filterIoSubstring"},{kind:"Variable",name:"sessionId",variableName:"sessionId"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"ProjectSessionConnection",kind:"LinkedField",name:"__SessionsTable_sessions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectSessionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"session",args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"sessionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numTraces",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"firstInput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"lastOutput",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TokenUsage",kind:"LinkedField",name:"tokenUsage",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"total",storageKey:null}],storageKey:null},{alias:"traceLatencyMsP50",args:[{kind:"Literal",name:"probability",value:.5}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.5)"},{alias:"traceLatencyMsP99",args:[{kind:"Literal",name:"probability",value:.99}],kind:"ScalarField",name:"traceLatencyMsQuantile",storageKey:"traceLatencyMsQuantile(probability:0.99)"},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProjectSessionAnnotation",kind:"LinkedField",name:"sessionAnnotations",plural:!0,selections:[l,a,i,r,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"sessionAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},i],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[l,a,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[i,r],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"SessionAnnotationSummaryGroup"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ProjectSession",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}})();hy.hash="5b3f781dd578f1b1198e7de5a5daf95d";const ky=f.createContext(null);function nI({children:n,...a}){const[l]=f.useState(()=>a1(a));return e(ky.Provider,{value:l,children:n})}function Fn(n,a){const l=f.useContext(ky);if(!l)throw new Error("Missing TracingContext.Provider in the tree");return Jt(l,n,a)}const by={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SessionColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"sessionAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};by.hash="c7adb0cb468a43dbf739811ff7826066";const aI=["sessionId"];function lI(n){return o(se,{children:[e(R,{trailingVisual:e(na,{}),children:o(b,{alignItems:"center",gap:"size-100",children:[e(x,{svg:e(kc,{})}),"Columns"]})}),e(we,{children:e(tI,{...n})})]})}const Li=K`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function tI(n){const{columns:a}=n,l=Fn(c=>c.columnVisibility),t=Fn(c=>c.setColumnVisibility),i=f.useMemo(()=>a.filter(c=>!aI.includes(c.id)),[a]),r=f.useMemo(()=>i.every(c=>{const u=l[c.id];return u??!0}),[i,l]),s=f.useCallback(c=>{const{name:u,checked:m}=c.target;t({...l,[u]:m})},[l,t]),d=f.useCallback(c=>{const{checked:u}=c.target,m=i.reduce((g,p)=>({...g,[p.id]:u}),{});t(m)},[i,t]);return e("div",{css:K`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:o(C,{padding:"size-50",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:Li,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-all",checked:r,onChange:d}),"session columns"]})})}),e("ul",{children:i.map(c=>{const u=l[c.id],m=u??!0,g=typeof c.columnDef.header=="string"?c.columnDef.header:c.id;return e("li",{css:Li,children:o("label",{children:[e("input",{type:"checkbox",name:c.id,checked:m,onChange:s}),g]})},c.id)})}),e(iI,{...n})]})})}function iI({query:n}){const a=T.useFragment(by,n),l=Fn(s=>s.annotationColumnVisibility),t=Fn(s=>s.setAnnotationColumnVisibility),i=f.useMemo(()=>a.sessionAnnotationNames.every(s=>l[s]||!1),[a.sessionAnnotationNames,l]),r=f.useCallback(()=>{const s=a.sessionAnnotationNames.reduce((d,c)=>({...d,[c]:!i}),{});t(s)},[a.sessionAnnotationNames,t,i]);return o("section",{children:[e(C,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",children:e("div",{css:Li,children:o("label",{children:[e("input",{type:"checkbox",name:"toggle-annotations-all",checked:i,onChange:r}),"annotations"]})})}),e("ul",{children:a.sessionAnnotationNames.map(s=>{const d=l[s]??!1;return e("li",{css:Li,children:o("label",{children:[e("input",{type:"checkbox",name:s,checked:d,onChange:()=>{t({...l,[s]:!d})}}),s]})},s)})})]})}const rI=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,sI=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
    background-color: var(--ac-global-input-field-background-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
  .search-icon {
    margin-left: var(--ac-global-dimension-static-size-100);
    margin-top: var(--ac-global-dimension-static-size-100);
  }
`,oI={lineNumbers:!1,foldGutter:!1,bracketMatching:!1,syntaxHighlighting:!1,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1,searchKeymap:!1};function dI(n){const{placeholder:a="Search messages or session ID"}=n,[l,t]=f.useState(!1),{filterIoSubstringOrSessionId:i,setFilterIoSubstringOrSessionId:r}=yy(),{theme:s}=ia();return e("div",{"data-is-focused":l,className:"sessions-substring-field",css:sI,children:o(b,{direction:"row",children:[e(x,{svg:e(Ss,{}),className:"search-icon"}),e(Vl,{css:rI,indentWithTab:!1,basicSetup:oI,onFocus:()=>t(!0),onBlur:()=>t(!1),value:i,onChange:r,height:"36px",width:"100%",theme:s==="light"?Ml:Rl,placeholder:a}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${i!==""?"visible":"hidden"};
          `,onClick:()=>r(""),className:"button--reset",children:e(x,{svg:e(Bi,{})})})]})})}const cI="pip install openinference-instrumentation",uI=`import uuid

import openai
from openinference.instrumentation import using_session
from openinference.semconv.trace import SpanAttributes
from opentelemetry import trace

client = openai.Client()
session_id = str(uuid.uuid4())

tracer = trace.get_tracer(__name__)

@tracer.start_as_current_span(name="agent", attributes={SpanAttributes.OPENINFERENCE_SPAN_KIND: "agent"})
def assistant(
  messages: list[dict],
  session_id: str = str,
):
  current_span = trace.get_current_span()
  current_span.set_attribute(SpanAttributes.SESSION_ID, session_id)
  current_span.set_attribute(SpanAttributes.INPUT_VALUE, messages[-1].get('content'))

  # Propagate the session_id down to spans crated by the OpenAI instrumentation
  # This is not strictly necessary, but it helps to correlate the spans to the same session
  with using_session(session_id):
   response = client.chat.completions.create(
       model="gpt-3.5-turbo",
       messages=[{"role": "system", "content": "You are a helpful assistant."}] + messages,
   ).choices[0].message

  current_span.set_attribute(SpanAttributes.OUTPUT_VALUE, response.content)
  return response

messages = [
  {"role": "user", "content": "hi! im bob"}
]
response = assistant(
  messages,
  session_id=session_id,
)
messages = messages + [
  response,
  {"role": "user", "content": "what's my name?"}
]
response = assistant(
  messages,
  session_id=session_id,
)`;function mI(){return o("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(Te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:o(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Kl,{children:e(zr,{value:cI})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(Te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Kl,{children:e(zr,{value:uI})}),e(C,{paddingBottom:"size-100",paddingTop:"size-100",children:o(v,{children:["For more information on how to use sessions, consult the"," ",e(tl,{href:"https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}const gI="npm install @arizeai/openinference-core --save",pI=`import { trace } from "@opentelemetry/api";
import { SemanticConventions } from "@arizeai/openinference-semantic-conventions";
import { context } from "@opentelemetry/api";
import { setSession } from "@arizeai/openinference-core";

const tracer = trace.getTracer("agent");

const client = new OpenAI({
  apiKey: process.env["OPENAI_API_KEY"], // This is the default and can be omitted
});

async function assistant(params: {
  messages: { role: string; content: string }[];
  sessionId: string;
}) {
  return tracer.startActiveSpan("agent", async (span: Span) => {
    span.setAttribute(SemanticConventions.OPENINFERENCE_SPAN_KIND, "agent");
    span.setAttribute(SemanticConventions.SESSION_ID, params.sessionId);
    span.setAttribute(
      SemanticConventions.INPUT_VALUE,
      messages[messages.length - 1].content,
    );
    try {
      // This is not strictly necessary but it helps propagate the session ID
      // to all child spans
      return context.with(
        setSession(context.active(), { sessionId: params.sessionId }),
        async () => {
          // Calls within this block will generate spans with the session ID set
          const chatCompletion = await client.chat.completions.create({
            messages: params.messages,
            model: "gpt-3.5-turbo",
          });
          const response = chatCompletion.choices[0].message;
          span.setAttribute(SemanticConventions.OUTPUT_VALUE, response.content);
          span.end();
          return response;
        },
      );
    } catch (e) {
      span.error(e);
    }
  });
}

const sessionId = crypto.randomUUID();

let messages = [{ role: "user", content: "hi! im Tim" }];

const res = await assistant({
  messages,
  sessionId: sessionId,
});

messages = [res, { role: "assistant", content: "What is my name?" }];

await assistant({
  messages,
  sessionId: sessionId,
});
`;function yI(){return o("div",{children:[e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(Te,{level:2,weight:"heavy",children:"Install Dependencies"})}),e(C,{paddingBottom:"size-100",children:o(v,{children:["Sessions are tracked via the OpenTelemetry attribute ",e("b",{children:"session.id"}),". The easiest way to get started with sessions is to use the OpenInference instrumentation package."]})}),e(Kl,{children:e(zr,{value:gI})}),e(C,{paddingTop:"size-200",paddingBottom:"size-100",children:e(Te,{level:2,weight:"heavy",children:"Add Session ID to your Traces"})}),e(C,{paddingBottom:"size-100",children:e(v,{children:"Below is an example of how to add session IDs to a simple OpenAI application."})}),e(Kl,{children:e(q0,{value:pI})}),e(C,{paddingBottom:"size-100",children:o(v,{children:["For more information on how to use sessions, consult the"," ",e(tl,{href:"https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-sessions",children:"documentation"})]})})]})}function fI(){const{programmingLanguage:n,setProgrammingLanguage:a}=Cn(l=>({programmingLanguage:l.programmingLanguage,setProgrammingLanguage:l.setProgrammingLanguage}));return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Setup Sessions for this Project"}),e(ke,{children:e(be,{slot:"close"})})]}),o(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(cs,{language:n,onChange:a})}),n==="Python"?e(mI,{}):e(yI,{})]})]})})}function hI(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:o(b,{direction:"column",gap:"size-200",alignItems:"center",children:["No sessions found for this project",o(se,{children:[e(R,{leadingVisual:e(x,{svg:e(Qa,{})}),children:"Setup Sessions"}),e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(fI,{})})})]})]})})})})}const fo=K`
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  overflow: hidden;
  .span-filter-condition-field {
    flex: 1 1 auto;
  }

  // Style the column selector
  .ac-dropdown-button {
    min-width: var(--ac-global-dimension-static-size-300);
  }
`,ho="annotations",Di="-",Sy={col:"startTime",dir:"desc"},kI={col:"startTime",dir:"desc"};function vy(n){let a=null,l=null;if(n.id&&n.id.startsWith(ho)){const[,t,i]=n.id.split(Di);l={attr:t,name:i}}else a=n.id;return{col:a,evalResultKey:l,dir:n.desc?"desc":"asc"}}function bI(n){let a=null,l=null;if(n.id&&n.id.startsWith(ho)){const[,t,i]=n.id.split(Di);l={attr:t,name:i}}else a=n.id;return{col:a,annoResultKey:l,dir:n.desc?"desc":"asc"}}function pt(n,a){return`${ho}${Di}${a}${Di}${n}`.replace(/[^a-zA-Z0-9]/g,"-")}const Sd=Gs,SI={minSize:100},Fy=({table:n})=>{const a=Me();return e("tbody",{children:n.getRowModel().rows.map(l=>e("tr",{onClick:()=>a(`${encodeURIComponent(l.original.id)}`),children:l.getVisibleCells().map(t=>e("td",{style:{width:`calc(var(--col-${t.column.id}-size) * 1px)`,maxWidth:`calc(var(--col-${t.column.id}-size) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:de(t.column.columnDef.cell,t.getContext())},t.id))},l.id))})},vI=Da.memo(Fy,(n,a)=>n.table.options.data===a.table.options.data);function FI(n){const a=f.useRef(null),[l,t]=f.useState([]),{filterIoSubstringOrSessionId:i}=yy(),{fetchKey:r}=Nl(),{data:s,loadNext:d,hasNext:c,isLoadingNext:u,refetch:m}=T.usePaginationFragment(hy,n.project),g=f.useMemo(()=>s.sessions.edges.map(({session:N})=>{var B,Q;return{...N,tokenCountTotal:N.tokenUsage.total,costTotal:((Q=(B=N.costSummary)==null?void 0:B.total)==null?void 0:Q.cost)??null}}),[s.sessions]),p=Fn(N=>N.annotationColumnVisibility),h=f.useMemo(()=>Object.keys(p).filter(N=>p[N]),[p]).map(N=>({header:N,columns:[{header:"labels",accessorKey:pt(N,"label"),cell:({row:B})=>{const Q=B.original.sessionAnnotationSummaries.find(q=>q.name===N);return Q?e(co,{name:N,labelFractions:Q.labelFractions}):null}},{header:"mean score",accessorKey:pt(N,"score"),cell:({row:B})=>{const Q=B.original.sessionAnnotationSummaries.find(q=>q.name===N);return Q?e(Ht,{value:Q.meanScore,fallback:null}):null}}]})),k=[{header:()=>o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e("span",{children:"annotations"}),o(kt,{children:[e(Te,{level:3,weight:"heavy",children:"Annotations"}),e(v,{children:"Evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"annotations",accessorKey:"sessionAnnotations",enableSorting:!1,cell:({row:N})=>e(U0,{session:N.original})},...h],S=[{header:"session id",accessorKey:"sessionId",enableSorting:!1,cell:In},{header:"first input",accessorKey:"firstInput.value",enableSorting:!1,cell:In},{header:"last output",accessorKey:"lastOutput.value",enableSorting:!1,cell:In},...k,{header:"start time",accessorKey:"startTime",enableSorting:!0,cell:tn},{header:"end time",accessorKey:"endTime",enableSorting:!0,cell:tn},{header:"p50 latency",accessorKey:"traceLatencyMsP50",enableSorting:!1,cell:({getValue:N})=>{const B=N();return B===null||typeof B!="number"?null:e(Rn,{latencyMs:B})}},{header:"p99 latency",accessorKey:"traceLatencyMsP99",enableSorting:!1,cell:({getValue:N})=>{const B=N();return B===null||typeof B!="number"?null:e(Rn,{latencyMs:B})}},{header:"total tokens",accessorKey:"tokenCountTotal",enableSorting:!0,minSize:80,cell:({getValue:N,row:B})=>{const Q=N();if(Q==null||typeof Q!="number")return"--";const q=B.original;return e(pc,{tokenCountTotal:Q,nodeId:q.id,size:"S"})}},{header:"total cost",accessorKey:"costSummary.total.cost",id:"costTotal",enableSorting:!0,minSize:80,cell:({row:N,getValue:B})=>{const Q=B();if(Q===null||typeof Q!="number")return"--";const q=N.original;return e(H0,{totalCost:Q,nodeId:q.id})}},{header:"total traces",accessorKey:"numTraces",enableSorting:!0,cell:$r}];f.useEffect(()=>{const N=l[0];f.startTransition(()=>{m({sort:N?bI(N):kI,after:null,first:Sd,filterIoSubstring:i,sessionId:i},{fetchPolicy:"store-and-network"})})},[l,m,i,r]);const F=Da.useCallback(N=>{if(N){const{scrollHeight:B,scrollTop:Q,clientHeight:q}=N;B-Q-q<300&&!u&&c&&d(Sd)}},[c,u,d]),[I,L]=f.useState({}),M=Fn(N=>N.columnVisibility),E=Fn(N=>N.columnSizing),P=Fn(N=>N.setColumnSizing),_=Qe({columns:S,data:g,onExpandedChange:L,manualSorting:!0,state:{sorting:l,expanded:I,columnVisibility:M,columnSizing:E},defaultColumn:SI,columnResizeMode:"onChange",onColumnSizingChange:P,enableSubRowSelection:!1,onSortingChange:t,getCoreRowModel:Be(),getSortedRowModel:Vn(),getExpandedRowModel:Qc()}),A=_.getRowModel().rows.length===0,V=_.getAllColumns().filter(N=>N.columns.length===0),{columnSizingInfo:j,columnSizing:ce}=_.getState(),W=_.getFlatHeaders,Pe=S.length,ne=Da.useMemo(()=>{const N=W(),B={};for(let Q=0;Q<N.length;Q++){const q=N[Q];B[`--header-${q.id}-size`]=q.getSize(),B[`--col-${q.column.id}-size`]=q.column.getSize()}return B},[W,j,ce,Pe]);return o("div",{css:fo,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(C,{flex:"1 1 auto",children:e(dI,{})}),e(lI,{columns:V,query:s})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:N=>F(N.target),ref:a,children:o("table",{css:Al,style:{...ne,width:_.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:_.getHeaderGroups().map(N=>e("tr",{children:N.headers.map(B=>e("th",{colSpan:B.colSpan,style:{width:`calc(var(--header-${B.id}-size) * 1px)`},children:B.isPlaceholder?null:o(te,{children:[o("div",{"data-sortable":B.column.getCanSort(),className:B.column.getCanSort()?"sort":"",onClick:B.column.getToggleSortingHandler(),style:{left:B.getStart(),width:B.getSize()},children:[e(mn,{maxWidth:"100%",children:de(B.column.columnDef.header,B.getContext())}),B.column.getIsSorted()?e(x,{className:"sort-icon",svg:B.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]}),e("div",{onMouseDown:B.getResizeHandler(),onTouchStart:B.getResizeHandler(),className:`resizer ${B.column.getIsResizing()?"isResizing":""}`})]})},B.id))},N.id))}),A?e(hI,{}):j.isResizingColumn?e(vI,{table:_}):e(Fy,{table:_})]})})]})}function ko({children:n}){const{projectId:a}=on();if(!a)throw new Error("projectId is required");const{tab:l}=sr();if(!Am(l))throw new Error(`Invalid tab: ${l}`);return e(nI,{projectId:a,tableId:l||"table",children:n})}function CI({queryReference:n}){const a=T.usePreloadedQuery(Bm,n);return e(eI,{children:e(FI,{project:a.project})})}const b5=()=>{const{sessionsQueryReference:n}=nr();return n?o(ko,{children:[e(oo,{children:e(f.Suspense,{fallback:e(me,{}),children:e(CI,{queryReference:n})})}),e(f.Suspense,{children:e(Ue,{})})]}):null},Cy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:null,kind:"LocalArgument",name:"orphanSpanAsRootSpan"},r={defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},s={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},d={defaultValue:null,kind:"LocalArgument",name:"timeRange"},c=[{kind:"Variable",name:"id",variableName:"id"}],u={kind:"Variable",name:"after",variableName:"after"},m={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},g={kind:"Variable",name:"first",variableName:"first"},p={kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},y={kind:"Variable",name:"sort",variableName:"sort"},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},F=[u,m,g,{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},p,y,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],I={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},L=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],M={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},E={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d],kind:"Fragment",metadata:null,name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[u,m,g,p,y],kind:"FragmentSpread",name:"SpansTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,s,d,t],kind:"Operation",name:"SpansTableSpansQuery",selections:[{alias:null,args:c,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,k,{kind:"InlineFragment",selections:[S,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:null,args:F,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{condition:"rootSpansOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},I]},{condition:"rootSpansOnly",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null}]},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[k,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{condition:"rootSpansOnly",kind:"Condition",passingValue:!0,selections:[I]}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:L,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:L,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[k,S,M,E,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},M],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},S],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[k,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[k,S,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[M,E],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[k],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[h,k],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:F,filters:["sort","rootSpansOnly","filterCondition","orphanSpanAsRootSpan","timeRange"],handle:"connection",key:"SpansTable_spans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"50df80de2e7d5548f9f9e9ecf7e1f59f",id:null,metadata:{},name:"SpansTableSpansQuery",operationKind:"query",text:`query SpansTableSpansQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $orphanSpanAsRootSpan: Boolean
  $rootSpansOnly: Boolean = true
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...SpansTable_spans_xYL0c
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment SpansTable_spans_xYL0c on Project {
  name
  ...SpanColumnSelector_annotations
  spans(first: $first, after: $after, sort: $sort, rootSpansOnly: $rootSpansOnly, filterCondition: $filterCondition, orphanSpanAsRootSpan: $orphanSpanAsRootSpan, timeRange: $timeRange) {
    edges {
      span: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        latencyMs
        tokenCountTotal @skip(if: $rootSpansOnly)
        costSummary @skip(if: $rootSpansOnly) {
          total {
            cost
          }
        }
        cumulativeTokenCountTotal @include(if: $rootSpansOnly)
        spanId
        trace {
          id
          traceId
          costSummary @include(if: $rootSpansOnly) {
            total {
              cost
            }
          }
        }
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        ...AnnotationSummaryGroup
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Cy.hash="6d9c8e6ab059fb3f21b93768129924fe";const Ky=(function(){var n=["spans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},i=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],r={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{kind:"RootArgument",name:"orphanSpanAsRootSpan"},{defaultValue:!0,kind:"LocalArgument",name:"rootSpansOnly"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Cy,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"SpansTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"spans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"orphanSpanAsRootSpan",variableName:"orphanSpanAsRootSpan"},{kind:"Variable",name:"rootSpansOnly",variableName:"rootSpansOnly"},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__SpansTable_spans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"span",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{condition:"rootSpansOnly",kind:"Condition",passingValue:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},t]},{condition:"rootSpansOnly",kind:"Condition",passingValue:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null}]},{alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{condition:"rootSpansOnly",kind:"Condition",passingValue:!0,selections:[t]}],storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,a,r,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},r],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}})();Ky.hash="6d9c8e6ab059fb3f21b93768129924fe";const KI=K`
  border-radius: var(--ac-global-dimension-size-50);
  border: 1px solid var(--ac-global-color-grey-200);
  padding: var(--ac-global-dimension-size-50)
    var(--ac-global-dimension-size-100);
  transition: background-color 0.2s;

  &[role="button"] {
    cursor: pointer;
    &:hover {
      background-color: var(--ac-global-color-grey-200);
      border-color: var(--ac-global-color-grey-400);
    }
  }
  max-width: 100%;
  height: var(--ac-global-dimension-size-200);
`;function TI({metadata:n,onClick:a}){const l=f.useMemo(()=>{let t=n;return t.startsWith("{")&&(t=t.slice(1)),t.endsWith("}")&&(t=t.slice(0,-1)),t},[n]);return e("div",{css:K(KI),role:a?"button":"label","aria-label":"metadata",onClick:t=>{t.stopPropagation(),t.preventDefault(),a==null||a()},children:e(b,{direction:"row",justifyContent:"space-between",alignItems:"center",height:"100%",children:e(mn,{maxWidth:"100%",children:e(v,{children:l})})})})}function PI(n){return n.replaceAll("\\","\\\\").replaceAll(`
`,"\\n").replaceAll('"','\\"')}function II(n){return typeof n=="boolean"?n?"True":"False":typeof n=="number"?n.toString():typeof n=="string"?`"${PI(n)}"`:""}const Ty=(n,a)=>`metadata${n.split(".").map(i=>/^\d+$/.test(i)?`[${i}]`:`['${i}']`).join("")} == ${II(a)}`;function xI({children:n,metadata:a,width:l}){const{appendFilterCondition:t}=rr(),i=Object.entries(a).map(([r,s])=>({key:r,value:String(s),filterCondition:Ty(r,s)}));return o(Se,{delay:500,children:[e(Zn,{children:n}),e(fa,{offset:3,width:l,children:o(b,{direction:"row",wrap:"nowrap",gap:"size-100",children:[e(b,{flexBasis:"40%",children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Metadata"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: column;
                  gap: var(--ac-global-dimension-size-100);
                  overflow-y: auto;
                  max-height: 200px;
                  scrollbar-gutter: stable;
                  padding-right: var(--ac-global-dimension-size-50);
                `,children:i.map(({key:r,value:s})=>e("li",{children:o(b,{direction:"row",gap:"size-100",children:[e(b,{flexBasis:"30%",width:0,children:e(mn,{maxWidth:"100%",children:e(v,{weight:"heavy",color:"inherit",size:"XS",children:r})})}),e(b,{flexBasis:"70%",flexShrink:1,justifyContent:"end",width:0,children:e(mn,{maxWidth:"100%",children:e(v,{color:"inherit",size:"XS",maxWidth:"100%",children:s})})})]})},r))})]})}),e(C,{borderColor:"dark",paddingStart:"size-200",paddingEnd:"size-100",marginStart:"size-200",flexBasis:"60%",borderStartWidth:"thin",children:o(b,{direction:"column",gap:"size-100",width:"100%",children:[e(v,{weight:"heavy",children:"Filters"}),e("ul",{css:K`
                  display: flex;
                  flex-direction: row;
                  gap: var(--ac-global-dimension-size-100);
                  padding: var(--ac-global-dimension-size-50) 0;
                  flex-wrap: wrap;
                `,children:i.map(({key:r,filterCondition:s})=>e("li",{children:o("button",{onClick:d=>{d.preventDefault(),d.stopPropagation(),t(s)},css:K`
                        all: unset;
                        color: var(--ac-global-text-color-900);
                        border: 1px solid var(--ac-global-color-grey-300);
                        border-radius: 4px;
                        padding: var(--ac-global-dimension-size-50)
                          var(--ac-global-dimension-size-100);
                        cursor: pointer;
                        transition: background-color 0.2s;
                        &:hover {
                          background-color: var(--ac-global-color-gray-300);
                        }
                      `,children:["Match ",r]})},r))})]})})]})})]})}const Py=({metadata:n})=>{const{appendFilterCondition:a}=rr(),[l,t]=f.useMemo(()=>{try{if(typeof n!="string")throw new Error("Metadata is not a string");const i=G0(n),r=JSON.stringify(i);if(Object.keys(i).length===0)throw new Error("Metadata is empty");return[i,r]}catch{return[null,null]}},[n]);return!l||!t?"--":e("div",{style:{maxWidth:"100%"},children:e(xI,{width:"800px",metadata:l,children:e(TI,{metadata:t,onClick:()=>{const[i,r]=Object.entries(l)[0],s=Ty(i,r);a(s)}})})})};function LI(){const n=Ot(l=>l.treatOrphansAsRoots),a=Ot(l=>l.setTreatOrphansAsRoots);return o(se,{children:[e(R,{size:"M","aria-label":"Filter Configuration",leadingVisual:e(x,{svg:e(Xd,{})})}),o(we,{children:[e(_l,{}),e(re,{children:e(C,{padding:"size-100",children:e(b,{direction:"column",gap:"size-100",children:e(Il,{isSelected:n,onChange:l=>{f.startTransition(()=>{a(l)})},children:"Treat Orphan Spans as Roots"})})})})]})]})}function DI({projectName:n}){const{programmingLanguage:a,setProgrammingLanguage:l}=Cn(t=>({programmingLanguage:t.programmingLanguage,setProgrammingLanguage:t.setProgrammingLanguage}));return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Send Traces to this Project"}),e(ke,{children:e(be,{slot:"close"})})]}),o(C,{padding:"size-400",overflow:"auto",children:[e(C,{paddingBottom:"size-100",children:e(cs,{language:a,onChange:l})}),a==="Python"?e(bc,{projectName:n}):e(Sc,{projectName:n})]})]})})}function Iy({projectName:n}){return e(te,{children:e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
              text-align: center;
              padding: var(--ac-global-dimension-size-300)
                var(--ac-global-dimension-size-300) !important;
            `,children:o(b,{direction:"column",gap:"size-200",alignItems:"center",children:["No traces found that match the selected filters",o(se,{children:[e(R,{variant:"default",leadingVisual:e(x,{svg:e(Qa,{})}),children:"Get Started"}),e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(DI,{projectName:n})})})]})]})})})})})}const xy={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SpanColumnSelector_annotations",selections:[{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null}],type:"Project",abstractKey:null};xy.hash="ad01e6897ad1ea779eb346d85783b8b4";const _I=["spanKind","name"];function Ly(n){return o(se,{children:[e(R,{trailingVisual:e(na,{}),children:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(x,{svg:e(kc,{})}),"Columns"]})}),e(we,{children:e(AI,{...n})})]})}const _i=K`
  padding: var(--ac-global-dimension-static-size-50)
    var(--ac-global-dimension-static-size-100);
  label {
    display: flex;
    align-items: center;
    gap: var(--ac-global-dimension-static-size-100);
  }
`;function AI(n){const{columns:a}=n,l=Fn(u=>u.columnVisibility),t=Fn(u=>u.setColumnVisibility),i=f.useMemo(()=>a.filter(u=>!_I.includes(u.id)),[a]),r=f.useMemo(()=>i.every(u=>{const m=l[u.id];return m??!0}),[i,l]),s=f.useMemo(()=>i.some(u=>{const m=l[u.id];return m??!0}),[i,l]),d=f.useCallback((u,m)=>{t({...l,[u]:m})},[l,t]),c=f.useCallback(u=>{const m=i.reduce((g,p)=>({...g,[p.id]:u}),{});t(m)},[i,t]);return e("div",{css:K`
        overflow-y: auto;
        max-height: calc(100vh - 200px);
      `,children:o(C,{padding:"size-50",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",paddingBottom:"size-50",children:e("div",{css:_i,children:e(ut,{name:"toggle-all",isSelected:r,isIndeterminate:s&&!r,onChange:c,children:"span columns"})})}),e("ul",{children:i.map(u=>{const m=l[u.id],g=m??!0,p=typeof u.columnDef.header=="string"?u.columnDef.header:u.id;return e("li",{css:_i,children:e(ut,{name:u.id,isSelected:g,onChange:y=>d(u.id,y),children:p})},u.id)})}),e(EI,{...n})]})})}function EI({query:n}){const a=T.useFragment(xy,n),l=Fn(d=>d.annotationColumnVisibility),t=Fn(d=>d.setAnnotationColumnVisibility),i=f.useMemo(()=>a.spanAnnotationNames.every(d=>l[d]||!1),[a.spanAnnotationNames,l]),r=f.useMemo(()=>a.spanAnnotationNames.some(d=>l[d]||!1),[a.spanAnnotationNames,l]),s=f.useCallback(()=>{const d=a.spanAnnotationNames.reduce((c,u)=>({...c,[u]:!i}),{});t(d)},[a.spanAnnotationNames,t,i]);return o("section",{children:[e(C,{paddingTop:"size-50",paddingBottom:"size-50",borderColor:"dark",borderTopWidth:"thin",children:e("div",{css:_i,children:e(ut,{name:"toggle-annotations-all",isSelected:i,isIndeterminate:r&&!i,onChange:s,children:"annotations"})})}),e("ul",{children:a.spanAnnotationNames.map(d=>{const c=l[d]??!1;return e("li",{css:_i,children:e(ut,{name:d,isSelected:c,onChange:u=>t({...l,[d]:u}),children:d})},d)})})]})}const Dy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateSpanFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanFilterConditionFieldValidationQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"38e5e2288d5746b32b21632854cc7c82",id:null,metadata:{},name:"SpanFilterConditionFieldValidationQuery",operationKind:"query",text:`query SpanFilterConditionFieldValidationQuery(
  $condition: String!
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      validateSpanFilterCondition(condition: $condition) {
        isValid
        errorMessage
      }
    }
    id
  }
}
`}}})();Dy.hash="4020987ee29c63747be68dc3cada3de0";const _y=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,Ay=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
  .search-icon {
    margin-left: var(--ac-global-dimension-static-size-100);
    margin-top: var(--ac-global-dimension-static-size-100);
  }
`;function wI(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"span_kind",type:"variable",info:"The span variant: CHAIN, LLM, RETRIEVER, TOOL, etc."},{label:"status_code",type:"variable",info:"The span status: OK, UNSET, or ERROR"},{label:"input.value",type:"variable",info:"The input value of a span, typically a query"},{label:"output.value",type:"variable",info:"The output value of a span, typically a response"},{label:"name",type:"variable",info:"The name given to a span - e.x. OpenAI"},{label:"latency_ms",type:"variable",info:"Latency (i.e. duration) in milliseconds"},{label:"cumulative_token_count.prompt",type:"variable",info:"Sum of token count for prompt from self and all child spans"},{label:"cumulative_token_count.completion",type:"variable",info:"Sum of token count for completion from self and all child spans"},{label:"cumulative_token_count.total",type:"variable",info:"Sum of token count total (prompt + completion) from self and all child spans"},{label:"llm spans",type:"text",apply:"span_kind == 'LLM'",detail:"macro"},{label:"retriever spans",type:"text",apply:"span_kind == 'RETRIEVER'",detail:"macro"},{label:"search input",type:"text",apply:"'' in input.value",detail:"macro"},{label:"search output",type:"text",apply:"'' in output.value",detail:"macro"},{label:"status_code error",type:"text",apply:"status_code == 'ERROR'",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Tokens >= 1,000",type:"text",apply:"llm.token_count.total >= 1_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Annotations",type:"text",apply:"annotations['Hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['topic'] == 'agent'",detail:"macro"},{label:"Substring",type:"text",apply:"'agent' in input.value",detail:"macro"}]}}async function MI(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await Xt.fetchQuery(ze,Dy,{condition:n,id:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.project.validateSpanFilterCondition}const RI=[Rs.of([{key:"Enter",run:n=>!0}]),Yt(),Uc({override:[wI]})],VI={lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1,searchKeymap:!1};function Ey(n){const{onValidCondition:a,placeholder:l="filter condition (e.x. span_kind == 'LLM')"}=n,[t,i]=f.useState(!1),[r,s]=f.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:u}=rr(),m=f.useDeferredValue(d),{theme:g}=ia(),p=g==="light"?Ml:Rl,{projectId:y}=on(),h=f.useRef(null);f.useEffect(()=>{MI(m,y).then(F=>{F!=null&&F.isValid?(s(""),f.startTransition(()=>{a(m)})):s((F==null?void 0:F.errorMessage)??"Invalid filter condition")})},[a,m,y]);const k=r!=="";return o("div",{"data-is-focused":t,"data-is-invalid":k,className:"span-filter-condition-field",css:Ay,ref:h,children:[o(b,{direction:"row",children:[e(x,{svg:e(Ss,{}),className:"search-icon"}),e(Vl,{css:_y,indentWithTab:!1,basicSetup:VI,onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:p,placeholder:l,extensions:RI}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${d!==""?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(x,{svg:e(Bi,{})})}),o(se,{children:[e(fn,{css:K`
              color: var(--ac-global-text-color-700);
              border-left: 1px solid var(--ac-global-input-field-border-color);
              border-bottom: 0;
              border-top: 0;
              padding-left: var(--ac-global-dimension-static-size-100);
              padding-right: var(--ac-global-dimension-static-size-100);
              border-radius: 0;
              height: 36px !important;
            `,className:"button--reset",children:e(x,{svg:e(Mn,{})})}),e(we,{placement:"bottom right",children:e(NI,{onAddFilterConditionSnippet:u})})]})]}),e(Se,{isOpen:k&&t,children:e($e,{placement:"bottom",triggerRef:h,children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})})]})}function NI(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",padding:"size-200",borderRadius:"medium",backgroundColor:"light",children:o(b,{direction:"column",gap:"size-100",children:[e($l,{label:"filter by kind",initialSnippet:"span_kind == 'LLM'",onAddFilterConditionSnippet:a},"kind"),e($l,{label:"filter by token count",initialSnippet:"cumulative_token_count.total > 1000",onAddFilterConditionSnippet:a},"token_count"),e($l,{label:"filter by annotation label",initialSnippet:"annotations['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"annotation_label"),e($l,{label:"filter by evaluation label",initialSnippet:"evals['Hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e($l,{label:"filter by evaluation score",initialSnippet:"evals['Hallucination'].score < 1",onAddFilterConditionSnippet:a},"eval_score"),e($l,{label:"filter by metadata",initialSnippet:"metadata['topic'] == 'agent'",onAddFilterConditionSnippet:a},"metadata"),e($l,{label:"filter by substring",initialSnippet:"'agent' in input.value",onAddFilterConditionSnippet:a},"substring")]})})}function $l(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=f.useState(a),{theme:r}=ia(),s=r==="light"?Ml:Rl;return o("div",{css:ba,children:[e(J,{children:n.label}),o(b,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(Ay,K`
              flex: 1 1 auto;
            `),children:e(Vl,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Yt()],editable:!0,onChange:i,theme:s,css:_y})}),e(R,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(x,{svg:e(xl,{})})})]})]})}const wy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"traceIds"}],a=[{alias:null,args:[{kind:"Variable",name:"traceIds",variableName:"traceIds"}],concreteType:"Query",kind:"LinkedField",name:"deleteTraces",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarDeleteTracesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarDeleteTracesMutation",selections:a},params:{cacheID:"3e39d87554a43d8dc3006d3e977317e5",id:null,metadata:{},name:"SpanSelectionToolbarDeleteTracesMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarDeleteTracesMutation(
  $traceIds: [ID!]!
) {
  deleteTraces(traceIds: $traceIds) {
    __typename
  }
}
`}}})();wy.hash="61f5b577eead8d4094340843ed9d8d28";const My=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addSpansToDataset",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"SpanSelectionToolbarAddSpansToDatasetMutation",selections:a},params:{cacheID:"1c694540190478b8fba8ef3c0cacf30c",id:null,metadata:{},name:"SpanSelectionToolbarAddSpansToDatasetMutation",operationKind:"mutation",text:`mutation SpanSelectionToolbarAddSpansToDatasetMutation(
  $input: AddSpansToDatasetInput!
) {
  addSpansToDataset(input: $input) {
    dataset {
      id
    }
  }
}
`}}})();My.hash="5e3aef907285081a06c0e0360045e865";const Ry=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"search"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{args:[{kind:"Variable",name:"search",variableName:"search"}],kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetSelectorPopoverContentDatasetsQuery",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Variable",name:"value",variableName:"search"}],kind:"ObjectValue",name:"filter"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"01d8b191af606c33309651b7504ffbaf",id:null,metadata:{},name:"DatasetSelectorPopoverContentDatasetsQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentDatasetsQuery(
  $search: String!
) {
  ...DatasetSelectorPopoverContent_datasets_40zwac
}

fragment DatasetSelectorPopoverContent_datasets_40zwac on Query {
  datasets(filter: {col: name, value: $search}) {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}}})();Ry.hash="60d20faa9c3d4bbb03be15dec748af49";const Vy={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"search"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:Ry}},name:"DatasetSelectorPopoverContent_datasets",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Variable",name:"value",variableName:"search"}],kind:"ObjectValue",name:"filter"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Vy.hash="60d20faa9c3d4bbb03be15dec748af49";const Ny={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetSelectorPopoverContentQuery",selections:[{args:[{kind:"Literal",name:"search",value:""}],kind:"FragmentSpread",name:"DatasetSelectorPopoverContent_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetSelectorPopoverContentQuery",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Literal",name:"value",value:""}],kind:"ObjectValue",name:"filter"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dataset",args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'datasets(filter:{"col":"name","value":""})'}]},params:{cacheID:"02fcced29ddf37dbf2220d4d94ec7a44",id:null,metadata:{},name:"DatasetSelectorPopoverContentQuery",operationKind:"query",text:`query DatasetSelectorPopoverContentQuery {
  ...DatasetSelectorPopoverContent_datasets_1oCkZB
}

fragment DatasetSelectorPopoverContent_datasets_1oCkZB on Query {
  datasets(filter: {col: name, value: ""}) {
    edges {
      dataset: node {
        id
        name
      }
    }
  }
}
`}};Ny.hash="ed6b4586cff4c203c56ae2f5f5ce6a8e";function zI(n){const{onCreateNewDataset:a,onDatasetSelected:l}=n,t=T.useLazyLoadQuery(Ny,{},{fetchPolicy:"network-only"});return e($I,{query:t,onCreateNewDataset:a,onDatasetSelected:l})}function $I(n){const{contains:a}=Zt({sensitivity:"base"}),{onDatasetSelected:l,onCreateNewDataset:t}=n,[i,r]=T.useRefetchableFragment(Vy,n.query),s=f.useMemo(()=>i.datasets.edges.map(c=>c.dataset),[i]);return o(Fl,{filter:a,children:[e(C,{padding:"size-100",borderBottomWidth:"thin",borderColor:"dark",children:o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e(Te,{level:4,weight:"heavy",children:"Add to Dataset"}),e(fn,{size:"S",onPress:t,children:e(x,{svg:e(Mn,{})})})]}),e(Ll,{autoFocus:!0,"aria-label":"Search datasets",placeholder:"Search datasets...",onChange:c=>{f.startTransition(()=>{r({search:c})})}})]})}),e(Bn,{"aria-label":"datasets",selectionMode:"single",css:K`
          height: 300px;
          width: 300px;
        `,renderEmptyState:()=>"No datasets found",onSelectionChange:c=>{if(typeof c=="object"){const u=Array.from(c);l(u[0])}},children:s.map(c=>e(rl,{id:c.id,children:c.name},c.id))})]})}const zy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"search"}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TransferTracesButtonProjectsQuery",selections:[{args:[{kind:"Variable",name:"search",variableName:"search"}],kind:"FragmentSpread",name:"TransferTracesButton_projects"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TransferTracesButtonProjectsQuery",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Variable",name:"value",variableName:"search"}],kind:"ObjectValue",name:"filter"}],concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"cbe218bcb13ce57f75c3f785490e5ec4",id:null,metadata:{},name:"TransferTracesButtonProjectsQuery",operationKind:"query",text:`query TransferTracesButtonProjectsQuery(
  $search: String!
) {
  ...TransferTracesButton_projects_40zwac
}

fragment TransferTracesButton_projects_40zwac on Query {
  projects(filter: {col: name, value: $search}) {
    edges {
      node {
        id
        name
      }
    }
  }
}
`}}})();zy.hash="a44c352be1e86a92920582b62ce0b767";const $y={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"search"}],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:[],operation:zy}},name:"TransferTracesButton_projects",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Variable",name:"value",variableName:"search"}],kind:"ObjectValue",name:"filter"}],concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};$y.hash="a44c352be1e86a92920582b62ce0b767";const Oy={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"TransferTracesButtonQuery",selections:[{args:[{kind:"Literal",name:"search",value:""}],kind:"FragmentSpread",name:"TransferTracesButton_projects"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"TransferTracesButtonQuery",selections:[{alias:null,args:[{fields:[{kind:"Literal",name:"col",value:"name"},{kind:"Literal",name:"value",value:""}],kind:"ObjectValue",name:"filter"}],concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'projects(filter:{"col":"name","value":""})'}]},params:{cacheID:"69ed32ad09cd0c5b2dacbd308cd825a6",id:null,metadata:{},name:"TransferTracesButtonQuery",operationKind:"query",text:`query TransferTracesButtonQuery {
  ...TransferTracesButton_projects_1oCkZB
}

fragment TransferTracesButton_projects_1oCkZB on Query {
  projects(filter: {col: name, value: ""}) {
    edges {
      node {
        id
        name
      }
    }
  }
}
`}};Oy.hash="f0df0f5854d02d94e6acd211de27eb6a";const jy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"},{defaultValue:null,kind:"LocalArgument",name:"traceIds"}],a=[{kind:"Variable",name:"projectId",variableName:"projectId"},{kind:"Variable",name:"traceIds",variableName:"traceIds"}],l=[{kind:"Variable",name:"id",variableName:"projectId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TransferTracesButtonTransferMutation",selections:[{alias:null,args:a,concreteType:"Query",kind:"LinkedField",name:"transferTracesToProject",plural:!1,selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TransferTracesButtonTransferMutation",selections:[{alias:null,args:a,concreteType:"Query",kind:"LinkedField",name:"transferTracesToProject",plural:!1,selections:[{alias:"project",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,i],storageKey:null}],storageKey:null}]},params:{cacheID:"ca0996306d7a238a1a37964b959dcf92",id:null,metadata:{},name:"TransferTracesButtonTransferMutation",operationKind:"mutation",text:`mutation TransferTracesButtonTransferMutation(
  $projectId: ID!
  $traceIds: [ID!]!
) {
  transferTracesToProject(traceIds: $traceIds, projectId: $projectId) {
    project: node(id: $projectId) {
      __typename
      id
      ... on Project {
        name
      }
    }
  }
}
`}}})();jy.hash="11306bf401c87cbfba767ee1ddd9dde5";function OI({traceIds:n,currentProjectId:a,onSuccess:l,onError:t}){const[i,r]=T.useMutation(jy),s=d=>{i({variables:{traceIds:n,projectId:d},onCompleted:c=>{var m;const u=((m=c.transferTracesToProject.project)==null?void 0:m.name)||"unknown";l({projectName:u,projectId:d})},onError:c=>{t(c)}})};return o(se,{children:[e(R,{leadingVisual:e(x,{svg:e(W0,{})}),isDisabled:r,children:r?"Transferring":"Transfer"}),o(we,{children:[e(_l,{}),e(re,{children:({close:d})=>e(f.Suspense,{fallback:e(me,{}),children:e(jI,{onProjectSelect:c=>{s(c),d()},currentProjectId:a})})})]})]})}function jI({onProjectSelect:n,currentProjectId:a}){const l=T.useLazyLoadQuery(Oy,{search:""});return e(QI,{query:l,onProjectSelect:n,currentProjectId:a})}function QI({query:n,onProjectSelect:a,currentProjectId:l}){const[,t]=f.useTransition(),{contains:i}=Zt({sensitivity:"base"}),[r,s]=T.useRefetchableFragment($y,n),d=f.useMemo(()=>r.projects.edges.map(u=>u.node),[r]);return o(Fl,{filter:i,children:[e(C,{padding:"size-100",borderBottomWidth:"thin",borderColor:"dark",minWidth:300,children:o(b,{direction:"column",gap:"size-50",children:[e(Te,{level:4,weight:"heavy",children:"Transfer Traces to Project"}),e(Ll,{autoFocus:!0,"aria-label":"Search projects",placeholder:"Search projects...",onChange:u=>{t(()=>{s({search:u})})}})]})}),e(Bn,{"aria-label":"projects",items:d,selectionMode:"single",css:K`
          height: 300px;
        `,onSelectionChange:u=>{if(u==="all")return;const m=u.keys().next().value;typeof m=="string"&&a(m)},renderEmptyState:()=>"No projects found",children:u=>e(rl,{id:u.id,isDisabled:u.id===l,children:u.name},u.id)})]})}function Qy(n){const{projectId:a}=on(),{setFetchKey:l}=Nl();Xe(a);const t=Me(),i=Le(),r=Ve(),[s,d]=f.useState(!1),[c,u]=f.useState(!1),[m,g]=f.useState(!1),{selectedSpans:p,onClearSelection:y}=n,h=f.useMemo(()=>[...new Set(p.map(_=>_.traceId))],[p]),[k,S]=T.useMutation(My),[F,I]=T.useMutation(wy),L=p.length!==1,M=f.useCallback(_=>{k({variables:{input:{datasetId:_,spanIds:p.map(D=>D.id)}},onCompleted:()=>{i({title:"Examples added to dataset",message:`${p.length} example${L?"s have":" has"} been added to the dataset.`,action:{text:"View dataset",onClick:()=>{t(`/datasets/${_}/examples`)}}}),y()},onError:D=>{const A=je(D);r({title:"An error occurred",message:`Failed to add spans to dataset: ${(A==null?void 0:A[0])??D.message}`})}})},[k,p,i,L,y,t,r]),E=f.useCallback(()=>{F({variables:{traceIds:h},onCompleted:()=>{i({title:"Traces deleted",message:`${h.length} trace${h.length!==1?"s have":" has"} been deleted.`}),y()},onError:_=>{const D=je(_);r({title:"An error occurred",message:`Failed to delete traces: ${(D==null?void 0:D[0])??_.message}`})}})},[F,h,i,y,r]),P=()=>{g(!0)};return e(Fs,{children:o(vs,{children:[o(Or,{"aria-label":"Span selection",children:[e(fn,{size:"M",onPress:y,"aria-label":"Clear selection",children:e(x,{svg:e(mt,{})})}),e(C,{paddingEnd:"size-100",children:e(v,{children:`${p.length} span${L?"s":""} selected`})})]}),o(Or,{"aria-label":"Span selection actions",children:[o(se,{isOpen:c,onOpenChange:_=>{u(_)},children:[e(R,{variant:"primary",size:"M",leadingVisual:e(x,{svg:e(Mn,{})}),onPress:()=>{u(!0)},isDisabled:S,children:S?"Adding...":"Add to Dataset"}),e(we,{placement:"top end",children:o(f.Suspense,{children:[e(_l,{}),e(re,{children:e(zI,{onDatasetSelected:_=>{M(_),u(!1)},onCreateNewDataset:()=>{u(!1),d(!0)}})})]})})]}),e(OI,{traceIds:h,currentProjectId:a,onSuccess:({projectName:_})=>{i({title:"Transfer Success",message:`The traces have been moved to project: ${_}`}),y(),l(`trace-transfer-${Date.now()}`)},onError:_=>{r({title:"Transfer Failed",message:`Failed to transfer due to error: ${_.message}`})}}),e(se,{isOpen:s,onOpenChange:d,children:e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"New Dataset"}),e(ke,{children:e(R,{variant:"default",size:"S",onPress:()=>{d(!1)},leadingVisual:e(x,{svg:e(mt,{})})})})]}),e(vc,{onDatasetCreateError:_=>{const D=je(_);r({title:"Dataset creation failed",message:`Failed to create dataset: ${(D==null?void 0:D[0])??_.message}`})},onDatasetCreated:_=>{d(!1),i({title:"Dataset created",message:`${_.name} has been successfully created.`}),u(!0)}})]})})})})}),e(R,{size:"M","aria-label":"Delete Traces",isDisabled:I,onPress:P,variant:"danger",leadingVisual:e(x,{svg:e(Tn,{})})}),e(se,{isOpen:m,onOpenChange:g,children:e(oe,{children:e(ae,{children:e(re,{children:o(ye,{children:[e(fe,{children:e(he,{children:"Delete Traces"})}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete the selected spans and their traces?"})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{variant:"default",onPress:()=>{g(!1)},children:"Cancel"}),e(R,{variant:"danger",onPress:()=>{E(),g(!1)},children:"Delete Traces"})]})})]})})})})})]})]})})}const yi=Gs,BI={minSize:100};function qI(n){return n==="root"||n==="all"}const By=({table:n,hasNext:a,onLoadNext:l,isLoadingNext:t})=>{const i=Me(),[r]=_n(),{traceId:s}=on(),d=r.get(aa);return o("tbody",{children:[n.getRowModel().rows.map(c=>{const u=d===c.original.id||!d&&c.original.trace.traceId===s;return e("tr",{"data-selected":u,onClick:()=>i(`${c.original.trace.traceId}?${aa}=${c.original.id}`),children:c.getVisibleCells().map(m=>{const g=`--col-${m.column.id}-size`;return e("td",{style:{width:`calc(var(${g}) * 1px)`,maxWidth:`calc(var(${g}) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:de(m.column.columnDef.cell,m.getContext())},m.id)})},c.id)}),a?e(ls,{onLoadMore:l,isLoadingNext:t},"load-more"):null]})},UI=Da.memo(By,(n,a)=>n.table.options.data===a.table.options.data);function HI(n){const{fetchKey:a}=Nl(),l=f.useRef(null),t=f.useRef(!0),[i,r]=f.useState({}),[s,d]=f.useState([]),[c,u]=f.useState(""),[m,g]=f.useState(!0),p=Fn(w=>w.columnVisibility),{data:y,loadNext:h,hasNext:k,isLoadingNext:S,refetch:F}=T.usePaginationFragment(Ky,n.project),I=mo(),L=I==null?void 0:I.setTraceSequence;f.useEffect(()=>{if(L)return L(y.spans.edges.map(({span:w})=>({traceId:w.trace.traceId,spanId:w.id}))),()=>{L([])}},[y.spans.edges,L]);const M=Fn(w=>w.annotationColumnVisibility),E=f.useMemo(()=>Object.keys(M).filter(w=>M[w]),[M]),P=f.useMemo(()=>y.spans.edges.map(({span:$})=>$),[y]),_=E.map(w=>({header:w,columns:[{header:"labels",accessorKey:pt(w,"label"),cell:({row:$})=>{const X=$.original.spanAnnotationSummaries.find(pe=>pe.name===w);return X?e(co,{name:w,labelFractions:X.labelFractions}):null}},{header:"mean score",accessorKey:pt(w,"score"),cell:({row:$})=>{const X=$.original.spanAnnotationSummaries.find(pe=>pe.name===w);return X?e(Ht,{value:X.meanScore,fallback:null}):null}}]})),D=[{header:()=>o(b,{direction:"row",gap:"size-50",children:[e("span",{children:"annotations"}),o(kt,{children:[e(Te,{level:3,weight:"heavy",children:"Annotations"}),e(v,{children:"Evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"annotations",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:w})=>o(b,{direction:"row",gap:"size-50",wrap:"wrap",children:[e(ji,{span:w.original,showFilterActions:!0}),w.original.documentRetrievalMetrics.map($=>o(te,{children:[e(ya,{name:$.evaluationName,metric:"ndcg",score:$.ndcg},"ndcg"),e(ya,{name:$.evaluationName,metric:"precision",score:$.precision},"precision"),e(ya,{name:$.evaluationName,metric:"hit",score:$.hit},"hit")]}))]})},..._],A=[{id:"select",maxSize:32,header:({table:w})=>e(Va,{isSelected:w.getIsAllRowsSelected(),isIndeterminate:w.getIsSomeRowsSelected(),onChange:w.toggleAllRowsSelected}),cell:({row:w})=>e(Va,{isSelected:w.getIsSelected(),isDisabled:!w.getCanSelect(),isIndeterminate:w.getIsSomeSelected(),onChange:w.toggleSelected})},{header:"status",accessorKey:"statusCode",enableSorting:!1,minSize:50,maxSize:75,cell:({getValue:w})=>{const $=w();return e(Ni,{statusCode:$})}},{header:"kind",accessorKey:"spanKind",maxSize:100,enableSorting:!1,cell:({getValue:w})=>e(ms,{spanKind:w()})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:w,row:$})=>{const X=$.original,{traceId:pe}=X.trace;return e(Dn,{to:`${pe}?${aa}=${X.id}`,children:w()})}},{header:"input",accessorKey:"input.value",cell:In,enableSorting:!1},{header:"output",accessorKey:"output.value",cell:In,enableSorting:!1},{header:"metadata",accessorKey:"metadata",cell:({row:w})=>e(Py,{metadata:w.original.metadata}),enableSorting:!1},...D,{header:"start time",accessorKey:"startTime",cell:tn},{header:"latency",accessorKey:"latencyMs",cell:({getValue:w})=>{const $=w();return $===null||typeof $!="number"?null:e(Rn,{latencyMs:$})}},{header:m?"cumulative tokens":"total tokens",accessorKey:m?"cumulativeTokenCountTotal":"tokenCountTotal",cell:({row:w,getValue:$})=>{if($()===null)return"--";const pe=w.original,Pn=m?pe.cumulativeTokenCountTotal:pe.tokenCountTotal;return m?e(gc,{tokenCountTotal:Pn||0,nodeId:pe.id}):e(zi,{tokenCountTotal:Pn||0,nodeId:pe.id})}},{header:m?"cumulative cost":"total cost",accessorKey:m?"trace.costSummary.total.cost":"costSummary.total.cost",id:m?"cumulativeTokenCostTotal":"tokenCostTotal",cell:({row:w,getValue:$})=>{const X=$();if(X===null||typeof X!="number")return"--";const pe=w.original;return m?e(fs,{totalCost:X,nodeId:pe.trace.id,size:"S"}):e($i,{totalCost:X,spanNodeId:pe.id,size:"S"})}}];f.useEffect(()=>{if(t.current===!0){t.current=!1;return}f.startTransition(()=>{const w=s[0];F({sort:w?vy(w):Sy,after:null,first:yi,filterCondition:c,rootSpansOnly:m},{fetchPolicy:"store-and-network"})})},[s,F,c,a,m]);const V=f.useCallback(w=>{if(w){const{scrollHeight:$,scrollTop:X,clientHeight:pe}=w;$-X-pe<300&&!S&&k&&h(yi)}},[k,S,h]),j=Fn(w=>w.setColumnSizing),ce=Fn(w=>w.columnSizing),W=Qe({columns:A,data:P,state:{sorting:s,columnVisibility:p,rowSelection:i,columnSizing:ce},defaultColumn:BI,columnResizeMode:"onChange",manualSorting:!0,enableRowSelection:!0,onRowSelectionChange:r,onSortingChange:d,onColumnSizingChange:j,getCoreRowModel:Be(),getSortedRowModel:Vn()}),Pe=W.getRowModel().rows,ne=W.getSelectedRowModel().rows,N=ne.map(w=>({id:w.original.id,traceId:w.original.trace.id})),B=f.useCallback(()=>{r({})},[r]),Q=Pe.length===0,q=W.getAllColumns().filter(w=>w.columns.length===0),{columnSizingInfo:ie,columnSizing:Z}=W.getState(),ue=W.getFlatHeaders,Ke=q.length,[Ce]=f.useMemo(()=>{const w=ue(),$={};for(let X=0;X<w.length;X++){const pe=w[X];$[`--header-${pe.id}-size`]=pe.getSize(),$[`--col-${pe.column.id}-size`]=pe.column.getSize()}return[$]},[ue,ie,Z,Ke]);return o("div",{css:fo,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Ey,{onValidCondition:u}),o(qt,{"aria-label":"Toggle between root and all spans",selectionMode:"single",selectedKeys:[m?"root":"all"],onSelectionChange:w=>{if(w.size===0)return;const $=w.keys().next().value;if(qI($))g($==="root");else throw new Error(`Unknown root span filter selection: ${$}`)},children:[e(ga,{"aria-label":"root spans",id:"root",children:"Root Spans"}),e(ga,{"aria-label":"all spans",id:"all",children:"All"})]}),e(Ly,{columns:q,query:y}),e(LI,{})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:w=>V(w.target),ref:l,children:o("table",{css:Al,style:{...Ce,width:W.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:W.getHeaderGroups().map(w=>e("tr",{children:w.headers.map($=>e("th",{colSpan:$.colSpan,style:{width:`calc(var(--header-${$.id}-size) * 1px)`},children:$.isPlaceholder?null:o(te,{children:[o("div",{className:$.column.getCanSort()?"sort":"",onClick:$.column.getToggleSortingHandler(),style:{left:$.getStart(),width:$.getSize()},children:[e(mn,{maxWidth:$.getSize(),children:de($.column.columnDef.header,$.getContext())}),$.column.getIsSorted()?e(x,{className:"sort-icon",svg:$.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]}),e("div",{onMouseDown:$.getResizeHandler(),onTouchStart:$.getResizeHandler(),className:`resizer ${$.column.getIsResizing()?"isResizing":""}`})]})},$.id))},w.id))}),Q&&!k?e(Iy,{projectName:y.name}):ie.isResizingColumn?e(UI,{table:W,hasNext:k,onLoadNext:()=>h(yi),isLoadingNext:S}):e(By,{table:W,hasNext:k,onLoadNext:()=>h(yi),isLoadingNext:S})]})}),ne.length?e(Qy,{selectedSpans:N,onClearSelection:B}):null]})}function GI({queryReference:n}){const a=T.usePreloadedQuery(Qm,n);return e(HI,{project:a.project})}const S5=()=>{const{spansQueryReference:n}=nr();return n?e(ko,{children:o(Tp,{children:[e(oo,{children:e(f.Suspense,{fallback:e(me,{}),children:e(GI,{queryReference:n})})}),e(f.Suspense,{children:e(Ue,{})})]})}):null},qy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},l={defaultValue:30,kind:"LocalArgument",name:"first"},t={defaultValue:null,kind:"LocalArgument",name:"id"},i={defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},r={defaultValue:null,kind:"LocalArgument",name:"timeRange"},s=[{kind:"Variable",name:"id",variableName:"id"}],d={kind:"Variable",name:"after",variableName:"after"},c={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},u={kind:"Variable",name:"first",variableName:"first"},m={kind:"Variable",name:"sort",variableName:"sort"},g={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},h=[d,c,u,{kind:"Literal",name:"rootSpansOnly",value:!0},m,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],k={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},F={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},L={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},M=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],E={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:M,storageKey:null},P={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:M,storageKey:null},_={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},D={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},A={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},V={alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},j={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[p,y,A,V,{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},p],storageKey:null}],storageKey:null},ce={alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},A],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},y],storageKey:null},W={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[p,{alias:null,args:null,concreteType:"AnnotationConfigConnection",kind:"LinkedField",name:"annotationConfigs",plural:!1,selections:[{alias:null,args:null,concreteType:"AnnotationConfigEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationType",storageKey:null}],type:"AnnotationConfigBase",abstractKey:"__isAnnotationConfigBase"},{kind:"InlineFragment",selections:[p,y,{alias:null,args:null,kind:"ScalarField",name:"optimizationDirection",storageKey:null},{alias:null,args:null,concreteType:"CategoricalAnnotationValue",kind:"LinkedField",name:"values",plural:!0,selections:[A,V],storageKey:null}],type:"CategoricalAnnotationConfig",abstractKey:null},{kind:"InlineFragment",selections:[p],type:"Node",abstractKey:"__isNode"}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},Pe={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:[d,c,u,m],kind:"FragmentSpread",name:"TracesTable_spans"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,i,r,t],kind:"Operation",name:"TracesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,p,{kind:"InlineFragment",selections:[y,{alias:null,args:null,kind:"ScalarField",name:"spanAnnotationNames",storageKey:null},{alias:"rootSpans",args:h,concreteType:"SpanConnection",kind:"LinkedField",name:"spans",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,k,y,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},S,F,I,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},L,E,P,_,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[p,D,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},j,ce,W,Pe,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[p,k,y,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},S,F,I,L,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},E,P,_,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[p,D],storageKey:null},j,W,ce,Pe],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[g,p],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"rootSpans",args:h,filters:["sort","rootSpansOnly","filterCondition","timeRange"],handle:"connection",key:"TracesTable_rootSpans",kind:"LinkedHandle",name:"spans"}],type:"Project",abstractKey:null}],storageKey:null}]},params:{cacheID:"d30684c52189e88dab2fb3e08b4e4ada",id:null,metadata:{},name:"TracesTableQuery",operationKind:"query",text:`query TracesTableQuery(
  $after: String = null
  $filterCondition: String = null
  $first: Int = 30
  $sort: SpanSort = {col: startTime, dir: desc}
  $timeRange: TimeRange
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...TracesTable_spans_1XEuU
    id
  }
}

fragment AnnotationSummaryGroup on Span {
  project {
    id
    annotationConfigs {
      edges {
        node {
          __typename
          ... on AnnotationConfigBase {
            __isAnnotationConfigBase: __typename
            annotationType
          }
          ... on CategoricalAnnotationConfig {
            id
            name
            optimizationDirection
            values {
              label
              score
            }
          }
          ... on Node {
            __isNode: __typename
            id
          }
        }
      }
    }
  }
  spanAnnotations {
    id
    name
    label
    score
    annotatorKind
    createdAt
    user {
      username
      profilePictureUrl
      id
    }
  }
  spanAnnotationSummaries {
    labelFractions {
      fraction
      label
    }
    meanScore
    name
  }
}

fragment SpanColumnSelector_annotations on Project {
  spanAnnotationNames
}

fragment TraceHeaderRootSpanAnnotationsFragment on Span {
  ...AnnotationSummaryGroup
}

fragment TracesTable_spans_1XEuU on Project {
  name
  ...SpanColumnSelector_annotations
  rootSpans: spans(first: $first, after: $after, sort: $sort, rootSpansOnly: true, filterCondition: $filterCondition, timeRange: $timeRange) {
    edges {
      rootSpan: node {
        id
        spanKind
        name
        metadata
        statusCode
        startTime
        endTime
        latencyMs
        cumulativeTokenCountTotal
        parentId
        input {
          value: truncatedValue
        }
        output {
          value: truncatedValue
        }
        spanId
        trace {
          id
          traceId
          numSpans
          costSummary {
            total {
              cost
            }
          }
        }
        spanAnnotations {
          id
          name
          label
          score
          annotatorKind
          createdAt
        }
        spanAnnotationSummaries {
          labelFractions {
            fraction
            label
          }
          meanScore
          name
        }
        ...AnnotationSummaryGroup
        documentRetrievalMetrics {
          evaluationName
          ndcg
          precision
          hit
        }
        descendants(first: 50) {
          edges {
            node {
              id
              spanKind
              name
              statusCode: propagatedStatusCode
              startTime
              endTime
              latencyMs
              parentId
              cumulativeTokenCountTotal: tokenCountTotal
              input {
                value: truncatedValue
              }
              output {
                value: truncatedValue
              }
              spanId
              trace {
                id
                traceId
              }
              spanAnnotations {
                id
                name
                label
                score
                annotatorKind
                createdAt
              }
              ...AnnotationSummaryGroup
              documentRetrievalMetrics {
                evaluationName
                ndcg
                precision
                hit
              }
              ...TraceHeaderRootSpanAnnotationsFragment
            }
          }
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();qy.hash="b2ce5da0dab3a8061fce34751c19df14";const Uy=(function(){var n=["rootSpans"],a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"spanKind",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"parentId",storageKey:null},c=[{alias:"value",args:null,kind:"ScalarField",name:"truncatedValue",storageKey:null}],u={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"input",plural:!1,selections:c,storageKey:null},m={alias:null,args:null,concreteType:"SpanIOValue",kind:"LinkedField",name:"output",plural:!1,selections:c,storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},h={alias:null,args:null,concreteType:"SpanAnnotation",kind:"LinkedField",name:"spanAnnotations",plural:!0,selections:[l,a,y,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},k={args:null,kind:"FragmentSpread",name:"AnnotationSummaryGroup"},S={alias:null,args:null,concreteType:"DocumentRetrievalMetrics",kind:"LinkedField",name:"documentRetrievalMetrics",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"evaluationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ndcg",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"precision",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hit",storageKey:null}],storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:30,kind:"LocalArgument",name:"first"},{defaultValue:{col:"startTime",dir:"desc"},kind:"LocalArgument",name:"sort"},{kind:"RootArgument",name:"timeRange"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:qy,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"TracesTable_spans",selections:[a,{args:null,kind:"FragmentSpread",name:"SpanColumnSelector_annotations"},{alias:"rootSpans",args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Literal",name:"rootSpansOnly",value:!0},{kind:"Variable",name:"sort",variableName:"sort"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanConnection",kind:"LinkedField",name:"__TracesTable_rootSpans_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"rootSpan",args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,a,{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"statusCode",storageKey:null},i,r,s,{alias:null,args:null,kind:"ScalarField",name:"cumulativeTokenCountTotal",storageKey:null},d,u,m,g,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,p,{alias:null,args:null,kind:"ScalarField",name:"numSpans",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},h,{alias:null,args:null,concreteType:"AnnotationSummary",kind:"LinkedField",name:"spanAnnotationSummaries",plural:!0,selections:[{alias:null,args:null,concreteType:"LabelFraction",kind:"LinkedField",name:"labelFractions",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fraction",storageKey:null},y],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},a],storageKey:null},k,S,{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"SpanConnection",kind:"LinkedField",name:"descendants",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,a,{alias:"statusCode",args:null,kind:"ScalarField",name:"propagatedStatusCode",storageKey:null},i,r,s,d,{alias:"cumulativeTokenCountTotal",args:null,kind:"ScalarField",name:"tokenCountTotal",storageKey:null},u,m,g,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[l,p],storageKey:null},h,k,S,{args:null,kind:"FragmentSpread",name:"TraceHeaderRootSpanAnnotationsFragment"}],storageKey:null}],storageKey:null}],storageKey:"descendants(first:50)"}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Span",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},l],type:"Project",abstractKey:null}})();Uy.hash="b2ce5da0dab3a8061fce34751c19df14";const vd=Gs,WI=50,Hy=({table:n})=>{const a=Me(),{traceId:l}=on();return e("tbody",{children:n.getRowModel().rows.map(t=>{const i=t.original.trace.traceId===l;return e("tr",{onClick:()=>a(`${t.original.trace.traceId}`),"data-is-additional-row":t.original.__additionalRow,"data-selected":i,css:K(XI),children:t.getVisibleCells().map(r=>{const s=`--col-${r.column.id}-size`;return e("td",{style:{width:`calc(var(${s}) * 1px)`,maxWidth:`calc(var(${s}) * 1px)`,textWrap:"nowrap",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:de(r.column.columnDef.cell,r.getContext())},r.id)})},t.id)})})},JI=Da.memo(Hy,(n,a)=>n.table.options.data===a.table.options.data),ZI=({row:n})=>n.original.__additionalRow?null:e(Py,{metadata:n.original.metadata}),XI=K`
  &[data-is-additional-row="true"] {
    box-shadow: inset 0 -10px 20px var(--ac-global-color-grey-100);
  }
`;function Gy(n){const{children:a}=n,l=[];for(const t of a){const i={...t.span,children:Gy({children:t.children})};l.push(i)}return l}function YI(n){const a=f.useRef(null),l=f.useRef(!0),[t,i]=f.useState({}),[r,s]=f.useState([]),[d,c]=f.useState(""),{fetchKey:u}=Nl(),{data:m,loadNext:g,hasNext:p,isLoadingNext:y,refetch:h}=T.usePaginationFragment(Uy,n.project),k=Fn(w=>w.annotationColumnVisibility),S=f.useMemo(()=>Object.keys(k).filter(w=>k[w]),[k]),F=f.useMemo(()=>m.rootSpans.edges.map(({rootSpan:w})=>{const $=J0([w,...w.descendants.edges.map(({node:Pn})=>Pn)]),[X]=Gy({children:$}),pe=w.trace.numSpans-WI-1;return pe>0&&(X.children=[...X.children,{...X,__additionalRow:!0,name:`+ ${pe} more span${pe>1?"s":""}`,id:`additional-${X.id}`,input:{value:""},output:{value:""},metadata:null,spanAnnotations:[],documentRetrievalMetrics:[],children:[]}]),X}),[m]),I=f.useMemo(()=>S.map(w=>({header:w,columns:[{header:"labels",accessorKey:pt(w,"label"),cell:({row:$})=>{var pe;const X=(pe=$.original.spanAnnotationSummaries)==null?void 0:pe.find(Pn=>Pn.name===w);return X?e(co,{name:w,labelFractions:X.labelFractions}):null}},{header:"mean score",accessorKey:pt(w,"score"),cell:({row:$})=>{var pe;const X=(pe=$.original.spanAnnotationSummaries)==null?void 0:pe.find(Pn=>Pn.name===w);return X?e(Ht,{value:X.meanScore,fallback:null}):null}}]})),[S]),L=f.useMemo(()=>[{header:()=>o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e("span",{children:"Annotations"}),o(kt,{children:[e(Te,{level:3,weight:"heavy",children:"Annotations"}),e(v,{children:"Evaluations and human annotations logged via the API or set via the UI."})]})]}),id:"annotations",accessorKey:"spanAnnotations",enableSorting:!1,cell:({row:w})=>{if(w.original.__additionalRow)return null;const $=w.original.spanAnnotations.length===0&&w.original.documentRetrievalMetrics.length===0;return o(b,{direction:"row",gap:"size-50",wrap:"wrap",children:[e(ji,{span:w.original,showFilterActions:!0}),w.original.documentRetrievalMetrics.map(X=>o(f.Fragment,{children:[e(ya,{name:X.evaluationName,metric:"ndcg",score:X.ndcg},"ndcg"),e(ya,{name:X.evaluationName,metric:"precision",score:X.precision},"precision"),e(ya,{name:X.evaluationName,metric:"hit",score:X.hit},"hit")]},"doc-evals")),$?"--":null]})}},...I],[I]),M=f.useMemo(()=>[{id:"select",maxSize:32,header:({table:w})=>e(Va,{isSelected:w.getIsAllRowsSelected(),isIndeterminate:w.getIsSomeRowsSelected(),onChange:w.toggleAllRowsSelected}),cell:({row:w})=>w.original.__additionalRow?null:e(Va,{isSelected:w.getIsSelected(),isDisabled:!w.getCanSelect(),isIndeterminate:w.getIsSomeSelected(),onChange:w.toggleSelected})},{header:"status",accessorKey:"statusCode",enableSorting:!1,minSize:50,maxSize:75,cell:({getValue:w,row:$})=>{if($.original.__additionalRow)return null;const X=w();return e(Ni,{statusCode:X})}},{header:({table:w})=>o(b,{gap:"size-50",direction:"row",alignItems:"center",children:[e(Lo,{isExpanded:w.getIsAllRowsExpanded(),onClick:w.getToggleAllRowsExpandedHandler(),"aria-label":"Expand all rows"}),"kind"]}),enableSorting:!1,accessorKey:"spanKind",maxSize:100,cell:w=>w.row.original.__additionalRow?e("div",{css:K`
                  // Since rows are flattened by default,
                  // we can use the row.depth property
                  // and paddingLeft to visually indicate the depth
                  // of the row
                  padding-left: ${w.row.depth*2}rem;
                `,children:e(x,{svg:e(ll,{})})}):e("div",{css:K`
                // Since rows are flattened by default,
                // we can use the row.depth property
                // and paddingLeft to visually indicate the depth
                // of the row
                padding-left: ${w.row.depth*2}rem;
              `,children:o(b,{gap:"size-50",children:[w.row.getCanExpand()?e(Lo,{isExpanded:w.row.getIsExpanded(),onClick:w.row.getToggleExpandedHandler(),"aria-label":"Expand row"}):null,e(ms,{spanKind:w.getValue()})]})})},{header:"name",accessorKey:"name",enableSorting:!1,cell:({getValue:w,row:$})=>{const{traceId:X}=$.original.trace,pe=$.original.isAdditionalSpansRow?null:$.original.id;return e(Dn,{to:`${X}${pe?`?${aa}=${pe}`:""}`,children:w()})}},{header:"input",accessorKey:"input.value",enableSorting:!1,cell:In},{header:"output",accessorKey:"output.value",enableSorting:!1,cell:In},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:ZI},...L,{header:"start time",accessorKey:"startTime",cell:w=>w.row.original.__additionalRow?null:e(tn,{...w})},{header:"latency",accessorKey:"latencyMs",cell:({getValue:w,row:$})=>{const X=w();return X===null||typeof X!="number"||$.original.__additionalRow?null:e(Rn,{latencyMs:X})}},{header:"total tokens",minSize:80,accessorKey:"cumulativeTokenCountTotal",cell:({row:w,getValue:$})=>{if(w.original.__additionalRow)return null;const X=$();return X===null?"--":e(Z0,{tokenCountTotal:X,nodeId:w.original.trace.id})}},{header:"total cost",minSize:80,accessorKey:"trace.costSummary.total.cost",id:"cumulativeTokenCostTotal",cell:({row:w,getValue:$})=>{const X=$();if(X===null||typeof X!="number")return"--";const pe=w.original;return e(fs,{totalCost:X,nodeId:pe.trace.id,size:"S"})}}],[L]);f.useEffect(()=>{if(l.current===!0){l.current=!1;return}const w=r[0];f.startTransition(()=>{h({sort:w?vy(w):Sy,after:null,first:vd,filterCondition:d},{fetchPolicy:"store-and-network"})})},[r,h,d,u]);const E=f.useCallback(w=>{if(w){const{scrollHeight:$,scrollTop:X,clientHeight:pe}=w;$-X-pe<300&&!y&&p&&g(vd)}},[p,y,g]),P=mo(),_=P==null?void 0:P.setTraceSequence;f.useEffect(()=>{if(_)return _(m.rootSpans.edges.map(({rootSpan:w})=>({traceId:w.trace.traceId,spanId:w.id}))),()=>{_([])}},[m.rootSpans.edges,_]);const[D,A]=f.useState({}),V=Fn(w=>w.columnVisibility),j=Fn(w=>w.setColumnSizing),ce=Fn(w=>w.columnSizing),W=Qe({columns:M,data:F,onExpandedChange:A,manualSorting:!0,getSubRows:w=>w.children,state:{sorting:r,expanded:D,columnVisibility:V,rowSelection:t,columnSizing:ce},columnResizeMode:"onChange",onRowSelectionChange:i,enableSubRowSelection:!1,onSortingChange:s,onColumnSizingChange:j,getCoreRowModel:Be(),getSortedRowModel:Vn(),getExpandedRowModel:Qc()}),Pe=W.getRowModel().rows,ne=W.getSelectedRowModel().flatRows,N=ne.map(w=>({id:w.original.id,traceId:w.original.trace.id})),B=f.useCallback(()=>{i({})},[i]),Q=Pe.length===0,q=W.getAllColumns().filter(w=>w.columns.length===0),{columnSizingInfo:ie,columnSizing:Z}=W.getState(),ue=W.getFlatHeaders,Ke=q.length,Ce=Da.useMemo(()=>{const w=ue(),$={};for(let X=0;X<w.length;X++){const pe=w[X];$[`--header-${pe.id}-size`]=pe.getSize(),$[`--col-${pe.column.id}-size`]=pe.column.getSize()}return $},[ue,ie,Z,Ke]);return o("div",{css:fo,children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-100",width:"100%",alignItems:"center",children:[e(Ey,{onValidCondition:c}),e(Ly,{columns:q,query:m})]})}),e("div",{css:K`
          flex: 1 1 auto;
          overflow: auto;
        `,onScroll:w=>E(w.target),ref:a,children:o("table",{css:Al,style:{...Ce,width:W.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:W.getHeaderGroups().map(w=>e("tr",{children:w.headers.map($=>e("th",{style:{width:`calc(var(--header-${$.id}-size) * 1px)`},colSpan:$.colSpan,children:$.isPlaceholder?null:o(te,{children:[o("div",{"data-sortable":$.column.getCanSort(),className:$.column.getCanSort()?"sort":"",onClick:$.column.getToggleSortingHandler(),style:{left:$.getStart(),width:$.getSize()},children:[e(mn,{maxWidth:"100%",children:de($.column.columnDef.header,$.getContext())}),$.column.getIsSorted()?e(x,{className:"sort-icon",svg:$.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]}),e("div",{onMouseDown:$.getResizeHandler(),onTouchStart:$.getResizeHandler(),className:`resizer ${$.column.getIsResizing()?"isResizing":""}`})]})},$.id))},w.id))}),Q?e(Iy,{projectName:m.name}):ie.isResizingColumn?e(JI,{table:W}):e(Hy,{table:W})]})}),ne.length?e(Qy,{selectedSpans:N,onClearSelection:B}):null]})}const ex=({tracesQueryReference:n})=>{const a=T.usePreloadedQuery(jm,n);return e(YI,{project:a.project})},v5=()=>{const{tracesQueryReference:n}=nr();return n?e(ko,{children:o(Tp,{children:[e(oo,{children:e(f.Suspense,{fallback:e(me,{}),children:e(ex,{tracesQueryReference:n})})}),e(f.Suspense,{children:e(Ue,{})})]})}):null},Wy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"projectLoaderQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"146b6f58a3f2f95565821ff5d976155d",id:null,metadata:{},name:"projectLoaderQuery",operationKind:"query",text:`query projectLoaderQuery(
  $id: ID!
) {
  project: node(id: $id) {
    __typename
    id
    ... on Project {
      name
    }
  }
}
`}}})();Wy.hash="3e1dc1a02098a23c327567a7fcf393fd";async function F5(n){const{projectId:a}=n.params;return await T.fetchQuery(ze,Wy,{id:a}).toPromise()}const Jy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"projectId"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l],i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],s={alias:null,args:[{kind:"Variable",name:"projectId",variableName:"projectId"},l],concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TopModelsByCostQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"GenerativeModel",kind:"LinkedField",name:"topModelsByCost",plural:!0,selections:[i,s],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TopModelsByCostQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"GenerativeModel",kind:"LinkedField",name:"topModelsByCost",plural:!0,selections:[i,s,d],storageKey:null}],type:"Project",abstractKey:null},d],storageKey:null}]},params:{cacheID:"414c76bdca99afd8a181b7f86f0577c2",id:null,metadata:{},name:"TopModelsByCostQuery",operationKind:"query",text:`query TopModelsByCostQuery(
  $projectId: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      topModelsByCost(timeRange: $timeRange) {
        name
        costSummary(projectId: $projectId, timeRange: $timeRange) {
          prompt {
            cost
          }
          completion {
            cost
          }
          total {
            cost
          }
        }
        id
      }
    }
    id
  }
}
`}}})();Jy.hash="2c9e10de82227b52a32ee3be700dcb2f";function nx({active:n,payload:a,label:l}){var i,r;const t=cl();if(n&&a&&a.length){const s=((i=a[0])==null?void 0:i.value)??null,d=((r=a[1])==null?void 0:r.value)??null;return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:l}),e(_e,{color:t.category1,shape:"circle",name:"Prompt cost",value:cn(s)}),e(_e,{color:t.category2,shape:"circle",name:"Completion cost",value:cn(d)})]})}return null}function ax({projectId:n,timeRange:a}){var r,s;const l=cl(),t=T.useLazyLoadQuery(Jy,{projectId:n,timeRange:{start:(r=a.start)==null?void 0:r.toISOString(),end:(s=a.end)==null?void 0:s.toISOString()}}),i=f.useMemo(()=>(t.project.topModelsByCost??[]).map(c=>{const u=c.costSummary;return{model:c.name,prompt_cost:u.prompt.cost,completion_cost:u.completion.cost,total_cost:u.total.cost}}),[t]);return e(yn,{width:"100%",height:"100%",children:o(oa,{data:i,margin:{top:0,right:18,left:0,bottom:0},layout:"vertical",barSize:10,children:[e(Sn,{...Fa,vertical:!1}),e(pn,{content:nx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(vn,{...Ca,type:"number",tickLine:!1,tickFormatter:cn}),e(an,{...Ka,dataKey:"model",type:"category",width:120}),e(Ze,{dataKey:"prompt_cost",fill:l.category1,stackId:"a",radius:[2,0,0,2]}),e(Ze,{dataKey:"completion_cost",fill:l.category2,stackId:"a",radius:[0,2,2,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const Zy=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"projectId"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t=[l],i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},r=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null}],s={alias:null,args:[{kind:"Variable",name:"projectId",variableName:"projectId"},l],concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:r,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:r,storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"TopModelsByTokenQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"GenerativeModel",kind:"LinkedField",name:"topModelsByTokenCount",plural:!0,selections:[i,s],storageKey:null}],type:"Project",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"TopModelsByTokenQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"GenerativeModel",kind:"LinkedField",name:"topModelsByTokenCount",plural:!0,selections:[i,s,d],storageKey:null}],type:"Project",abstractKey:null},d],storageKey:null}]},params:{cacheID:"72eb0f60cae5139d787a911c29d7b600",id:null,metadata:{},name:"TopModelsByTokenQuery",operationKind:"query",text:`query TopModelsByTokenQuery(
  $projectId: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      topModelsByTokenCount(timeRange: $timeRange) {
        name
        costSummary(projectId: $projectId, timeRange: $timeRange) {
          prompt {
            tokens
          }
          completion {
            tokens
          }
          total {
            tokens
          }
        }
        id
      }
    }
    id
  }
}
`}}})();Zy.hash="68024c3ccb1477417cea20a939d0d378";function lx({active:n,payload:a,label:l}){var i,r;const t=cl();if(n&&a&&a.length){const s=((i=a[0])==null?void 0:i.value)??null,d=((r=a[1])==null?void 0:r.value)??null;return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:l}),e(_e,{color:t.category1,shape:"circle",name:"Prompt tokens",value:Ye(s)}),e(_e,{color:t.category2,shape:"circle",name:"Completion tokens",value:Ye(d)})]})}return null}function tx({projectId:n,timeRange:a}){var r,s;const l=cl(),t=T.useLazyLoadQuery(Zy,{projectId:n,timeRange:{start:(r=a.start)==null?void 0:r.toISOString(),end:(s=a.end)==null?void 0:s.toISOString()}}),i=f.useMemo(()=>(t.project.topModelsByTokenCount??[]).map(c=>{const u=c.costSummary,m=u.prompt.tokens,g=u.completion.tokens,p=u.total.tokens;return{model:c.name,prompt_tokens:m,completion_tokens:g,total_tokens:p}}),[t]);return e(yn,{width:"100%",height:"100%",children:o(oa,{data:i,margin:{top:0,right:18,left:0,bottom:0},layout:"vertical",barSize:10,children:[e(Sn,{...Fa,vertical:!1}),e(pn,{content:lx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(vn,{...Ca,type:"number",tickLine:!1,tickFormatter:Ye}),e(an,{...Ka,dataKey:"model",type:"category",width:120}),e(Ze,{dataKey:"prompt_tokens",stackId:"a",fill:l.category1,radius:[2,0,0,2]}),e(Ze,{dataKey:"completion_tokens",stackId:"a",fill:l.category2,radius:[0,2,2,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const Xy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"TraceCountByStatusTimeSeries",kind:"LinkedField",name:"traceCountByStatusTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceCountByStatusTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"TraceErrorsTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"TraceErrorsTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"14406c9b74559086ef4c1a390d71c30a",id:null,metadata:{},name:"TraceErrorsTimeSeriesQuery",operationKind:"query",text:`query TraceErrorsTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      traceCountByStatusTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          errorCount
        }
      }
    }
    id
  }
}
`}}})();Xy.hash="e200b36b8a75e09ce855dc7230a68ec1";function Ga({timeRange:n}){return f.useMemo(()=>{const a=n.start;let l="DAY";if(a){const i=((n.end||new Date).getTime()-a.getTime())/1e3;i>5*X0?l="YEAR":i>5*Y0?l="MONTH":i>5*eb?l="WEEK":i>5*nb?l="DAY":i>5*ab?l="HOUR":l="MINUTE"}return l},[n])}function Wa(){return f.useMemo(()=>-new Date().getTimezoneOffset(),[])}const ix=new Intl.NumberFormat([],{maximumFractionDigits:2});function rx({active:n,payload:a,label:l}){var r;const t=ul(),{fullTimeFormatter:i}=kn();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=typeof s=="number"?ix.format(s):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${i(new Date(l))}`}),e(_e,{color:t.danger,shape:"circle",name:"error",value:d})]})}return null}function sx({projectId:n,timeRange:a}){var u,m,g;const l=Ga({timeRange:a}),t=Wa(),r=(((g=T.useLazyLoadQuery(Xy,{projectId:n,timeRange:{start:(u=a.start)==null?void 0:u.toISOString(),end:(m=a.end)==null?void 0:m.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}).project.traceCountByStatusTimeSeries)==null?void 0:g.data)??[]).map(p=>({timestamp:p.timestamp,error:p.errorCount})),s=Ba({scale:l}),d=qa({scale:l}),c=ul();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:p=>s(new Date(p))}),e(an,{...Ka,width:55,tickFormatter:p=>Ye(p),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:rx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:c.danger,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const Yy=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"projectId"}],r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanCountTimeSeries",kind:"LinkedField",name:"spanCountTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanCountTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"okCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unsetCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"LLMSpanCountTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"LLMSpanCountTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"d53f83979a3c6e1c08999f5b6ac8a3f7",id:null,metadata:{},name:"LLMSpanCountTimeSeriesQuery",operationKind:"query",text:`query LLMSpanCountTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
  $filterCondition: String!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      spanCountTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig, filterCondition: $filterCondition) {
        data {
          timestamp
          okCount
          errorCount
          unsetCount
        }
      }
    }
    id
  }
}
`}}})();Yy.hash="514bda0696087b04a30995ca559b80c1";function ox({active:n,payload:a,label:l}){var i,r,s,d,c,u;const{fullTimeFormatter:t}=kn();if(n&&a&&a.length){const m=((i=a[0])==null?void 0:i.value)??null,g=((r=a[0])==null?void 0:r.color)??null,p=((s=a[1])==null?void 0:s.value)??null,y=((d=a[1])==null?void 0:d.color)??null,h=((c=a[2])==null?void 0:c.value)??null,k=((u=a[2])==null?void 0:u.color)??null,S=Ye(h),F=Ye(p),I=Ye(m);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:g,shape:"circle",name:"error",value:I}),e(_e,{color:y,shape:"circle",name:"unset",value:F}),e(_e,{color:k,shape:"circle",name:"ok",value:S})]})}return null}function dx({projectId:n,timeRange:a}){var m,g,p;const l=Ga({timeRange:a}),t=Wa(),r=(((p=T.useLazyLoadQuery(Yy,{projectId:n,timeRange:{start:(m=a.start)==null?void 0:m.toISOString(),end:(g=a.end)==null?void 0:g.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t},filterCondition:'span_kind == "LLM"'}).project.spanCountTimeSeries)==null?void 0:p.data)??[]).map(y=>({timestamp:y.timestamp,error:y.errorCount,unset:y.unsetCount,ok:y.okCount})),s=Ba({scale:l}),d=Un(),c=ul(),u=qa({scale:l});return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",interval:u,tickFormatter:y=>s(new Date(y))}),e(an,{...Ka,width:55,tickFormatter:y=>Gt(y),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:ox,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:c.danger}),e(Ze,{dataKey:"unset",stackId:"a",fill:d.grey500}),e(Ze,{dataKey:"ok",stackId:"a",fill:d.grey300,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const ef=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"projectId"}],r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanCountTimeSeries",kind:"LinkedField",name:"spanCountTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanCountTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"LLMSpanErrorsTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"LLMSpanErrorsTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"1b8e901b031f21828f03593299119bb0",id:null,metadata:{},name:"LLMSpanErrorsTimeSeriesQuery",operationKind:"query",text:`query LLMSpanErrorsTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
  $filterCondition: String!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      spanCountTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig, filterCondition: $filterCondition) {
        data {
          timestamp
          errorCount
        }
      }
    }
    id
  }
}
`}}})();ef.hash="b865d5f1114d973668d82efdedc53b21";function cx({active:n,payload:a,label:l}){var r;const t=ul(),{fullTimeFormatter:i}=kn();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=Ye(s);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${i(new Date(l))}`}),e(_e,{color:t.danger,shape:"circle",name:"error",value:d})]})}return null}function ux({projectId:n,timeRange:a}){var u,m,g;const l=Ga({timeRange:a}),t=qa({scale:l}),i=Wa(),s=(((g=T.useLazyLoadQuery(ef,{projectId:n,timeRange:{start:(u=a.start)==null?void 0:u.toISOString(),end:(m=a.end)==null?void 0:m.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:i},filterCondition:'span_kind == "LLM"'}).project.spanCountTimeSeries)==null?void 0:g.data)??[]).map(p=>({timestamp:p.timestamp,error:p.errorCount})),d=Ba({scale:l}),c=ul();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:s,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",interval:t,tickFormatter:p=>d(new Date(p))}),e(an,{...Ka,width:55,tickFormatter:p=>Gt(p),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:cx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:c.danger,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const nf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanAnnotationScoreTimeSeries",kind:"LinkedField",name:"spanAnnotationScoreTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanAnnotationScoreTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,concreteType:"SpanAnnotationScoreWithLabel",kind:"LinkedField",name:"scoresWithLabels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"names",storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"SpanAnnotationScoreTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"SpanAnnotationScoreTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"7f0d6f5b5da2c7e87daa43a6f5f4bf3c",id:null,metadata:{},name:"SpanAnnotationScoreTimeSeriesQuery",operationKind:"query",text:`query SpanAnnotationScoreTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      spanAnnotationScoreTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          scoresWithLabels {
            label
            score
          }
        }
        names
      }
    }
    id
  }
}
`}}})();nf.hash="709170f6d6e7e1273b1d5d924a3ba262";function mx({active:n,payload:a,label:l}){const{fullTimeFormatter:t}=kn();return n&&a&&a.length?o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),a.map((i,r)=>i.value?e(_e,{color:i.color||"#FF00FF",shape:"line",name:String(i.dataKey||"unknown"),value:i.value.toFixed(2)},r):null)]}):null}function gx({name:n}){const a=gs(n);return e(Pa,{type:"monotone",dataKey:n,stroke:a,strokeWidth:2,dot:{r:2},activeDot:{r:4},name:n})}function px({projectId:n,timeRange:a}){var m,g,p,y;const l=Ga({timeRange:a}),t=Wa(),i=T.useLazyLoadQuery(nf,{projectId:n,timeRange:{start:(m=a.start)==null?void 0:m.toISOString(),end:(g=a.end)==null?void 0:g.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}),r=((p=i.project.spanAnnotationScoreTimeSeries)==null?void 0:p.data)??[],s=((y=i.project.spanAnnotationScoreTimeSeries)==null?void 0:y.names)??[],d=r.map(h=>{const k={timestamp:new Date(h.timestamp)};return h.scoresWithLabels.forEach(S=>{k[S.label]=S.score}),k}),c=Ba({scale:l}),u=qa({scale:l});return e(yn,{width:"100%",height:"100%",children:o(e1,{data:d,margin:{top:0,right:18,left:0,bottom:0},syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",tickFormatter:h=>c(h),interval:u}),e(an,{width:55,tickFormatter:h=>Bl(h),label:{value:"Score",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}},...Ka}),e(Sn,{vertical:!1,...Fa}),e(pn,{content:mx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),s.map(h=>e(gx,{name:h},h)),e(sa,{...Ta,iconType:"line",iconSize:8})]})})}const af=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"projectId"}],r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanCountTimeSeries",kind:"LinkedField",name:"spanCountTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanCountTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"okCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"unsetCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"ToolSpanCountTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"ToolSpanCountTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"0a5e4bdb5bcce53751043c0baded7246",id:null,metadata:{},name:"ToolSpanCountTimeSeriesQuery",operationKind:"query",text:`query ToolSpanCountTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
  $filterCondition: String!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      spanCountTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig, filterCondition: $filterCondition) {
        data {
          timestamp
          okCount
          errorCount
          unsetCount
        }
      }
    }
    id
  }
}
`}}})();af.hash="3eccaa798cffe752af3f941b03e3047d";function yx({active:n,payload:a,label:l}){var i,r,s,d,c,u;const{fullTimeFormatter:t}=kn();if(n&&a&&a.length){const m=((i=a[0])==null?void 0:i.value)??null,g=((r=a[0])==null?void 0:r.color)??null,p=((s=a[1])==null?void 0:s.value)??null,y=((d=a[1])==null?void 0:d.color)??null,h=((c=a[2])==null?void 0:c.value)??null,k=((u=a[2])==null?void 0:u.color)??null,S=Ye(h),F=Ye(p),I=Ye(m);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:g,shape:"circle",name:"error",value:I}),e(_e,{color:y,shape:"circle",name:"unset",value:F}),e(_e,{color:k,shape:"circle",name:"ok",value:S})]})}return null}function fx({projectId:n,timeRange:a}){var m,g,p;const l=Ga({timeRange:a}),t=Wa(),r=(((p=T.useLazyLoadQuery(af,{projectId:n,timeRange:{start:(m=a.start)==null?void 0:m.toISOString(),end:(g=a.end)==null?void 0:g.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t},filterCondition:'span_kind == "TOOL"'}).project.spanCountTimeSeries)==null?void 0:p.data)??[]).map(y=>({timestamp:y.timestamp,error:y.errorCount,unset:y.unsetCount,ok:y.okCount})),s=Ba({scale:l}),d=qa({scale:l}),c=Un(),u=ul();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",tickFormatter:y=>s(new Date(y)),interval:d}),e(an,{...Ka,width:55,tickFormatter:y=>Gt(y),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:yx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:u.danger}),e(Ze,{dataKey:"unset",stackId:"a",fill:c.grey500}),e(Ze,{dataKey:"ok",stackId:"a",fill:c.grey300,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const lf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"filterCondition"},a={defaultValue:null,kind:"LocalArgument",name:"projectId"},l={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"projectId"}],r={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterCondition",variableName:"filterCondition"},{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"SpanCountTimeSeries",kind:"LinkedField",name:"spanCountTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"SpanCountTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"ToolSpanErrorsTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"ToolSpanErrorsTimeSeriesQuery",selections:[{alias:"project",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"d07d10e3b5535a3248d2616aad003c16",id:null,metadata:{},name:"ToolSpanErrorsTimeSeriesQuery",operationKind:"query",text:`query ToolSpanErrorsTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
  $filterCondition: String!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      spanCountTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig, filterCondition: $filterCondition) {
        data {
          timestamp
          errorCount
        }
      }
    }
    id
  }
}
`}}})();lf.hash="d4e6aef140bdee0a0e33a519f47785d1";function hx({active:n,payload:a,label:l}){var r;const t=ul(),{fullTimeFormatter:i}=kn();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=Ye(s);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${i(new Date(l))}`}),e(_e,{color:t.danger,shape:"circle",name:"error",value:d})]})}return null}function kx({projectId:n,timeRange:a}){var u,m,g;const l=Ga({timeRange:a}),t=Wa(),r=(((g=T.useLazyLoadQuery(lf,{projectId:n,timeRange:{start:(u=a.start)==null?void 0:u.toISOString(),end:(m=a.end)==null?void 0:m.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t},filterCondition:'span_kind == "TOOL"'}).project.spanCountTimeSeries)==null?void 0:g.data)??[]).map(p=>({timestamp:p.timestamp,error:p.errorCount})),s=Ba({scale:l}),d=qa({scale:l}),c=ul();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:p=>s(new Date(p))}),e(an,{...Ka,width:55,tickFormatter:p=>Gt(p),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:hx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:c.danger,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const tf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"TraceCountByStatusTimeSeries",kind:"LinkedField",name:"traceCountByStatusTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceCountByStatusTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"okCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"TraceCountTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"TraceCountTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"8a15201a8fa5e84fe8ead9a696d5db46",id:null,metadata:{},name:"TraceCountTimeSeriesQuery",operationKind:"query",text:`query TraceCountTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      traceCountByStatusTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          okCount
          errorCount
        }
      }
    }
    id
  }
}
`}}})();tf.hash="eaa82065496e0128142e6922554d0ddf";function bx({active:n,payload:a,label:l}){var i,r,s,d;const{fullTimeFormatter:t}=kn();if(n&&a&&a.length){const c=((i=a[0])==null?void 0:i.value)??null,u=((r=a[0])==null?void 0:r.color)??null,m=((s=a[1])==null?void 0:s.value)??null,g=((d=a[1])==null?void 0:d.color)??null,p=Ye(m),y=Ye(c);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:u,shape:"circle",name:"error",value:y}),e(_e,{color:g,shape:"circle",name:"ok",value:p})]})}return null}function Sx({projectId:n,timeRange:a}){var m,g,p;const l=Ga({timeRange:a}),t=Wa(),i=T.useLazyLoadQuery(tf,{projectId:n,timeRange:{start:(m=a.start)==null?void 0:m.toISOString(),end:(g=a.end)==null?void 0:g.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}),r=f.useMemo(()=>{var y;return(((y=i.project.traceCountByStatusTimeSeries)==null?void 0:y.data)??[]).map(h=>({timestamp:new Date(h.timestamp),ok:h.okCount,error:h.errorCount}))},[(p=i.project.traceCountByStatusTimeSeries)==null?void 0:p.data]),s=Ba({scale:l}),d=qa({scale:l}),c=Un(),u=ul();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:y=>s(new Date(y))}),e(an,{...Ka,width:55,tickFormatter:y=>Ye(y),label:{value:"Count",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(Sn,{...Fa,vertical:!1}),e(pn,{content:bx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"error",stackId:"a",fill:u.danger}),e(Ze,{dataKey:"ok",stackId:"a",fill:c.grey300,radius:[2,2,0,0]}),e(sa,{iconType:"circle",iconSize:8,...Ta})]})})}const rf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"TraceLatencyPercentileTimeSeries",kind:"LinkedField",name:"traceLatencyMsPercentileTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceLatencyMsPercentileTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p50",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p75",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p90",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p95",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p99",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"p999",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"max",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"TraceLatencyPercentilesTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"TraceLatencyPercentilesTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"6c789d659dbd5cdd9a890996b82d2aeb",id:null,metadata:{},name:"TraceLatencyPercentilesTimeSeriesQuery",operationKind:"query",text:`query TraceLatencyPercentilesTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      traceLatencyMsPercentileTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          p50
          p75
          p90
          p95
          p99
          p999
          max
        }
      }
    }
    id
  }
}
`}}})();rf.hash="741f12e79590c1e1fb779d92730cacf9";function vx({active:n,payload:a,label:l}){const{fullTimeFormatter:t}=kn();return n&&a&&a.length?o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),a.map((i,r)=>i.value?e(_e,{color:i.color||"#ffffff",shape:"line",name:i.dataKey||"unknown",value:`${Bl(i.value)} s`},r):null)]}):null}function Fx({projectId:n,timeRange:a}){var p,y,h;const l=Ga({timeRange:a}),t=Wa(),r=(((h=T.useLazyLoadQuery(rf,{projectId:n,timeRange:{start:(p=a.start)==null?void 0:p.toISOString(),end:(y=a.end)==null?void 0:y.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}).project.traceLatencyMsPercentileTimeSeries)==null?void 0:h.data)??[]).map(k=>({timestamp:new Date(k.timestamp),p50:typeof k.p50=="number"?k.p50/1e3:null,p75:typeof k.p75=="number"?k.p75/1e3:null,p90:typeof k.p90=="number"?k.p90/1e3:null,p95:typeof k.p95=="number"?k.p95/1e3:null,p99:typeof k.p99=="number"?k.p99/1e3:null,p999:typeof k.p999=="number"?k.p999/1e3:null,max:typeof k.max=="number"?k.max/1e3:null})),s=Ba({scale:l}),d=qa({scale:l}),c=Un(),[u,m]=f.useState({p50:!1,p75:!1,p90:!1,p95:!1,p99:!1,p999:!1,max:!1}),g=k=>{m({...u,[String(k.dataKey)]:!u[k.dataKey]})};return e(yn,{width:"100%",height:"100%",children:o(at,{data:r,margin:{top:0,right:18,left:0,bottom:0},syncId:"projectMetrics",children:[e(Sn,{vertical:!1,...Fa}),e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:k=>s(k)}),e(an,{width:55,tickFormatter:k=>Ye(k),label:{value:"Latency (s)",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}},...Ka}),e(Pa,{type:"monotone",dataKey:"p50",stroke:c.blue400,strokeWidth:1,activeDot:{r:4},name:"P50",hide:u.p50}),e(Pa,{type:"monotone",dataKey:"p75",stroke:c.blue400,strokeWidth:1,dot:{r:2},activeDot:{r:4},name:"P75",hide:u.p75}),e(Pa,{type:"monotone",dataKey:"p90",stroke:c.blue500,strokeWidth:2,dot:{r:2},activeDot:{r:4},name:"P90",hide:u.p90}),e(Pa,{type:"monotone",dataKey:"p95",stroke:c.blue600,strokeWidth:2,dot:{r:2},activeDot:{r:4},name:"P95",hide:u.p95}),e(Pa,{type:"monotone",dataKey:"p99",stroke:c.blue700,strokeWidth:2,dot:{r:2},activeDot:{r:4},name:"P99",hide:u.p99}),e(Pa,{type:"monotone",dataKey:"p999",stroke:c.blue800,strokeWidth:2,dot:{r:2},activeDot:{r:4},name:"P99.9",hide:u.p999}),e(Pa,{type:"monotone",dataKey:"max",stroke:c.blue900,strokeWidth:2,strokeDasharray:"5 5",dot:{r:2},activeDot:{r:4},name:"Max",hide:u.max}),e(sa,{...Ta,iconType:"line",iconSize:8,onClick:g}),e(pn,{content:vx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}})]})})}const sf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"TraceTokenCostTimeSeries",kind:"LinkedField",name:"traceTokenCostTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceTokenCostTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptCost",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completionCost",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"totalCost",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"TraceTokenCostTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"TraceTokenCostTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"7522c293e243611bc4bebfe30c7522ef",id:null,metadata:{},name:"TraceTokenCostTimeSeriesQuery",operationKind:"query",text:`query TraceTokenCostTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      traceTokenCostTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          promptCost
          completionCost
          totalCost
        }
      }
    }
    id
  }
}
`}}})();sf.hash="109edc0430448e11877ced236204dd49";function Cx({active:n,payload:a,label:l}){var r,s;const t=cl(),{fullTimeFormatter:i}=kn();if(n&&a&&a.length){const d=(r=a[0])==null?void 0:r.value,c=(s=a[1])==null?void 0:s.value,u=cn(d),m=cn(c);return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${i(new Date(l))}`}),e(_e,{color:t.category1,shape:"circle",name:"prompt",value:u}),e(_e,{color:t.category2,shape:"circle",name:"completion",value:m})]})}return null}function Kx({projectId:n,timeRange:a}){var u,m,g;const l=Ga({timeRange:a}),t=Wa(),r=(((g=T.useLazyLoadQuery(sf,{projectId:n,timeRange:{start:(u=a.start)==null?void 0:u.toISOString(),end:(m=a.end)==null?void 0:m.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}).project.traceTokenCostTimeSeries)==null?void 0:g.data)??[]).map(p=>({timestamp:p.timestamp,prompt:p.promptCost,completion:p.completionCost})),s=Ba({scale:l}),d=qa({scale:l}),c=cl();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(Sn,{...Fa,vertical:!1}),e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:p=>s(new Date(p))}),e(an,{...Ka,width:55,tickFormatter:p=>lb(p),label:{value:"Cost (USD)",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--chart-axis-label-color)"}}}),e(pn,{content:Cx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"prompt",stackId:"a",fill:c.category1}),e(Ze,{dataKey:"completion",stackId:"a",fill:c.category2,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}const of=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"projectId"},a={defaultValue:null,kind:"LocalArgument",name:"timeBinConfig"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"projectId"}],i={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"timeBinConfig",variableName:"timeBinConfig"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"TraceTokenCountTimeSeries",kind:"LinkedField",name:"traceTokenCountTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TraceTokenCountTimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptTokenCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"completionTokenCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"totalTokenCount",storageKey:null}],storageKey:null}],storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"TraceTokenCountTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"TraceTokenCountTimeSeriesQuery",selections:[{alias:"project",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"e123a97bd485838cd5cb2b534eabd0d5",id:null,metadata:{},name:"TraceTokenCountTimeSeriesQuery",operationKind:"query",text:`query TraceTokenCountTimeSeriesQuery(
  $projectId: ID!
  $timeRange: TimeRange!
  $timeBinConfig: TimeBinConfig!
) {
  project: node(id: $projectId) {
    __typename
    ... on Project {
      traceTokenCountTimeSeries(timeRange: $timeRange, timeBinConfig: $timeBinConfig) {
        data {
          timestamp
          promptTokenCount
          completionTokenCount
          totalTokenCount
        }
      }
    }
    id
  }
}
`}}})();of.hash="04ca506080201401409afce5ef6eb89d";function Tx({active:n,payload:a,label:l}){var r,s;const t=cl(),{fullTimeFormatter:i}=kn();if(n&&a&&a.length){const d=((r=a[0])==null?void 0:r.value)??null,c=((s=a[1])==null?void 0:s.value)??null,u=typeof d=="number"?Ye(d):"--",m=typeof c=="number"?Ye(c):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${i(new Date(l))}`}),e(_e,{color:t.category1,shape:"circle",name:"prompt",value:u}),e(_e,{color:t.category2,shape:"circle",name:"completion",value:m})]})}return null}function Px({projectId:n,timeRange:a}){var u,m,g;const l=Ga({timeRange:a}),t=Wa(),r=(((g=T.useLazyLoadQuery(of,{projectId:n,timeRange:{start:(u=a.start)==null?void 0:u.toISOString(),end:(m=a.end)==null?void 0:m.toISOString()},timeBinConfig:{scale:l,utcOffsetMinutes:t}}).project.traceTokenCountTimeSeries)==null?void 0:g.data)??[]).map(p=>({timestamp:p.timestamp,prompt:p.promptTokenCount??0,completion:p.completionTokenCount??0})),s=Ba({scale:l}),d=qa({scale:l}),c=cl();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:{top:0,right:18,left:0,bottom:0},barSize:10,syncId:"projectMetrics",children:[e(Sn,{...Fa,vertical:!1}),e(vn,{...Ca,dataKey:"timestamp",interval:d,tickFormatter:p=>s(new Date(p))}),e(an,{...Ka,width:55,tickFormatter:p=>Gt(p),label:{value:"Tokens",angle:-90,dx:-20,style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(pn,{content:Tx,cursor:{fill:"var(--chart-tooltip-cursor-fill-color)"}}),e(Ze,{dataKey:"prompt",stackId:"a",fill:c.category1}),e(Ze,{dataKey:"completion",stackId:"a",fill:c.category2,radius:[2,2,0,0]}),e(sa,{...Ta,iconType:"circle",iconSize:8})]})})}function Ix({title:n,subtitle:a}){return e("div",{css:K`
        padding: var(--ac-global-dimension-size-100)
          var(--ac-global-dimension-size-200) 0
          var(--ac-global-dimension-size-200);

        display: flex;
        flex-direction: row;
        gap: var(--ac-global-dimension-size-100);
      `,className:"dashboard-panel-header",children:o(b,{direction:"column",children:[e(Te,{children:n}),a&&e(v,{size:"XS",color:"grey-600",children:a})]})})}const da=f.forwardRef(function({title:a,subtitle:l,children:t},i){return e(C,{borderWidth:"thin",borderColor:"grey-200",borderRadius:"medium",height:"100%",width:"100%","data-testid":"dashboard-panel",backgroundColor:"grey-75",ref:i,children:o("div",{css:K`
          display: flex;
          flex-direction: column;
          height: 100%;
        `,children:[e(Ix,{title:a,subtitle:l}),e("div",{css:K`
            flex: 1 1 auto;
            padding: var(--ac-global-dimension-size-200);
            height: 190px;
            overflow: auto;
          `,children:e(ht,{children:e(f.Suspense,{fallback:e(me,{}),children:t})})})]})})});function xx(){const{timeRange:n}=Ut(),a=f.useMemo(()=>n.start?n.start.getTime():null,[n.start]),l=f.useMemo(()=>n.end?n.end.getTime():null,[n.end]),t=f.useRef({startMs:a,endMs:l}),i=f.useRef(Date.now());(t.current.startMs!==a||t.current.endMs!==l)&&(t.current={startMs:a,endMs:l},i.current=Date.now());const r=i.current;return f.useMemo(()=>{let d=a,c=l;return d!==null&&c!==null?{start:d,end:c}:d===null&&c!==null?{start:c-ki,end:c}:d!==null&&c===null?(c=d<r?r:d+ki,{start:d,end:c}):(c=r,d=c-ki,{start:d,end:c})},[a,l,r])}function C5(){const{projectId:n}=on();if(!n)throw new Error("projectId is required");const a=xx();return e("main",{css:K`
        width: 100%;
        height: 100%;
        box-sizing: border-box;
        overflow-y: auto;
      `,children:e(Lx,{projectId:n,epochTimeRange:a})})}const Lx=f.memo(function({projectId:a,epochTimeRange:l}){const t=f.useMemo(()=>({start:new Date(l.start),end:new Date(l.end)}),[l]);return o("div",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-size-200);
        padding: var(--ac-global-dimension-size-200);
      `,children:[o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"Traces over time",subtitle:"Overall volume of traces",children:e(Sx,{projectId:a,timeRange:t})}),e(da,{title:"Traces with errors",subtitle:"Overall volume of traces with errors",children:e(sx,{projectId:a,timeRange:t})})]}),o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"Trace Latency",subtitle:"Latency percentiles",children:e(Fx,{projectId:a,timeRange:t})}),e(da,{title:"Annotation scores",subtitle:"Average annotation scores",children:e(px,{projectId:a,timeRange:t})})]}),o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"Cost",subtitle:"Estimated cost in USD",children:e(Kx,{projectId:a,timeRange:t})}),e(da,{title:"Top models by cost",children:e(ax,{projectId:a,timeRange:t})})]}),o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"Token usage",subtitle:"Token usage by prompt and completion",children:e(Px,{projectId:a,timeRange:t})}),e(da,{title:"Top models by tokens",children:e(tx,{projectId:a,timeRange:t})})]}),o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"LLM spans",subtitle:"LLM span count over time",children:e(dx,{projectId:a,timeRange:t})}),e(da,{title:"LLM spans with errors",subtitle:"LLM spans with errors over time",children:e(ux,{projectId:a,timeRange:t})})]}),o(b,{direction:"row",gap:"size-200",children:[e(da,{title:"Tool spans",subtitle:"Tool span count over time",children:e(fx,{projectId:a,timeRange:t})}),e(da,{title:"Tool spans with errors",subtitle:"Tool spans with errors over time",children:e(kx,{projectId:a,timeRange:t})})]})]})});function K5(){const n=US(),a=f.useMemo(()=>n instanceof Error&&n.message==="Failed to fetch"?e(Dx,{}):n instanceof Error&&tb(n)?e(_x,{}):e(Ax,{error:n}),[n]);return e("main",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:e("section",{css:K`
          width: 500px;
          /* Add spacing on the bottom so it gets pushed down */
          margin-top: 200px;
          display: flex;
          flex-direction: column;
        `,children:a})})}function Dx(){return o(te,{children:[e(b,{direction:"column",width:"100%",alignItems:"center",children:e("h1",{children:"Server disconnected"})}),e("p",{children:"We are unable to reach the Phoenix server. Please ensure that Phoenix is running and try again."})]})}function _x(){return o(te,{children:[e(b,{direction:"column",width:"100%",alignItems:"center",children:e("h1",{children:"Connection timed out"})}),e("p",{children:"The connection to the Phoenix server timed out before a response was received. This typically happens when a load balancer or proxy closes the connection before the server can respond."}),e("p",{children:"Possible solutions:"}),o("ul",{css:K`
          margin: var(--ac-global-dimension-static-size-100) 0;
          padding-left: var(--ac-global-dimension-static-size-300);
        `,children:[e("li",{children:"Increase your load balancer or proxy timeout settings"}),e("li",{children:"Check if the Phoenix server is overloaded or slow to respond"}),e("li",{children:"Verify network connectivity between components"})]}),e("div",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:e(R,{variant:"primary",size:"S",onPress:()=>{window.location.reload()},children:"Retry"})})]})}function Ax({error:n}){return o(te,{children:[e(b,{direction:"column",width:"100%",alignItems:"center",children:e("h1",{children:"Something went wrong"})}),e("p",{children:"We strive to do our very best but  bugs happen. It would mean a lot to us if you could file a an issue. If you feel comfortable, please include the error details below in your issue. We will get back to you as soon as we can."}),e("p",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:o("span",{css:K`
            display: inline-flex;
            flex-direction: row;
            align-items: baseline;
            gap: 0.2em;
          `,children:[" the",e(tl,{href:"mailto:phoenix-devs@arize.com",children:"phoenix team"})]})}),o("div",{css:K`
          display: flex;
          flex-direction: row;
          justify-content: flex-end;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(tl,{href:"https://github.com/Arize-ai/phoenix/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D",children:"file an issue with us"}),e(R,{variant:"primary",size:"S",onPress:()=>{window.location.href="/"},children:"Return Home"})]}),o("details",{open:!0,children:[e("summary",{children:"error details"}),e("pre",{css:K`
            white-space: pre-wrap;
            overflow-wrap: break-word;
            overflow: hidden;
            overflow-y: auto;
            max-height: 500px;
          `,children:n instanceof Error?n.message:null})]})]})}function T5(){return e(ib,{children:e(Ue,{})})}const df=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={kind:"Variable",name:"timeRange",variableName:"timeRange"},t={kind:"InlineFragment",selections:[{alias:null,args:[l],kind:"ScalarField",name:"traceCount",storageKey:null},{alias:"latencyMsP50",args:[{kind:"Literal",name:"probability",value:.5},l],kind:"ScalarField",name:"latencyMsQuantile",storageKey:null}],type:"Project",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectMetricsQuery",selections:[{alias:"project",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{cacheID:"fe700bb5c4a22149fbc01725d5fd0c27",id:null,metadata:{},name:"ProjectsPageProjectMetricsQuery",operationKind:"query",text:`query ProjectsPageProjectMetricsQuery(
  $id: ID!
  $timeRange: TimeRange!
) {
  project: node(id: $id) {
    __typename
    ... on Project {
      traceCount(timeRange: $timeRange)
      latencyMsP50: latencyMsQuantile(probability: 0.5, timeRange: $timeRange)
    }
    id
  }
}
`}}})();df.hash="a3d9bb6d55795e9afa84514d8d1dcba1";const cf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectsPageProjectsQuery",selections:[{args:a,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectsPageProjectsQuery",selections:[{alias:null,args:a,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort","filter"],handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"4ce729574f508383c8126b9947ee799c",id:null,metadata:{},name:"ProjectsPageProjectsQuery",operationKind:"query",text:`query ProjectsPageProjectsQuery(
  $after: String = null
  $filter: ProjectFilter = null
  $first: Int = 50
  $sort: ProjectSort = null
) {
  ...ProjectsPageProjectsFragment_3JsJJ3
}

fragment ProjectsPageProjectsFragment_3JsJJ3 on Query {
  projects(first: $first, after: $after, sort: $sort, filter: $filter) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
        startTime
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();cf.hash="d4c6c361639eeba67a41568089bf699a";const uf=(function(){var n=["projects"];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:cf}},name:"ProjectsPageProjectsFragment",selections:[{alias:"projects",args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"ProjectConnection",kind:"LinkedField",name:"__ProjectsPage_projects_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();uf.hash="d4c6c361639eeba67a41568089bf699a";const mf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"filter"},a={defaultValue:null,kind:"LocalArgument",name:"first"},l={defaultValue:null,kind:"LocalArgument",name:"sort"},t=[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ProjectsPageQuery",selections:[{args:t,kind:"FragmentSpread",name:"ProjectsPageProjectsFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"ProjectsPageQuery",selections:[{alias:null,args:t,concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"project",args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:t,filters:["sort","filter"],handle:"connection",key:"ProjectsPage_projects",kind:"LinkedHandle",name:"projects"}]},params:{cacheID:"ca0df034be070fca2025c4f8922b9932",id:null,metadata:{},name:"ProjectsPageQuery",operationKind:"query",text:`query ProjectsPageQuery(
  $first: Int
  $sort: ProjectSort
  $filter: ProjectFilter
) {
  ...ProjectsPageProjectsFragment_1bvy9D
}

fragment ProjectsPageProjectsFragment_1bvy9D on Query {
  projects(first: $first, sort: $sort, filter: $filter) {
    edges {
      project: node {
        id
        name
        gradientStartColor
        gradientEndColor
        endTime
        startTime
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();mf.hash="c85f2b2ff3b9697931cca71426ea0b59";const Ex=()=>{const{projectViewMode:n,setProjectViewMode:a}=Cn(l=>({projectViewMode:l.projectViewMode,setProjectViewMode:l.setProjectViewMode}));return o(qt,{css:K`
        flex-basis: fit-content;
      `,selectedKeys:[n],selectionMode:"single",onSelectionChange:l=>{const t=l.values().next().value;typeof t=="string"&&a(t)},size:"M",children:[o(Se,{delay:100,children:[e(ga,{id:"grid",leadingVisual:e(x,{svg:e(rb,{})})}),e(Ii,{offset:10,children:e(C,{padding:"size-100",backgroundColor:"light",borderColor:"dark",borderWidth:"thin",borderRadius:"small",children:e(v,{children:"View projects in a grid"})})})]}),o(Se,{delay:100,children:[e(ga,{id:"table",leadingVisual:e(x,{svg:e(sb,{})})}),e(Ii,{offset:10,children:e(C,{padding:"size-100",backgroundColor:"light",borderColor:"dark",borderWidth:"thin",borderRadius:"small",children:e(v,{children:"View projects in a table"})})})]})]})},gf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},t=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ProjectMutationPayload",kind:"LinkedField",name:"createProject",plural:!1,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"gradientStartColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gradientEndColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:[{kind:"Literal",name:"first",value:50}],concreteType:"ProjectConnection",kind:"LinkedField",name:"projects",plural:!1,selections:[{alias:null,args:null,concreteType:"ProjectEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"node",plural:!1,selections:[a,l],storageKey:null}],storageKey:null}],storageKey:"projects(first:50)"}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ManualProjectGuideCreateProjectMutation",selections:t,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ManualProjectGuideCreateProjectMutation",selections:t},params:{cacheID:"66adc44a362691c6f6552bd469443fc9",id:null,metadata:{},name:"ManualProjectGuideCreateProjectMutation",operationKind:"mutation",text:`mutation ManualProjectGuideCreateProjectMutation(
  $input: CreateProjectInput!
) {
  createProject(input: $input) {
    project {
      id
      name
      gradientStartColor
      gradientEndColor
      createdAt
    }
    query {
      projects(first: 50) {
        edges {
          node {
            id
            name
          }
        }
      }
    }
  }
}
`}}})();gf.hash="da1e5f68e9954a2618ba7de1fb86921c";const wx=/^[a-zA-Z0-9._-]+$/,Fd=[{id:"blue-purple",label:"Blue Purple",startColor:"#3B82F6",endColor:"#6366F1"},{id:"green-cyan",label:"Green Cyan",startColor:"#10B981",endColor:"#06B6D4"},{id:"purple-pink",label:"Purple Pink",startColor:"#8B5CF6",endColor:"#EC4899"},{id:"orange-yellow",label:"Orange Yellow",startColor:"#F97316",endColor:"#FCD34D"},{id:"pink-red",label:"Pink Red",startColor:"#EC4899",endColor:"#EF4444"},{id:"cyan-blue",label:"Cyan Blue",startColor:"#06B6D4",endColor:"#3B82F6"},{id:"emerald-teal",label:"Emerald Teal",startColor:"#10B981",endColor:"#14B8A6"},{id:"violet-indigo",label:"Violet Indigo",startColor:"#8B5CF6",endColor:"#6366F1"},{id:"rose-pink",label:"Rose Pink",startColor:"#F43F5E",endColor:"#EC4899"},{id:"amber-orange",label:"Amber Orange",startColor:"#F59E0B",endColor:"#F97316"},{id:"lime-green",label:"Lime Green",startColor:"#84CC16",endColor:"#10B981"},{id:"sky-cyan",label:"Sky Cyan",startColor:"#0EA5E9",endColor:"#06B6D4"}];function Mx({onSubmit:n,isSubmitting:a,submitButtonText:l}){"use no memo";const{control:t,handleSubmit:i,watch:r,formState:{isDirty:s}}=sn({defaultValues:{name:"",description:"",gradientPreset:"blue-purple"}}),d=r("gradientPreset"),c=()=>{const p=Fd.find(y=>y.id===d);return{startColor:(p==null?void 0:p.startColor)||"#3B82F6",endColor:(p==null?void 0:p.endColor)||"#6366F1"}},{startColor:u,endColor:m}=c(),g=p=>{const{startColor:y,endColor:h}=c();n({name:p.name,description:p.description,gradientPreset:p.gradientPreset,gradientStartColor:y,gradientEndColor:h})};return o(bn,{children:[o(C,{padding:"size-200",children:[e(C,{paddingBottom:"size-200",marginBottom:"size-200",children:o(b,{direction:"row",gap:"size-400",alignItems:"center",children:[e(b,{direction:"column",alignItems:"center",gap:"size-200",children:e(Cs,{gradientStartColor:u,gradientEndColor:m,size:100})}),e(H,{name:"gradientPreset",control:t,render:({field:{onChange:p,value:y}})=>o("div",{css:ba,children:[e(J,{children:"Project Gradient"}),e(ob,{value:y,onChange:p,direction:"row",children:Fd.map(h=>e(db,{value:h.id,gradientStartColor:h.startColor,gradientEndColor:h.endColor,label:h.label,size:48},h.id))}),e(v,{slot:"description",children:"Select a predefined gradient to help identify your project"})]})})]})}),e(H,{name:"name",control:t,rules:{required:"Project name is required",pattern:{value:wx,message:"Project name must be URI safe. Use only letters, numbers, hyphens, underscores, and dots. No spaces or special characters."},minLength:{value:1,message:"Project name must be at least 1 character long"},maxLength:{value:100,message:"Project name must be less than 100 characters long"}},render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Project Name"}),e(ge,{placeholder:"e.x. my-ai-project"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The name of the project. Must be URI safe (letters, numbers, hyphens, underscores, dots only)."})]})}),e(H,{name:"description",control:t,render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Description"}),e(Ha,{placeholder:"e.x. A project for tracking agent performance"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The description of the project"})]})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{isDisabled:a,variant:s?"primary":"default",size:"M",onPress:()=>{i(g)()},children:l})})})]})}function Rx({refetchProjects:n}){const a=Me(),l=Le(),t=Ve(),[i,r]=T.useMutation(gf),s=f.useCallback(d=>{i({variables:{input:{name:d.name,description:d.description,gradientStartColor:d.gradientStartColor,gradientEndColor:d.gradientEndColor}},onCompleted:c=>{const u=c.createProject.project;l({title:"Project created",message:`Project "${u.name}" has been successfully created.`}),n(),a(`/projects/${u.id}`)},onError:()=>{t({title:"Failed to create project",message:"This is likely due to a naming conflict. Please try a different name."})}})},[i,l,t,a,n]);return e(Mx,{onSubmit:s,isSubmitting:r,submitButtonText:r?"Creating...":"Create Project"})}const Vx="https://arize.com/docs/phoenix/tracing/how-to-tracing/setup-tracing";function Cd(){return o(v,{children:["Projects are created when you log your first trace via OpenTelemetry. See the"," ",e(tl,{href:Vx,children:"documentation"})," ","for a complete guide."]})}function Nx({variant:n,refetchProjects:a}){return e("div",{children:o(se,{children:[e(R,{leadingVisual:e(x,{svg:e(Ud,{})}),size:"M",variant:n,children:"New Project"}),e(oe,{children:e(ae,{variant:"slideover",size:"L",css:K`
              width: 70vw !important;
            `,children:e(zx,{refetchProjects:a})})})]})})}function zx({refetchProjects:n}){const l=Cn(t=>t.programmingLanguage);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Create a New Project"}),e(ke,{children:e(be,{slot:"close"})})]}),o(jn,{defaultSelectedKey:l,children:[o(On,{children:[e(ve,{id:"Python",children:"Python"}),e(ve,{id:"TypeScript",children:"TypeScript"}),e(ve,{id:"manual",children:"Manual"})]}),e(ua,{id:"Python",children:o(C,{padding:"size-200",overflow:"auto",children:[e(Cd,{}),e(bc,{})]})}),e(ua,{id:"TypeScript",children:o(C,{padding:"size-200",overflow:"auto",children:[e(Cd,{}),e(Sc,{})]})}),e(ua,{id:"manual",children:e(C,{padding:"size-200",overflow:"auto",children:e(Rx,{refetchProjects:n})})})]})]})})}const pf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuClearMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuClearMutation",selections:a},params:{cacheID:"63319b4e42b499db2447817f1dc821fb",id:null,metadata:{},name:"ProjectActionMenuClearMutation",operationKind:"mutation",text:`mutation ProjectActionMenuClearMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}})();pf.hash="c43eec4d6b882468c611dd9ebf3b095e";const yf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"projectId"}],a=[{alias:null,args:[{kind:"Variable",name:"id",variableName:"projectId"}],concreteType:"Query",kind:"LinkedField",name:"deleteProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ProjectActionMenuDeleteMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ProjectActionMenuDeleteMutation",selections:a},params:{cacheID:"9a79d6d39a73196765b89d130a8e6a3f",id:null,metadata:{},name:"ProjectActionMenuDeleteMutation",operationKind:"mutation",text:`mutation ProjectActionMenuDeleteMutation(
  $projectId: ID!
) {
  deleteProject(id: $projectId) {
    __typename
  }
}
`}}})();yf.hash="e97af5c157e96020ec94d1ca72af6737";const ff=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Query",kind:"LinkedField",name:"clearProject",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"RemoveProjectDataFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"RemoveProjectDataFormMutation",selections:a},params:{cacheID:"1b27a3f7535c3f3943b0f2248d1505a6",id:null,metadata:{},name:"RemoveProjectDataFormMutation",operationKind:"mutation",text:`mutation RemoveProjectDataFormMutation(
  $input: ClearProjectInput!
) {
  clearProject(input: $input) {
    __typename
  }
}
`}}})();ff.hash="212501fe2d6367ec1503bd7a00c1730f";function $x(n){const{nowEpochMs:a}=Wd(),{projectId:l}=n,t=cb(),i=f.useRef(null),[r,s]=T.useMutation(ff),{control:d,handleSubmit:c,setError:u,formState:{isValid:m}}=sn({defaultValues:{endDate:Rc(new Date(a-ki).toISOString())}}),g=f.useCallback(p=>{const y=p.endDate.toDate(nt());if(!HS(y))return u("endDate",{message:"Date is not in a valid format"});r({variables:{input:{id:l,endTime:new Date(y).toISOString()}},onCompleted:()=>{n.onComplete()},onError:h=>{alert("Failed to clear project traces: "+h)}})},[r,l,n,u]);return o("form",{onSubmit:c(g),ref:i,children:[o(C,{padding:"size-200",children:[e(v,{color:"danger",children:" This will remove all data before the following date. This cannot be undone."}),e(H,{name:"endDate",control:d,rules:{required:"field is required"},render:({field:{name:p,onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(Bd,{isInvalid:S,onChange:y,name:p,onBlur:h,value:k,granularity:"second",hideTimeZone:!0,css:K`
                .react-aria-DateInput {
                  width: 100%;
                }
              `,children:[e(J,{children:"End Date"}),e(Vc,{children:I=>e(Nc,{segment:I})}),F?e(Ae,{children:F.message}):e(v,{slot:"description",children:`The date up to which you want to remove data. The format is ${t}.`})]})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{type:"submit",variant:"danger",isDisabled:!m||s,size:"S",leadingVisual:s?e(x,{svg:e(ta,{})}):void 0,onPress:()=>{var p;(p=i.current)==null||p.requestSubmit()},children:s?"Removing...":"Remove Data"})})})]})}function hf({projectId:n,projectName:a,onProjectDelete:l,onProjectClear:t,onProjectRemoveData:i}){const r=Le(),[s,d]=f.useState(!1),[c,u]=f.useState(!1),[m,g]=f.useState(!1),p=a!=="default",[y]=T.useMutation(yf),[h]=T.useMutation(pf),k=f.useCallback(()=>{f.startTransition(()=>{y({variables:{projectId:n}}),l()})},[y,n,l]),S=f.useCallback(()=>{f.startTransition(()=>{h({variables:{input:{id:n}},onCompleted:()=>{t()},onError:M=>{alert("Failed to clear project: "+M)}})})},[h,n,t]),F=f.useCallback(()=>{d(!0)},[]),I=f.useCallback(()=>{u(!0)},[]),L=f.useCallback(()=>{g(!0)},[]);return o(ja,{children:[o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:o($n,{"aria-label":"Project Actions Menu",onAction:M=>{switch(M){case"copyName":{navigator.clipboard.writeText(a),r({title:"Project name copied to clipboard"});return}case"deleteProject":return F();case"clearProject":return I();case"removeProjectData":return L()}},disabledKeys:p?[]:["deleteProject"],children:[e(Oe,{id:"copyName",textValue:"Copy Name",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Mr,{})}),e(v,{children:"Copy Name"})]})}),e(Oe,{id:"clearProject",textValue:"Clear All Traces",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Qd,{})}),e(v,{children:"Clear All Data"})]})}),e(Oe,{id:"removeProjectData",textValue:"Remove Data",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Bi,{})}),e(v,{children:"Remove Data"})]})}),p?e(Oe,{id:"deleteProject",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Tn,{})}),e(v,{children:"Delete"})]})}):null]})})]}),e(se,{isOpen:s,onOpenChange:d,children:e(oe,{children:e(ae,{size:"M",children:e(re,{children:({close:M})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Project"}),e(ke,{children:e(be,{slot:"close"})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete project ${a}? This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{variant:"danger",onPress:()=>{k(),M()},children:"Delete Project"})})})]})})})})}),e(se,{isOpen:c,onOpenChange:u,children:e(oe,{children:e(ae,{size:"M",children:e(re,{children:({close:M})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Clear Project"}),e(ke,{children:e(be,{slot:"close"})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to clear project ${a}? All traces and evaluations for this project will be deleted. This cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{variant:"danger",onPress:()=>{S(),M()},children:"Clear"})})})]})})})})}),e(se,{isOpen:m,onOpenChange:g,children:e(oe,{children:e(ae,{size:"M",children:e(re,{children:({close:M})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Remove Data"}),e(ke,{children:e(be,{slot:"close"})})]}),e($x,{projectId:n,onComplete:()=>{i(),M()}})]})})})})})]})}const Zr=10,bo=()=>{const{projectSortOrder:n}=Cn(l=>({projectViewMode:l.projectViewMode,projectSortOrder:l.projectSortOrder}));return f.useMemo(()=>({sort:{col:n.column,dir:n.direction}}),[n])};function P5(){const{timeRange:n}=Ut(),a=bo(),[l]=f.useState(()=>a),t=T.useLazyLoadQuery(mf,{first:Zr,filter:{value:"",col:"name"},...l});return e(f.Suspense,{fallback:e(me,{}),children:e(Ox,{timeRange:n,query:t})})}function Ox({timeRange:n,query:a}){"use no memo";const{projectViewMode:l}=Cn(_=>({projectViewMode:_.projectViewMode})),t=bo(),[i,r]=f.useState(""),s=Le(),d=f.useMemo(()=>{var _,D;return{start:(_=n==null?void 0:n.start)==null?void 0:_.toISOString(),end:(D=n==null?void 0:n.end)==null?void 0:D.toISOString()}},[n]),{data:c,loadNext:u,hasNext:m,isLoadingNext:g,refetch:p}=T.usePaginationFragment(uf,a),y=f.useMemo(()=>({...t,filter:{value:i,col:"name"}}),[t,i]),h=f.useCallback(({vars:_,onComplete:D})=>{f.startTransition(()=>{p({...y,..._},{fetchPolicy:"store-and-network",onComplete:()=>{D==null||D()}})})},[p,y]),k=c==null?void 0:c.projects.edges.map(_=>_.project),S=f.useRef(null),F=f.useCallback(_=>{if(_){const{scrollHeight:D,scrollTop:A,clientHeight:V}=_;D-A-V<300&&!g&&m&&u(Zr,{UNSTABLE_extraVariables:y})}},[m,g,u,y]),I=f.useCallback(_=>{h({vars:{sort:_}})},[h]),L=f.useCallback(_=>{f.startTransition(()=>{h({onComplete:()=>{s({title:"Project Deleted",message:`Project ${_} has been deleted.`})}})})},[s,h]),M=f.useCallback(_=>{f.startTransition(()=>{h({onComplete:()=>{s({title:"Project Cleared",message:`Project ${_} has been cleared of traces.`})}})})},[s,h]),E=f.useCallback(_=>{f.startTransition(()=>{h({onComplete:()=>{s({title:"Project Data Removed",message:`Old data from project ${_} have been removed.`})}})})},[s,h]),P=f.useCallback(()=>{u(Zr,{UNSTABLE_extraVariables:y})},[u,y]);return o("div",{css:K`
        display: flex;
        flex-direction: column;
        overflow: auto;
      `,onScroll:_=>F(_.target),ref:S,children:[e(C,{padding:"size-200",width:"100%",borderBottomColor:"grey-200",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(Ll,{"aria-label":"Search projects by name",placeholder:"Search projects by name",onChange:_=>{r(_),h({vars:{filter:{value:_,col:"name"}}})}}),o(b,{direction:"row",justifyContent:"end",alignItems:"center",gap:"size-100",css:K`
              button {
                text-wrap: nowrap;
              }
            `,children:[e(Ex,{}),e(hc,{size:"M"}),e(qi,{children:e(Nx,{variant:"primary",refetchProjects:()=>h({})})})]})]})}),l==="grid"?e("div",{css:K`
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
          `,children:e(jx,{projects:k,onDelete:L,onClear:M,onRemove:E,timeRangeVariable:d,hasNext:m,loadNext:P,isLoadingNext:g,onSort:I})}):e("div",{css:K`
            display: flex;
            flex-direction: column;
            flex: 1 1 auto;
          `,children:e(Gx,{projects:k,onDelete:L,onClear:M,onRemove:E,timeRangeVariable:d,hasNext:m,loadNext:P,isLoadingNext:g,onSort:I})})]})}function jx({projects:n,onDelete:a,onClear:l,onRemove:t,timeRangeVariable:i,hasNext:r,loadNext:s,isLoadingNext:d}){return o(C,{padding:"size-200",width:"100%",children:[e("ul",{css:K`
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--ac-global-dimension-size-3600), 1fr)
          );
          gap: var(--ac-global-dimension-size-200);
        `,children:n==null?void 0:n.map(c=>e("li",{css:K`
              display: flex;
              flex-direction: column;
              height: 100%;
              & > div {
                height: 100%;
              }
            `,children:e(Dn,{title:c.name,to:`/projects/${c.id}`,css:K`
                text-decoration: none;
                display: flex;
                flex-direction: column;
                height: 100%;
              `,children:e(Qx,{project:c,timeRange:i,onProjectDelete:()=>a(c.name),onProjectClear:()=>l(c.name),onProjectRemoveData:()=>t(c.name)})})},c.id))}),r&&e(b,{width:"100%",justifyContent:"center",alignItems:"center",marginTop:"size-200",children:e(Fc,{onLoadMore:s,isLoadingNext:d})})]})}function Qx({project:n,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t,timeRange:i}){const{gradientStartColor:r,gradientEndColor:s,endTime:d}=n,c=f.useMemo(()=>d?`Last updated  ${GS(new Date(d),new Date,{addSuffix:!0})}`:"No traces uploaded yet.",[d]);return o("div",{css:K`
        padding: var(--ac-global-dimension-size-200);
        border: 1px solid var(--ac-global-color-grey-100);
        box-shadow:
          0 0 1px 0px var(--ac-global-color-grey-400) inset,
          0 0 1px 0px var(--ac-global-color-grey-400);
        border-radius: var(--ac-global-rounding-medium);
        transition: border-color 0.2s;
        &:hover {
          border-color: var(--ac-global-color-primary);
        }
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        gap: var(--ac-global-dimension-size-200);
        height: 100%;
      `,children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"start",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",minWidth:0,children:[e(Cs,{gradientStartColor:r,gradientEndColor:s}),o(b,{direction:"column",minWidth:0,children:[e(Te,{level:2,css:K`
                overflow: hidden;
                display: -webkit-box;
                -webkit-box-orient: vertical;
                -webkit-line-clamp: 1;
              `,children:n.name}),e(v,{color:"text-700",size:"XS",fontStyle:"italic",children:c})]})]}),e(qi,{children:e(hf,{projectId:n.id,projectName:n.name,onProjectDelete:a,onProjectClear:l,onProjectRemoveData:t})})]}),e(kf,{projectId:n.id,timeRange:i})]})}const Bx=df;function qx(){return o(b,{direction:"row",justifyContent:"space-between",minHeight:"size-600",children:[o(b,{direction:"column",flex:"none",gap:"size-100",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(Ol,{width:60,height:20,animation:"wave"})]}),o(b,{direction:"column",flex:"none",gap:"size-100",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),e(Ol,{width:60,height:20,animation:"wave"})]})]})}const kf=f.memo(function({projectId:a,timeRange:l,flexProps:t}){const i=T.useRelayEnvironment(),r=f.useRef(null),[s,d]=f.useState(null),c=f.useCallback(()=>(d(null),T.fetchQuery(i,Bx,{id:a,timeRange:l}).subscribe({next:g=>{d(g)},error:()=>{d(null)}})),[a,l,i]);return f.useEffect(()=>(r.current=c(),()=>{var u;(u=r.current)==null||u.unsubscribe(),r.current=null}),[c]),s==null?e(qx,{}):e(Ux,{project:s,flexProps:t})});function Ux({project:n,flexProps:a}){const{project:{traceCount:l,latencyMsP50:t}}=n;return o(b,{direction:"row",justifyContent:"space-between",minHeight:"size-600",...a,children:[o(b,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Total Traces"}),e(v,{size:"L",fontFamily:"mono",children:Ye(l)})]}),o(b,{direction:"column",children:[e(v,{elementType:"h3",size:"S",color:"text-700",children:"Latency P50"}),t!=null?e(Rn,{latencyMs:t,size:"L"}):e(v,{size:"L",children:"--"})]})]})}const Hx=["name","endTime"];function Gx({projects:n,onDelete:a,onClear:l,onRemove:t,timeRangeVariable:i,hasNext:r,loadNext:s,isLoadingNext:d,onSort:c}){const u=Me(),m=Ks(),g=f.useMemo(()=>{const L=[{header:"name",accessorKey:"name",maxSize:135,cell:({row:M})=>o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(Cs,{gradientStartColor:M.original.gradientStartColor,gradientEndColor:M.original.gradientEndColor}),e(Dn,{to:`/projects/${M.original.id}`,children:e(mn,{maxWidth:"300px",children:M.original.name})})]})},{header:"last updated at",accessorKey:"endTime",maxSize:30,cell:tn},{header:"metrics",id:"metrics",enableSorting:!1,cell:({row:M})=>e("div",{css:K`
                max-width: 100%;
              `,children:e(kf,{flexProps:{justifyContent:"start",gap:"size-800",rowGap:"size-100"},projectId:M.original.id,timeRange:i})})}];return m&&L.push({header:"",id:"actions",enableSorting:!1,size:10,maxSize:10,minSize:10,cell:({row:M})=>e(hf,{projectId:M.original.id,projectName:M.original.name,onProjectClear:()=>l(M.original.name),onProjectRemoveData:()=>t(M.original.name),onProjectDelete:()=>a(M.original.name)})}),L},[i,l,a,t,m]),p=bo(),{setProjectSortOrder:y}=Cn(L=>({setProjectSortOrder:L.setProjectSortOrder})),h=f.useMemo(()=>[{id:p.sort.col,desc:p.sort.dir==="desc"}],[p.sort.col,p.sort.dir]),k=f.useCallback(L=>{if(typeof L=="function"){const M=L(h),[E]=M;if(E==null)return;const P=E.id;if(!Hx.includes(P))return;c({col:P,dir:E.desc?"desc":"asc"}),y({column:P,direction:E.desc?"desc":"asc"})}},[y,h,c]),S=Qe({data:n,columns:g,getCoreRowModel:Be(),state:{sorting:h},enableSortingRemoval:!1,onSortingChange:k}),I=S.getRowModel().rows.length===0;return e(C,{flex:"none",height:"100%",width:"100%",children:o("div",{css:K`
          flex: 1 1 auto;
          height: 100%;
          width: 100%;
        `,children:[o("table",{css:Kn,"data-testid":"projects-table",children:[e("thead",{children:S.getHeaderGroups().map(L=>e("tr",{children:L.headers.map(M=>e("th",{colSpan:M.colSpan,style:{width:M.getSize()},children:M.isPlaceholder?null:o("div",{className:M.column.getCanSort()?"sort":"",onClick:M.column.getToggleSortingHandler(),style:{left:M.getStart(),width:M.getSize(),textWrap:"nowrap"},children:[de(M.column.columnDef.header,M.getContext()),M.column.getIsSorted()?e(x,{className:"sort-icon",svg:M.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},M.id))},L.id))}),I?e(Xn,{}):e("tbody",{children:S.getRowModel().rows.map(L=>e("tr",{onClick:()=>{u(`/projects/${L.original.id}`)},children:L.getVisibleCells().map(M=>e("td",{style:{width:M.column.getSize(),maxWidth:M.column.getSize()},children:de(M.column.columnDef.cell,M.getContext())},M.id))},L.id))})]}),r?e(C,{paddingY:"size-200",children:e(b,{direction:"row",justifyContent:"center",alignItems:"center",width:"100%",children:e(Fc,{onLoadMore:s,isLoadingNext:d})})}):null]})})}const bf=(function(){var n=[{kind:"Literal",name:"first",value:100},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:'datasets(first:100,sort:{"col":"createdAt","dir":"desc"})'},{alias:null,args:n,filters:["sort","filter"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"0bdf83ff96fd6bfc2dc513d5edbadc31",id:null,metadata:{},name:"DatasetsPageQuery",operationKind:"query",text:`query DatasetsPageQuery {
  ...DatasetsTable_datasets
}

fragment DatasetsTable_datasets on Query {
  datasets(first: 100, sort: {col: createdAt, dir: desc}) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        labels {
          id
          name
          color
        }
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();bf.hash="985853a7939f44c0cefdd1a91472c67e";const Sf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"sort",variableName:"sort"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetsTableDatasetsQuery",selections:[{args:a,kind:"FragmentSpread",name:"DatasetsTable_datasets"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetsTableDatasetsQuery",selections:[{alias:null,args:a,concreteType:"DatasetConnection",kind:"LinkedField",name:"datasets",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["sort","filter"],handle:"connection",key:"DatasetsTable_datasets",kind:"LinkedHandle",name:"datasets"}]},params:{cacheID:"3e819f41f7a6ed480c70522da77062a9",id:null,metadata:{},name:"DatasetsTableDatasetsQuery",operationKind:"query",text:`query DatasetsTableDatasetsQuery(
  $after: String = null
  $filter: DatasetFilter = null
  $first: Int = 100
  $sort: DatasetSort = {col: createdAt, dir: desc}
) {
  ...DatasetsTable_datasets_3JsJJ3
}

fragment DatasetsTable_datasets_3JsJJ3 on Query {
  datasets(first: $first, after: $after, sort: $sort, filter: $filter) {
    edges {
      node {
        id
        name
        description
        metadata
        createdAt
        exampleCount
        experimentCount
        labels {
          id
          name
          color
        }
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();Sf.hash="82e24aac9e40f779947bb6b87468f506";const vf=(function(){var n=["datasets"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:{col:"createdAt",dir:"desc"},kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:Sf}},name:"DatasetsTable_datasets",selections:[{alias:"datasets",args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"DatasetConnection",kind:"LinkedField",name:"__DatasetsTable_datasets_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();vf.hash="82e24aac9e40f779947bb6b87468f506";const Ff=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{alias:null,args:[{fields:[{kind:"Variable",name:"datasetId",variableName:"datasetId"}],kind:"ObjectValue",name:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeleteDatasetDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeleteDatasetDialogMutation",selections:a},params:{cacheID:"dd7db4b6f6eac9ceaecd096c341e427c",id:null,metadata:{},name:"DeleteDatasetDialogMutation",operationKind:"mutation",text:`mutation DeleteDatasetDialogMutation(
  $datasetId: ID!
) {
  deleteDataset(input: {datasetId: $datasetId}) {
    __typename
  }
}
`}}})();Ff.hash="bd97316dd472eec18504f66e16088abc";function Wx({datasetId:n,datasetName:a,onDatasetDelete:l,onDatasetDeleteError:t,isOpen:i,onOpenChange:r}){const[s,d]=T.useMutation(Ff),c=f.useCallback(()=>{f.startTransition(()=>{s({variables:{datasetId:n},onCompleted:()=>{l(),r&&r(!1)},onError:u=>{t(u)}})})},[s,n,l,t,r]);return e(oe,{isOpen:i,onOpenChange:r,children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Dataset"}),e(ke,{children:e(be,{})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:`Are you sure you want to delete dataset ${a}? This will also delete all associated experiments and traces, and it cannot be undone.`})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{size:"S",onPress:()=>r==null?void 0:r(!1),children:"Cancel"}),e(R,{variant:"danger",size:"S",onPress:()=>{c()},isDisabled:d,leadingVisual:e(x,{svg:d?e(ta,{}):e(Tn,{})}),children:"Delete Dataset"})]})})]})})})})}function Jx({datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:i,onDatasetEditError:r,isOpen:s,onOpenChange:d}){return e(oe,{isOpen:s,onOpenChange:d,children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Edit Dataset"}),e(ke,{children:e(be,{})})]}),e(ub,{datasetName:n,datasetId:a,datasetDescription:l,datasetMetadata:t,onDatasetEdited:()=>{i(),d&&d(!1)},onDatasetEditError:r})]})})})})}function Zx(n){const{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetDelete:r,onDatasetDeleteError:s,onDatasetEdit:d,onDatasetEditError:c}=n,[u,m]=f.useState(!1),[g,p]=f.useState(!1);return o(ja,{children:[o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:o($n,{onAction:y=>{switch(y){case"deleteDataset":m(!0);break;case"editDataset":p(!0);break}},children:[e(Oe,{id:"editDataset",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(ps,{})}),e(v,{children:"Edit"})]})}),o(Oc,{children:[e(Oe,{id:"configureLabels",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Ql,{})}),e(v,{children:"Label"})]})}),o(we,{placement:"start top",css:K`
                  min-width: 300px;
                  width: 300px;
                `,children:[e(_l,{}),e(f.Suspense,{fallback:e(me,{css:K`
                        min-width: 300px;
                        min-height: 100px;
                      `}),children:e(mb,{datasetId:a})})]})]}),e(Oe,{id:"deleteDataset",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Tn,{})}),e(v,{children:"Delete"})]})})]})})]}),e(Wx,{datasetId:a,datasetName:l,onDatasetDelete:r,onDatasetDeleteError:s,isOpen:u,onOpenChange:m}),e(Jx,{datasetId:a,datasetName:l,datasetDescription:t,datasetMetadata:i,onDatasetEdited:d,onDatasetEditError:c,isOpen:g,onOpenChange:p})]})}function Xx(){return e(C,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(C,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(v,{size:"XL",children:"Create datasets for testing prompts, experimentation, and fine-tuning."}),e(Ts,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/datasets.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(gt,{href:"https://arize.com/docs/phoenix/datasets-and-experiments/how-to-datasets",target:"_blank",leadingVisual:e(x,{svg:e(Ps,{})}),children:"Documentation"}),e(gt,{href:"https://arize.com/docs/phoenix/get-started/get-started-datasets-and-experiments",target:"_blank",leadingVisual:e(x,{svg:e(gb,{})}),children:"Quickstart"})]})]})})})})}const Kd=100;function Yx(n){const a=n.id;if(a!=="createdAt"&&a!=="name")throw new Error("Invalid sort column");return{col:a,dir:n.desc?"desc":"asc"}}function eL(n){"use no memo";const{filter:a,labelFilter:l}=n,[t,i]=f.useState([]),r=f.useRef(null),s=Me(),d=Le(),c=Ve(),{data:u,loadNext:m,hasNext:g,isLoadingNext:p,refetch:y}=T.usePaginationFragment(vf,n.query),h=f.useMemo(()=>u.datasets.edges.map(E=>E.node),[u]),k=f.useCallback(E=>{if(E){const{scrollHeight:P,scrollTop:_,clientHeight:D}=E;P-_-D<300&&!p&&g&&m(Kd,{UNSTABLE_extraVariables:{filter:a||l!=null&&l.length?{col:"name",value:a||"",...l!=null&&l.length?{filterLabels:l}:{}}:null}})}},[g,p,m,a,l]),S=Ks(),F=f.useMemo(()=>{const E=[{header:"name",accessorKey:"name",cell:({row:P})=>{const D=P.original.experimentCount>0?`${P.original.id}/experiments`:`${P.original.id}/examples`;return e(Dn,{to:D,children:P.original.name})}},{header:"labels",accessorKey:"labels",enableSorting:!1,cell:({row:P})=>e("ul",{css:K`
                display: flex;
                flex-direction: row;
                gap: var(--ac-global-dimension-size-100);
                min-width: 0;
                flex-wrap: wrap;
              `,children:P.original.labels.map(_=>e("li",{children:e(nn,{color:_.color,children:e(mn,{maxWidth:200,title:_.name,children:_.name})})},_.id))})},{header:"description",accessorKey:"description",enableSorting:!1},{header:"created at",accessorKey:"createdAt",cell:tn},{header:"example count",accessorKey:"exampleCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"experiment count",accessorKey:"experimentCount",enableSorting:!1,meta:{textAlign:"right"}},{header:"metadata",accessorKey:"metadata",enableSorting:!1,cell:ot}];return S&&E.push({header:"",id:"actions",enableSorting:!1,size:10,cell:({row:P})=>e(Zx,{datasetId:P.original.id,datasetName:P.original.name,datasetDescription:P.original.description,datasetMetadata:P.original.metadata,onDatasetEdit:()=>{d({title:"Dataset updated",message:`${P.original.name} has been successfully updated.`}),y({filter:a||l!=null&&l.length?{col:"name",value:a||"",...l!=null&&l.length?{filterLabels:l}:{}}:null},{fetchPolicy:"store-and-network"})},onDatasetEditError:_=>{const D=je(_);c({title:"Dataset update failed",message:(D==null?void 0:D[0])??_.message})},onDatasetDelete:()=>{d({title:"Dataset deleted",message:`${P.original.name} has been successfully deleted.`}),y({filter:a||l!=null&&l.length?{col:"name",value:a||"",...l!=null&&l.length?{filterLabels:l}:{}}:null},{fetchPolicy:"store-and-network"})},onDatasetDeleteError:_=>{const D=je(_);c({title:"Dataset deletion failed",message:(D==null?void 0:D[0])??_.message})}})}),E},[a,l,c,d,y,S]),I=Qe({columns:F,data:h,state:{sorting:t},getCoreRowModel:Be(),getSortedRowModel:Vn(),onSortingChange:i,manualSorting:!0});f.useEffect(()=>{const E=t[0];f.startTransition(()=>{y({sort:E?Yx(E):{col:"createdAt",dir:"desc"},after:null,first:Kd,filter:a||l!=null&&l.length?{col:"name",value:a||"",...l!=null&&l.length?{filterLabels:l}:{}}:null},{fetchPolicy:"store-and-network"})})},[t,y,a,l]);const L=I.getRowModel().rows,M=L.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:E=>k(E.target),ref:r,children:o("table",{css:Al,children:[e("thead",{children:I.getHeaderGroups().map(E=>e("tr",{children:E.headers.map(P=>{var _;return e("th",{colSpan:P.colSpan,children:P.isPlaceholder?null:o("div",{className:P.column.getCanSort()?"sort":"",onClick:P.column.getToggleSortingHandler(),style:{textAlign:(_=P.column.columnDef.meta)==null?void 0:_.textAlign},children:[de(P.column.columnDef.header,P.getContext()),P.column.getIsSorted()?e(x,{className:"sort-icon",svg:P.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},P.id)})},E.id))}),M?e(pb,{children:e(Xx,{})}):e("tbody",{children:L.map(E=>e("tr",{onClick:()=>{const _=E.original.experimentCount>0?`${E.original.id}/experiments`:`${E.original.id}/examples`;s(_)},children:E.getVisibleCells().map(P=>{var _;return e("td",{align:(_=P.column.columnDef.meta)==null?void 0:_.textAlign,children:de(P.column.columnDef.cell,P.getContext())},P.id)})},E.id))})]})})}function vl(n){const{columns:a,selectedColumns:l,onChange:t,label:i,description:r,errorMessage:s}=n,d=a.length===0,c=f.useMemo(()=>a.map(u=>({id:u,value:u})),[a]);return o("div",{css:ba,children:[e(J,{children:i}),o(Dl,{isDisabled:d,placeholder:"Select columns",selectionMode:"multiple",onChange:u=>t(u==="all"?a:Array.from(u)),value:l,children:[o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:e(Bn,{renderEmptyState:()=>"No columns to select",items:c,children:u=>e(rl,{id:u.id,children:u.value})})})]}),s?e(v,{slot:"errorMessage",color:"danger",children:s}):null,r&&!s?e(v,{slot:"description",children:r}):null]})}function nL(n,a){try{const l=n.split(`
`);return Array.from(new Set(l.filter(t=>t.trim()!=="").map(t=>{const i=JSON.parse(t);return Object.keys(i)}).flat()))}catch(l){a(l)}}function aL(n){const{onDatasetCreated:a,onDatasetCreateError:l}=n,[t,i]=f.useState([]),{control:r,handleSubmit:s,resetField:d,setValue:c,formState:{isDirty:u,isValid:m}}=sn({defaultValues:{name:"",input_keys:[],output_keys:[],metadata_keys:[],split_keys:[],description:"",metadata:{}}}),g=f.useCallback(p=>{const y=new FormData;return y.append("file",p.file[0]),y.append("name",p.name),y.append("description",p.description),y.append("metadata",JSON.stringify(p.metadata)),p.input_keys.forEach(h=>{y.append("input_keys[]",h)}),p.output_keys.forEach(h=>{y.append("output_keys[]",h)}),p.metadata_keys.forEach(h=>{y.append("metadata_keys[]",h)}),p.split_keys.forEach(h=>{y.append("split_keys[]",h)}),fetch(ea("/v1/datasets/upload?sync=true"),{method:"POST",body:y}).then(h=>{if(!h.ok)throw l(new Error(h.statusText||"Failed to create dataset"));return h.json()}).then(h=>{a({name:p.name,id:h.data.dataset_id})})},[l,a]);return o(bn,{onSubmit:s(g),encType:"multipart/form-data",children:[o("div",{css:K`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(H,{control:r,name:"file",rules:{required:"JSONL file is required"},render:({field:{value:p,onChange:y,...h}})=>o("div",{css:K(ba,K`
                    display: flex;
                    flex-direction: column;
                    gap: var(--ac-global-dimension-size-50);
                    margin-bottom: var(--ac-global-dimension-size-200);
                  `),children:[e(J,{children:"JSONL file"}),e("input",{...h,onChange:k=>{var F;d("input_keys"),d("output_keys"),d("metadata_keys"),d("split_keys");const S=(F=k.target.files)==null?void 0:F[0];if(S){const I=new File([S],S.name,{type:"application/jsonl"});y([I]);const L=I.name.split(".")[0],M=new FileReader;M.onload=function(E){if(!E.target)return;const P=E.target.result,_=nL(P,l);i(_??[]),c("name",L)},M.readAsText(I)}},type:"file",id:"file",accept:".jsonl"})]})}),e(H,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Dataset Name"}),e(ge,{placeholder:"e.x. Golden Dataset"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The name of the dataset"})]})}),e(H,{name:"description",control:r,render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Description"}),e(Ha,{placeholder:"e.x. A dataset for structured data extraction"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The description of the dataset"})]})}),e(H,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"input keys",description:"the keys to use as input",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"output_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"output keys",description:"the keys to use as output",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"metadata_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"metadata keys",description:"the keys to use as metadata",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"split_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"split keys",description:"the keys to use for automatically assigning examples to splits",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{type:"submit",isDisabled:!m,variant:u?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function lL(n){const a=n.split(`
`);return a.length>0?a[0].split(",").map(l=>l.trim()):[]}function tL(n){const{onDatasetCreated:a,onDatasetCreateError:l}=n,[t,i]=f.useState([]),{control:r,handleSubmit:s,resetField:d,setValue:c,formState:{isDirty:u,isValid:m}}=sn({defaultValues:{name:"",input_keys:[],output_keys:[],metadata_keys:[],split_keys:[],description:"",metadata:{}}}),g=f.useCallback(p=>{const y=new FormData;return y.append("file",p.file[0]),y.append("name",p.name),y.append("description",p.description),y.append("metadata",JSON.stringify(p.metadata)),p.input_keys.forEach(h=>{y.append("input_keys[]",h)}),p.output_keys.forEach(h=>{y.append("output_keys[]",h)}),p.metadata_keys.forEach(h=>{y.append("metadata_keys[]",h)}),p.split_keys.forEach(h=>{y.append("split_keys[]",h)}),fetch(ea("/v1/datasets/upload?sync=true"),{method:"POST",body:y}).then(h=>{if(!h.ok)throw l(new Error(h.statusText||"Failed to create dataset"));return h.json()}).then(h=>{a({name:p.name,id:h.data.dataset_id})})},[l,a]);return o(bn,{onSubmit:s(g),children:[o("div",{css:K`
          padding: var(--ac-global-dimension-size-200);
          .ac-dropdown-button {
            width: 100%;
          }
        `,children:[e(H,{control:r,name:"file",rules:{required:"CSV file is required"},render:({field:{value:p,onChange:y,...h}})=>o("div",{css:K(ba,K`
                    display: flex;
                    flex-direction: column;
                    gap: var(--ac-global-dimension-size-50);
                    margin-bottom: var(--ac-global-dimension-size-200);
                  `),children:[e(J,{children:"CSV file"}),e("input",{...h,onChange:k=>{var F;y(k.target.files),d("input_keys"),d("output_keys"),d("metadata_keys"),d("split_keys");const S=(F=k.target.files)==null?void 0:F[0];if(S){const I=S.name.split(".")[0],L=new FileReader;L.onload=function(M){if(!M.target)return;const E=M.target.result,P=lL(E);i(P),c("name",I)},L.readAsText(S)}},type:"file",id:"file",accept:".csv"})]})}),e(H,{name:"name",control:r,rules:{required:"field is required"},render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Dataset Name"}),e(ge,{placeholder:"e.x. Golden Dataset"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The name of the dataset"})]})}),e(H,{name:"description",control:r,render:({field:{onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isInvalid:k,onChange:p,onBlur:y,value:h.toString(),children:[e(J,{children:"Description"}),e(Ha,{placeholder:"e.x. A dataset for structured data extraction"}),S!=null&&S.message?e(Ae,{children:S.message}):e(v,{slot:"description",children:"The description of the dataset"})]})}),e(H,{name:"input_keys",control:r,rules:{required:"field is required"},render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"input keys",description:"the columns to use as input",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"output_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"output keys",description:"the columns to use as output",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"metadata_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"metadata keys",description:"the columns to use as metadata",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})}),e(H,{name:"split_keys",control:r,render:({field:{value:p,onChange:y},fieldState:{error:h}})=>e(vl,{label:"split keys",description:"the columns to use for automatically assigning examples to splits",columns:t,selectedColumns:p,onChange:y,errorMessage:h==null?void 0:h.message})})]}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{type:"submit",isDisabled:!m,variant:u?"primary":"default",size:"S",children:"Create Dataset"})})})]})}function iL({onDatasetCreated:n}){const a=Me(),l=Le(),t=Ve(),[i,r]=f.useState(!1),[s,d]=f.useState(!1),[c,u]=f.useState(!1),m=()=>{r(!0)},g=()=>{d(!0)},p=()=>{u(!0)};return o(ja,{children:[o(la,{children:[e(R,{variant:"primary",size:"M",leadingVisual:e(x,{svg:e(Mn,{})}),children:"New Dataset"}),e(we,{children:o($n,{onAction:y=>{switch(y){case"newDataset":m();break;case"datasetFromCSV":g();break;case"datasetFromJSONL":p();break}},children:[e(Oe,{id:"newDataset",children:"New Dataset"}),e(Oe,{id:"datasetFromCSV",children:"Dataset from CSV"}),e(Oe,{id:"datasetFromJSONL",children:"Dataset from JSONL"})]})})]}),e(oe,{isOpen:i,onOpenChange:r,children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"New Dataset"}),e(ke,{children:e(be,{slot:"close"})})]}),e(vc,{onDatasetCreated:y=>{l({title:"Dataset created",message:`${y.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${y.id}`)}}}),r(!1),n()},onDatasetCreateError:y=>{const h=je(y);t({title:"Dataset creation failed",message:(h==null?void 0:h[0])??y.message})}})]})})})}),e(oe,{isOpen:s,onOpenChange:d,children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"New Dataset from CSV"}),e(ke,{children:e(be,{slot:"close"})})]}),e(tL,{onDatasetCreated:y=>{l({title:"Dataset created",message:`${y.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${y.id}`)}}}),d(!1),n()},onDatasetCreateError:y=>{const h=je(y);t({title:"Dataset creation failed",message:(h==null?void 0:h[0])??y.message})}})]})})})}),e(oe,{isOpen:c,onOpenChange:u,children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"New Dataset from JSONL"}),e(ke,{children:e(be,{slot:"close"})})]}),e(aL,{onDatasetCreated:y=>{l({title:"Dataset created",message:`${y.name} has been successfully created.`,action:{text:"Go to Dataset",onClick:()=>{a(`/datasets/${y.id}`)}}}),u(!1),n()},onDatasetCreateError:y=>{const h=je(y);t({title:"Dataset creation failed",message:(h==null?void 0:h[0])??y.message})}})]})})})})]})}function I5(){return e(f.Suspense,{fallback:e(me,{}),children:e(rL,{})})}function rL(){const[n,a]=f.useState(0),l=T.useLazyLoadQuery(bf,{},{fetchKey:n,fetchPolicy:"store-and-network"}),t=f.useCallback(()=>{a(c=>c+1)},[a]),[i,r]=f.useState(""),[s,d]=f.useState([]);return o(b,{direction:"column",height:"100%",children:[e(C,{padding:"size-200",flex:"none",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(C,{flex:"1 1 auto",minWidth:0,children:e(Ll,{"aria-label":"Search datasets by name",onChange:r,placeholder:"Search datasets by name"})}),o(b,{direction:"row",alignItems:"center",gap:"size-100",flex:"none",children:[e(yb,{selectedLabelIds:s,onSelectionChange:d}),e(qi,{children:e(iL,{onDatasetCreated:t})})]})]})}),e(eL,{query:l,filter:i,labelFilter:s})]})}const Cf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},r={kind:"InlineFragment",selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"exampleCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,i,{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetPageQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetPageQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,r],storageKey:null}]},params:{cacheID:"eadb7b2b778f365366b68f4fd1092b49",id:null,metadata:{},name:"DatasetPageQuery",operationKind:"query",text:`query DatasetPageQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      name
      description
      exampleCount
      experimentCount
      labels {
        id
        name
        color
      }
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}})();Cf.hash="92feaaf745e08f22d75510858aeb729f";const Kf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={kind:"InlineFragment",selections:[{alias:"latestVersions",args:[{kind:"Literal",name:"first",value:1},{kind:"Literal",name:"sort",value:{col:"createdAt",dir:"desc"}}],concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"version",args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'versions(first:1,sort:{"col":"createdAt","dir":"desc"})'}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetStore_latestVersionQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,t],storageKey:null}]},params:{cacheID:"8d1b89f8e5b4cd2774b9862c9aff1d3e",id:null,metadata:{},name:"datasetStore_latestVersionQuery",operationKind:"query",text:`query datasetStore_latestVersionQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      latestVersions: versions(first: 1, sort: {col: createdAt, dir: desc}) {
        edges {
          version: node {
            id
            description
            createdAt
          }
        }
      }
    }
  }
}
`}}})();Kf.hash="55c5e6b728d6f3e3088308750a4e43f7";const sL=n=>{const a=(l,t)=>({...n,isRefreshingLatestVersion:!1,refreshLatestVersion:async()=>{const i=t();l({isRefreshingLatestVersion:!0},!1,{type:"refreshLatestVersionInit"});const r=await oL({datasetId:i.datasetId});l({latestVersion:r,isRefreshingLatestVersion:!1},!1,{type:"refreshLatestVersionSuccess"})}});return Wt()(Gi(a,{name:"datasetStore"}))};async function oL({datasetId:n}){var i;const a=await T.fetchQuery(ze,Kf,{datasetId:n}).toPromise(),l=(i=a==null?void 0:a.dataset.latestVersions)==null?void 0:i.edges;return l&&l.length&&l[0].version||null}const Tf=f.createContext(null);function dL({children:n,...a}){const[l]=f.useState(()=>sL(a));return e(Tf.Provider,{value:l,children:n})}function ct(n,a){const l=f.useContext(Tf);if(!l)throw new Error("Missing DatasetContext.Provider in the tree");return Jt(l,n,a)}function cL({datasetId:n}){return o(la,{children:[e(R,{size:"M",leadingVisual:e(x,{svg:e(Ui,{})})}),e(we,{children:o($n,{"aria-label":"Dataset download",onAction:a=>{switch(a){case"csv":window.open(ea(`/v1/datasets/${n}/csv`),"_blank");break;case"openai-ft":window.open(ea(`/v1/datasets/${n}/jsonl/openai_ft`),"_blank");break;case"openai-evals":window.open(ea(`/v1/datasets/${n}/jsonl/openai_evals`),"_blank");break}},children:[e(Oe,{id:"csv",children:"Download CSV"}),e(Oe,{id:"openai-ft",children:"Download OpenAI Fine-Tuning JSONL"}),e(Oe,{id:"openai-evals",children:"Download OpenAI Evals JSONL"})]})})]})}function Pf({variant:n="default",size:a="S"}={variant:"default",size:"S"}){const l=Me(),t=ct(u=>u.datasetId),i=ct(u=>u.datasetName),r=ct(u=>u.latestVersion),[s,d]=f.useState(!1),c=r!=null;return o(te,{children:[o(la,{children:[e(R,{size:a,variant:n,leadingVisual:e(x,{svg:e(Mn,{})}),children:"Experiment"}),e(we,{placement:"bottom end",children:o($n,{disabledKeys:c?[]:["run-in-playground"],onAction:u=>{switch(u){case"run-via-sdk":d(!0);break;case"run-in-playground":l(`/playground?datasetId=${t}`);break}},children:[e(Oe,{id:"run-via-sdk",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(x,{svg:e(is,{})}),e(v,{children:"Run via SDK"})]})}),e(Oe,{id:"run-in-playground",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(x,{svg:e(Qa,{})}),e(v,{children:"Run in Playground"})]})})]})})]}),e(se,{isOpen:s,onOpenChange:d,children:e(fb,{datasetId:t,datasetName:i,version:r})})]})}const Xr=Cf;function x5(){const n=wn();Xe(n);const a=T.usePreloadedQuery(Xr,n.queryRef),l=f.useMemo(()=>{const t=a.dataset.latestVersions;return t!=null&&t.edges&&t.edges.length?t.edges[0].version:null},[a]);return e(dL,{datasetId:a.dataset.id,datasetName:a.dataset.name,latestVersion:l,children:e(f.Suspense,{fallback:e(me,{}),children:e(gL,{dataset:a.dataset})})})}const uL=K`
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  .ac-tabs {
    flex: 1 1 auto;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    div[role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      flex: 1 1 auto;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      div[role="tabpanel"]:not([hidden]) {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }
    }
  }
`,Yr={0:"experiments",1:"examples",2:"versions",3:"evaluators"},So=Object.values(Yr);function If(n){return typeof n=="string"&&So.includes(n)}function mL(n){const a=n.split("/").at(-1);return If(a)?So.indexOf(a):0}function gL({dataset:n}){const a=Zv("evaluators"),l=n.id,t=Me(),i=f.useCallback(d=>{if(Yr[d]){const c=Yr[d];t(`/datasets/${l}/${c}`)}},[t,l]),r=Ft(),s=mL(r.pathname);return o("main",{css:uL,children:[e(Vi,{title:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Te,{level:1,children:n.name}),n.labels&&n.labels.length>0&&e("ul",{css:K`
                  display: flex;
                  flex-direction: row;
                  gap: var(--ac-global-dimension-size-100);
                  min-width: 0;
                  flex-wrap: wrap;
                `,children:n.labels.map(d=>e("li",{children:e(nn,{color:d.color,children:e(mn,{maxWidth:200,title:d.name,children:d.name})})},d.id))})]}),subTitle:n.description||"--",extra:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(cL,{datasetId:n.id}),e(hb,{datasetId:n.id}),e(Pf,{variant:"primary",size:"M"})]})}),o(jn,{defaultSelectedKey:s===0?"experiments":s===1?"examples":"versions",onSelectionChange:d=>{If(d)&&i(So.indexOf(d))},children:[o(On,{children:[o(ve,{id:"experiments",children:["Experiments ",e(La,{children:n.experimentCount})]}),o(ve,{id:"examples",children:["Examples ",e(La,{children:n.exampleCount})]}),e(ve,{id:"versions",children:"Versions"}),a?e(ve,{id:"evaluators",isDisabled:!a,children:"Evaluators"}):null]}),e(Re,{id:"experiments",children:e(f.Suspense,{children:e(Ue,{})})}),e(Re,{id:"examples",children:e(f.Suspense,{children:e(Ue,{})})}),e(Re,{id:"versions",children:e(f.Suspense,{children:e(Ue,{})})}),e(Re,{id:"evaluators",children:e(f.Suspense,{children:e(Ue,{})})})]})]})}async function L5(n){const{datasetId:a}=n.params,l=T.loadQuery(ze,Xr,{id:a}),t=await T.fetchQuery(ze,Xr,{id:a}).toPromise();return{queryRef:l,dataset:t==null?void 0:t.dataset}}const xf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DatasetHistoryTableVersionsQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:l,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"adbbc367bb0082b7de0428488e0b2173",id:null,metadata:{},name:"DatasetHistoryTableVersionsQuery",operationKind:"query",text:`query DatasetHistoryTableVersionsQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...DatasetHistoryTable_versions_2HEEH6
    id
  }
}

fragment DatasetHistoryTable_versions_2HEEH6 on Dataset {
  versions(first: $first, after: $after) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();xf.hash="37e453bc58759a1e89bc5862c460de6b";const Lf=(function(){var n=["versions"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:xf,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"DatasetHistoryTable_versions",selections:[{alias:"versions",args:null,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"__DatasetHistoryTable_versions_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}})();Lf.hash="37e453bc58759a1e89bc5862c460de6b";const pL=100;function yL(n){"use no memo";const a=f.useRef(null),{data:l,loadNext:t,hasNext:i,isLoadingNext:r}=T.usePaginationFragment(Lf,n.dataset),s=f.useMemo(()=>l.versions.edges.map(g=>g.node),[l]),d=f.useCallback(g=>{if(g){const{scrollHeight:p,scrollTop:y,clientHeight:h}=g;p-y-h<300&&!r&&i&&t(pL)}},[i,r,t]),c=Qe({columns:[{header:"version ID",accessorKey:"id"},{header:"description",accessorKey:"description"},{header:"created at",accessorKey:"createdAt",cell:tn}],data:s,getCoreRowModel:Be(),getSortedRowModel:Vn()}),u=c.getRowModel().rows,m=u.length===0;return e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:g=>d(g.target),ref:a,children:o("table",{css:Kn,children:[e("thead",{children:c.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[de(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(x,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},p.id))},g.id))}),m?e(Xn,{}):e("tbody",{children:u.map(g=>e("tr",{children:g.getVisibleCells().map(p=>e("td",{children:de(p.column.columnDef.cell,p.getContext())},p.id))},g.id))})]})})}function D5(){const n=wn();return Xe(n),o(te,{children:[e(yL,{dataset:n.dataset}),e(f.Suspense,{children:e(Ue,{})})]})}const Df=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"datasetVersionsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"DatasetHistoryTable_versions"}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"datasetVersionsLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetVersionConnection",kind:"LinkedField",name:"versions",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetVersionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetVersion",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"versions(first:100)"},{alias:null,args:i,filters:null,handle:"connection",key:"DatasetHistoryTable_versions",kind:"LinkedHandle",name:"versions"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"ccd74bfc8e94dcbfc16bc569ce1f377a",id:null,metadata:{},name:"datasetVersionsLoaderQuery",operationKind:"query",text:`query datasetVersionsLoaderQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ... on Dataset {
      id
      ...DatasetHistoryTable_versions
    }
  }
}

fragment DatasetHistoryTable_versions on Dataset {
  versions(first: 100) {
    edges {
      node {
        id
        description
        createdAt
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Df.hash="cc354793d8ae8557ee05c57a77cd7ee2";async function _5(n){const{datasetId:a}=n.params;return await T.fetchQuery(ze,Df,{id:a}).toPromise()}function A5(){const{exampleId:n,datasetId:a}=on(),l=Me();return e(se,{isOpen:!0,onOpenChange:t=>{t||l(`/datasets/${a}/examples`)},children:e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(f.Suspense,{fallback:e(me,{}),children:e(to,{exampleId:n})})})})})}const _f=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{args:null,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"examplesLoaderQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,l,{kind:"InlineFragment",selections:[{alias:null,args:i,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[l,{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"datasetSplits",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[t,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"examples(first:100)"},{alias:null,args:i,filters:["datasetVersionId","filter","splitIds"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"93cd93577a230d47f89421b58878480d",id:null,metadata:{},name:"examplesLoaderQuery",operationKind:"query",text:`query examplesLoaderQuery(
  $id: ID!
) {
  dataset: node(id: $id) {
    __typename
    id
    ...ExamplesTableFragment
  }
}

fragment ExamplesTableFragment on Dataset {
  examples(first: 100) {
    edges {
      example: node {
        id
        datasetSplits {
          id
          name
          color
        }
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();_f.hash="87c9a24e8d6450699d9fd403b3653108";const Af=_f;function E5(n){const{datasetId:a}=n.params;return T.loadQuery(ze,Af,{id:a})}const Ef=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"addExamplesToDataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"AddDatasetExampleDialogMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"AddDatasetExampleDialogMutation",selections:a},params:{cacheID:"718cf02ccb39b279132822bf503e51e6",id:null,metadata:{},name:"AddDatasetExampleDialogMutation",operationKind:"mutation",text:`mutation AddDatasetExampleDialogMutation(
  $input: AddExamplesToDatasetInput!
) {
  addExamplesToDataset(input: $input) {
    __typename
  }
}
`}}})();Ef.hash="8d99470f590cd5d28701fa6e3c0330e6";const Ir={backgroundColor:"light",borderColor:"light",collapsible:!0};function fL(n){const{datasetId:a,onCompleted:l}=n,[t,i]=f.useState(null),[r,s]=T.useMutation(Ef),{control:d,setError:c,handleSubmit:u,formState:{isValid:m}}=sn({defaultValues:{input:"{}",output:"{}",metadata:"{}"}}),g=f.useCallback((p,y)=>{if(i(null),!ma(p==null?void 0:p.input))return c("input",{message:"Input must be a valid JSON object"});if(!ma(p==null?void 0:p.output))return c("output",{message:"Output must be a valid JSON object"});if(!ma(p==null?void 0:p.metadata))return c("metadata",{message:"Metadata must be a valid JSON object"});r({variables:{input:{datasetId:a,examples:[{input:JSON.parse(p.input),output:JSON.parse(p.output),metadata:JSON.parse(p.metadata)}],datasetVersionDescription:p.description}},onCompleted:()=>{y(),l()},onError:h=>{const k=je(h);i((k==null?void 0:k[0])??h.message)}})},[r,a,c,l]);return e(re,{children:({close:p})=>o(ye,{children:[o(fe,{children:[e(he,{children:"Add Example"}),e(ke,{children:e(be,{slot:"close"})})]}),e("div",{css:K`
              overflow-y: auto;
              padding: var(--ac-global-dimension-size-400);
            `,children:e(b,{direction:"row",justifyContent:"center",children:e(C,{width:"900px",paddingStart:"auto",paddingEnd:"auto",children:o(b,{direction:"column",gap:"size-200",children:[t?e(Ee,{variant:"danger",children:t}):null,e(H,{control:d,name:"input",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Input",subTitle:"The input to the LLM, retriever, program, etc.",...Ir,children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"output",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Output",subTitle:"The output of the LLM or program to be used as an expected output",...Ir,backgroundColor:"green-100",borderColor:"green-700",children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"metadata",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(ee,{title:"Metadata",subTitle:"All data from the span to use during experimentation or evaluation",...Ir,children:[S?e(Ee,{variant:"danger",banner:!0,children:F==null?void 0:F.message}):null,e(En,{value:k,onChange:y,onBlur:h})]})}),e(H,{control:d,name:"description",render:({field:{onChange:y,onBlur:h,value:k},fieldState:{invalid:S,error:F}})=>o(Fe,{value:k,onChange:y,onBlur:h,isInvalid:S,children:[e(J,{children:"Version Description"}),e(Ha,{}),F?e(Ae,{children:F.message}):e(v,{slot:"description",children:"A description of the changes made. Will be displayed in the version history."})]})})]})})})}),e(C,{padding:"size-200",borderTopColor:"light",borderTopWidth:"thin",children:e(b,{direction:"row",justifyContent:"end",gap:"size-100",children:e(R,{variant:"primary",size:"M",isDisabled:!m||s,leadingVisual:s?e(x,{svg:e(ta,{})}):null,onPress:()=>u(y=>g(y,p))(),children:s?"Adding Example...":"Add Example"})})})]})})}function hL(n){const{datasetId:a,onAddExampleCompleted:l}=n;return o(se,{children:[e(R,{leadingVisual:e(x,{svg:e(Mn,{})}),size:"M","aria-label":"Add Dataset Example",variant:"primary",children:"Example"}),e(oe,{children:e(ae,{size:"L",children:e(fL,{datasetId:a,onCompleted:()=>{l()}})})})]})}const wf=f.createContext(null),kL=({children:n})=>{const[a,l]=f.useState(""),[t,i]=f.useState([]),[r,s]=f.useState([]),[d,c]=f.useState({});return e(wf.Provider,{value:{selectedSplitIds:t,setSelectedSplitIds:i,filter:a,setFilter:l,selectedExampleIds:r,setSelectedExampleIds:s,examplesCache:d,setExamplesCache:c},children:n})},Mf=()=>{const n=f.useContext(wf);if(n===null)throw new Error("useExamplesFilterContext must be used within ExamplesFilterProvider");return n},bL=()=>{const{setFilter:n,filter:a,selectedSplitIds:l,setSelectedSplitIds:t,selectedExampleIds:i,setSelectedExampleIds:r,examplesCache:s}=Mf(),{datasetId:d}=on();Xe(d);const c=ct(m=>m.refreshLatestVersion),u=Le();return e(C,{padding:"size-100",minHeight:54,borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{width:"100%",justifyContent:"space-between",gap:"size-100",alignItems:"center",wrap:"nowrap",children:[e(Ll,{defaultValue:a,onChange:n,placeholder:"Search examples by input, output, or metadata","aria-label":"Search examples"}),e(zg,{onSelectionChange:t,onExampleSelectionChange:r,selectedSplitIds:l,selectedExampleIds:i,examplesCache:s}),e(hL,{datasetId:d,onAddExampleCompleted:()=>{u({title:"Example added",message:"The example has been added successfully and the version has been updated."}),c()}})]})})},Rf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"after"},a={defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},l={defaultValue:null,kind:"LocalArgument",name:"filter"},t={defaultValue:100,kind:"LocalArgument",name:"first"},i={defaultValue:null,kind:"LocalArgument",name:"id"},r={defaultValue:null,kind:"LocalArgument",name:"splitIds"},s=[{kind:"Variable",name:"id",variableName:"id"}],d=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"splitIds",variableName:"splitIds"}],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r],kind:"Fragment",metadata:null,name:"ExamplesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:d,kind:"FragmentSpread",name:"ExamplesTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,a,l,t,r,i],kind:"Operation",name:"ExamplesTableQuery",selections:[{alias:null,args:s,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,u,{kind:"InlineFragment",selections:[{alias:null,args:d,concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"examples",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[u,{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"datasetSplits",plural:!0,selections:[u,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[c,u],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:d,filters:["datasetVersionId","filter","splitIds"],handle:"connection",key:"ExamplesTable_examples",kind:"LinkedHandle",name:"examples"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"25fc48ec69201eec67455bbeeb490734",id:null,metadata:{},name:"ExamplesTableQuery",operationKind:"query",text:`query ExamplesTableQuery(
  $after: String = null
  $datasetVersionId: ID
  $filter: String = null
  $first: Int = 100
  $splitIds: [ID!]
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExamplesTableFragment_FYWYy
    id
  }
}

fragment ExamplesTableFragment_FYWYy on Dataset {
  examples(datasetVersionId: $datasetVersionId, first: $first, after: $after, filter: $filter, splitIds: $splitIds) {
    edges {
      example: node {
        id
        datasetSplits {
          id
          name
          color
        }
        revision {
          input
          output
          metadata
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  id
}
`}}})();Rf.hash="ebe08bedf9904f2cb003b0ebc5d3f682";const Vf=(function(){var n=["examples"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"datasetVersionId"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"splitIds"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:Rf,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExamplesTableFragment",selections:[{alias:"examples",args:[{kind:"Variable",name:"datasetVersionId",variableName:"datasetVersionId"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"splitIds",variableName:"splitIds"}],concreteType:"DatasetExampleConnection",kind:"LinkedField",name:"__ExamplesTable_examples_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExampleEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"example",args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"datasetSplits",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},a],type:"Dataset",abstractKey:null}})();Vf.hash="ebe08bedf9904f2cb003b0ebc5d3f682";const Nf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"DatasetMutationPayload",kind:"LinkedField",name:"deleteDatasetExamples",plural:!1,selections:[{alias:null,args:null,concreteType:"Dataset",kind:"LinkedField",name:"dataset",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExampleSelectionToolbarDeleteExamplesMutation",selections:a},params:{cacheID:"b63159f3c325b9af3dc469692f9329e5",id:null,metadata:{},name:"ExampleSelectionToolbarDeleteExamplesMutation",operationKind:"mutation",text:`mutation ExampleSelectionToolbarDeleteExamplesMutation(
  $input: DeleteDatasetExamplesInput!
) {
  deleteDatasetExamples(input: $input) {
    dataset {
      id
    }
  }
}
`}}})();Nf.hash="455bf9e5dc4b9cc655095dc829ef7e12";function SL(n){const a=ct(y=>y.refreshLatestVersion),{selectedExamples:l,onExamplesDeleted:t,onClearSelection:i}=n,[r,s]=f.useState(!1),d=Le(),c=Ve(),[u,m]=T.useMutation(Nf),g=l.length!==1,p=f.useCallback(()=>{u({variables:{input:{exampleIds:l.map(y=>y.id)}},onCompleted:()=>{d({title:"Examples Deleted",message:`${l.length} example${g?"s":""} have been deleted.`}),t(),i(),a()},onError:y=>{const h=je(y);c({title:"An error occurred",message:`Failed to delete examples: ${(h==null?void 0:h[0])??y.message}`})}})},[u,l,d,g,t,i,a,c]);return o(Fs,{children:[o(vs,{children:[e(C,{paddingEnd:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[o(Se,{children:[e(fn,{size:"M",onPress:i,"aria-label":"Clear selection",children:e(x,{svg:e(mt,{})})}),e($e,{children:"Clear selection"})]}),e(v,{children:`${l.length} example${g?"s":""} selected`})]})}),e(R,{variant:"danger",size:"M",leadingVisual:e(x,{svg:m?e(ta,{}):e(Tn,{})}),isDisabled:m,onPress:()=>s(!0),"aria-label":"Delete Examples",children:m?"Deleting...":"Delete"})]}),e(oe,{isOpen:r,onOpenChange:y=>{y||s(!1)},isDismissable:!0,children:e(ae,{children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Examples"}),e(ke,{children:e(be,{})})]}),e(C,{padding:"size-200",children:o(v,{color:"danger",children:["Are you sure you want to delete ",l.length," ","example",g?"s":"","?"]})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{size:"S",onPress:()=>s(!1),children:"Cancel"}),e(R,{variant:"danger",size:"S",onPress:()=>{p(),s(!1)},children:"Delete"})]})})]})})})})]})}const vL=100;function FL({dataset:n}){"use no memo";const{filter:a,selectedExampleIds:l,setSelectedExampleIds:t,selectedSplitIds:i,setExamplesCache:r}=Mf(),s=ct(A=>A.latestVersion),d=f.useRef(null),{data:c,loadNext:u,hasNext:m,isLoadingNext:g,refetch:p}=T.usePaginationFragment(Vf,n);f.useEffect(()=>{f.startTransition(()=>{p({datasetVersionId:(s==null?void 0:s.id)||null,filter:a,splitIds:i},{fetchPolicy:"store-and-network"})})},[s,a,p,i]),f.useEffect(()=>{r(c.examples.edges.map(A=>({id:A.example.id,datasetSplits:A.example.datasetSplits})).filter(A=>l.includes(A.id)).reduce((A,V)=>(A[V.id]=V,A),{}))},[c,l,r]);const y=f.useMemo(()=>l.reduce((A,V)=>(A[V]=!0,A),{}),[l]),h=f.useCallback(A=>{t(V=>Object.keys(typeof A=="function"?A(V.reduce((j,ce)=>(j[ce]=!0,j),{})):A))},[t]),k=f.useMemo(()=>c.examples.edges.map(A=>{const V=A.example,j=V.revision;return{id:V.id,splits:V.datasetSplits,input:j.input,output:j.output,metadata:j.metadata}}),[c]),S=f.useMemo(()=>{const A=[{id:"select",header:({table:V})=>e(Va,{isSelected:V.getIsAllRowsSelected(),isIndeterminate:V.getIsSomeRowsSelected(),onChange:V.toggleAllRowsSelected}),cell:({row:V})=>e(Va,{isSelected:V.getIsSelected(),isDisabled:!V.getCanSelect(),isIndeterminate:V.getIsSomeSelected(),onChange:V.toggleSelected})},{header:"example id",accessorKey:"id",cell:({getValue:V,row:j})=>{const ce=j.original.id;return e(Dn,{to:`${ce}`,children:V()})}},{header:"input",accessorKey:"input",cell:ot},{header:"output",accessorKey:"output",cell:ot},{header:"metadata",accessorKey:"metadata",cell:ot}];return A.splice(2,0,{header:"splits",accessorKey:"splits",cell:({row:V})=>e(kb,{labels:V.original.splits})}),A},[]),F=Qe({columns:S,data:k,state:{rowSelection:y},onRowSelectionChange:h,getCoreRowModel:Be(),getRowId:A=>A.id}),I=F.getRowModel().rows,L=I.length===0,M=F.getSelectedRowModel().rows,E=M.map(A=>A.original),P=f.useCallback(()=>{h({})},[h]),_=f.useCallback(A=>{if(A){const{scrollHeight:V,scrollTop:j,clientHeight:ce}=A;V-j-ce<300&&!g&&m&&u(vL)}},[m,g,u]),D=Me();return o("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,ref:d,onScroll:A=>_(A.target),children:[o("table",{css:Al,children:[e("thead",{children:F.getHeaderGroups().map(A=>e("tr",{children:A.headers.map(V=>e("th",{children:e("div",{children:de(V.column.columnDef.header,V.getContext())})},V.id))},A.id))}),L?e(Xn,{}):e("tbody",{children:I.map(A=>e("tr",{onClick:()=>{D(`${A.original.id}`)},children:A.getVisibleCells().map(V=>e("td",{children:de(V.column.columnDef.cell,V.getContext())},V.id))},A.id))})]}),M.length?e(SL,{selectedExamples:E,onClearSelection:P,onExamplesDeleted:()=>{p({},{fetchPolicy:"store-and-network"})}}):null]})}function w5(){const n=wn();Xe(n);const a=T.usePreloadedQuery(Af,n);return o(kL,{children:[e(bL,{}),e(FL,{dataset:a.dataset}),e(f.Suspense,{children:e(Ue,{})})]})}const zf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"}],a=[{kind:"Variable",name:"id",variableName:"datasetId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"experimentCount",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},s=[{kind:"Literal",name:"first",value:100}],d={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsPageQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t],type:"Dataset",abstractKey:null},{args:null,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsPageQuery",selections:[{alias:"dataset",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,l,{kind:"InlineFragment",selections:[t,{alias:null,args:null,concreteType:"DatasetExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:s,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[l],storageKey:null},{alias:null,args:null,concreteType:"DatasetSplitConnection",kind:"LinkedField",name:"datasetSplits",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetSplitEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"node",plural:!1,selections:[l,d,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:c,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"experiments(first:100)"},{alias:null,args:s,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"f4116336e082a85a6ab3ecae34bf37e3",id:null,metadata:{},name:"ExperimentsPageQuery",operationKind:"query",text:`query ExperimentsPageQuery(
  $datasetId: ID!
) {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experimentCount
    }
    ...ExperimentsTableFragment
  }
}

fragment ExperimentsTableFragment on Dataset {
  id
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: 100) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        repetitions
        averageRunLatencyMs
        project {
          id
        }
        datasetSplits {
          edges {
            node {
              id
              name
              color
            }
          }
        }
        costSummary {
          total {
            tokens
            cost
          }
          prompt {
            tokens
            cost
          }
          completion {
            tokens
            cost
          }
        }
        annotationSummaries {
          annotationName
          meanScore
          count
          errorCount
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();zf.hash="72428d5b7cecc029f5f05ae1802abb9f";const $f=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"count"},a={defaultValue:null,kind:"LocalArgument",name:"id"},l=[{kind:"Variable",name:"id",variableName:"id"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={kind:"InlineFragment",selections:[{alias:"chartExperiments",args:[{kind:"Variable",name:"first",variableName:"count"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ExperimentsLineChartQuery",selections:[{alias:"dataset",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ExperimentsLineChartQuery",selections:[{alias:"dataset",args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,t],storageKey:null}]},params:{cacheID:"4afc08039c6ccd37b80d9637f73ecc08",id:null,metadata:{},name:"ExperimentsLineChartQuery",operationKind:"query",text:`query ExperimentsLineChartQuery(
  $id: ID!
  $count: Int!
) {
  dataset: node(id: $id) {
    __typename
    ... on Dataset {
      chartExperiments: experiments(first: $count) {
        edges {
          experiment: node {
            id
            sequenceNumber
            averageRunLatencyMs
            annotationSummaries {
              annotationName
              meanScore
            }
          }
        }
      }
    }
    id
  }
}
`}}})();$f.hash="fb0556f7193f4e63c1a5b7e92028528d";const CL={top:8,right:18,left:18,bottom:58},KL=new Intl.NumberFormat([],{maximumFractionDigits:4}),Of=n=>typeof n!="number"?"--":`${Wi(".1f")(n/1e3)}s`;function TL({active:n,payload:a,label:l}){const{grey300:t}=Un(),{theme:i}=ia();if(n&&a&&a.length){const r=a.filter(s=>s.dataKey!=="avgLatency"&&typeof s.value=="number");return o(gn,{children:[o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(v,{weight:"heavy",size:"S",children:"experiment"}),e(Pi,{sequenceNumber:Number(l)})]}),r.map(s=>e(_e,{color:Is({word:String(s.dataKey),theme:i}),shape:"line",name:String(s.dataKey),value:typeof s.value=="number"?KL.format(s.value):"--"},String(s.dataKey))),(()=>{const s=a.find(d=>d.dataKey==="avgLatency");return s?e(_e,{color:t,shape:"square",name:"avg latency",value:Of(s.value)},"avgLatency"):null})()]})}return null}function PL({datasetId:n}){var c,u;const{theme:a}=ia(),l=T.useLazyLoadQuery($f,{id:n,count:50},{fetchPolicy:"store-or-network",networkCacheConfig:{force:!1}}),{chartData:t,scoreKeys:i}=f.useMemo(()=>{var p,y;const m=new Set;return{chartData:(((y=(p=l.dataset)==null?void 0:p.chartExperiments)==null?void 0:y.edges)??[]).map(h=>{const k=h.experiment,S={},F=k.annotationSummaries;for(const I of F)m.add(I.annotationName),S[I.annotationName]=I.meanScore??void 0;return{iteration:k.sequenceNumber,avgLatency:k.averageRunLatencyMs??void 0,...S}}).filter(h=>h!==null).sort((h,k)=>h.iteration-k.iteration),scoreKeys:Array.from(m)}},[(u=(c=l.dataset)==null?void 0:c.chartExperiments)==null?void 0:u.edges]),{grey300:r}=Un(),s=f.useMemo(()=>{const m={};for(const g of i)m[g]=Is({word:g,theme:a});return m},[i,a]),d=f.useMemo(()=>{let m=1/0,g=-1/0;for(const p of t)for(const y of i){const h=p[y];typeof h=="number"&&(h<m&&(m=h),h>g&&(g=h))}return m>=0&&g<=1?[0,1]:void 0},[t,i]);return e(yn,{width:"100%",height:"100%",children:o(at,{data:t,margin:CL,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"latencyBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:r,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:r,stopOpacity:0})]})}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(vn,{dataKey:"iteration",tick:{fontSize:12,fill:"var(--ac-global-text-color-700)"}}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Score",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"},domain:d}),e(an,{yAxisId:"right",orientation:"right",stroke:"var(--ac-global-color-grey-500)",label:{value:"avg latency",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"},tickFormatter:Of}),e(Ze,{yAxisId:"right",dataKey:"avgLatency",fill:"url(#latencyBarColor)",spacing:3}),i.map(m=>e(Pa,{type:"monotone",dataKey:m,stroke:s[m],strokeWidth:2,dot:{r:3},activeDot:{r:5},yAxisId:0},m)),e(pn,{content:TL})]})})}function IL({datasetId:n}){return e(f.Suspense,{fallback:e(me,{}),children:e(PL,{datasetId:n})})}function xL(){return e(C,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(C,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(v,{size:"XL",children:"Run experiments to evaluate and improve your AI applications."}),e(Ts,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/experiments.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(gt,{href:"https://docs.arize.com/phoenix/datasets-and-experiments/how-to-experiments/run-experiments",target:"_blank",leadingVisual:e(x,{svg:e(Ps,{})}),children:"Documentation"}),e(gt,{href:"https://docs.arize.com/phoenix/cookbook/datasets-and-experiments/summarization",target:"_blank",leadingVisual:e(x,{svg:e(bb,{})}),children:"Example"}),e(Pf,{variant:"primary",size:"M"})]})]})})})})}const jf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"first",variableName:"first"}],t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:l,kind:"FragmentSpread",name:"ExperimentsTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentsTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DatasetExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:l,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,s,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[i],storageKey:null},{alias:null,args:null,concreteType:"DatasetSplitConnection",kind:"LinkedField",name:"datasetSplits",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetSplitEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"node",plural:!1,selections:[i,s,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:d,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:d,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:d,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:l,filters:null,handle:"connection",key:"ExperimentsTable_experiments",kind:"LinkedHandle",name:"experiments"}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"b2d2222a5512686c8f5aa2600a565467",id:null,metadata:{},name:"ExperimentsTableQuery",operationKind:"query",text:`query ExperimentsTableQuery(
  $after: String = null
  $first: Int = 100
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...ExperimentsTableFragment_2HEEH6
    id
  }
}

fragment ExperimentsTableFragment_2HEEH6 on Dataset {
  id
  experimentAnnotationSummaries {
    annotationName
    minScore
    maxScore
  }
  experiments(first: $first, after: $after) {
    edges {
      experiment: node {
        id
        name
        sequenceNumber
        description
        createdAt
        metadata
        errorRate
        runCount
        repetitions
        averageRunLatencyMs
        project {
          id
        }
        datasetSplits {
          edges {
            node {
              id
              name
              color
            }
          }
        }
        costSummary {
          total {
            tokens
            cost
          }
          prompt {
            tokens
            cost
          }
          completion {
            tokens
            cost
          }
        }
        annotationSummaries {
          annotationName
          meanScore
          count
          errorCount
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();jf.hash="60efbafffc865e6c197c185ad3112606";const Qf=(function(){var n=["experiments"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:["node"],operation:jf,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"ExperimentsTableFragment",selections:[a,{alias:null,args:null,concreteType:"DatasetExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:"experiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"__ExperimentsTable_experiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorRate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"DatasetSplitConnection",kind:"LinkedField",name:"datasetSplits",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetSplitEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetSplit",kind:"LinkedField",name:"node",plural:!1,selections:[a,t,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:i,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"count",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorCount",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}})();Qf.hash="60efbafffc865e6c197c185ad3112606";function Jn(n){return n.replace(/[^a-zA-Z0-9]/g,"-")}function LL({experimentId:n}){return e(ja,{children:o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Ui,{})})}),e(we,{children:o($n,{onAction:a=>{a==="csv"&&window.open(ea(`/v1/experiments/${n}/csv`),"_blank"),a==="json"&&window.open(ea(`/v1/experiments/${n}/json`),"_blank")},children:[e(Oe,{id:"csv",children:"Download CSV"}),e(Oe,{id:"json",children:"Download JSON"})]})})]})})}function DL({getValue:n}){const a=n(),l=a!==null?a*100:null,t=f.useMemo(()=>{if(l!==null)return l>=80?"red-1100":l>0?"orange-1100":"green-1100"},[l]);return e(v,{color:t,children:$t(l)})}const Bf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"ExperimentMutationPayload",kind:"LinkedField",name:"deleteExperiments",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentSelectionToolbarDeleteExperimentsMutation",selections:a},params:{cacheID:"3af24cbaf3208c0d5ad1cd9313dd3823",id:null,metadata:{},name:"ExperimentSelectionToolbarDeleteExperimentsMutation",operationKind:"mutation",text:`mutation ExperimentSelectionToolbarDeleteExperimentsMutation(
  $input: DeleteExperimentsInput!
) {
  deleteExperiments(input: $input) {
    __typename
  }
}
`}}})();Bf.hash="4ab310746eb51c6a3fcb799d2c972762";function _L(n){const a=Me(),[l,t]=f.useState(!1),[i,r]=T.useMutation(Bf),{datasetId:s,selectedExperiments:d,onClearSelection:c,onExperimentsDeleted:u}=n,m=d.length!==1,g=Le(),p=Ve(),y=f.useCallback(()=>{i({variables:{input:{experimentIds:d.map(k=>k.id)}},onCompleted:()=>{g({title:"Experiments Deleted",message:`${d.length} experiment${m?"s":""} have been deleted.`}),u(),c(),t(!1)},onError:k=>{const S=je(k);p({title:"An error occurred",message:`Failed to delete experiments: ${(S==null?void 0:S[0])??k.message}`}),t(!1)}})},[i,m,p,g,c,u,d]),h=f.useCallback(()=>{t(!0)},[]);return o(Fs,{children:[e(vs,{"aria-label":"Experiment selection",children:o(Or,{"aria-label":"Experiment selection",children:[e(C,{paddingEnd:"size-100",children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(fn,{size:"S",onPress:c,"aria-label":"Clear selection",children:e(x,{svg:e(mt,{})})}),e(v,{children:`${d.length} experiment${m?"s":""} selected`})]})}),e(R,{variant:"primary",size:"M",onPress:()=>{const k=d[d.length-1].id,S=d.slice(0,-1).map(L=>L.id),I=`?${[k,...S].map(L=>`experimentId=${L}`).join("&")}`;a(`/datasets/${s}/compare${I}`)},leadingVisual:e(x,{svg:e(Sb,{})}),children:"Compare"}),e(R,{variant:"danger",size:"M",leadingVisual:e(x,{svg:r?e(ta,{}):e(Tn,{})}),isDisabled:r,onPress:h,"aria-label":"Delete Experiments"})]})}),e(oe,{isDismissable:!0,isOpen:l,onOpenChange:t,children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Experiments"}),e(ke,{children:e(be,{slot:"close"})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete these experiments? This will also delete all associated annotations and traces, and it cannot be undone."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{size:"S",onPress:()=>t(!1),children:"Cancel"}),e(R,{variant:"danger",size:"S",onPress:y,isDisabled:r,children:"Delete"})]})})]})})})})]})}const xr=100,AL={minSize:100},qf=({table:n,hasNext:a,onLoadNext:l,isLoadingNext:t,dataset:i})=>{const r=Me();return o("tbody",{children:[n.getRowModel().rows.map(s=>e("tr",{onClick:()=>{r(`/datasets/${i.id}/compare?experimentId=${s.original.id}`)},children:s.getVisibleCells().map(d=>{const c=`--col-${Jn(d.column.id)}-size`;return e("td",{style:{width:`calc(var(${c}) * 1px)`,maxWidth:`calc(var(${c}) * 1px)`},children:de(d.column.columnDef.cell,d.getContext())},d.id)})},s.id)),a?e(ls,{onLoadMore:l,isLoadingNext:t},"load-more"):null]})},EL=f.memo(qf,(n,a)=>n.table.options.data===a.table.options.data);function wL({dataset:n}){const a=f.useRef(null),[l,t]=f.useState({}),[i,r]=f.useState({}),{data:s,loadNext:d,hasNext:c,isLoadingNext:u,refetch:m}=T.usePaginationFragment(Qf,n),g=f.useMemo(()=>s.experiments.edges.map(D=>{const A=D.experiment.annotationSummaries.reduce((V,j)=>{const ce=D.experiment.runCount,W=j.count-j.errorCount;return V[j.annotationName]={...j,annotatedCount:W,totalRunCount:ce},V},{});return{...D.experiment,annotationSummaryMap:A}}),[s.experiments.edges]),p=[{id:"select",maxSize:50,header:({table:D})=>e(Va,{isSelected:D.getIsAllRowsSelected(),isIndeterminate:D.getIsSomeRowsSelected(),onChange:D.toggleAllRowsSelected}),cell:({row:D})=>e(Va,{isSelected:D.getIsSelected(),isDisabled:!D.getCanSelect(),isIndeterminate:D.getIsSomeSelected(),onChange:D.toggleSelected})},{header:"name",accessorKey:"name",minSize:200,cell:({getValue:D,row:A})=>{const V=A.original.id,j=A.original.sequenceNumber;return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Pi,{sequenceNumber:j}),e(Dn,{to:`/datasets/${s.id}/compare?experimentId=${V}`,children:D()})]})}},{header:"description",accessorKey:"description",minSize:300,cell:In},{header:"created at",accessorKey:"createdAt",cell:tn},{header:"splits",accessorKey:"datasetSplits",cell:({row:D})=>{const A=D.original.datasetSplits;return!A||A.edges.length===0?e(te,{children:"all examples"}):e(b,{direction:"row",gap:"size-100",alignItems:"center",wrap:"wrap",children:A.edges.map(V=>e(nn,{color:V.node.color,children:V.node.name},V.node.id))})}}],y=s.experimentAnnotationSummaries.map(D=>{const{annotationName:A,minScore:V,maxScore:j}=D;return{header:()=>o(b,{direction:"row",gap:"size-100",alignItems:"center",justifyContent:"end",children:[e(v,{children:A}),e(Cc,{annotationName:A})]}),id:`annotation-${A}`,meta:{textAlign:"right"},cell:({row:ce})=>{const W=ce.original.annotationSummaryMap[A];return!W||W.meanScore==null?e("span",{css:K`
                  float: right;
                `,children:"--"}):e(RL,{annotationName:A,value:W.meanScore,min:V,max:j,annotatedCount:W.annotatedCount,totalRunCount:W.totalRunCount})}}}),h=[{header:"repetitions",accessorKey:"repetitions",meta:{textAlign:"right"},cell:$r},{header:"run count",accessorKey:"runCount",meta:{textAlign:"right"},cell:$r},{header:"avg latency",accessorKey:"averageRunLatencyMs",meta:{textAlign:"right"},cell:({getValue:D})=>{const A=D();return A===null||typeof A!="number"?"--":e(Rn,{latencyMs:A})}},{header:"total cost",accessorKey:"costSummary.total.cost",meta:{textAlign:"right"},cell:({getValue:D,row:A})=>{const V=D(),j=A.original.id;return V==null?"--":e(vb,{totalCost:V,experimentId:j})}},{header:"total tokens",accessorKey:"costSummary.total.tokens",meta:{textAlign:"right"},cell:({getValue:D,row:A})=>{const V=D(),j=A.original.id;return e(Fb,{tokenCountTotal:V,experimentId:j,size:"S"})}},{header:"error rate",accessorKey:"errorRate",meta:{textAlign:"right"},cell:DL},{header:"metadata",accessorKey:"metadata",minSize:200,cell:ot},{id:"actions",maxSize:120,cell:({row:D})=>{const A=D.original.project,V=D.original.metadata;return e(ja,{children:o(b,{direction:"row",gap:"size-100",children:[A!=null&&A.id?e(qn,{to:`/projects/${A==null?void 0:A.id}`,leadingVisual:e(x,{svg:e(yt,{})}),size:"S","aria-label":"View traces",isDisabled:!(A!=null&&A.id),children:"Traces"}):null,e(LL,{experimentId:D.original.id}),e(Kc,{projectId:(A==null?void 0:A.id)||null,experimentId:D.original.id,metadata:V,canDeleteExperiment:!0,onExperimentDeleted:()=>{m({},{fetchPolicy:"network-only"})}})]})})}}],k=Qe({columns:[...p,...y,...h],data:g,state:{rowSelection:l,columnSizing:i},defaultColumn:AL,columnResizeMode:"onChange",onRowSelectionChange:t,onColumnSizingChange:r,getCoreRowModel:Be()}),S=k.getSelectedRowModel().rows,F=S.map(D=>D.original),I=f.useCallback(()=>{t({})},[t]),L=f.useCallback(D=>{if(D){const{scrollHeight:A,scrollTop:V,clientHeight:j}=D;A-V-j<300&&!u&&c&&d(xr)}},[c,u,d]),{columnSizingInfo:M,columnSizing:E}=k.getState(),P=k.getFlatHeaders,[_]=f.useMemo(()=>{const D=P(),A={};for(let V=0;V<D.length;V++){const j=D[V];A[`--header-${Jn(j.id)}-size`]=j.getSize(),A[`--col-${Jn(j.column.id)}-size`]=j.column.getSize()}return[A]},[P,M,E]);return o("div",{css:K`
        height: 100%;
        overflow: auto;
      `,ref:a,onScroll:D=>L(D.target),children:[o("table",{css:Al,style:{..._,width:k.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:k.getHeaderGroups().map(D=>e("tr",{children:D.headers.map(A=>{var V,j;return e("th",{colSpan:A.colSpan,style:{width:`calc(var(--header-${Jn(A.id)}-size) * 1px)`},align:(j=(V=A.column.columnDef)==null?void 0:V.meta)==null?void 0:j.textAlign,children:A.isPlaceholder?null:o(te,{children:[e("div",{children:e(mn,{maxWidth:"100%",children:de(A.column.columnDef.header,A.getContext())})}),e("div",{onMouseDown:A.getResizeHandler(),onTouchStart:A.getResizeHandler(),className:`resizer ${A.column.getIsResizing()?"isResizing":""}`})]})},A.id)})},D.id))}),M.isResizingColumn?e(EL,{table:k,hasNext:c,onLoadNext:()=>d(xr),isLoadingNext:u,dataset:s}):e(qf,{table:k,hasNext:c,onLoadNext:()=>d(xr),isLoadingNext:u,dataset:s})]}),S.length?e(_L,{datasetId:s.id,selectedExperiments:F,onClearSelection:I,onExperimentsDeleted:()=>{m({},{fetchPolicy:"network-only"})}}):null]})}function ML({unannotatedRatio:n}){const l=f.useMemo(()=>[{name:"hasAnnotation",value:1-n},{name:"missingAnnotation",value:n}],[n]);return e(zs,{width:16,height:16,children:e(Vs,{data:l,dataKey:"value",nameKey:"name",cx:"50%",cy:"50%",innerRadius:6,outerRadius:8,strokeWidth:0,stroke:"transparent",startAngle:90,endAngle:-270,children:l.map(t=>e(Ns,{fill:t.name==="missingAnnotation"?"var(--ac-global-color-warning)":"var(--ac-global-color-grey-300)",opacity:t.name==="missingAnnotation"?.8:.5},t.name))})})}function RL({annotationName:n,value:a,min:l,max:t,annotatedCount:i,totalRunCount:r}){const s=gs(n),d=f.useMemo(()=>Ci(a,l,t),[a,l,t]),c=r>0?1-i/r:0;return o("div",{css:K`
        float: right;
        --mod-barloader-fill-color: ${s};
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: var(--ac-global-dimension-size-100);
      `,children:[c>0&&o(Se,{children:[e(Zn,{children:e(ML,{unannotatedRatio:c})}),e(fa,{children:e(C,{width:"size-2000",children:o(v,{size:"XS",children:[Rr(c*100)," (",r-i,"/",r,") missing"," ",n]})})})]}),o(Se,{children:[e(Zn,{children:o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[kl(a),e(bi,{width:"40px",value:d,"aria-label":"where the mean score lands between overall min max"})]})}),e(fa,{children:o(C,{width:"size-2400",children:[e(Te,{level:3,weight:"heavy",children:n}),o(b,{direction:"column",children:[o(b,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score"}),e(v,{size:"XS",children:kl(a)})]}),o(b,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Min"}),e(v,{size:"XS",children:kl(l)})]}),o(b,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"All Experiments Max"}),e(v,{size:"XS",children:kl(t)})]}),o(b,{justifyContent:"space-between",children:[e(v,{weight:"heavy",size:"XS",children:"Mean Score Percentile"}),e(v,{size:"XS",children:Rr(d)})]})]})]})})]})]})}function M5(){var l;const{datasetId:n}=on();Xe(n);const a=T.useLazyLoadQuery(zf,{datasetId:n});return(l=a.dataset)!=null&&l.experimentCount?o(te,{children:[o($a,{direction:"vertical",autoSaveId:"experiments-layout",children:[o(An,{order:0,minSize:20,maxSize:30,defaultSize:20,collapsible:!0,children:[e(C,{paddingX:"size-200",paddingY:"size-100",children:e(Te,{level:2,children:"Experiments Analysis"})}),e(IL,{datasetId:n})]}),e(sl,{css:Bt}),e(An,{order:1,children:e(C,{height:"100%",overflow:"hidden",flex:"1 1 auto",children:e(ht,{fallback:VL,children:e(wL,{dataset:a.dataset})})})})]}),e(f.Suspense,{children:e(Ue,{})})]}):e(xL,{})}function VL(){return e(C,{width:"100%",height:"100%",children:e(b,{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",direction:"column",children:o(C,{width:"400px",children:[e(Te,{children:"Sorry about that!"}),o(v,{children:["There's a known issue in one of our dependencies that causes intermittent errors. We will resolve it as soon as there is an upstream fix.",e("br",{}),e("br",{}),e(R,{variant:"primary",onClick:()=>window.location.reload(),children:"Refresh the page"})]})]})})})}const Uf={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],kind:"Fragment",metadata:null,name:"ExperimentComparePage_selectedCompareExperiments",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null};Uf.hash="3f48f25489a511f201875e2e75dd691f";const Hf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},a={defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},l={defaultValue:null,kind:"LocalArgument",name:"datasetId"},t={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},i={defaultValue:null,kind:"LocalArgument",name:"hasCompareExperiments"},r={kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},s={kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"},d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],u=[{alias:null,args:null,kind:"ScalarField",name:"numRunsImproved",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRunsRegressed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRunsEqual",storageKey:null}];return{fragment:{argumentDefinitions:[n,a,l,t,i],kind:"Fragment",metadata:null,name:"ExperimentComparePageQueriesCompareMetricsQuery",selections:[{args:[r,s,{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},{kind:"Variable",name:"hasCompareExperiments",variableName:"hasCompareExperiments"}],kind:"FragmentSpread",name:"ExperimentCompareMetricsPage_experiments"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,a,t,i],kind:"Operation",name:"ExperimentComparePageQueriesCompareMetricsQuery",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:c,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:c,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null},d],storageKey:null},{condition:"hasCompareExperiments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[r,s],concreteType:"ExperimentRunMetricComparisons",kind:"LinkedField",name:"experimentRunMetricComparisons",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"latency",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"totalTokenCount",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"promptTokenCount",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"completionTokenCount",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"totalCost",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"promptCost",plural:!1,selections:u,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"completionCost",plural:!1,selections:u,storageKey:null}],storageKey:null}]}]},params:{cacheID:"3ed7109cef57b2b62e4501f5e0915b6b",id:null,metadata:{},name:"ExperimentComparePageQueriesCompareMetricsQuery",operationKind:"query",text:`query ExperimentComparePageQueriesCompareMetricsQuery(
  $datasetId: ID!
  $baseExperimentId: ID!
  $compareExperimentIds: [ID!]!
  $experimentIds: [ID!]!
  $hasCompareExperiments: Boolean!
) {
  ...ExperimentCompareMetricsPage_experiments_4DSN89
}

fragment ExperimentCompareMetricsPage_experiments_4DSN89 on Query {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      experiments(filterIds: $experimentIds) {
        edges {
          experiment: node {
            id
            averageRunLatencyMs
            costSummary {
              total {
                tokens
                cost
              }
              prompt {
                tokens
                cost
              }
              completion {
                tokens
                cost
              }
            }
            annotationSummaries {
              annotationName
              meanScore
            }
          }
        }
      }
    }
    id
  }
  experimentRunMetricComparisons(baseExperimentId: $baseExperimentId, compareExperimentIds: $compareExperimentIds) @include(if: $hasCompareExperiments) {
    latency {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    totalTokenCount {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    promptTokenCount {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    completionTokenCount {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    totalCost {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    promptCost {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
    completionCost {
      numRunsImproved
      numRunsRegressed
      numRunsEqual
    }
  }
}
`}}})();Hf.hash="685145a4c7c865793fb65817a1232288";const Gf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},a={defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},l={defaultValue:null,kind:"LocalArgument",name:"datasetId"},t={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s=[{kind:"Literal",name:"first",value:50}],d={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},m={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"ExperimentComparePageQueriesCompareListQuery",selections:[{args:[{kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},{kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"}],kind:"FragmentSpread",name:"ExperimentCompareListPage_comparisons"},{args:[{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],kind:"FragmentSpread",name:"ExperimentCompareListPage_aggregateData"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,n,a,t],kind:"Operation",name:"ExperimentComparePageQueriesCompareListQuery",selections:[{alias:"experiment",args:[{kind:"Variable",name:"id",variableName:"baseExperimentId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[{alias:null,args:s,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"runs",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},d,c,u,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},r],storageKey:null},m,g,{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[r,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"experimentIds",variableName:"compareExperimentIds"}],concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"experimentRepeatedRunGroups",plural:!0,selections:[p,{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[r,p,d,c,u,m,g],storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"runs(first:50)"},{alias:null,args:s,filters:["sort"],handle:"connection",key:"ExperimentCompareListPage_runs",kind:"LinkedHandle",name:"runs"}],type:"Experiment",abstractKey:null}],storageKey:null},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"DatasetExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"datasetVersionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},m,{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"d2de365d9d9a8a91c6c5c6e9eb77728d",id:null,metadata:{},name:"ExperimentComparePageQueriesCompareListQuery",operationKind:"query",text:`query ExperimentComparePageQueriesCompareListQuery(
  $datasetId: ID!
  $baseExperimentId: ID!
  $compareExperimentIds: [ID!]!
  $experimentIds: [ID!]!
) {
  ...ExperimentCompareListPage_comparisons_2bWqNi
  ...ExperimentCompareListPage_aggregateData_3xL6z4
}

fragment ExperimentCompareListPage_aggregateData_3xL6z4 on Query {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      id
      experimentAnnotationSummaries {
        annotationName
        minScore
        maxScore
      }
      experiments(filterIds: $experimentIds) {
        edges {
          experiment: node {
            id
            repetitions
            datasetVersionId
            averageRunLatencyMs
            runCount
            costSummary {
              total {
                tokens
                cost
              }
            }
            annotationSummaries {
              annotationName
              meanScore
            }
          }
        }
      }
    }
    id
  }
}

fragment ExperimentCompareListPage_comparisons_2bWqNi on Query {
  experiment: node(id: $baseExperimentId) {
    __typename
    ... on Experiment {
      id
      runs(first: 50) {
        edges {
          run: node {
            id
            repetitionNumber
            output
            startTime
            endTime
            trace {
              traceId
              projectId
              id
            }
            costSummary {
              total {
                tokens
                cost
              }
            }
            annotations {
              edges {
                annotation: node {
                  name
                  score
                  label
                  id
                }
              }
            }
            example {
              id
              revision {
                input
                referenceOutput: output
              }
              experimentRepeatedRunGroups(experimentIds: $compareExperimentIds) {
                experimentId
                runs {
                  id
                  experimentId
                  output
                  startTime
                  endTime
                  costSummary {
                    total {
                      tokens
                      cost
                    }
                  }
                  annotations {
                    edges {
                      annotation: node {
                        name
                        score
                        label
                        id
                      }
                    }
                  }
                }
                id
              }
            }
          }
          cursor
          node {
            __typename
            id
          }
        }
        pageInfo {
          endCursor
          hasNextPage
        }
      }
    }
    id
  }
}
`}}})();Gf.hash="95e9f4185f1ba0917cd613c32cf36cfa";const Wf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},a={defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},l={defaultValue:null,kind:"LocalArgument",name:"datasetId"},t={defaultValue:null,kind:"LocalArgument",name:"experimentIds"},i={kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},r={kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"},s=[i,r,{kind:"Literal",name:"first",value:50}],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null},m={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[c,u],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},d],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"ExperimentComparePageQueriesCompareGridQuery",selections:[{args:[i,r,{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],kind:"FragmentSpread",name:"ExperimentCompareTable_comparisons"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,t,n,a],kind:"Operation",name:"ExperimentComparePageQueriesCompareGridQuery",selections:[{alias:null,args:s,concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"compareExperiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[d,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"repeatedRunGroups",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"averageLatencyMs",storageKey:null},m,{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroupAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},g,m,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[d,p,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},y,g],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[h,d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["baseExperimentId","compareExperimentIds","filterCondition"],handle:"connection",key:"ExperimentCompareTable_compareExperiments",kind:"LinkedHandle",name:"compareExperiments"},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,d,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[d,p,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},y,{alias:null,args:null,kind:"ScalarField",name:"datasetVersionId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[d],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[u,c],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"1c4e6c5f43f41a6bd6b54414fa07749d",id:null,metadata:{},name:"ExperimentComparePageQueriesCompareGridQuery",operationKind:"query",text:`query ExperimentComparePageQueriesCompareGridQuery(
  $datasetId: ID!
  $experimentIds: [ID!]!
  $baseExperimentId: ID!
  $compareExperimentIds: [ID!]!
) {
  ...ExperimentCompareTable_comparisons_4mFQqw
}

fragment ExperimentCompareTable_comparisons_4mFQqw on Query {
  compareExperiments(first: 50, baseExperimentId: $baseExperimentId, compareExperimentIds: $compareExperimentIds) {
    edges {
      comparison: node {
        example {
          id
          revision {
            input
            referenceOutput: output
          }
        }
        repeatedRunGroups {
          ...ExperimentRepeatedRunGroupMetadataFragment
          annotationSummaries {
            annotationName
            meanScore
          }
          experimentId
          runs {
            id
            latencyMs
            repetitionNumber
            output
            error
            trace {
              traceId
              projectId
              id
            }
            costSummary {
              total {
                tokens
                cost
              }
            }
            annotations {
              edges {
                annotation: node {
                  id
                  name
                  score
                  label
                  annotatorKind
                  explanation
                  metadata
                  trace {
                    traceId
                    projectId
                    id
                  }
                }
              }
            }
          }
          id
        }
        id
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments(filterIds: $experimentIds) {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            datasetVersionId
            project {
              id
            }
            costSummary {
              total {
                cost
                tokens
              }
            }
            averageRunLatencyMs
            runCount
            repetitions
          }
        }
      }
    }
  }
}

fragment ExperimentRepeatedRunGroupMetadataFragment on ExperimentRepeatedRunGroup {
  id
  averageLatencyMs
  costSummary {
    total {
      tokens
      cost
    }
  }
}
`}}})();Wf.hash="a328b01cd5bf68e34f987eb2eaa5bea4";const Jf=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentComparePageQueriesSelectedCompareExperimentsQuery",selections:[{args:[{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],kind:"FragmentSpread",name:"ExperimentComparePage_selectedCompareExperiments"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentComparePageQueriesSelectedCompareExperimentsQuery",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null},a],storageKey:null}]},params:{cacheID:"447dbe5b828f328f716ef4aed7d1e0ec",id:null,metadata:{},name:"ExperimentComparePageQueriesSelectedCompareExperimentsQuery",operationKind:"query",text:`query ExperimentComparePageQueriesSelectedCompareExperimentsQuery(
  $datasetId: ID!
  $experimentIds: [ID!]!
) {
  ...ExperimentComparePage_selectedCompareExperiments_3xL6z4
}

fragment ExperimentComparePage_selectedCompareExperiments_3xL6z4 on Query {
  dataset: node(id: $datasetId) {
    __typename
    ... on Dataset {
      experiments(filterIds: $experimentIds) {
        edges {
          experiment: node {
            id
            sequenceNumber
            name
          }
        }
      }
    }
    id
  }
}
`}}})();Jf.hash="27e79df0ed587748bcb0b0089a89bf47";const Zf=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},a={defaultValue:null,kind:"LocalArgument",name:"datasetId"},l={defaultValue:null,kind:"LocalArgument",name:"hasBaseExperiment"},t={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"ExperimentComparePageQueriesMultiSelectorQuery",selections:[{args:[{kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"hasBaseExperiment",variableName:"hasBaseExperiment"}],kind:"FragmentSpread",name:"ExperimentMultiSelector__data"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"ExperimentComparePageQueriesMultiSelectorQuery",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[r,{alias:"allExperiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null},{condition:"hasBaseExperiment",kind:"Condition",passingValue:!0,selections:[{alias:"baseExperiment",args:[{kind:"Variable",name:"id",variableName:"baseExperimentId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{kind:"InlineFragment",selections:[r],type:"Experiment",abstractKey:null}],storageKey:null}]}]},params:{cacheID:"027b1dfb0abf8b0bb9ccf3d3e87bbd39",id:null,metadata:{},name:"ExperimentComparePageQueriesMultiSelectorQuery",operationKind:"query",text:`query ExperimentComparePageQueriesMultiSelectorQuery(
  $datasetId: ID!
  $hasBaseExperiment: Boolean!
  $baseExperimentId: ID!
) {
  ...ExperimentMultiSelector__data_Lig34
}

fragment ExperimentMultiSelector__data_Lig34 on Query {
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      id
      name
      allExperiments: experiments {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            createdAt
          }
        }
      }
    }
  }
  baseExperiment: node(id: $baseExperimentId) @include(if: $hasBaseExperiment) {
    __typename
    ... on Experiment {
      id
      name
    }
    id
  }
}
`}}})();Zf.hash="cda2c0440bd30af78972cfbe3e717756";const Xf=Zf,Yf=Jf,eh=Wf,nh=Gf,ah=Hf;function lh({name:n,color:a}){return o(b,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",children:[e(Qn,{color:a,shape:"circle"}),e(v,{css:K`
          white-space: nowrap;
          max-width: var(--ac-global-dimension-size-2000);
          overflow: hidden;
          text-overflow: ellipsis;
        `,title:n,size:"S",children:n})]})}const th=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"}],a={kind:"Variable",name:"after",variableName:"after"},l={kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},t={kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"},i={kind:"Variable",name:"filterCondition",variableName:"filterCondition"},r={kind:"Variable",name:"first",variableName:"first"},s=[a,l,t,i,r],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null},m={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[c,u],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},d],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},y={alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentCompareTableQuery",selections:[{args:[a,l,t,{kind:"Variable",name:"datasetId",variableName:"datasetId"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"},i,r],kind:"FragmentSpread",name:"ExperimentCompareTable_comparisons"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentCompareTableQuery",selections:[{alias:null,args:s,concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"compareExperiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[d,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"repeatedRunGroups",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"averageLatencyMs",storageKey:null},m,{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroupAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[d,{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},g,m,{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[d,p,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},y,g],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},d],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[h,d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["baseExperimentId","compareExperimentIds","filterCondition"],handle:"connection",key:"ExperimentCompareTable_compareExperiments",kind:"LinkedHandle",name:"compareExperiments"},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,d,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[d,p,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},y,{alias:null,args:null,kind:"ScalarField",name:"datasetVersionId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[d],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[u,c],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}]},params:{cacheID:"2ecd56abbd0d0ba2d368be7efd277353",id:null,metadata:{},name:"ExperimentCompareTableQuery",operationKind:"query",text:`query ExperimentCompareTableQuery(
  $after: String = null
  $baseExperimentId: ID!
  $compareExperimentIds: [ID!]!
  $datasetId: ID!
  $experimentIds: [ID!]!
  $filterCondition: String = null
  $first: Int = 50
) {
  ...ExperimentCompareTable_comparisons_Gjac5
}

fragment ExperimentCompareTable_comparisons_Gjac5 on Query {
  compareExperiments(first: $first, after: $after, baseExperimentId: $baseExperimentId, compareExperimentIds: $compareExperimentIds, filterCondition: $filterCondition) {
    edges {
      comparison: node {
        example {
          id
          revision {
            input
            referenceOutput: output
          }
        }
        repeatedRunGroups {
          ...ExperimentRepeatedRunGroupMetadataFragment
          annotationSummaries {
            annotationName
            meanScore
          }
          experimentId
          runs {
            id
            latencyMs
            repetitionNumber
            output
            error
            trace {
              traceId
              projectId
              id
            }
            costSummary {
              total {
                tokens
                cost
              }
            }
            annotations {
              edges {
                annotation: node {
                  id
                  name
                  score
                  label
                  annotatorKind
                  explanation
                  metadata
                  trace {
                    traceId
                    projectId
                    id
                  }
                }
              }
            }
          }
          id
        }
        id
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
  dataset: node(id: $datasetId) {
    __typename
    id
    ... on Dataset {
      experiments(filterIds: $experimentIds) {
        edges {
          experiment: node {
            id
            name
            sequenceNumber
            metadata
            datasetVersionId
            project {
              id
            }
            costSummary {
              total {
                cost
                tokens
              }
            }
            averageRunLatencyMs
            runCount
            repetitions
          }
        }
      }
    }
  }
}

fragment ExperimentRepeatedRunGroupMetadataFragment on ExperimentRepeatedRunGroup {
  id
  averageLatencyMs
  costSummary {
    total {
      tokens
      cost
    }
  }
}
`}}})();th.hash="bef4b265b59d70ee5cfd9ed06f535497";const ih=(function(){var n=["compareExperiments"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"metadata",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"},{defaultValue:null,kind:"LocalArgument",name:"filterCondition"},{defaultValue:50,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:th}},name:"ExperimentCompareTable_comparisons",selections:[{alias:"compareExperiments",args:[{kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},{kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"},{kind:"Variable",name:"filterCondition",variableName:"filterCondition"}],concreteType:"ExperimentComparisonConnection",kind:"LinkedField",name:"__ExperimentCompareTable_compareExperiments_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentComparisonEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"comparison",args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"repeatedRunGroups",plural:!0,selections:[{args:null,kind:"FragmentSpread",name:"ExperimentRepeatedRunGroupMetadataFragment"},{alias:null,args:null,concreteType:"ExperimentRepeatedRunGroupAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"latencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"error",storageKey:null},l,{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[t,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[a,r,{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"annotatorKind",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"explanation",storageKey:null},s,l],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentComparison",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[a,r,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},s,{alias:null,args:null,kind:"ScalarField",name:"datasetVersionId",storageKey:null},{alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[a],storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[i,t],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();ih.hash="bef4b265b59d70ee5cfd9ed06f535497";const rh=f.createContext(null);function sh(){const n=f.useContext(rh);if(n===null)throw new Error("useExperimentRunFilterCondition must be used within a ExperimentRunFilterConditionProvider");return n}function NL(n){const[a,l]=f.useState(""),t=f.useCallback(r=>{f.startTransition(()=>{l(r)})},[]),i=f.useCallback(r=>{f.startTransition(()=>{a.length>0?l(a+" and "+r):l(r)})},[a]);return e(rh.Provider,{value:{filterCondition:a,setFilterCondition:t,appendFilterCondition:i},children:n.children})}function zL({annotation:n}){const{appendFilterCondition:a}=sh(),{name:l,score:t,label:i}=n,r=f.useMemo(()=>typeof t=="number"?[{text:`${l} is ${Bl(t)}`,condition:`evals['${l}'].score == ${t}`},{text:`${l} is greater than ${Bl(t)}`,condition:`evals['${l}'].score > ${t}`},{text:`${l} is less than ${Bl(t)}`,condition:`evals['${l}'].score < ${t}`}]:typeof i=="string"&&i?[{text:`${l} matches ${i}`,condition:`evals['${l}'].label == '${i}'`},{text:`${l} doesn't equal ${i}`,condition:`evals['${l}'].label != '${i}'`}]:[],[l,i,t]);return e(Bn,{items:r,"aria-label":"experiment filters",selectionMode:"single",onSelectionChange:s=>{if(s==="all")return;const d=s.keys().next().value;d&&a(String(d))},children:s=>e(rl,{id:s.condition,children:s.text},s.condition)})}function or({traceId:n,projectId:a,title:l}){return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:l}),o(ke,{children:[e(qn,{size:"S",to:`/projects/${a}/traces/${n}`,children:"View Trace in Project"}),e(be,{})]})]}),e(f.Suspense,{fallback:e(me,{}),children:e(uo,{traceId:n,projectId:a})})]})})}const oh={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExperimentRepeatedRunGroupMetadataFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null}],type:"ExperimentRepeatedRunGroup",abstractKey:null};oh.hash="a5fdac9740fed436ed80e90d5750cb38";function $L(n){const a=T.useFragment(oh,n.fragmentRef),{id:l,averageLatencyMs:t,costSummary:i}=a,r=i.total.tokens,s=i.total.cost;return o(b,{direction:"row",gap:"size-100",children:[t!=null&&e(Rn,{size:"S",latencyMs:t}),e(Cb,{tokenCountTotal:r,experimentRepeatedRunGroupId:l,size:"S"}),s!=null&&l?e(Kb,{costTotal:s,experimentRepeatedRunGroupId:l,size:"S"}):null]})}const dh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"condition"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],a=[{alias:null,args:[{kind:"Variable",name:"condition",variableName:"condition"},{kind:"Variable",name:"experimentIds",variableName:"experimentIds"}],concreteType:"ValidationResult",kind:"LinkedField",name:"validateExperimentRunFilterCondition",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isValid",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"errorMessage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentRunFilterConditionFieldValidationQuery",selections:a},params:{cacheID:"efd70fda1905f639957b01b0d1495895",id:null,metadata:{},name:"ExperimentRunFilterConditionFieldValidationQuery",operationKind:"query",text:`query ExperimentRunFilterConditionFieldValidationQuery(
  $condition: String!
  $experimentIds: [ID!]!
) {
  validateExperimentRunFilterCondition(condition: $condition, experimentIds: $experimentIds) {
    isValid
    errorMessage
  }
}
`}}})();dh.hash="76143b48e9f598432119ada0e8f29a8f";const ch=K`
  flex: 1 1 auto;
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100) 0;
  }
  .cm-editor {
    background-color: transparent !important;
  }
  .cm-focused {
    outline: none;
  }
  .cm-selectionLayer .cm-selectionBackground {
    background: var(--ac-global-color-cyan-400) !important;
  }
`,uh=K`
  border-width: var(--ac-global-border-size-thin);
  border-style: solid;
  border-color: var(--ac-global-input-field-border-color);
  border-radius: var(--ac-global-rounding-small);
  background-color: var(--ac-global-input-field-background-color);
  transition: all 0.2s ease-in-out;
  overflow-x: hidden;
  &:hover,
  &[data-is-focused="true"] {
    border-color: var(--ac-global-input-field-border-color-active);
  }
  &[data-is-invalid="true"] {
    border-color: var(--ac-global-color-danger);
  }
  box-sizing: border-box;
  .search-icon {
    margin-left: var(--ac-global-dimension-static-size-100);
    margin-top: var(--ac-global-dimension-static-size-100);
  }
`;function OL(n){const a=n.matchBefore(/\w*/);return!a||a.from==a.to&&!n.explicit?null:{from:a.from,options:[{label:"input",type:"variable",info:"The input of the dataset example"},{label:"reference_output",type:"variable",info:"The reference output of the dataset example"},{label:"metadata",type:"variable",info:"The metadata of the dataset example"},{label:"output",type:"variable",info:"The output of the experiment run"},{label:"error",type:"variable",info:"The error message of the experiment run (if exists)"},{label:"latency_ms",type:"variable",info:"The duration of the experiment run in milliseconds"},{label:"evals",type:"variable",info:"The evaluations of the experiment run"},{label:"search input",type:"text",apply:"'' in input",detail:"macro"},{label:"search reference output",type:"text",apply:"'' in reference_output",detail:"macro"},{label:"search output",type:"text",apply:"'' in output",detail:"macro"},{label:"has error",type:"text",apply:"error is not None",detail:"macro"},{label:"Latency >= 10s",type:"text",apply:"latency_ms >= 10_000",detail:"macro"},{label:"Hallucinations",type:"text",apply:"evals['hallucination'].label == 'hallucinated'",detail:"macro"},{label:"Metadata",type:"text",apply:"metadata['category'] == 'hard_examples'",detail:"macro"}]}}async function jL(n,a){if(!n)return{isValid:!0,errorMessage:null};const l=await Xt.fetchQuery(ze,dh,{condition:n,experimentIds:a}).toPromise();if(!l)throw new Error("Filter condition validation is null");return l.validateExperimentRunFilterCondition}const QL=[Rs.of([{key:"Enter",run:n=>!0}]),Yt(),Uc({override:[OL]})];function BL(n){const{onValidCondition:a,placeholder:l=`filter condition (e.g., evals["Hallucination"].label == 'hallucinated')`}=n,[t,i]=f.useState(!1),[r,s]=f.useState(""),{filterCondition:d,setFilterCondition:c,appendFilterCondition:u}=sh(),m=f.useDeferredValue(d),{theme:g}=ia(),p=g==="light"?Ml:Rl,[y]=_n(),h=y.getAll("experimentId"),k=f.useRef(null);f.useEffect(()=>{jL(m,h).then(I=>{I!=null&&I.isValid?(s(""),f.startTransition(()=>{a(m)})):s((I==null?void 0:I.errorMessage)??"Invalid filter condition")})},[a,m,h]);const S=r!=="",F=d!=="";return o("div",{"data-is-focused":t,"data-is-invalid":S,css:K(uh,K`
          flex: 1;
        `),ref:k,children:[o(b,{direction:"row",children:[e(x,{svg:e(Ss,{}),className:"search-icon"}),e(Vl,{css:ch,indentWithTab:!1,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1,defaultKeymap:!1},onFocus:()=>i(!0),onBlur:()=>i(!1),value:d,onChange:c,height:"36px",width:"100%",theme:p,placeholder:l,extensions:QL}),e("button",{css:K`
            margin-right: var(--ac-global-dimension-static-size-100);
            color: var(--ac-global-text-color-700);
            visibility: ${F?"visible":"hidden"};
          `,onClick:()=>c(""),className:"button--reset",children:e(x,{svg:e(Bi,{})})}),o(se,{children:[e(fn,{css:K`
              color: var(--ac-global-text-color-700);
              border-left: 1px solid var(--ac-global-input-field-border-color);
              border-bottom: 0;
              border-top: 0;
              padding-left: var(--ac-global-dimension-static-size-100);
              padding-right: var(--ac-global-dimension-static-size-100);
              border-radius: 0;
              height: 36px !important;
            `,className:"button--reset",children:e(x,{svg:e(Mn,{})})}),e(we,{placement:"bottom right",children:e(qL,{onAddFilterConditionSnippet:u})})]})]}),e(Se,{isOpen:S&&t,children:e($e,{placement:"bottom",triggerRef:k,children:r!=""?e(v,{color:"danger",children:r}):e(v,{color:"success",children:"Valid Expression"})})})]})}function qL(n){const{onAddFilterConditionSnippet:a}=n;return e(C,{width:"500px",paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",paddingBottom:"size-200",borderRadius:"medium",backgroundColor:"light",children:o(bn,{children:[e(fl,{label:"filter by substring",initialSnippet:"'search term' in output['key']",onAddFilterConditionSnippet:a},"substring"),e(fl,{label:"filter on errors",initialSnippet:"error is not None",onAddFilterConditionSnippet:a},"errors"),e(fl,{label:"filter by evaluation label",initialSnippet:"evals['hallucination'].label == 'hallucinated'",onAddFilterConditionSnippet:a},"eval_label"),e(fl,{label:"filter by evaluation score",initialSnippet:"evals['hallucination'].score >= 0.5",onAddFilterConditionSnippet:a},"eval_score"),e(fl,{label:"filter by evaluation explanation",initialSnippet:"'search term' in evals['hallucination'].explanation",onAddFilterConditionSnippet:a},"eval_explanation"),e(fl,{label:"filter for lower scores than first experiment",initialSnippet:"evals['hallucination'].score < experiments[0].evals['hallucination'].score",onAddFilterConditionSnippet:a},"compare_experiments"),e(fl,{label:"filter by metadata",initialSnippet:"metadata['category'] == 'hard_examples'",onAddFilterConditionSnippet:a},"metadata"),e(fl,{label:"filter by latency",initialSnippet:"latency_ms >= 10_000",onAddFilterConditionSnippet:a},"latency")]})})}function fl(n){const{initialSnippet:a,onAddFilterConditionSnippet:l}=n,[t,i]=f.useState(a),{theme:r}=ia(),s=r==="light"?Ml:Rl;return o("div",{css:ba,children:[e(J,{children:n.label}),o(b,{direction:"row",width:"100%",gap:"size-100",children:[e("div",{css:K(uh,K`
              flex: 1 1 auto;
            `),children:e(Vl,{value:t,basicSetup:{lineNumbers:!1,foldGutter:!1,bracketMatching:!0,syntaxHighlighting:!0,highlightActiveLine:!1,highlightActiveLineGutter:!1},extensions:[Yt()],editable:!0,onChange:i,theme:s,css:ch})}),e(R,{"aria-label":"Add to filter condition",variant:"default",onPress:()=>l(t),leadingVisual:e(x,{svg:e(xl,{})})})]})]})}const UL=K`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`,Lr=50;function HL(n){const[a,l]=f.useState(null),[t,i]=f.useState(null),[r,s]=f.useState(!1),{datasetId:d,baseExperimentId:c,compareExperimentIds:u}=n,[m,g]=f.useState(""),p=f.useRef(null),[,y]=_n(),{baseExperimentColor:h,getExperimentColor:k}=Yl(),S=T.usePreloadedQuery(eh,n.queryRef),{data:F,loadNext:I,hasNext:L,isLoadingNext:M,refetch:E}=T.usePaginationFragment(ih,S),P=f.useMemo(()=>{var Q,q;return((q=(Q=F.dataset)==null?void 0:Q.experiments)==null?void 0:q.edges.reduce((ie,Z)=>(ie[Z.experiment.id]={...Z.experiment},ie),{}))||{}},[F]),_=P[c],D=f.useMemo(()=>F.compareExperiments.edges.map(Q=>{const q=Q.comparison,ie=q.repeatedRunGroups.reduce((Z,ue)=>(Z[ue.experimentId]=ue,Z),{});return{...q,id:q.example.id,input:q.example.revision.input,referenceOutput:q.example.revision.referenceOutput,repeatedRunGroupsByExperimentId:ie}}),[F]),A=f.useMemo(()=>D.map(Q=>Q.id),[D]),V=f.useMemo(()=>[{header:"input",accessorKey:"input",enableSorting:!1,cell:({row:Q})=>o(b,{direction:"column",height:"100%",css:K`
                overflow: hidden;
              `,children:[e(Gl,{extra:o(Se,{children:[e(fn,{size:"S",onPress:()=>{l(e(to,{exampleId:Q.original.example.id,datasetVersionId:_==null?void 0:_.datasetVersionId}))},children:e(x,{svg:e(ft,{})})}),o($e,{children:[e(ln,{}),"view example"]})]}),children:e(v,{size:"S",color:"text-500",children:`example ${Q.original.example.id}`})}),e(Ai,{children:e(vo,{children:e(il,{json:Q.original.input,disableTitle:!0,space:r?2:0})})})]})},{header:"reference output",accessorKey:"referenceOutput",enableSorting:!1,cell:Q=>o(te,{children:[e(Gl,{children:e(v,{size:"S",color:"text-500",children:"reference"})}),e(Ai,{children:r?XL(Q):ot(Q)})]})}],[_==null?void 0:_.datasetVersionId,r,l]),j=f.useMemo(()=>[c,...u].map((Q,q)=>({header:()=>{var w;const ie=P[Q],Z=(ie==null?void 0:ie.name)||"unknown-experiment",ue=ie==null?void 0:ie.metadata,Ke=(w=ie==null?void 0:ie.project)==null?void 0:w.id,Ce=q===0?h:k(q-1);return o(b,{direction:"row",gap:"size-100",wrap:!0,alignItems:"center",justifyContent:"space-between",children:[o(b,{direction:"column",gap:"size-50",children:[e(lh,{name:Z,color:Ce}),e("div",{children:ie&&e(WL,{experiment:ie})})]}),e(b,{direction:"row",wrap:!0,justifyContent:"end",alignItems:"center",children:e(Kc,{experimentId:Q,metadata:ue,projectId:Ke,canDeleteExperiment:!1})})]})},accessorKey:Q,minSize:500,enableSorting:!1,cell:({row:ie})=>{var Ke;const Z=ie.original.repeatedRunGroupsByExperimentId[Q];if(Z==null)return null;const ue=Z.annotationSummaries;return e(e3,{rowIndex:ie.index,experimentRepetitionCount:((Ke=P[Q])==null?void 0:Ke.repetitions)??0,repeatedRunGroup:Z,displayFullText:r,setDialog:l,setSelectedExampleIndex:i,annotationSummaries:ue})}})),[c,h,u,r,P,k]),ce=f.useMemo(()=>[...V,...j],[V,j]),W=Qe({columns:ce,data:D,getCoreRowModel:Be(),columnResizeMode:"onChange"}),Pe=Da.useMemo(()=>{const Q=W.getFlatHeaders(),q={};for(let ie=0;ie<Q.length;ie++){const Z=Q[ie];q[`--header-${Jn(Z.id)}-size`]=Z.getSize(),q[`--col-${Jn(Z.column.id)}-size`]=Z.column.getSize()}return q},[W.getState().columnSizingInfo,W.getState().columnSizing]),N=W.getRowModel().rows.length===0,B=f.useCallback(Q=>{if(Q){const{scrollHeight:q,scrollTop:ie,clientHeight:Z}=Q;q-ie-Z<300&&!M&&L&&I(Lr)}},[L,M,I]);return f.useEffect(()=>{f.startTransition(()=>{E({after:null,first:Lr,filterCondition:m,baseExperimentId:c,compareExperimentIds:u,datasetId:d},{fetchPolicy:"store-and-network"})})},[d,c,u,m,E]),o(C,{overflow:"auto",children:[o(b,{direction:"column",height:"100%",children:[e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderBottomColor:"grey-300",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(BL,{onValidCondition:g}),e(Il,{onChange:Q=>{s(Q)},defaultSelected:!1,labelPlacement:"start",children:e(v,{children:"Full Text"})})]})}),e("div",{css:UL,onScroll:Q=>B(Q.target),ref:p,children:o("table",{css:K(Kn,ks),style:{...Pe,width:W.getTotalSize(),minWidth:"100%"},children:[e("thead",{children:W.getHeaderGroups().map(Q=>e("tr",{children:Q.headers.map(q=>e("th",{colSpan:q.colSpan,style:{width:`calc(var(--header-${Jn(q==null?void 0:q.id)}-size) * 1px)`},children:q.isPlaceholder?null:o(te,{children:[o("div",{className:q.column.getCanSort()?"sort":"",onClick:q.column.getToggleSortingHandler(),style:{left:q.getStart(),width:"100%"},children:[e(mn,{maxWidth:"100%",children:de(q.column.columnDef.header,q.getContext())}),q.column.getIsSorted()?e(x,{className:"sort-icon",svg:q.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]}),e("div",{onMouseDown:q.getResizeHandler(),onTouchStart:q.getResizeHandler(),className:`resizer ${q.column.getIsResizing()?"isResizing":""}`})]})},q.id))},Q.id))}),N?e(Xn,{}):W.getState().columnSizingInfo.isResizingColumn?e(GL,{table:W,tableContainerRef:p}):e(mh,{table:W,tableContainerRef:p})]})})]}),e(oe,{isOpen:t!==null,onOpenChange:Q=>{Q||i(null)},children:e(ae,{variant:"slideover",size:"fullscreen",children:t!==null&&A[t]&&_&&e(io,{datasetId:d,datasetVersionId:_.datasetVersionId,selectedExampleIndex:t,selectedExampleId:A[t],baseExperimentId:c,compareExperimentIds:u,exampleIds:A,onExampleChange:Q=>{Q===A.length-1&&!M&&L&&I(Lr),Q>=0&&Q<A.length&&i(Q)},openTraceDialog:(Q,q,ie)=>{l(e(or,{traceId:Q,projectId:q,title:ie}))}})})}),e(oe,{isOpen:!!a,onOpenChange:()=>{y(Q=>{const q=new URLSearchParams(Q);return q.delete("selectedSpanNodeId"),q},{replace:!0}),l(null)},children:e(ae,{variant:"slideover",size:"fullscreen",children:a})})]})}function mh({table:n,tableContainerRef:a}){"use no memo";const l=n.getRowModel().rows,t=Ms({count:l.length,getScrollElement:()=>a.current,estimateSize:()=>350,overscan:5}),i=t.getVirtualItems(),r=t.getTotalSize(),s=f.useMemo(()=>r-i.reduce((d,c)=>d+c.size,0),[r,i]);return o("tbody",{children:[i.map((d,c)=>{const u=l[d.index];return e("tr",{style:{height:`${d.size}px`,transform:`translateY(${d.start-c*d.size}px)`},children:u.getVisibleCells().map(m=>e("td",{style:{width:`calc(var(--col-${Jn(m.column.id)}-size) * 1px)`,maxWidth:`calc(var(--col-${Jn(m.column.id)}-size) * 1px)`,padding:0},children:de(m.column.columnDef.cell,m.getContext())},m.id))},u.id)}),e("tr",{children:e("td",{style:{height:`${s}px`,padding:0},colSpan:n.getAllColumns().length})})]})}const GL=Da.memo(mh,(n,a)=>n.table.options.data===a.table.options.data);function WL(n){const{experiment:a}=n,l=a.averageRunLatencyMs,t=a.runCount,i=a.costSummary.total.cost,r=a.costSummary.total.tokens,s=i==null||t==0?null:i/t,d=r==null||t==0?null:r/t;return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[o(Se,{children:[e(Zn,{children:e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"AVG"})}),e($e,{children:"Averages computed over all runs in the experiment"})]}),l!=null&&e(Rn,{size:"S",latencyMs:l}),e(Tb,{averageRunTokenCountTotal:d,experimentId:a.id,size:"S"}),s!=null&&e(Pb,{averageRunCostTotal:s,experimentId:a.id,size:"S"})]})}function JL(n){const{output:a,error:l,annotations:t,displayFullText:i,setDialog:r}=n;if(l)return e(ZL,{error:l});const s=t!=null&&t.edges.length?t.edges.map(d=>d.annotation):[];return o(b,{direction:"column",height:"100%",justifyContent:"space-between",children:[e(C,{padding:"size-200",flex:"1 1 auto",children:e(vo,{children:e(il,{json:a,disableTitle:!0,space:i?2:0})})}),e(YL,{annotations:s,annotationSummaries:n.annotationSummaries,numRepetitions:n.numRepetitions,onTraceClick:({traceId:d,projectId:c,annotationName:u})=>{r(e(or,{title:`Evaluator Trace: ${u}`,traceId:d,projectId:c}))}})]})}function ZL({error:n}){return o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(x,{svg:e(lc,{}),color:"danger"}),e(v,{color:"danger",children:n})]})}function XL({getValue:n}){const a=n();return e(vo,{children:e(il,{json:a,space:2})})}function vo({children:n}){return e("div",{css:K`
        height: 300px;
        overflow-y: auto;
        flex: 1 1 auto;
      `,children:n})}function Ai({children:n}){return e(C,{paddingX:"size-200",paddingY:"size-100",children:n})}function YL(n){const{annotations:a,annotationSummaries:l,onTraceClick:t,numRepetitions:i}=n,r=f.useMemo(()=>l.reduce((s,d)=>(s[d.annotationName]=d,s),{}),[l]);return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        flex: none;
        padding: 0 var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-100)
          var(--ac-global-dimension-static-size-100);
      `,children:a.map(s=>{var g,p,y;const d=(g=s.trace)==null?void 0:g.traceId,c=(p=s.trace)==null?void 0:p.projectId,u=d!=null&&c!=null,m=(y=r[s.name])==null?void 0:y.meanScore;return o("li",{css:K`
              display: flex;
              flex-direction: row;
              align-items: center;
              justify-content: space-between;
              gap: var(--ac-global-dimension-static-size-50);
            `,children:[o(se,{children:[e(Ib,{annotation:s,extra:m!=null&&i>1?o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(v,{fontFamily:"mono",children:kl(m)}),e(v,{fontFamily:"mono",color:"grey-500",children:"AVG"})]}):null}),o(we,{placement:"top",children:[e(_l,{}),e(re,{style:{width:400},children:e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-50",children:[e(xb,{annotation:s}),e(Lb,{}),o("section",{children:[e(Te,{level:4,weight:"heavy",children:"Filters"}),e(zL,{annotation:s})]})]})})})]})]}),o(Se,{children:[e(fn,{size:"S",onPress:()=>{u&&t({annotationName:s.name,traceId:d,projectId:c})},children:e(x,{svg:e(yt,{})})}),o($e,{children:[e(ln,{}),"View evaluation trace"]})]})]},s.id)})})}function e3({experimentRepetitionCount:n,repeatedRunGroup:a,displayFullText:l,setDialog:t,rowIndex:i,setSelectedExampleIndex:r,annotationSummaries:s}){var k,S;const[d,c]=f.useState(1),u=f.useMemo(()=>a.runs.reduce((I,L)=>(I[L.repetitionNumber]=L,I),{}),[a.runs]);if(a.runs.length===0)return e(Ai,{children:e(Ti,{message:"No Run"})});const m=u[d],g=(k=m==null?void 0:m.trace)==null?void 0:k.traceId,p=(S=m==null?void 0:m.trace)==null?void 0:S.projectId,y=g!=null&&p!=null,h=o(te,{children:[n>1?e(ro,{repetitionNumber:d,totalRepetitions:n,setRepetitionNumber:c}):null,o(Se,{children:[e(fn,{className:"expand-button",size:"S","aria-label":"View example run details",onPress:()=>{r(i)},children:e(x,{svg:e(ft,{})})}),o($e,{children:[e(ln,{}),"view experiment run"]})]}),o(Se,{isDisabled:!y,children:[e(fn,{className:"trace-button",size:"S","aria-label":"View run trace",onPress:()=>{t(e(or,{traceId:g||"",projectId:p||"",title:"Experiment Run Trace"}))},isDisabled:!y,children:e(x,{svg:e(yt,{})})}),o($e,{children:[e(ln,{}),"view run trace"]})]})]});return o(b,{direction:"column",height:"100%",children:[e(Gl,{extra:h,children:e($L,{fragmentRef:a})}),m?e(JL,{...m,numRepetitions:n,displayFullText:l,setDialog:t,annotationSummaries:s}):e(Ai,{children:e(Ti,{message:"Missing Repetition"})})]})}function n3({queryRef:n}){const[a]=_n(),{baseExperimentId:l,compareExperimentIds:t}=f.useMemo(()=>{const[r,...s]=a.getAll("experimentId");return{baseExperimentId:r,compareExperimentIds:s}},[a]),{datasetId:i}=on();return Xe(i!=null),e(NL,{children:e(f.Suspense,{fallback:e(me,{}),children:e(HL,{queryRef:n,datasetId:i,baseExperimentId:l,compareExperimentIds:t})})})}const gh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],a={kind:"Variable",name:"after",variableName:"after"},l={kind:"Variable",name:"first",variableName:"first"},t={kind:"Variable",name:"sort",variableName:"sort"},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s=[a,l,t],d={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},m={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},g={alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExperimentCompareListPageQuery",selections:[{args:[a,{kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},{kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"},l,t],kind:"FragmentSpread",name:"ExperimentCompareListPage_comparisons"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExperimentCompareListPageQuery",selections:[{alias:"experiment",args:[{kind:"Variable",name:"id",variableName:"baseExperimentId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{kind:"InlineFragment",selections:[{alias:null,args:s,concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"runs",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[r,{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},d,c,u,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null},r],storageKey:null},m,g,{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[r,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"experimentIds",variableName:"compareExperimentIds"}],concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"experimentRepeatedRunGroups",plural:!0,selections:[p,{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[r,p,d,c,u,m,g],storageKey:null},r],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:s,filters:["sort"],handle:"connection",key:"ExperimentCompareListPage_runs",kind:"LinkedHandle",name:"runs"}],type:"Experiment",abstractKey:null}],storageKey:null}]},params:{cacheID:"c3825ea3e5b600579f2c0143acc80fad",id:null,metadata:{},name:"ExperimentCompareListPageQuery",operationKind:"query",text:`query ExperimentCompareListPageQuery(
  $after: String = null
  $baseExperimentId: ID!
  $compareExperimentIds: [ID!]!
  $first: Int = 50
  $sort: ExperimentRunSort = null
) {
  ...ExperimentCompareListPage_comparisons_3SQ0kE
}

fragment ExperimentCompareListPage_comparisons_3SQ0kE on Query {
  experiment: node(id: $baseExperimentId) {
    __typename
    ... on Experiment {
      id
      runs(first: $first, after: $after, sort: $sort) {
        edges {
          run: node {
            id
            repetitionNumber
            output
            startTime
            endTime
            trace {
              traceId
              projectId
              id
            }
            costSummary {
              total {
                tokens
                cost
              }
            }
            annotations {
              edges {
                annotation: node {
                  name
                  score
                  label
                  id
                }
              }
            }
            example {
              id
              revision {
                input
                referenceOutput: output
              }
              experimentRepeatedRunGroups(experimentIds: $compareExperimentIds) {
                experimentId
                runs {
                  id
                  experimentId
                  output
                  startTime
                  endTime
                  costSummary {
                    total {
                      tokens
                      cost
                    }
                  }
                  annotations {
                    edges {
                      annotation: node {
                        name
                        score
                        label
                        id
                      }
                    }
                  }
                }
                id
              }
            }
          }
          cursor
          node {
            __typename
            id
          }
        }
        pageInfo {
          endCursor
          hasNextPage
        }
      }
    }
    id
  }
}
`}}})();gh.hash="9ccda00d27d4d8a3fb4233f2ffadb778";const ph=(function(){var n=["experiment","runs"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"output",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null},r={alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},s={alias:null,args:null,concreteType:"ExperimentRunAnnotationConnection",kind:"LinkedField",name:"annotations",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunAnnotationEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"annotation",args:null,concreteType:"ExperimentRunAnnotation",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"score",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"label",storageKey:null},a],storageKey:null}],storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"experimentId",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},{defaultValue:50,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"sort"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:gh}},name:"ExperimentCompareListPage_comparisons",selections:[{alias:"experiment",args:[{kind:"Variable",name:"id",variableName:"baseExperimentId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[a,{alias:"runs",args:[{kind:"Variable",name:"sort",variableName:"sort"}],concreteType:"ExperimentRunConnection",kind:"LinkedField",name:"__ExperimentCompareListPage_runs_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"run",args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"repetitionNumber",storageKey:null},l,t,i,{alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"projectId",storageKey:null}],storageKey:null},r,s,{alias:null,args:null,concreteType:"DatasetExample",kind:"LinkedField",name:"example",plural:!1,selections:[a,{alias:null,args:null,concreteType:"DatasetExampleRevision",kind:"LinkedField",name:"revision",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"input",storageKey:null},{alias:"referenceOutput",args:null,kind:"ScalarField",name:"output",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"experimentIds",variableName:"compareExperimentIds"}],concreteType:"ExperimentRepeatedRunGroup",kind:"LinkedField",name:"experimentRepeatedRunGroups",plural:!0,selections:[d,{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"runs",plural:!0,selections:[a,d,l,t,i,r,s],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"ExperimentRun",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Experiment",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();ph.hash="9ccda00d27d4d8a3fb4233f2ffadb778";const yh=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"}],kind:"Fragment",metadata:null,name:"ExperimentCompareListPage_aggregateData",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"DatasetExperimentAnnotationSummary",kind:"LinkedField",name:"experimentAnnotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"minScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxScore",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"repetitions",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"datasetVersionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"runCount",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();yh.hash="46e4b2378bc6dc7c46e9b892397393d9";const Td=50,a3=K`
  flex: 1 1 auto;
  overflow: auto;
  // Make sure the table fills up the remaining space
  table {
    min-width: 100%;
    td {
      vertical-align: top;
    }
  }
`;function l3({queryRef:n}){var ie;const[a,l]=_n(),t=f.useMemo(()=>a.getAll("experimentId"),[a]),[i,r]=f.useState(null),[s,d]=f.useState(null),[c,u]=f.useState([]),m=f.useRef(!0),{getExperimentColor:g,baseExperimentColor:p}=Yl(),y=f.useRef(null),h=T.usePreloadedQuery(nh,n),k=T.useFragment(yh,h),{data:S,loadNext:F,hasNext:I,isLoadingNext:L,refetch:M}=T.usePaginationFragment(ph,h),E=f.useMemo(()=>{var Ke;const Z={};return(Ke=k==null?void 0:k.dataset.experiments)==null||Ke.edges.forEach(Ce=>{Z[Ce.experiment.id]=Ce.experiment}),t.map(Ce=>Z[Ce]).filter(Ce=>Ce!=null)},[(ie=k==null?void 0:k.dataset.experiments)==null?void 0:ie.edges,t]),P=f.useMemo(()=>{var ue,Ke,Ce;const Z=(Ke=(ue=k==null?void 0:k.dataset.experiments)==null?void 0:ue.edges[0])==null?void 0:Ke.experiment;return(Ce=k==null?void 0:k.dataset.experimentAnnotationSummaries)==null?void 0:Ce.filter(w=>{var $;return($=Z==null?void 0:Z.annotationSummaries)==null?void 0:$.some(X=>X.annotationName===w.annotationName)})},[k==null?void 0:k.dataset]),_=k==null?void 0:k.dataset.id,D=E[0],A=f.useMemo(()=>E.slice(1).map(Z=>Z.id),[E]),V=f.useMemo(()=>{var Z;return((Z=S==null?void 0:S.experiment.runs)==null?void 0:Z.edges.map(ue=>{const Ke=ue.run,Ce=Ke.example,w=Ce.experimentRepeatedRunGroups.filter(O=>t.includes(O.experimentId)),$=Ke,X=w.map(O=>O.runs[0]),pe={};Ke.annotations.edges.forEach(O=>{const G=O.annotation;pe[G.name]=G});const Pn={};Ke.example.experimentRepeatedRunGroups.forEach(O=>{O.runs.forEach(G=>{const Ie=G.experimentId;G.annotations.edges.forEach(De=>{const Hn=De.annotation;Pn[Hn.name]||(Pn[Hn.name]={}),Pn[Hn.name][Ie]=Hn})})});const gl={};return P==null||P.forEach(O=>{const G=O.annotationName;gl[G]||(gl[G]=[]),Pn[G]||(Pn[G]={}),A.forEach(Ie=>{const De=Pn[G][Ie];gl[G].push(De)})}),{id:Ce.id,example:Ce.id,repetitionNumber:$.repetitionNumber,input:Ce.revision.input,referenceOutput:Ce.revision.referenceOutput,outputs:{baseExperimentValue:$.output,compareExperimentValues:X.map(O=>O==null?void 0:O.output)},tokens:{baseExperimentValue:$.costSummary.total.tokens,compareExperimentValues:X.map(O=>O==null?void 0:O.costSummary.total.tokens)},latencyMs:{baseExperimentValue:new Date($.endTime).getTime()-new Date($.startTime).getTime(),compareExperimentValues:X.map(O=>O?new Date(O.endTime).getTime()-new Date(O.startTime).getTime():void 0)},cost:{baseExperimentValue:$.costSummary.total.cost,compareExperimentValues:X.map(O=>O==null?void 0:O.costSummary.total.cost)},baseExperimentRunAnnotationsByName:pe,compareExperimentRunAnnotationsByName:gl}}))??[]},[S,P,A,t]),j=f.useMemo(()=>WS(),[]),ce=f.useCallback(Z=>{if(Z){const{scrollHeight:ue,scrollTop:Ke,clientHeight:Ce}=Z;ue-Ke-Ce<300&&!L&&I&&F(Td)}},[I,L,F]),W=f.useMemo(()=>{const Z={header:"example",accessorKey:"example",size:110,cell:({getValue:z,row:O})=>{const G=z();return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Dr,{children:G}),o(Se,{children:[e(fn,{size:"S","aria-label":"View experiment run details",onPress:()=>{r(O.index)},css:K`
                  flex: none;
                `,children:e(x,{svg:e(ft,{})})}),o($e,{children:[e(ln,{}),"view experiment runs"]})]})]})}},ue={header:"repetition",size:64,accessorKey:"repetitionNumber",cell:({getValue:z})=>{const O=z();return e(v,{size:"S",fontFamily:"mono",children:O})}},Ke={header:"input",accessorKey:"input",cell:({getValue:z})=>{const O=z();return e(fi,{content:O,children:e(Do,{lines:E.length,children:e(il,{json:O,disableTitle:!0})})})}},Ce={header:"reference output",accessorKey:"referenceOutput",cell:({getValue:z})=>{const O=z();return e(fi,{content:O,children:e(Do,{lines:E.length,children:e(il,{json:O,disableTitle:!0})})})}},w={header:"output",accessorKey:"outputs",cell:({getValue:z})=>{const O=z();return o("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:[e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{css:K`
                    flex-shrink: 0;
                  `,children:e(Qn,{color:p,shape:"circle"})}),e(fi,{content:O.baseExperimentValue,children:e(Dr,{children:e(v,{size:"S",fontFamily:"mono",children:xa(O.baseExperimentValue)?JSON.stringify(O.baseExperimentValue):String(O.baseExperimentValue)})})})]})}),O.compareExperimentValues.map((G,Ie)=>e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e("span",{css:K`
                      flex-shrink: 0;
                    `,children:e(Qn,{color:g(Ie),shape:"circle"})}),G?e(fi,{content:G,children:e(Dr,{children:e(v,{size:"S",fontFamily:"mono",children:xa(G)?JSON.stringify(G):String(G)})})}):e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"not run"})]})},Ie))]})}},$={header:()=>o(b,{direction:"column",gap:"size-100",children:[e(v,{size:"S",weight:"heavy",children:"tokens"}),e("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:E.map(z=>{const O=Id(z.costSummary.total.tokens,z.runCount);return e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"AVG"}),e(v,{size:"S",fontFamily:"mono",children:kl(O)})]})},z.id)})})]}),accessorKey:"tokens",minSize:150,enableResizing:!1,cell:({getValue:z})=>{const O=z();return o("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:[e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:p,shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:Ye(O.baseExperimentValue)})]})}),O.compareExperimentValues.map((G,Ie)=>e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:g(Ie),shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:Ye(G)})]})},Ie))]})}},X=j.accessor("latencyMs",{header:({column:z})=>o(b,{direction:"column",gap:"size-100",children:[o("div",{className:z.getCanSort()?"sort":"",onClick:z.getToggleSortingHandler(),style:{left:z.getStart(),width:z.getSize()},children:[e(v,{size:"S",weight:"heavy",children:"latency"}),z.getIsSorted()?e(x,{className:"sort-icon",svg:z.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]}),e("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:E.map(O=>e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"AVG"}),e(v,{size:"S",fontFamily:"mono",children:Si(O.averageRunLatencyMs)})]})},O.id))})]}),minSize:150,enableResizing:!1,enableSorting:!0,cell:({getValue:z})=>{const O=z();return o("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:[e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:p,shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:Si(O.baseExperimentValue)})]})}),O.compareExperimentValues.map((G,Ie)=>e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:g(Ie),shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:Si(G)})]})},Ie))]})}}),pe={header:()=>o(b,{direction:"column",gap:"size-100",children:[e(v,{size:"S",weight:"heavy",children:"cost"}),e("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:E.map(z=>{const O=Id(z.costSummary.total.cost,z.runCount);return e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"AVG"}),e(v,{size:"S",fontFamily:"mono",children:cn(O)})]})},z.id)})})]}),accessorKey:"cost",minSize:150,enableResizing:!1,cell:({getValue:z})=>{const O=z();return o("ul",{css:K`
              display: flex;
              flex-direction: column;
              gap: var(--ac-global-dimension-size-50);
            `,children:[e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:p,shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:cn(O.baseExperimentValue)})]})}),O.compareExperimentValues.map((G,Ie)=>e("li",{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:g(Ie),shape:"circle"}),e(v,{size:"S",fontFamily:"mono",children:cn(G)})]})},Ie))]})}},Pn=(P==null?void 0:P.map(z=>j.accessor(O=>{const G=O.baseExperimentRunAnnotationsByName[z.annotationName],Ie=O.compareExperimentRunAnnotationsByName[z.annotationName];return{baseExperimentRunAnnotation:G,compareExperimentRunAnnotations:Ie}},{id:z.annotationName,header:O=>o(b,{direction:"column",gap:"size-100",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Cc,{annotationName:z.annotationName}),o("div",{className:O.column.getCanSort()?"sort":"",onClick:O.column.getToggleSortingHandler(),style:{left:O.column.getStart(),width:O.column.getSize()},children:[e(v,{size:"S",weight:"heavy",children:z.annotationName}),O.column.getIsSorted()?e(x,{className:"sort-icon",svg:O.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})]}),e("ul",{css:K`
                      display: flex;
                      flex-direction: column;
                      gap: var(--ac-global-dimension-size-25);
                    `,children:E.map((G,Ie)=>{var _a;const De=(_a=G.annotationSummaries)==null?void 0:_a.find(pl=>pl.annotationName===z.annotationName),Hn=Ie===0?p:g(Ie-1);return o("li",{css:K`
                            --mod-barloader-fill-color: ${Hn};
                          `,children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",color:"grey-500",children:"AVG"}),e(v,{size:"S",fontFamily:"mono",children:el(De==null?void 0:De.meanScore)})]}),typeof(De==null?void 0:De.meanScore)=="number"?e(bi,{width:"100%",height:"var(--ac-global-dimension-size-25)",value:Ci(De.meanScore,z.minScore,z.maxScore),"aria-label":`${z.annotationName} mean score`}):e(_r,{})]},G.id)})})]}),minSize:200,enableResizing:!1,cell:({getValue:O})=>{const{baseExperimentRunAnnotation:G,compareExperimentRunAnnotations:Ie}=O(),De=Pd(G),Hn=typeof De=="number"?el(De):De;return o("ul",{css:K`
                    display: flex;
                    flex-direction: column;
                    gap: var(--ac-global-dimension-size-25);
                  `,children:[o("li",{css:K`
                      --mod-barloader-fill-color: ${p};
                    `,children:[e(b,{direction:"row",gap:"size-100",alignItems:"center",children:e(v,{size:"S",fontFamily:"mono",children:Hn})}),typeof De=="number"?e(bi,{width:"100%",height:"var(--ac-global-dimension-size-25)",value:Ci(De,z.minScore,z.maxScore),"aria-label":`${z.annotationName} score`}):e(_r,{})]}),Ie.map((_a,pl)=>{const Aa=Pd(_a),yl=typeof Aa=="number"?el(Aa):Aa,It=g(pl);return o("li",{css:K`
                            --mod-barloader-fill-color: ${It};
                          `,children:[e(b,{direction:"row",gap:"size-100",alignItems:"center",children:e(v,{size:"S",fontFamily:"mono",children:yl})}),typeof Aa=="number"?e(bi,{width:"100%",height:"var(--ac-global-dimension-size-25)",value:Ci(Aa,z.minScore,z.maxScore),"aria-label":`${z.annotationName} score`}):e(_r,{})]},pl)})]})}})))??[];return[Z,ue,Ke,Ce,w,$,X,pe,...Pn]},[P,p,j,E,g]),Pe=Qe({data:V,columns:W,onSortingChange:u,getCoreRowModel:Be(),getSortedRowModel:Vn(),columnResizeMode:"onChange",state:{sorting:c,columnVisibility:{repetitionNumber:D.repetitions>1}},manualSorting:!0});f.useEffect(()=>{if(m.current===!0){m.current=!1;return}let Z;if(c.length>0){const ue=c[0],Ke=ue.desc?"desc":"asc",Ce=ue.id;let w,$;s3(Ce)?w=Ce:$=Ce,Z={col:{metric:w,annotationName:$},dir:Ke}}f.startTransition(()=>{M({after:null,first:50,sort:Z},{fetchPolicy:"store-and-network"})})},[c,M]);const ne=Pe.getRowModel().rows,N=Ms({count:ne.length,getScrollElement:()=>y.current,estimateSize:()=>{const Z=E.length;return 29+Z*20+4*(Z-1)},overscan:10}),B=Pe.getState(),Q=f.useMemo(()=>{const Z=Pe.getFlatHeaders(),ue={};for(let Ke=0;Ke<Z.length;Ke++){const Ce=Z[Ke];ue[`--header-${Jn(Ce.id)}-size`]=Ce.getSize(),ue[`--col-${Jn(Ce.column.id)}-size`]=Ce.column.getSize()}return ue},[B.columnSizingInfo,B.columnSizing,B.columnVisibility]),q=f.useMemo(()=>ne.map(Z=>Z.original.example),[ne]);return o(C,{overflow:"auto",children:[e(b,{direction:"column",height:"100%",children:e("div",{css:a3,onScroll:Z=>ce(Z.target),ref:y,children:o("table",{css:K(Kn,ks),style:{...Q,width:Pe.getTotalSize(),minWidth:"100%",tableLayout:"fixed"},children:[e("thead",{children:Pe.getHeaderGroups().map(Z=>e("tr",{children:Z.headers.map((ue,Ke)=>e("th",{style:{width:`calc(var(--header-${Jn(ue==null?void 0:ue.id)}-size) * 1px)`,padding:"var(--ac-global-dimension-size-175) var(--ac-global-dimension-size-200)"},children:ue.isPlaceholder?null:o(te,{children:[de(ue.column.columnDef.header,ue.getContext()),ue.column.getCanResize()&&e("div",{onMouseDown:ue.getResizeHandler(),onTouchStart:ue.getResizeHandler(),className:`resizer ${ue.column.getIsResizing()?"isResizing":""}`})]})},ue.id+"-"+Ke))},Z.id))}),Pe.getState().columnSizingInfo.isResizingColumn?e(t3,{table:Pe,virtualizer:N}):e(fh,{table:Pe,virtualizer:N})]})})}),e(oe,{isOpen:i!==null,onOpenChange:Z=>{Z||r(null)},children:e(ae,{variant:"slideover",size:"fullscreen",children:i!==null&&_&&ne[i]&&e(io,{repetitionNumber:(D==null?void 0:D.repetitions)>1?ne[i].original.repetitionNumber:void 0,datasetId:_,datasetVersionId:D==null?void 0:D.datasetVersionId,selectedExampleIndex:i,selectedExampleId:ne[i].original.example,baseExperimentId:D==null?void 0:D.id,compareExperimentIds:A,exampleIds:q,onExampleChange:Z=>{Z===q.length-1&&!L&&I&&F(Td),Z>=0&&Z<q.length&&r(Z)},openTraceDialog:(Z,ue,Ke)=>{d({traceId:Z,projectId:ue,dialogTitle:Ke})}})})}),e(oe,{isOpen:s!==null,onOpenChange:Z=>{Z||(l(ue=>{const Ke=new URLSearchParams(ue);return Ke.delete("selectedSpanNodeId"),Ke},{replace:!0}),d(null))},children:e(ae,{variant:"slideover",size:"fullscreen",children:s!==null&&e(or,{traceId:s.traceId,projectId:s.projectId,title:s.dialogTitle})})})]})}function fh({table:n,virtualizer:a}){const l=n.getRowModel().rows,t=a.getVirtualItems(),i=a.getTotalSize(),r=f.useMemo(()=>i-t.reduce((s,d)=>s+d.size,0),[i,t]);return o("tbody",{children:[t.map((s,d)=>{const c=l[s.index];return e("tr",{style:{height:`${s.size}px`,transform:`translateY(${s.start-d*s.size}px)`},children:c.getVisibleCells().map((u,m)=>e("td",{style:{width:`calc(var(--col-${Jn(u.column.id)}-size) * 1px)`,maxWidth:`calc(var(--col-${Jn(u.column.id)}-size) * 1px)`,padding:"var(--ac-global-dimension-size-175) var(--ac-global-dimension-size-200)",verticalAlign:"middle"},children:de(u.column.columnDef.cell,u.getContext())},u.id+"-"+m))},c.id)}),e("tr",{children:e("td",{style:{height:`${r}px`,padding:0},colSpan:n.getVisibleLeafColumns().length})})]})}const t3=f.memo(fh,(n,a)=>n.table.options.data===a.table.options.data),Pd=n=>(n==null?void 0:n.score)??(n==null?void 0:n.label)??"--",Id=(n,a)=>n===null||a===0?null:n/a;function fi({content:n,children:a}){return o(Se,{children:[e(Zn,{css:K`
          overflow: hidden;
        `,children:a}),e(fa,{placement:"right",offset:3,css:K`
          overflow-y: auto;
        `,children:xa(n)?e(il,{json:n,disableTitle:!0,space:2}):e(v,{size:"S",fontFamily:"mono",children:String(n)})})]})}const i3=K`
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;

  // prevent default behavior of title tooltip showing on safari
  &::after {
    content: "";
    display: block;
  }
`;function Dr({children:n}){return e("div",{css:i3,children:n})}const r3=K`
  width: 100%;
  height: var(--ac-global-dimension-size-25);
`;function _r(){return e("div",{css:r3})}function s3(n){return n==="latencyMs"}const hh=(function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"tokens",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cost",storageKey:null}],a=[{alias:null,args:null,kind:"ScalarField",name:"numRunsImproved",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRunsRegressed",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"numRunsEqual",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"compareExperimentIds"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"experimentIds"},{defaultValue:null,kind:"LocalArgument",name:"hasCompareExperiments"}],kind:"Fragment",metadata:null,name:"ExperimentCompareMetricsPage_experiments",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"filterIds",variableName:"experimentIds"}],concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"averageRunLatencyMs",storageKey:null},{alias:null,args:null,concreteType:"SpanCostSummary",kind:"LinkedField",name:"costSummary",plural:!1,selections:[{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"total",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"prompt",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"CostBreakdown",kind:"LinkedField",name:"completion",plural:!1,selections:n,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ExperimentAnnotationSummary",kind:"LinkedField",name:"annotationSummaries",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"annotationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"meanScore",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null},{condition:"hasCompareExperiments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{kind:"Variable",name:"baseExperimentId",variableName:"baseExperimentId"},{kind:"Variable",name:"compareExperimentIds",variableName:"compareExperimentIds"}],concreteType:"ExperimentRunMetricComparisons",kind:"LinkedField",name:"experimentRunMetricComparisons",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"latency",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"totalTokenCount",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"promptTokenCount",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"completionTokenCount",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"totalCost",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"promptCost",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"ExperimentRunMetricComparison",kind:"LinkedField",name:"completionCost",plural:!1,selections:a,storageKey:null}],storageKey:null}]}],type:"Query",abstractKey:null}})();hh.hash="96673053ee2ac1663eb158f8054baac3";const xd=K`
  font-size: var(--ac-global-text-font-size-l);
`,o3=K`
  padding: var(--ac-global-dimension-size-200);
  border: 1px solid var(--ac-global-color-grey-200);
  border-radius: var(--ac-global-rounding-medium);
  transition: border-color 0.2s;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  gap: var(--ac-global-dimension-size-200);
  height: 100%;
`;function d3({queryRef:n}){const[a]=_n(),[l=void 0,...t]=a.getAll("experimentId");if(l==null)throw new Error("Empty state not yet implemented");const{getExperimentColor:i}=Yl(),r=T.usePreloadedQuery(ah,n),s=T.useFragment(hh,r);if(!s)throw new Error("Empty state not implemented");const{theme:d}=ia(),{annotationMetrics:c,costMetrics:u,performanceMetrics:m,tokenCountMetrics:g}=f.useMemo(()=>{var W,Pe;const p={};(W=s.dataset.experiments)==null||W.edges.forEach(ne=>{const N=ne.experiment;p[N.id]=N});const y=p[l];if(!y)return{annotationMetrics:[],costMetrics:[],performanceMetrics:[],tokenCountMetrics:[]};const h=t.map(ne=>p[ne]).filter(ne=>ne!=null),k=s.experimentRunMetricComparisons,S={icon:e(x,{svg:e(Db,{})}),title:"Latency",baseExperimentValue:y.averageRunLatencyMs,comparison:{numImprovements:(k==null?void 0:k.latency.numRunsImproved)??0,numRegressions:(k==null?void 0:k.latency.numRunsRegressed)??0,numEqual:(k==null?void 0:k.latency.numRunsEqual)??0,optimizationDirection:"MAXIMIZE"},compareExperiments:[],formatter:Si},F={icon:e(x,{svg:e(ur,{})}),title:"Total Tokens",baseExperimentValue:y.costSummary.total.tokens,comparison:{numImprovements:(k==null?void 0:k.totalTokenCount.numRunsImproved)??0,numRegressions:(k==null?void 0:k.totalTokenCount.numRunsRegressed)??0,numEqual:(k==null?void 0:k.totalTokenCount.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[]},I={icon:e(x,{svg:e(ur,{})}),title:"Prompt Tokens",baseExperimentValue:y.costSummary.prompt.tokens,comparison:{numImprovements:(k==null?void 0:k.promptTokenCount.numRunsImproved)??0,numRegressions:(k==null?void 0:k.promptTokenCount.numRunsRegressed)??0,numEqual:(k==null?void 0:k.promptTokenCount.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[]},L={icon:e(x,{svg:e(ur,{})}),title:"Completion Tokens",baseExperimentValue:y.costSummary.completion.tokens,comparison:{numImprovements:(k==null?void 0:k.completionTokenCount.numRunsImproved)??0,numRegressions:(k==null?void 0:k.completionTokenCount.numRunsRegressed)??0,numEqual:(k==null?void 0:k.completionTokenCount.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[]},M={icon:e(x,{svg:e(Ql,{})}),title:"Total Cost",baseExperimentValue:y.costSummary.total.cost,comparison:{numImprovements:(k==null?void 0:k.totalCost.numRunsImproved)??0,numRegressions:(k==null?void 0:k.totalCost.numRunsRegressed)??0,numEqual:(k==null?void 0:k.totalCost.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[],formatter:cn},E={icon:e(x,{svg:e(Ql,{})}),title:"Prompt Cost",baseExperimentValue:y.costSummary.prompt.cost,comparison:{numImprovements:(k==null?void 0:k.promptCost.numRunsImproved)??0,numRegressions:(k==null?void 0:k.promptCost.numRunsRegressed)??0,numEqual:(k==null?void 0:k.promptCost.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[],formatter:cn},P={icon:e(x,{svg:e(Ql,{})}),title:"Completion Cost",baseExperimentValue:y.costSummary.completion.cost,comparison:{numImprovements:(k==null?void 0:k.completionCost.numRunsImproved)??0,numRegressions:(k==null?void 0:k.completionCost.numRunsRegressed)??0,numEqual:(k==null?void 0:k.completionCost.numRunsEqual)??0,optimizationDirection:"MINIMIZE"},compareExperiments:[],formatter:cn};h.forEach((ne,N)=>{const B=i(N);S.compareExperiments.push({id:ne.id,value:ne.averageRunLatencyMs,color:B}),I.compareExperiments.push({id:ne.id,value:ne.costSummary.prompt.tokens,color:B}),L.compareExperiments.push({id:ne.id,value:ne.costSummary.completion.tokens,color:B}),F.compareExperiments.push({id:ne.id,value:ne.costSummary.total.tokens,color:B}),M.compareExperiments.push({id:ne.id,value:ne.costSummary.total.cost,color:B}),E.compareExperiments.push({id:ne.id,value:ne.costSummary.prompt.cost,color:B}),P.compareExperiments.push({id:ne.id,value:ne.costSummary.completion.cost,color:B})});const _=[S],D=[M,E,P],A=[F,I,L],V={};(Pe=y.annotationSummaries)==null||Pe.forEach(ne=>{ne.meanScore!=null&&(V[ne.annotationName]=ne.meanScore)});const j={};h.forEach(ne=>{var N;(N=ne.annotationSummaries)==null||N.forEach(B=>{const Q=B.annotationName,q=ne.id,ie=B.meanScore;q!=null&&ie!=null&&(Q in j||(j[Q]={}),j[Q][q]=ie)})});const ce=[];for(const ne in V){const N=V[ne];if(!(ne in j))continue;const B=[];h.forEach((Q,q)=>{const ie=Q.id,Z=i(q);let ue=null;ie==null||!(ie in j[ne])?ue=null:ue=j[ne][ie],B.push({id:ie,value:ue,color:Z})}),ce.push({icon:e(Qn,{color:Is({word:ne,theme:d})}),title:ne,baseExperimentValue:N,compareExperiments:B})}return{annotationMetrics:ce,costMetrics:D,performanceMetrics:_,tokenCountMetrics:A}},[l,t,s,i,d]);return e("div",{css:K`
        overflow: auto;
        padding: var(--ac-global-dimension-size-200);
        height: 100%;
      `,children:e("div",{css:K`
          min-width: 1280px;
        `,children:o(b,{direction:"row",gap:"size-250",children:[c.length>0&&e(hi,{title:"Evaluations",metrics:c}),e(hi,{title:"Cost",metrics:u}),e(hi,{title:"Performance",metrics:m}),e(hi,{title:"Token Counts",metrics:g})]})})})}function hi({title:n,metrics:a}){return o(C,{children:[e(Te,{level:2,css:K`
          margin-bottom: var(--ac-global-dimension-size-150);
        `,children:n}),e("ul",{css:K`
          display: flex;
          flex-direction: column;
          gap: var(--ac-global-dimension-size-200);
          min-width: 300px;
        `,children:a.map(l=>e("li",{css:K`
              display: flex;
              flex-direction: column;
              height: 100%;
            `,children:e(c3,{...l})},l.title))})]})}function c3({icon:n,title:a,baseExperimentValue:l,comparison:t,compareExperiments:i,formatter:r=el}){const{baseExperimentColor:s}=Yl();return e("div",{css:o3,children:o(b,{direction:"column",gap:"size-200",children:[o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[n,e(Te,{level:3,children:a})]}),t&&e(g3,{...t})]}),e(p3,{bars:[{value:l??0,color:s},...i.map(d=>({value:d.value??0,color:d.color}))]}),o(b,{direction:"column",children:[e(u3,{value:l,formatter:r}),i.map(d=>e(m3,{value:d.value,baseExperimentValue:l,color:d.color,formatter:r},d.id))]})]})})}function u3({value:n,formatter:a=el}){const{baseExperimentColor:l}=Yl(),t=a(n);return o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(Qn,{color:l,shape:"circle"}),e(v,{size:"M",fontFamily:"mono",weight:"heavy",children:t})]})}function m3({value:n,baseExperimentValue:a,color:l,formatter:t=el}){const i=f.useMemo(()=>t(n),[t,n]),r=f.useMemo(()=>{let s="+0%";if(a==null||n==null)return s;const d=n-a,c=d>=0?"+":"-";if(a!==0){const u=Math.abs(d/a)*100;s=`${c}${$t(u)}`}return s},[a,n]);return o(b,{direction:"row",alignItems:"center",gap:"size-100",children:[e(Qn,{color:l,shape:"circle"}),o(b,{direction:"row",alignItems:"center",gap:"size-50",children:[e(v,{size:"M",fontFamily:"mono",children:i}),e(v,{color:"text-500",size:"S",fontFamily:"mono",children:r})]})]})}function g3({numImprovements:n,numRegressions:a,numEqual:l}){const{disableTooltip:t,tooltipItems:i}=f.useMemo(()=>{const r=[];return n>0&&r.push({key:"improved",text:`${n} run${n>1?"s":""} improved`}),a>0&&r.push({key:"regressed",text:`${a} run${a>1?"s":""} regressed`}),l>0&&r.push({key:"equal",text:`${l} run${l>1?"s":""} stayed the same`}),{disableTooltip:r.length===0,tooltipItems:r}},[l,n,a]);return o(Se,{isDisabled:t,delay:200,children:[e(Zn,{children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[n>0&&o(b,{direction:"row",gap:"size-75",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",children:n}),e(x,{svg:e(_b,{}),color:"success",css:xd})]}),a>0&&o(b,{direction:"row",gap:"size-75",alignItems:"center",children:[e(v,{size:"S",fontFamily:"mono",children:a}),e(x,{svg:e(Ab,{}),color:"danger",css:xd})]})]})}),e($e,{children:e("ul",{children:i.map(r=>e("li",{children:e(v,{size:"S",children:r.text},r.key)},r.key))})})]})}function p3({bars:n}){if(n.length===0)return null;const a=Math.max(...n.map(t=>t.value));let l=[];return a!==0?l=n.map(t=>t.value/a*100):l=n.map(()=>0),e("div",{css:K`
        display: flex;
        flex-direction: column;
        gap: 0.3rem;
        width: 100%;
      `,children:n.map((t,i)=>e("div",{css:K`
            background-color: ${t.color};
            height: 0.3rem;
            border-radius: 2px;
            width: ${l[i]}%;
          `},i))})}const kh=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"baseExperimentId"},{defaultValue:null,kind:"LocalArgument",name:"datasetId"},{defaultValue:null,kind:"LocalArgument",name:"hasBaseExperiment"}],kind:"Fragment",metadata:null,name:"ExperimentMultiSelector__data",selections:[{alias:"dataset",args:[{kind:"Variable",name:"id",variableName:"datasetId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[n,{kind:"InlineFragment",selections:[a,{alias:"allExperiments",args:null,concreteType:"ExperimentConnection",kind:"LinkedField",name:"experiments",plural:!1,selections:[{alias:null,args:null,concreteType:"ExperimentEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"experiment",args:null,concreteType:"Experiment",kind:"LinkedField",name:"node",plural:!1,selections:[n,a,{alias:null,args:null,kind:"ScalarField",name:"sequenceNumber",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Dataset",abstractKey:null}],storageKey:null},{condition:"hasBaseExperiment",kind:"Condition",passingValue:!0,selections:[{alias:"baseExperiment",args:[{kind:"Variable",name:"id",variableName:"baseExperimentId"}],concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[n,a],type:"Experiment",abstractKey:null}],storageKey:null}]}],type:"Query",abstractKey:null}})();kh.hash="a616b80b60dec9ca1971902a32f27442";function y3(n){const{selectedBaseExperimentId:a,selectedCompareExperimentIds:l,onChange:t,queryRef:i}=n,{baseExperimentColor:r}=Yl(),s=T.usePreloadedQuery(Xf,i),d=T.useFragment(kh,s),{allExperiments:c,nonBaseExperiments:u}=f.useMemo(()=>{var y;const g=[],p=[];return(y=d.dataset.allExperiments)==null||y.edges.forEach(h=>{const k=h.experiment;g.push(k),k.id!==a&&p.push(k)}),{allExperiments:g,nonBaseExperiments:p}},[d.dataset.allExperiments,a]),m=f.useMemo(()=>{const g=l.length;return g>0?`${g} experiment${g>1?"s":""}`:"No experiments selected"},[l]);return o(b,{direction:"row",gap:"size-100",children:[o("div",{css:K(ba,Ao),children:[e(J,{children:"experiment"}),o(se,{children:[e(R,{size:"S",trailingVisual:e(na,{}),children:d.baseExperiment!=null?o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(Qn,{color:r,shape:"circle"}),e(v,{css:K`
                    white-space: nowrap;
                    max-width: var(--ac-global-dimension-size-2000);
                    overflow: hidden;
                    text-overflow: ellipsis;
                  `,children:d.baseExperiment.name})]}):"No experiment selected"}),e(we,{placement:"bottom start",children:e(re,{children:e(Bn,{selectionMode:"single",selectionBehavior:"replace",selectedKeys:new Set(a?[a]:[]),onSelectionChange:g=>{const[p]=g;Xe(typeof p=="string");const y=[...a?[a]:[],...l.filter(h=>h!==p)];t(p,y)},children:c.map(g=>e(rl,{id:g.id,children:({isSelected:p})=>o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",children:[e(Pi,{sequenceNumber:g.sequenceNumber}),e(v,{css:K`
                                white-space: nowrap;
                                max-width: var(--ac-global-dimension-size-2000);
                                overflow: hidden;
                                text-overflow: ellipsis;
                              `,children:g.name})]}),e(v,{size:"XS",color:"text-700",children:new Date(g.createdAt).toLocaleString()})]}),p&&e(x,{svg:e(_o,{})})]})},g.id))})})})]})]}),a&&u.length>0&&o("div",{css:K(ba,Ao),children:[e(J,{children:"comparisons"}),o(se,{children:[e(R,{size:"S",trailingVisual:e(na,{}),children:m}),e(we,{placement:"bottom start",children:e(re,{children:e(Bn,{selectionMode:"multiple",selectedKeys:new Set(l),onSelectionChange:g=>{t(a,Array.from(g))},children:u.map(g=>e(rl,{id:g.id,children:({isSelected:p})=>o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[o(b,{direction:"column",gap:"size-50",children:[o(b,{direction:"row",gap:"size-100",children:[e(Pi,{sequenceNumber:g.sequenceNumber}),e(v,{css:K`
                                  white-space: nowrap;
                                  max-width: var(
                                    --ac-global-dimension-size-2000
                                  );
                                  overflow: hidden;
                                  text-overflow: ellipsis;
                                `,children:g.name})]}),e(v,{size:"XS",color:"text-700",children:new Date(g.createdAt).toLocaleString()})]}),p&&e(x,{svg:e(_o,{})})]})},g.id))})})})]})]})]})}function R5(){const[n,a]=T.useQueryLoader(Xf),[l,t]=T.useQueryLoader(Yf),[i,r]=T.useQueryLoader(eh),[s,d]=T.useQueryLoader(nh),[c,u]=T.useQueryLoader(ah),{datasetId:m}=on();Xe(m!=null);const[g]=_n(),{baseExperimentId:p=void 0,compareExperimentIds:y}=f.useMemo(()=>{const[F=void 0,...I]=g.getAll("experimentId");return{baseExperimentId:F,compareExperimentIds:I}},[g]),h=f.useMemo(()=>{const F=g.get("view");return Eb(F)?F:"grid"},[g]),k=Me(),S=f.useCallback(F=>{g.set("view",F),k(`/datasets/${m}/compare?${g.toString()}`)},[m,k,g]);return f.useEffect(()=>{const F=[...p?[p]:[],...y];if(a({datasetId:m,hasBaseExperiment:p!=null,baseExperimentId:p??""}),t({datasetId:m,experimentIds:F}),p!=null)switch(h){case"grid":r({datasetId:m,experimentIds:F,baseExperimentId:p,compareExperimentIds:y});break;case"list":d({datasetId:m,experimentIds:F,baseExperimentId:p,compareExperimentIds:y});break;case"metrics":u({datasetId:m,experimentIds:F,baseExperimentId:p,compareExperimentIds:y,hasCompareExperiments:y.length>0});break;default:Ne()}},[p,y,m,a,t,r,d,u,h]),n==null?e(me,{}):o("main",{css:K`
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(C,{paddingX:"size-200",paddingTop:"size-100",paddingBottom:"size-200",borderBottomColor:"dark",borderBottomWidth:"thin",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",gap:"size-150",alignItems:"end",children:[e(y3,{queryRef:n,selectedBaseExperimentId:p,selectedCompareExperimentIds:y,onChange:(F,I)=>{f.startTransition(()=>{F==null?k(`/datasets/${m}/compare`):(g.delete("experimentId"),[F,...I].forEach(L=>{g.append("experimentId",L)}),k(`/datasets/${m}/compare?${g.toString()}`))})}}),e(C,{flex:"1",paddingBottom:5,children:e(f.Suspense,{children:l&&e(h3,{queryRef:l})})}),e(wb,{viewMode:h,onViewModeChange:S})]})}),p==null?e(C,{padding:"size-200",children:e(Ee,{variant:"info",title:"No Experiment Selected",children:"Please select an experiment."})}):e(f3,{compareGridQueryReference:i??null,compareListQueryReference:s??null,compareMetricsQueryReference:c??null})]})}function f3({compareGridQueryReference:n,compareListQueryReference:a,compareMetricsQueryReference:l}){const[t]=_n(),i=t.get("view")??"grid";return i==="grid"?n?e(f.Suspense,{fallback:e(me,{}),children:e(n3,{queryRef:n})}):e(me,{}):i==="metrics"?l?e(f.Suspense,{fallback:e(me,{}),children:e(d3,{queryRef:l})}):e(me,{}):i==="list"?a?e(f.Suspense,{fallback:e(me,{}),children:e(l3,{queryRef:a})}):e(me,{}):e(C,{padding:"size-200",children:e(Ee,{variant:"info",title:"Invalid View Mode Requested",children:'Please enter a valid view ("grid" or "metrics") in the URL query parameters.'})})}function h3({queryRef:n}){const[a]=_n(),[,...l]=a.getAll("experimentId"),{getExperimentColor:t}=Yl(),i=T.usePreloadedQuery(Yf,n),r=T.useFragment(Uf,i),s=f.useMemo(()=>{var u;const c={};return(u=r.dataset.experiments)==null||u.edges.forEach(m=>{c[m.experiment.id]=m.experiment}),c},[r]);if(l.length===0)return null;const d=l.map(c=>s[c]).filter(c=>c!=null);return e(b,{direction:"row",gap:"size-100",alignItems:"center",children:d.map((c,u)=>e(lh,{color:t(u),name:c.name},c.id))})}const k3=K`
  overflow-y: auto;
  height: 100%;
`,b3=K`
  padding: var(--ac-global-dimension-size-100);
  max-width: 1300px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`,Ld=[{id:"general",label:"General"},{id:"providers",label:"AI Providers"},{id:"models",label:"Models"},{id:"datasets",label:"Datasets"},{id:"annotations",label:"Annotations"},{id:"prompts",label:"Prompts"},{id:"data",label:"Data Retention"}];function V5(){const{pathname:n}=Ft(),a=Me(),l=n.split("/settings")[1].replace("/",""),t=f.useCallback(i=>{typeof i=="string"&&a(`/settings/${i}`,{replace:!0})},[a]);return l?e("main",{css:k3,children:e("div",{css:b3,children:o(jn,{selectedKey:l,onSelectionChange:t,children:[e(On,{items:Ld,children:i=>e(ve,{id:i.id,children:i.label})}),e(JS,{items:Ld,children:i=>e(ua,{id:i.id,padded:!0,children:e(f.Suspense,{fallback:e(me,{}),children:e(Ue,{})})})})]})})}):e(jc,{to:"/settings/general",replace:!0})}const bh={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptLabelsSettingsCardFragment",selections:[{args:null,kind:"FragmentSpread",name:"PromptLabelsTableFragment"}],type:"Query",abstractKey:null};bh.hash="a33febfbc1c6d2bdf5b65fdd5c292f52";const Sh={argumentDefinitions:[{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:null,direction:"forward",path:["promptLabels"]}]},name:"PromptLabelsTableFragment",selections:[{alias:"promptLabels",args:null,concreteType:"PromptLabelConnection",kind:"LinkedField",name:"__PromptLabelsTable__promptLabels_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Sh.hash="aa6aef745b6890f9e8a48c72d2309626";const vh=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connections"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"deletedPromptLabelIds",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"DeletePromptLabelButtonMutation",selections:[{alias:null,args:l,concreteType:"PromptLabelDeleteMutationPayload",kind:"LinkedField",name:"deletePromptLabels",plural:!1,selections:[t],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"DeletePromptLabelButtonMutation",selections:[{alias:null,args:l,concreteType:"PromptLabelDeleteMutationPayload",kind:"LinkedField",name:"deletePromptLabels",plural:!1,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"deletedPromptLabelIds",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"}]}],storageKey:null}]},params:{cacheID:"7aff7ce5ec0e34e1c9a2cd200e88194e",id:null,metadata:{},name:"DeletePromptLabelButtonMutation",operationKind:"mutation",text:`mutation DeletePromptLabelButtonMutation(
  $input: DeletePromptLabelsInput!
) {
  deletePromptLabels(input: $input) {
    deletedPromptLabelIds
  }
}
`}}})();vh.hash="d35d931a28299f492d2c9400cdb165e2";function S3(n){const{promptLabelId:a}=n,[l,t]=f.useState(!1),i=Le(),r=Ve(),[s,d]=T.useMutation(vh);return o(se,{isOpen:l,onOpenChange:t,children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Tn,{})}),"aria-label":"Delete Prompt Label",isDisabled:d}),e(ws,{children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Prompt Label"}),e(ke,{children:e(be,{})})]}),e(ye,{children:o(C,{padding:"size-200",children:[e(v,{color:"danger",children:"Are you sure you want to delete this label? It will be removed from all prompts if you do so."}),e(C,{paddingTop:"size-100",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{variant:"danger",size:"S",isDisabled:d,onPress:()=>{s({variables:{input:{promptLabelIds:[a]},connections:[T.ConnectionHandler.getConnectionID("client:root","PromptLabelConfigButtonAllLabels_promptLabels"),T.ConnectionHandler.getConnectionID("client:root","PromptLabelsTable__promptLabels")]},onCompleted:()=>{i({title:"Label Deleted",message:"Successfully deleted prompt label"}),t(!1)},onError:()=>{r({title:"Failed to delete prompt label",message:"Please try again"})}})},children:"Delete"})})})]})})]})})})})]})}function v3({query:n}){"use no memo";const a=T.useFragment(Sh,n),l=f.useMemo(()=>a.promptLabels.edges.map(d=>d.node),[a]),t=Qe({columns:[{header:"label",accessorKey:"name",cell:({row:d})=>e(nn,{color:d.original.color,children:d.original.name})},{header:"description",accessorKey:"description"},{header:"",id:"actions",cell:({row:d})=>e(b,{width:"100%",alignItems:"end",justifyContent:"end",children:e(S3,{promptLabelId:d.original.id})})}],data:l,getCoreRowModel:Be(),getSortedRowModel:Vn()}),i=t.getRowModel().rows,s=i.length>0?e("tbody",{children:i.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:de(c.column.columnDef.cell,c.getContext())},c.id))},d.id))}):e(Xn,{});return o("table",{css:Kn,children:[e("thead",{children:t.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:e("div",{children:de(c.column.columnDef.header,c.getContext())})},c.id))},d.id))}),s]})}function F3({query:n}){const a=T.useFragment(bh,n);return e(ee,{title:"Prompt Labels",extra:e(Mb,{}),children:e(v3,{query:a})})}function N5(){const n=wn();Xe(n);const a=T.usePreloadedQuery(Lu,n);return e("main",{children:e(F3,{query:a})})}const Fh=(function(){var n=[{kind:"Literal",name:"first",value:100}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"SettingsDatasetsPageQuery",selections:[{args:null,kind:"FragmentSpread",name:"DatasetLabelsSettingsCardFragment"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"SettingsDatasetsPageQuery",selections:[{alias:null,args:n,concreteType:"DatasetLabelConnection",kind:"LinkedField",name:"datasetLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"datasetLabels(first:100)"},{alias:null,args:n,filters:null,handle:"connection",key:"DatasetLabelsTable__datasetLabels",kind:"LinkedHandle",name:"datasetLabels"}]},params:{cacheID:"d644286d0a3b1a6e827bb334d3435e5f",id:null,metadata:{},name:"SettingsDatasetsPageQuery",operationKind:"query",text:`query SettingsDatasetsPageQuery {
  ...DatasetLabelsSettingsCardFragment
}

fragment DatasetLabelsSettingsCardFragment on Query {
  ...DatasetLabelsTableFragment
}

fragment DatasetLabelsTableFragment on Query {
  datasetLabels(first: 100) {
    edges {
      node {
        id
        name
        description
        color
        __typename
      }
      cursor
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();Fh.hash="5d2bdd09afe1ca6b4411604bf97e8f79";const Ch={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DatasetLabelsSettingsCardFragment",selections:[{args:null,kind:"FragmentSpread",name:"DatasetLabelsTableFragment"}],type:"Query",abstractKey:null};Ch.hash="3922211daa123323e1c2ac97b642ab76";const Kh={argumentDefinitions:[{defaultValue:100,kind:"LocalArgument",name:"first"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:null,direction:"forward",path:["datasetLabels"]}]},name:"DatasetLabelsTableFragment",selections:[{alias:"datasetLabels",args:null,concreteType:"DatasetLabelConnection",kind:"LinkedField",name:"__DatasetLabelsTable__datasetLabels_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Kh.hash="e22f9050d93574e15367cc63e355f3ce";const Th=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"connections"},a={defaultValue:null,kind:"LocalArgument",name:"input"},l=[{kind:"Variable",name:"input",variableName:"input"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"DeleteDatasetLabelButtonMutation",selections:[{alias:null,args:l,concreteType:"DeleteDatasetLabelsMutationPayload",kind:"LinkedField",name:"deleteDatasetLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"datasetLabels",plural:!0,selections:[t],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"DeleteDatasetLabelButtonMutation",selections:[{alias:null,args:l,concreteType:"DeleteDatasetLabelsMutationPayload",kind:"LinkedField",name:"deleteDatasetLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"DatasetLabel",kind:"LinkedField",name:"datasetLabels",plural:!0,selections:[t,{alias:null,args:null,filters:null,handle:"deleteEdge",key:"",kind:"ScalarHandle",name:"id",handleArgs:[{kind:"Variable",name:"connections",variableName:"connections"}]}],storageKey:null}],storageKey:null}]},params:{cacheID:"b8a0548c9df74137476118cf38dfcc9c",id:null,metadata:{},name:"DeleteDatasetLabelButtonMutation",operationKind:"mutation",text:`mutation DeleteDatasetLabelButtonMutation(
  $input: DeleteDatasetLabelsInput!
) {
  deleteDatasetLabels(input: $input) {
    datasetLabels {
      id
    }
  }
}
`}}})();Th.hash="e84ccde3a71540e1e768694c2a6adb56";function C3(n){const{datasetLabelId:a}=n,[l,t]=f.useState(!1),i=Le(),r=Ve(),[s,d]=T.useMutation(Th);return o(se,{isOpen:l,onOpenChange:t,children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(Tn,{})}),"aria-label":"Delete Dataset Label",isDisabled:d}),e(ws,{children:e(ae,{size:"S",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Dataset Label"}),e(ke,{children:e(be,{})})]}),e(ye,{children:o(C,{padding:"size-200",children:[e(v,{color:"danger",children:"Are you sure you want to delete this label? It will be removed from all datasets if you do so."}),e(C,{paddingTop:"size-100",children:e(b,{direction:"row",justifyContent:"end",children:e(R,{variant:"danger",size:"S",isDisabled:d,onPress:()=>{s({variables:{input:{datasetLabelIds:[a]},connections:[T.ConnectionHandler.getConnectionID("client:root","DatasetLabelsTable__datasetLabels")]},onCompleted:()=>{i({title:"Label Deleted",message:"Successfully deleted dataset label"}),t(!1)},onError:()=>{r({title:"Failed to delete label",message:"Failed to delete dataset label. Please try again."})}})},children:"Delete"})})})]})})]})})})})]})}function K3({query:n}){"use no memo";const a=T.useFragment(Kh,n),l=f.useMemo(()=>a.datasetLabels.edges.map(d=>d.node),[a.datasetLabels.edges]),t=Qe({columns:[{header:"label",accessorKey:"name",cell:({row:d})=>e(nn,{color:d.original.color,children:d.original.name})},{header:"description",accessorKey:"description"},{header:"",id:"actions",cell:({row:d})=>e(b,{width:"100%",alignItems:"end",justifyContent:"end",children:e(C3,{datasetLabelId:d.original.id})})}],data:l,getCoreRowModel:Be(),getSortedRowModel:Vn()}),i=t.getRowModel().rows,s=i.length>0?e("tbody",{children:i.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:de(c.column.columnDef.cell,c.getContext())},c.id))},d.id))}):e(Xn,{});return o("table",{css:Kn,children:[e("thead",{children:t.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:e("div",{children:de(c.column.columnDef.header,c.getContext())})},c.id))},d.id))}),s]})}function T3({query:n}){const a=T.useFragment(Ch,n);return e(ee,{title:"Dataset Labels",extra:e(Rb,{updateConnectionIds:[T.ConnectionHandler.getConnectionID("client:root","DatasetLabelsTable__datasetLabels")]}),children:e(K3,{query:a})})}function z5(){const n=T.useLazyLoadQuery(Fh,{},{fetchPolicy:"network-only"});return e("main",{children:e(T3,{query:n})})}const Dd=window.Config.basename,_d={width:"100%",height:"100%",border:"none",backgroundColor:"white"};function $5(){return o("div",{css:K`
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        height: 100%;
        .ac-tabs {
          flex: 1 1 auto;
        }
        .ac-tabs__pane-container,
        .ac-tabs__pane-container > div {
          flex: 1 1 auto;
          height: 100%;
        }
      `,children:[e(Ee,{variant:"info",banner:!0,icon:e(x,{svg:e(Vb,{})}),children:"These APIs are under active development and are subject to change."}),o(jn,{children:[o(On,{children:[e(ve,{id:"rest",children:"REST"}),e(ve,{id:"graphql",children:"GraphQL"})]}),e(Re,{id:"rest",children:e("iframe",{src:`${Dd}/docs`,style:_d})}),e(Re,{id:"graphql",children:e("iframe",{src:`${Dd}/graphql`,style:_d})})]})]})}const P3={password_reset:"Password has been reset."};function Ph(n){var a;return n?((a=window.Config.authErrorMessages)==null?void 0:a[n])??null:null}function I3(n){return n?P3[n]??null:null}function ri({children:n}){return o("main",{css:K`
        padding-top: 200px;
        width: 100%;
        height: 100vh;
        overflow: hidden;
        background: radial-gradient(
          90% 60% at 50% 30%,
          rgba(5, 145, 193, 0.4) 0%,
          transparent 100%
        );
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        box-sizing: border-box;
      `,children:[e(C,{borderColor:"light",borderWidth:"thin",width:"size-5000",padding:"size-400",backgroundColor:"dark",marginStart:"auto",marginEnd:"auto",borderRadius:"medium",overflow:"auto",children:n}),o("footer",{css:K`
          display: flex;
          justify-content: center;
          padding: var(--ac-global-dimension-size-400);
          gap: var(--ac-global-dimension-size-200);
          a {
            color: var(--ac-global-text-color-700);
            transition: color 0.2s ease-in-out;
            text-decoration: none;
            &:hover {
              color: var(--ac-global-text-color-900);
              text-decoration: underline;
            }
          }
        `,children:[e("a",{href:"https://arize.com/docs/phoenix",children:"Documentation"}),"|",e("a",{href:"https://arize-ai.slack.com/join/shared_invite/zt-2w57bhem8-hq24MB6u7yE_ZF_ilOYSBw#/shared-invite/email",children:"Community"}),"|",e("a",{href:"https://twitter.com/ArizePhoenix",children:"Social"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix",children:"GitHub"}),"|",e("a",{href:"https://github.com/Arize-ai/phoenix/releases",children:`arize-phoenix v${window.Config.platformVersion}`})]})]})}function x3(n){const a=Me(),{initialError:l,onSubmit:t}=n,[i,r]=f.useState(l),[s,d]=f.useState(!1),c=f.useCallback(async g=>{t==null||t(),r(null),d(!0);const p={...g,username:g.username.trim()};try{const h=await fetch(ea("/auth/ldap/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!h.ok){const k=h.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const y=Tc();a(y)},[a,t,r]),{control:u,handleSubmit:m}=sn({defaultValues:{username:"",password:""}});return o(te,{children:[i?o(C,{paddingBottom:"size-100",children:[e(Ee,{variant:"danger",children:i})," "]}):null,e(bn,{onSubmit:m(c),children:o(b,{direction:"column",gap:"size-200",children:[o(b,{direction:"column",gap:"size-100",children:[e(H,{name:"username",control:u,render:({field:{onChange:g,value:p,onBlur:y}})=>o(Fe,{name:"username",isRequired:!0,type:"text",onChange:g,onBlur:y,value:p,autoComplete:"username",onKeyDown:h=>{h.key==="Enter"&&h.preventDefault()},children:[e(J,{children:"LDAP Username"}),e(ge,{placeholder:"your LDAP username"})]})}),e(H,{name:"password",control:u,render:({field:{onChange:g,value:p}})=>o(Fe,{name:"password",type:"password",isRequired:!0,onChange:g,value:p,autoComplete:"current-password",children:[e(J,{children:"LDAP Password"}),e(ge,{placeholder:"your password"})]})})]}),e(R,{variant:"primary",type:"submit",isDisabled:s,leadingVisual:s?e(x,{svg:e(ta,{})}):void 0,children:s?"Logging In":"Log In"})]})})]})}function L3(n){const a=Me(),{initialError:l,onSubmit:t}=n,[i,r]=f.useState(l),[s,d]=f.useState(!1),c=f.useCallback(async g=>{t==null||t(),r(null),d(!0);const p={...g,email:g.email.trim().toLowerCase()};try{const h=await fetch(ea("/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!h.ok){const k=h.status===429?"Too many requests. Please try again later.":"Invalid login";r(k);return}}catch{r("Invalid login");return}finally{d(()=>!1)}const y=Tc();a(y)},[a,t,r]),{control:u,handleSubmit:m}=sn({defaultValues:{email:"",password:""}});return o(te,{children:[i?o(C,{paddingBottom:"size-100",children:[e(Ee,{variant:"danger",children:i})," "]}):null,e(bn,{onSubmit:m(c),children:o(b,{direction:"column",gap:"size-200",children:[o(b,{direction:"column",gap:"size-100",children:[e(H,{name:"email",control:u,render:({field:{onChange:g,value:p,onBlur:y}})=>o(Fe,{name:"email",isRequired:!0,type:"email",onChange:g,onBlur:y,value:p,autoComplete:"email",onKeyDown:h=>{h.key==="Enter"&&h.preventDefault()},children:[e(J,{children:"Email"}),e(ge,{placeholder:"your email address"})]})}),o("div",{css:K`
                position: relative;
                .link-container {
                  position: absolute;
                  float: right;
                  right: 0;
                  top: var(--ac-global-dimension-size-50);
                  font-size: 12px;
                }
              `,children:[e(H,{name:"password",control:u,render:({field:{onChange:g,value:p}})=>o(Fe,{name:"password",type:"password",isRequired:!0,onChange:g,value:p,autoComplete:"current-password",children:[e(J,{children:"Password"}),e(ge,{placeholder:"your password"})]})}),e(Dn,{id:"forgot-password-link",to:"/forgot-password",children:"Forgot your password?"})]})]}),e(R,{variant:"primary",type:"submit",isDisabled:s,leadingVisual:s?e(x,{svg:e(ta,{})}):void 0,children:s?"Logging In":"Log In"})]})})]})}const D3=K`
  button {
    width: 100%;
  }
  i {
    display: block;
    width: 20px;
    height: 20px;
    padding-right: var(--ac-global-dimension-size-50);
  }
  &[data-provider^="aws"],
  &[data-provider^="google"],
  &[data-provider^="arize"] {
    button {
      background-color: white;
      color: black;
      &:hover {
        background-color: #ececec !important;
      }
    }
  }
`,Ih=f.forwardRef(function({idpName:a,idpDisplayName:l,returnUrl:t},i){return e("form",{ref:i,action:ea(`/oauth2/${a}/login${t?`?returnUrl=${t}`:""}`),method:"post",css:D3,"data-provider":a,children:o(R,{variant:"default",type:"submit",leadingVisual:e(_3,{idpName:a}),children:["Login with ",l]})})});function _3({idpName:n}){return n==="github"||n==="google"||n==="microsoft_entra_id"||n==="arize"||n.startsWith("aws")?e("i",{children:e("div",{css:K`
          display: inline-block;
          width: 20px;
          height: 20px;
          position: relative;
          background-size: contain;
          background-repeat: no-repeat;
          background-position: 50%;
          &[data-provider^="github"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='20' height='20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0C4.477 0 0 4.36 0 9.74c0 4.304 2.865 7.955 6.839 9.243.5.09.682-.211.682-.47 0-.23-.008-.843-.013-1.656-2.782.588-3.369-1.306-3.369-1.306-.454-1.125-1.11-1.425-1.11-1.425-.908-.604.069-.592.069-.592 1.003.069 1.531 1.004 1.531 1.004.892 1.488 2.341 1.059 2.91.81.092-.63.35-1.06.636-1.303-2.22-.245-4.555-1.081-4.555-4.814 0-1.063.39-1.933 1.029-2.613-.103-.247-.446-1.238.098-2.578 0 0 .84-.262 2.75.998A9.818 9.818 0 0 1 10 4.71c.85.004 1.705.112 2.504.328 1.909-1.26 2.747-.998 2.747-.998.546 1.34.203 2.331.1 2.578.64.68 1.028 1.55 1.028 2.613 0 3.742-2.339 4.566-4.566 4.807.359.3.678.895.678 1.804 0 1.301-.012 2.352-.012 2.671 0 .261.18.564.688.47C17.137 17.69 20 14.042 20 9.74 20 4.36 15.522 0 10 0z' fill='%23161514' fill-rule='evenodd'/%3E%3C/svg%3E");
          }

          &[data-provider^="google"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 48 48'%3E%3Cdefs%3E%3Cpath id='a' d='M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z'/%3E%3C/defs%3E%3CclipPath id='b'%3E%3Cuse xlink:href='%23a' overflow='visible'/%3E%3C/clipPath%3E%3Cpath clip-path='url(%23b)' fill='%23FBBC05' d='M0 37V11l17 13z'/%3E%3Cpath clip-path='url(%23b)' fill='%23EA4335' d='M0 11l17 13 7-6.1L48 14V0H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%2334A853' d='M0 37l30-23 7.9 1L48 0v48H0z'/%3E%3Cpath clip-path='url(%23b)' fill='%234285F4' d='M48 48L17 24l-4-3 35-10z'/%3E%3C/svg%3E");
          }
          &[data-provider^="microsoft"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='21' height='21'%3E%3Cpath fill='%23f25022' d='M1 1h9v9H1z'/%3E%3Cpath fill='%2300a4ef' d='M1 11h9v9H1z'/%3E%3Cpath fill='%237fba00' d='M11 1h9v9h-9z'/%3E%3Cpath fill='%23ffb900' d='M11 11h9v9h-9z'/%3E%3C/svg%3E");
          }
          &[data-provider^="aws"] {
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg width='400' height='334' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M236.578 94.824c-9.683.765-20.854 1.502-32.021 3.006-17.12 2.211-34.24 5.219-48.386 11.907-27.544 11.208-46.163 35.053-46.163 70.114 0 44.018 28.298 66.354 64.026 66.354 11.93 0 21.606-1.466 30.522-3.71 14.156-4.481 26.07-12.67 40.209-27.596 8.192 11.205 10.413 16.428 24.575 28.338 3.725 1.502 7.448 1.502 10.413-.742 8.932-7.458 24.561-20.873 32.773-28.33 3.71-3.012 2.955-7.463.739-11.204-8.198-10.435-16.381-19.401-16.381-39.506V96.324c0-28.359 2.214-54.453-18.614-73.822C261.147 6.815 234.34.86 213.5.86h-8.947c-37.965 2.247-78.169 18.635-87.122 65.629-1.462 5.955 3.012 8.198 5.989 8.962l41.677 5.224c4.471-.773 6.691-4.491 7.432-8.233 3.74-16.388 17.136-24.583 32.024-26.087h2.998c8.905 0 18.586 3.743 23.813 11.168 5.932 8.965 5.21 20.904 5.21 31.339v5.961h.004v.001zm0 43.278c0 17.162.723 30.571-8.195 45.461-5.208 10.437-14.141 17.154-23.827 19.4-1.481 0-3.698.766-5.947.766-16.371 0-26.077-12.673-26.077-31.334 0-23.856 14.159-35.056 32.023-40.277 9.687-2.241 20.86-2.982 32.021-2.982v8.966h.002z'/%3E%3Cpath d='M373.71 315.303c18.201-15.398 25.89-43.349 26.29-57.939v-2.44c0-3.255-.803-5.661-1.6-6.88-3.646-4.445-30.369-8.523-53.402-1.627-6.468 2.045-12.146 4.865-17.396 8.507-4.051 2.854-3.238 6.464.802 6.08 4.447-.823 10.126-1.208 16.594-2.048 14.159-1.18 30.742-1.592 34.784 3.662 5.642 6.87-6.468 36.868-11.749 49.838-1.593 4.065 2.03 5.696 5.677 2.847z' fill='%23FE9900'/%3E%3Cpath d='M2.008 257.364c52.17 47.404 120.925 75.775 197.791 75.775 47.725 0 102.727-13.381 145.199-38.899 5.676-3.27 11.316-6.912 16.565-10.952 7.286-5.25.817-13.38-6.463-10.147-3.229 1.215-6.873 2.857-10.103 4.066-46.539 18.248-95.441 26.76-140.762 26.76-72.008 0-141.56-19.87-197.786-52.684-5.259-2.822-8.907 2.428-4.441 6.081z' fill='%23FE9900'/%3E%3C/svg%3E");
          }
          &[data-provider^="arize"] {
            background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20d%3D%22M11.9884%2017.7389C11.5829%2017.7414%2011.1872%2017.8689%2010.8513%2018.1051C10.5155%2018.3414%2010.2547%2018.6758%2010.1018%2019.0661C9.94885%2019.4564%209.91077%2019.8851%209.99233%2020.2979C10.0739%2020.7107%2010.2714%2021.0891%2010.56%2021.3853C10.8485%2021.6814%2011.2151%2021.882%2011.6133%2021.9616C12.0115%2022.0413%2012.4236%2021.9964%2012.7973%2021.8327C13.171%2021.669%2013.4896%2021.3938%2013.7127%2021.0419C13.9359%2020.6901%2014.0537%2020.2773%2014.0511%2019.8559C14.0502%2019.576%2013.9961%2019.2989%2013.8918%2019.0408C13.7875%2018.7826%2013.6351%2018.5484%2013.4434%2018.3517C13.2517%2018.155%2013.0245%2017.9995%2012.7748%2017.8944C12.5251%2017.7892%2012.2578%2017.7363%2011.9884%2017.7389V17.7389Z%22%20fill%3D%22%23CA2A76%22%2F%3E%3Cpath%20d%3D%22M21.6973%2014.9994L13.3945%202.7484C13.1657%202.4149%2012.8317%202.17533%2012.4505%202.07142L12.3272%202.0401C12.2202%202.01604%2012.1112%202.00269%2012.0018%202.00024C11.891%201.99795%2011.7805%202.01209%2011.6736%202.04224V2.04224L11.5476%202.07142C11.1668%202.1746%2010.8328%202.41312%2010.6036%202.74555L2.30008%2014.9994C2.17431%2015.1869%202.08541%2015.3983%202.03848%2015.6215C1.99155%2015.8448%201.9875%2016.0755%202.02659%2016.3004C2.06567%2016.5252%202.1471%2016.7399%202.26622%2016.932C2.38533%2017.1241%202.53978%2017.2898%202.7207%2017.4197C3.09016%2017.6822%203.54364%2017.7844%203.98456%2017.7047C4.42549%2017.6249%204.81903%2017.3694%205.08138%2016.9926L11.055%208.17558C11.1493%207.99991%2011.287%207.85358%2011.4539%207.75172C11.6209%207.64985%2011.8109%207.59615%2012.0045%207.59615C12.1981%207.59615%2012.3881%207.64985%2012.555%207.75172C12.722%207.85358%2012.8597%207.99991%2012.954%208.17558V8.17558L18.9262%2016.9926C19.1864%2017.3722%2019.5798%2017.6302%2020.0214%2017.711C20.4631%2017.7919%2020.9176%2017.689%2021.2869%2017.4247C21.6504%2017.1593%2021.8977%2016.7549%2021.9746%2016.3002C22.0516%2015.8456%2021.9518%2015.3778%2021.6973%2014.9994V14.9994Z%22%20fill%3D%22%23CA2A76%22%2F%3E%3C%2Fsvg%3E");
          }
        `,"data-provider":n})}):null}function dr(){return o("svg",{width:"253",height:"63",viewBox:"0 0 682 169",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o("g",{clipPath:"url(#clip0_290_1904)",children:[e("path",{d:"M147.458 105.593C147.022 103.63 146.028 101.824 144.492 100.222C143.901 99.6064 143.244 99.0233 142.529 98.4978C142.184 98.2432 141.815 98.005 141.437 97.7669C140.969 97.4712 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3897 133.699 92.9299 133.157 92.4535C131.851 91.312 130.972 90.3348 130.315 89.3C130.102 88.9715 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8957C129.173 87.7233 128.869 87.6494 128.565 87.6986C128.097 87.789 127.736 88.1667 127.678 88.6431C127.637 89.0126 127.637 89.4068 127.687 89.8092C127.719 90.0474 127.588 90.2773 127.366 90.3758C127.317 90.4005 127.259 90.4087 127.21 90.4169C126.898 90.4498 126.619 90.6222 126.438 90.885C126.257 91.1478 126.208 91.4681 126.282 91.7719C126.348 92.0347 126.438 92.2236 126.512 92.3714L126.578 92.5028C126.627 92.5931 126.676 92.6917 126.726 92.782C126.873 93.0612 127.021 93.3405 127.202 93.6033C127.547 94.1042 127.933 94.6052 128.393 95.1389C128.541 95.3114 128.565 95.5578 128.459 95.7549C128.352 95.952 128.13 96.0669 127.908 96.0341C125.321 95.681 122.996 95.0979 120.836 94.3013C120.59 94.211 120.335 94.1206 120.097 94.0221C118.158 93.2009 121.658 89.7189 123.259 87.247C130.282 76.4479 131.736 64.0802 131.794 51.5647C131.851 39.4681 130.545 27.5357 128.138 15.7593V15.7429C126.569 5.87173 125.239 2.168 124.401 0.796558C124.22 0.435219 124.023 0.205276 123.818 0.0985162C123.588 -0.0575166 123.465 0.0163937 123.465 0.0163937C123.013 0.0328182 122.495 0.435219 121.871 1.08399C119.251 3.83509 119.399 7.11178 120.122 10.5363C123.432 26.0903 125.921 41.7346 124.787 57.7157C124.007 68.7365 121.953 79.3468 114.248 87.9779C113.789 88.4952 113.287 88.9798 112.786 89.4725C112.211 90.0391 111.316 91.1396 110.651 90.6797C109.764 90.0638 110.552 88.7991 110.831 88.1421C115.341 77.5729 116.639 66.5275 115.949 55.1453C115.932 54.8825 115.908 54.6197 115.891 54.3569V54.3405C115.883 54.1269 115.858 53.9298 115.842 53.7245C115.727 52.2217 115.587 50.7189 115.398 49.2242C113.46 31.1655 111.127 29.9911 111.127 29.9911C110.971 29.8515 110.782 29.7448 110.528 29.6955C109.304 29.4409 108.638 30.5167 108.096 31.3297C105.648 34.9924 106.733 38.8932 107.521 42.753C110.289 56.2703 110.33 69.6645 105.583 82.8124C105.147 84.0113 104.63 85.1775 104.08 86.3272C103.496 87.5508 103.119 89.0783 101.131 88.4213C99.2662 87.8054 99.7918 86.3929 100.03 85.1036C100.654 81.8269 101.155 78.542 101.467 75.2489V75.2653C101.509 74.9368 101.525 74.6247 101.55 74.3127C101.599 73.746 101.632 73.1712 101.665 72.6045C101.689 72.1282 101.714 71.6601 101.739 71.2002C101.747 70.9621 101.763 70.7321 101.763 70.494C102.141 60.0562 100.383 55.3095 99.7179 53.9052C99.644 53.7328 99.5619 53.5767 99.4715 53.4371C98.7815 52.4024 97.6398 52.5256 96.6541 53.5028C94.8388 55.2931 93.8367 57.4118 94.2967 60.0808C95.6438 67.8496 94.8552 75.5445 93.4096 83.1983C93.2124 84.2249 92.7524 86.0973 90.5593 85.6127C89.0644 85.2842 88.7194 84.6437 88.6372 83.3461C88.6537 82.3689 88.6372 81.3916 88.6044 80.4144C88.6044 80.3897 88.6044 80.3651 88.6044 80.3405C88.6044 80.2009 88.588 80.0612 88.588 79.9299C88.588 79.8559 88.5797 79.7902 88.5715 79.7245C88.5058 78.3942 88.399 77.0556 88.2347 75.717C88.2183 75.5856 88.1937 75.4624 88.1773 75.331C87.3394 67.7921 86.247 67.0612 86.247 67.0612C85.5488 66.1497 84.4563 66.3057 83.5117 67.2419C81.6964 69.0322 80.7764 71.1427 81.1543 73.8199C81.4336 75.7745 81.3596 75.175 81.5568 76.8831C81.7128 77.7618 81.8771 79.3632 81.8935 79.8724C81.8525 80.324 81.7375 80.7182 81.4582 81.0139C80.53 82.0076 79.0351 80.9892 77.9015 80.5211C55.9209 71.4302 37.1108 58.6683 20.691 42.523C14.2513 35.945 3.25273 22.6329 3.25273 22.6329C2.84203 22.1566 2.33276 21.8856 1.55243 22.2223C0.114982 22.8383 0.156052 24.6778 0.0246278 26.2217C-0.23822 29.3177 1.42101 31.5597 3.21987 33.662C28.0179 62.5856 58.2783 83.3708 94.8059 93.7675L101.377 95.5085C101.451 95.5249 101.533 95.5496 101.607 95.566C101.624 95.566 101.632 95.566 101.64 95.5742L107.299 97.077L107.456 97.1181C107.267 97.1756 107.061 97.2167 106.839 97.2577C100.613 98.4895 88.2923 96.223 78.3944 93.9153C73.4988 92.8888 68.6854 91.6405 63.9788 90.1541C63.7653 90.0884 63.642 90.0556 63.642 90.0556C45.3577 84.2331 28.6093 74.7972 13.9556 60.4093C12.5674 59.0461 11.286 57.5761 10.0211 56.0897C8.86289 54.71 6.47262 51.8275 5.643 50.8338C5.55265 50.7024 5.45408 50.5875 5.35551 50.4807C5.10909 50.2261 4.80517 50.0619 4.36983 50.1604C3.3513 50.3986 3.05559 51.4498 2.86667 52.3367C2.1192 55.9008 3.25273 58.8983 5.65122 61.5755C20.6582 78.3942 39.4929 89.1358 60.6439 96.1819C72.6528 100.181 85.0067 102.612 97.6069 104.164C90.0911 106.595 82.3617 107.334 74.5667 107.137C59.4775 106.759 45.3248 103.138 32.0264 96.6746C27.1226 94.1535 22.5556 91.3449 21.3564 90.5894C20.6664 90.1213 19.9518 89.8338 19.2454 90.3758C17.9229 91.4024 18.8347 93.2009 19.2618 94.6051C20.075 97.307 21.956 99.1712 24.3956 100.46C46.0641 111.917 68.9401 116.499 93.2946 112.434C95.7588 112.023 98.0998 111.572 100.679 110.701C96.6048 114.224 91.89 116.524 86.9369 118.339C71.6835 123.915 56.5287 123.693 41.4314 119.915C36.5851 118.618 30.9668 116.507 30.9668 116.507C30.1536 116.154 29.3486 116.031 28.7243 116.926C27.6237 118.503 28.5847 120.145 29.5375 121.632C31.7882 125.138 36.1416 125.483 39.5832 126.674C40.7578 127.052 37.5544 129.187 36.5276 129.975C31.5335 133.794 26.6462 137.284 21.6767 140.98L18.424 143.378C17.8654 143.764 17.3726 144.199 17.6272 145.004C17.9229 145.915 18.8675 146.08 19.7875 146.268C23.3442 147.008 26.3833 145.825 29.1925 143.723C35.2134 139.214 41.3493 134.837 47.2387 130.156C49.4811 128.374 51.5182 128.522 54.582 129.31C46.9183 135.083 39.7475 140.495 32.5685 145.899C25.2827 151.376 17.9969 156.854 10.711 162.323L5.89764 165.888C5.82371 165.937 5.758 165.986 5.69229 166.044L5.61836 166.093C5.20766 166.421 4.90374 166.791 4.9941 167.267C5.19123 168.351 6.4644 168.622 7.50758 168.803C11.8117 169.542 14.4813 167.924 17.4219 165.715C32.1496 154.661 46.9266 143.682 61.5721 132.521C64.8577 130.016 68.2337 128.604 72.9731 129.138C68.9401 132.152 65.0631 135.051 61.2436 137.908L50.8611 145.587C50.7871 145.636 50.7132 145.694 50.6475 145.751C50.0972 146.186 49.7111 146.695 49.9247 147.451C50.3189 148.822 51.97 148.987 53.3745 149.2C55.9537 149.586 58.1387 148.675 60.1675 147.164C61.3339 146.293 62.5085 145.439 63.6831 144.593L79.5361 132.004C79.5361 132.004 83.2817 129.327 87.6187 126.871C88.0048 126.633 88.3908 126.387 88.7851 126.148C88.9494 126.075 89.3601 125.886 89.9843 125.59C90.4525 125.352 90.9207 125.114 91.3807 124.892C92.0625 124.547 92.851 124.128 93.7381 123.644C96.2927 122.584 103.611 119.168 109.657 112.73C112.532 110.512 116.581 107.613 119.735 106.217H119.752C119.99 106.111 120.228 106.012 120.458 105.93C120.458 105.93 120.475 105.93 120.483 105.922C120.639 105.864 120.787 105.815 120.935 105.766L121.337 105.61C122.479 105.289 124.335 105.166 124.582 107.679C124.623 108.295 124.615 108.927 124.541 109.593C124.491 110.093 124.393 110.627 124.319 111.054C124.245 111.465 124.417 111.876 124.746 112.122C124.795 112.163 124.853 112.196 124.91 112.22C125.346 112.434 125.871 112.335 126.2 111.974C126.323 111.834 126.446 111.703 126.569 111.572C128.122 109.937 129.699 108.804 131.375 108.114C133.822 107.104 136.303 107.096 138.94 108.106C140.197 108.582 141.379 109.239 142.554 110.102C143.055 110.471 143.556 110.882 144.057 111.334C144.353 111.605 144.648 111.9 144.911 112.163L144.952 112.204L145.166 112.418C145.166 112.418 145.248 112.491 145.289 112.524C145.536 112.705 145.856 112.779 146.168 112.713C146.529 112.631 146.825 112.376 146.957 112.032C146.981 111.966 147.006 111.9 147.031 111.834C147.778 109.617 147.934 107.581 147.499 105.593H147.458Z",fill:"url(#paint0_linear_290_1904)"}),e("path",{d:"M120.113 94.0303C120.195 94.0632 120.269 94.096 120.351 94.1207C120.269 94.0878 120.187 94.0632 120.113 94.0303Z",fill:"#FEDBB5"}),e("path",{d:"M111.283 87.1238C111.283 87.1238 111.267 87.1567 111.267 87.1731C111.267 87.1567 111.283 87.1402 111.283 87.1238Z",fill:"#FEDBB5"}),e("path",{d:"M123.383 87.1074C123.383 87.1074 123.358 87.1487 123.341 87.1652C123.358 87.1487 123.366 87.1239 123.383 87.1074Z",fill:"#FEDBB5"}),e("path",{d:"M104.104 86.3354C103.965 86.6229 103.841 86.9267 103.71 87.2142C103.85 86.9267 103.973 86.6229 104.104 86.3354Z",fill:"#FEDBB5"}),e("path",{d:"M89.0233 84.7422C89.0233 84.7422 89.0233 84.7505 89.0316 84.7588C89.0316 84.7588 89.0316 84.7505 89.0233 84.7422Z",fill:"#FEDBB5"}),e("path",{d:"M89.0644 84.7998C89.1876 84.964 89.3437 85.1118 89.5408 85.235C89.3437 85.1118 89.1876 84.9722 89.0644 84.7998ZM89.0644 84.7833C89.0644 84.7833 89.0644 84.7833 89.0644 84.7915C89.0644 84.7915 89.0644 84.7915 89.0644 84.7833ZM89.0562 84.7751C89.0562 84.7751 89.0562 84.7751 89.0562 84.7833C89.0562 84.7833 89.0562 84.7833 89.0562 84.7751ZM88.6947 83.3626C88.6947 83.3626 88.6947 83.3708 88.6947 83.379C88.6947 83.379 88.6947 83.3708 88.6947 83.3626ZM79.1665 81.0878C79.1665 81.0878 79.1829 81.0878 79.1829 81.096C79.6429 81.2931 80.1029 81.4492 80.53 81.4492C80.7107 81.4492 80.8832 81.4245 81.0393 81.3588C80.875 81.4245 80.7025 81.4492 80.53 81.4492C80.0947 81.4492 79.6265 81.2849 79.1665 81.0878ZM88.629 79.6507C88.629 79.6507 88.629 79.6507 88.629 79.6589C88.629 79.6589 88.629 79.6589 88.629 79.6507Z",fill:"#E5B4A6"}),e("path",{d:"M120.36 94.1206C120.36 94.1206 120.434 94.1535 120.475 94.1617C120.475 94.1617 120.401 94.1289 120.36 94.1206ZM110.273 89.8749C110.273 90.187 110.38 90.4662 110.684 90.6797C110.79 90.7536 110.905 90.7865 111.029 90.7865C111.209 90.7865 111.398 90.7126 111.595 90.5894C111.406 90.7126 111.218 90.7865 111.029 90.7865C110.905 90.7865 110.79 90.7536 110.684 90.6797C110.38 90.4744 110.273 90.187 110.273 89.8749ZM110.914 88.0189C110.914 88.0189 110.881 88.1011 110.864 88.1421C110.881 88.1011 110.897 88.06 110.914 88.0189ZM111.226 87.2798C111.127 87.5262 111.02 87.7726 110.914 88.0189C111.02 87.7726 111.119 87.5262 111.226 87.2798ZM111.267 87.1731C111.267 87.1731 111.234 87.2388 111.226 87.2798C111.242 87.247 111.259 87.2141 111.267 87.1731ZM123.341 87.1731C123.341 87.1731 123.341 87.1813 123.333 87.1895C123.333 87.1895 123.333 87.1813 123.341 87.1731ZM123.391 87.0992C123.391 87.0992 123.391 87.1074 123.382 87.1156C123.382 87.1156 123.382 87.1074 123.391 87.0992ZM111.308 87.0992C111.308 87.0992 111.3 87.132 111.291 87.1402C111.291 87.1238 111.3 87.1074 111.308 87.0992ZM99.8001 86.7707C99.8001 87.4769 100.079 88.0928 101.155 88.446C101.484 88.5527 101.771 88.602 102.026 88.602C102.93 88.602 103.365 87.9615 103.71 87.2306C103.357 87.9697 102.921 88.602 102.026 88.602C101.78 88.602 101.492 88.5527 101.155 88.446C100.088 88.0928 99.8001 87.4769 99.8001 86.7707ZM92.7689 84.9886C92.4486 85.4074 91.9722 85.7195 91.2575 85.7195C91.1836 85.7195 91.1097 85.7195 91.0358 85.7113C91.1097 85.7113 91.1836 85.7195 91.2575 85.7195C91.9722 85.7195 92.4486 85.4157 92.7689 84.9886ZM106.651 79.7081C106.651 79.7081 106.651 79.7081 106.642 79.7081C106.322 80.7511 105.985 81.8023 105.616 82.8452C105.993 81.8023 106.338 80.7593 106.659 79.7081M94.1571 79.1251C93.9846 80.2748 93.7875 81.4163 93.5739 82.566C93.7875 81.4245 93.9846 80.2748 94.1571 79.1251ZM122.191 73.6311C120.623 78.7884 118.175 83.65 114.29 88.0025C113.83 88.5199 113.329 89.0044 112.828 89.4972C113.329 89.0126 113.821 88.5199 114.29 88.0025C118.175 83.65 120.623 78.7884 122.2 73.6311",fill:"#E5B4A6"}),e("path",{opacity:"0.4",d:"M2.20136 22.0745C2.00423 22.0745 1.79066 22.1238 1.55246 22.2223C0.53392 22.6658 0.254644 23.7252 0.139648 24.8503C5.61017 32.0196 27.213 58.4548 61.1943 76.5875C61.1943 76.5875 94.4692 94.1453 127.933 96.0423C125.346 95.6892 123.021 95.1061 120.861 94.3095C120.729 94.2602 120.606 94.2192 120.475 94.1699C108.318 91.542 97.9519 88.2571 90.6168 85.6292C90.7565 85.662 90.8961 85.6784 91.0193 85.6949C90.8879 85.6867 90.7401 85.662 90.5922 85.6292C90.1486 85.5306 89.8037 85.4074 89.5408 85.2432C83.7417 83.1244 80.0454 81.4984 79.1583 81.096C78.7312 80.9153 78.3123 80.6936 77.9344 80.5376C55.9538 71.4466 37.1437 58.6848 20.7239 42.5395C14.2513 35.945 3.25275 22.633 3.25275 22.633C2.97348 22.3045 2.6367 22.0745 2.20136 22.0745Z",fill:"url(#paint1_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M4.62448 50.1358C4.55056 50.1358 4.46842 50.144 4.37806 50.1687C3.35953 50.4068 3.06382 51.458 2.8749 52.3449C2.84204 52.5009 2.80919 52.6652 2.78455 52.8212C19.7711 75.832 42.5732 85.235 42.5732 85.235C65.3341 95.952 84.0128 98.12 95.3892 98.12C100.096 98.12 103.554 97.7505 105.533 97.463C104.63 97.5616 103.636 97.6109 102.568 97.6109C95.8984 97.6109 86.362 95.7795 78.4026 93.9235C73.5071 92.897 68.6937 91.6488 63.987 90.1623C63.7735 90.0966 63.6503 90.0638 63.6503 90.0638C45.3659 84.2413 28.6176 74.8054 13.9638 60.4175C12.5756 59.0543 11.2942 57.5843 10.0293 56.0979C8.87112 54.7182 6.48084 51.8357 5.65123 50.8421C5.56088 50.7107 5.46231 50.5957 5.36374 50.4889C5.16661 50.2836 4.9284 50.1358 4.62448 50.1358Z",fill:"url(#paint2_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M20.0669 90.1049C19.7958 90.1049 19.5247 90.187 19.2537 90.4005C18.1037 91.2874 18.6458 92.7738 19.0812 94.0632C27.5991 99.2287 47.132 109.289 70.2626 109.289C79.0023 109.289 88.243 107.86 97.607 104.189C90.8469 106.382 83.9061 107.195 76.9077 107.195C76.1274 107.195 75.3471 107.186 74.5667 107.162C59.4776 106.784 45.3249 103.162 32.0264 96.6993C27.1227 94.1781 22.5557 91.3695 21.3565 90.614C20.9293 90.3266 20.5022 90.1049 20.0669 90.1049Z",fill:"url(#paint3_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M99.1759 111.949C95.4632 114.791 91.2987 116.762 86.937 118.355C78.7559 121.344 70.5994 122.666 62.4675 122.666C55.4363 122.666 48.4298 121.681 41.4315 119.932C36.5852 118.634 30.9668 116.524 30.9668 116.524C30.6136 116.368 30.2604 116.261 29.9237 116.261C29.4883 116.261 29.0776 116.442 28.7326 116.951C28.2234 117.682 28.1577 118.429 28.3219 119.168C33.6939 121.665 45.2181 126.099 59.2723 126.099C71.4536 126.099 85.5406 122.765 99.1759 111.949Z",fill:"url(#paint4_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M62.9356 129.368C49.7358 129.368 39.7557 126.699 38.4908 126.346C38.8604 126.452 39.2218 126.567 39.5833 126.69C40.7579 127.068 37.5544 129.203 36.5276 129.992C32.8396 132.817 29.2008 135.461 25.5537 138.138H36.7576C40.2897 135.527 43.8052 132.907 47.2387 130.172C48.5119 129.154 49.7275 128.768 51.0993 128.768C52.1342 128.768 53.2678 128.99 54.582 129.335C46.9184 135.108 39.7475 140.52 32.5685 145.924C28.3711 149.077 24.1738 152.231 19.9764 155.384H31.246C41.3821 147.804 51.51 140.216 61.5721 132.546C63.8967 130.78 66.2623 129.557 69.1208 129.179C67.0016 129.318 64.9316 129.376 62.9439 129.376L62.9356 129.368Z",fill:"url(#paint5_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M60.5782 138.409H71.47L79.5115 132.02C79.5115 132.02 83.2571 129.343 87.5941 126.888C87.9801 126.649 88.3662 126.403 88.7605 126.165C88.9248 126.091 89.3354 125.902 89.9597 125.606C90.4279 125.368 90.8961 125.13 91.3561 124.908C92.0625 124.547 92.8921 124.112 93.8121 123.603C86.0499 126.855 78.0987 128.44 70.739 129.056C70.8375 129.056 70.9443 129.056 71.0429 129.056C71.6589 129.056 72.2996 129.088 72.965 129.162C68.9319 132.176 65.0549 135.075 61.2354 137.933L60.5782 138.418V138.409Z",fill:"url(#paint6_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M88.6701 83.3544C88.6865 82.3771 88.6701 81.3999 88.6373 80.4226V80.3487C88.6373 80.2091 88.6208 80.0695 88.6208 79.9381L88.6044 79.7328C88.5633 78.9115 88.4976 78.0903 88.4237 77.2609C85.8281 76.1687 83.3803 74.7726 81.1215 73.1301C81.1379 73.3601 81.1461 73.59 81.179 73.8364C81.4582 75.7909 81.3843 75.1914 81.5814 76.8995C81.7375 77.7783 81.9018 79.3797 81.9182 79.8888C81.8771 80.3405 81.7621 80.7347 81.4829 81.0303C81.1954 81.3342 80.8586 81.4491 80.4972 81.4491C80.0619 81.4491 79.5937 81.2849 79.1337 81.0878C79.9961 81.4738 83.7007 83.108 89.5408 85.2432C88.9165 84.8572 88.7194 84.2742 88.6619 83.3626L88.6701 83.3544Z",fill:"url(#paint7_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M131.022 64.885C128.59 68.2685 125.6 71.2331 122.175 73.6146C120.606 78.7719 118.158 83.6336 114.273 87.9861C113.813 88.5035 113.312 88.988 112.811 89.4807C112.326 89.9488 111.628 90.8029 111.02 90.8029C110.897 90.8029 110.782 90.77 110.675 90.6961C109.788 90.0802 110.577 88.8155 110.856 88.1585C112.31 84.7505 113.427 81.2931 114.257 77.7865C111.825 78.698 109.271 79.3386 106.634 79.6999C106.314 80.7429 105.977 81.794 105.607 82.837C105.172 84.036 104.655 85.2021 104.104 86.3518C103.62 87.3702 103.275 88.602 102.018 88.602C101.771 88.602 101.484 88.5527 101.147 88.446C99.2827 87.83 99.8084 86.4175 100.047 85.1282C100.367 83.4201 100.663 81.7119 100.909 79.9956C98.5927 79.9217 96.3256 79.626 94.1325 79.1168C93.9271 80.4883 93.6889 81.8515 93.4261 83.2148C93.2536 84.1263 92.8675 85.7113 91.2412 85.7113C91.044 85.7113 90.8305 85.6867 90.6005 85.6374C97.9356 88.2735 108.293 91.5584 120.458 94.1863C120.335 94.1371 120.22 94.096 120.105 94.0467C118.167 93.2255 121.666 89.7435 123.268 87.2716C127.777 80.3323 129.987 72.7523 131.005 64.8932L131.022 64.885Z",fill:"url(#paint8_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M129.206 102.497C127.687 102.497 126.151 102.645 124.647 102.916C124.36 102.965 124.081 102.99 123.818 102.99C123.391 102.99 122.988 102.924 122.61 102.809C122.668 102.883 122.734 102.957 122.791 103.039C123.448 103.959 123.793 104.961 123.925 106.004C124.089 106.184 124.229 106.406 124.344 106.694C124.344 106.694 124.344 106.694 124.344 106.71C124.344 106.71 124.344 106.71 124.344 106.718C124.344 106.718 124.344 106.718 124.344 106.726C124.344 106.726 124.344 106.726 124.344 106.735C124.344 106.735 124.344 106.735 124.344 106.743C124.344 106.743 124.344 106.743 124.344 106.751C124.344 106.751 124.344 106.751 124.344 106.759C124.344 106.759 124.344 106.759 124.344 106.768V106.784C124.344 106.784 124.344 106.784 124.344 106.792C124.344 106.792 124.344 106.792 124.344 106.8C124.344 106.8 124.344 106.8 124.344 106.809C124.344 106.809 124.344 106.809 124.344 106.817C124.344 106.817 124.344 106.817 124.344 106.825C124.344 106.825 124.344 106.833 124.344 106.841C124.344 106.841 124.344 106.841 124.344 106.858C124.344 106.858 124.344 106.858 124.344 106.866C124.344 106.866 124.344 106.866 124.344 106.874C124.344 106.874 124.344 106.874 124.344 106.882C124.344 106.882 124.344 106.883 124.344 106.891C124.344 106.891 124.344 106.891 124.344 106.899C124.344 106.899 124.344 106.899 124.344 106.907C124.344 106.907 124.344 106.907 124.344 106.915C124.344 106.915 124.344 106.915 124.344 106.924C124.344 106.924 124.344 106.924 124.344 106.932C124.344 106.932 124.344 106.932 124.344 106.94C124.344 106.94 124.344 106.94 124.344 106.948C124.344 106.948 124.344 106.948 124.344 106.965C124.344 106.965 124.344 106.973 124.344 106.981C124.344 106.981 124.344 106.989 124.344 106.997V107.014C124.344 107.014 124.344 107.022 124.344 107.03C124.344 107.03 124.344 107.039 124.344 107.047C124.344 107.047 124.344 107.055 124.344 107.063C124.344 107.063 124.344 107.071 124.344 107.08C124.344 107.08 124.344 107.088 124.344 107.096C124.344 107.096 124.344 107.104 124.344 107.112C124.344 107.112 124.344 107.121 124.344 107.129C124.344 107.145 124.344 107.162 124.344 107.178C124.344 107.178 124.344 107.186 124.344 107.195C124.344 107.195 124.344 107.227 124.344 107.244C124.344 107.244 124.344 107.252 124.344 107.26V107.277C124.344 107.277 124.344 107.301 124.344 107.31C124.344 107.31 124.344 107.318 124.344 107.326V107.342V107.359C124.36 107.597 124.368 107.843 124.368 108.09C124.368 108.476 124.344 108.87 124.302 109.272C124.253 109.773 124.155 110.307 124.081 110.734C124.072 110.8 124.064 110.865 124.064 110.923C124.064 111.268 124.229 111.588 124.508 111.793L124.672 111.892C124.828 111.966 124.992 112.007 125.157 112.007C125.461 112.007 125.748 111.884 125.962 111.654C126.085 111.514 126.208 111.383 126.331 111.251C127.884 109.617 129.461 108.484 131.136 107.794C132.369 107.285 133.601 107.03 134.857 107.03C136.114 107.03 137.387 107.285 138.702 107.786C139.958 108.262 141.141 108.919 142.316 109.781C142.817 110.151 143.318 110.562 143.819 111.013C144.115 111.284 144.41 111.58 144.673 111.843L144.714 111.884L144.928 112.097L145.051 112.204C145.232 112.335 145.453 112.409 145.675 112.418C144.632 110.192 143.318 108.123 141.461 106.513C137.946 103.466 133.51 102.177 129.001 102.177",fill:"url(#paint9_linear_290_1904)"}),e("path",{opacity:"0.4",d:"M128.779 87.6905L128.582 87.7069C128.114 87.7972 127.752 88.175 127.695 88.6513C127.654 89.0208 127.654 89.415 127.703 89.8174C127.72 89.9488 127.687 90.072 127.629 90.1706C129.51 92.9627 133.584 97.9065 139.769 99.7789C139.769 99.7789 149.331 104.78 146.916 112.032L146.99 111.834C147.737 109.617 147.893 107.581 147.458 105.593C147.022 103.63 146.029 101.824 144.492 100.222C143.901 99.6064 143.244 99.0234 142.529 98.4978C142.184 98.2432 141.815 98.0051 141.437 97.7669C140.969 97.4713 140.484 97.192 139.95 96.921C137.995 95.9191 136.328 94.909 134.866 93.825C134.274 93.3898 133.699 92.9299 133.157 92.4536C131.851 91.3121 130.972 90.3348 130.315 89.3001C130.102 88.9716 129.913 88.6102 129.732 88.2653C129.658 88.1175 129.543 87.9943 129.412 87.8958C129.231 87.7562 129.001 87.6823 128.763 87.6823",fill:"url(#paint10_linear_290_1904)"}),e("path",{opacity:"0.5",d:"M116.647 107.893L118.586 106.768L126.734 95.8535C126.734 95.8535 122.274 95.0076 120.122 94.0303C120.122 94.0303 117.887 104.222 109.632 112.738L112.672 110.488C113.887 109.634 114.988 108.903 116.647 107.893Z",fill:"url(#paint11_linear_290_1904)"}),e("path",{d:"M209.416 49.9962H230.197C245.221 49.9962 252.104 57.7157 252.104 73.5818V81.4409C252.104 97.307 245.221 105.027 230.197 105.027H218.123V148.264H209.416V49.9962ZM230.197 97.0196C239.323 97.0196 243.397 92.9463 243.397 81.8598V73.0152C243.397 62.0682 239.323 57.8553 230.197 57.8553H218.123V97.0196H230.197Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M284.114 49.9962H292.821V93.0941H319.64V49.9962H328.346V148.256H319.64V100.953H292.821V148.256H284.114V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M362.451 125.656V72.5963C362.451 57.0177 370.312 48.5919 384.497 48.5919C398.683 48.5919 406.544 57.0177 406.544 72.5963V125.656C406.544 141.234 398.683 149.66 384.497 149.66C370.312 149.66 362.451 141.234 362.451 125.656ZM397.829 126.214V72.0297C397.829 61.5016 393.056 56.451 384.489 56.451C375.922 56.451 371.15 61.5016 371.15 72.0297V126.214C371.15 136.742 375.922 141.653 384.489 141.653C393.056 141.653 397.829 136.742 397.829 126.214Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M440.796 49.9962H480.108V57.8553H449.503V93.0859H474.638V100.945H449.503V140.249H480.108V148.248H440.796V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M511.56 49.9962H523.076L548.629 125.935V49.9962H556.769V148.256H547.504L519.56 64.458V148.256H511.56V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M592.007 49.9962H600.714V148.256H592.007V49.9962Z",fill:"var(--ac-global-text-color-900)"}),e("path",{d:"M651.674 98.1447L632.437 49.9962H641.702L657.144 89.0209L672.726 49.9962H681.154L661.917 98.1447L681.992 148.256H672.726L656.438 106.989L640.01 148.256H631.591L651.666 98.1447H651.674Z",fill:"var(--ac-global-text-color-900)"})]}),o("defs",{children:[o("linearGradient",{id:"paint0_linear_290_1904",x1:"22.0956",y1:"10.3474",x2:"97.4433",y2:"140.879",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#14BAB6"}),e("stop",{offset:"0.5",stopColor:"#00ADEE"}),e("stop",{offset:"1",stopColor:"#0095C4"})]}),o("linearGradient",{id:"paint1_linear_290_1904",x1:"95.422",y1:"114.807",x2:"31.8741",y2:"4.70214",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint2_linear_290_1904",x1:"76.6695",y1:"114.126",x2:"30.8746",y2:"34.7951",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint3_linear_290_1904",x1:"70.3612",y1:"119.915",x2:"44.7991",y2:"75.6384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint4_linear_290_1904",x1:"71.4208",y1:"128.85",x2:"55.5071",y2:"101.279",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint5_linear_290_1904",x1:"44.5363",y1:"126.346",x2:"44.5363",y2:"155.384",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.9"}),e("stop",{offset:"0.22",stopColor:"#231F20",stopOpacity:"0.4"}),e("stop",{offset:"0.42",stopColor:"#231F20",stopOpacity:"0.1"}),e("stop",{offset:"0.65",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint6_linear_290_1904",x1:"77.1952",y1:"123.603",x2:"77.1952",y2:"138.409",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint7_linear_290_1904",x1:"84.3413",y1:"85.235",x2:"84.3413",y2:"73.1301",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.03",stopColor:"#231F20",stopOpacity:"0.95"}),e("stop",{offset:"0.51",stopColor:"#231F20",stopOpacity:"0.26"}),e("stop",{offset:"0.81",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint8_linear_290_1904",x1:"110.815",y1:"94.1699",x2:"110.815",y2:"64.885",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.18",stopColor:"#231F20",stopOpacity:"0.48"}),e("stop",{offset:"0.38",stopColor:"#231F20",stopOpacity:"0.12"}),e("stop",{offset:"0.58",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint9_linear_290_1904",x1:"138.077",y1:"117.246",x2:"127.969",y2:"99.7278",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),o("linearGradient",{id:"paint10_linear_290_1904",x1:"146.226",y1:"112.434",x2:"131.084",y2:"86.1931",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#FDFDFE",stopOpacity:"0"}),e("stop",{offset:"0.11",stopColor:"#FDFDFE",stopOpacity:"0.17"}),e("stop",{offset:"0.3",stopColor:"#FDFDFE",stopOpacity:"0.42"}),e("stop",{offset:"0.47",stopColor:"#FDFDFE",stopOpacity:"0.63"}),e("stop",{offset:"0.64",stopColor:"#FDFDFE",stopOpacity:"0.79"}),e("stop",{offset:"0.78",stopColor:"#FDFDFE",stopOpacity:"0.9"}),e("stop",{offset:"0.91",stopColor:"#FDFDFE",stopOpacity:"0.97"}),e("stop",{offset:"1",stopColor:"#FDFDFE"})]}),o("linearGradient",{id:"paint11_linear_290_1904",x1:"106.889",y1:"107.999",x2:"128.941",y2:"95.2581",gradientUnits:"userSpaceOnUse",children:[e("stop",{stopColor:"#231F20"}),e("stop",{offset:"0.31",stopColor:"#231F20",stopOpacity:"0.5"}),e("stop",{offset:"0.67",stopColor:"#231F20",stopOpacity:"0.13"}),e("stop",{offset:"1",stopColor:"#231F20",stopOpacity:"0"})]}),e("clipPath",{id:"clip0_290_1904",children:e("rect",{width:"682",height:"169",fill:"white"})})]})]})}const Ad=K`
  text-align: center;
  margin-top: var(--ac-global-dimension-size-200);
  margin-bottom: var(--ac-global-dimension-size-200);
  color: var(--ac-global-text-color-700);
`,A3=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function O5(){const n=!window.Config.basicAuthDisabled,a=window.Config.ldapEnabled,l=window.Config.oAuth2Idps,t=l.length>0,[i,r]=_n(),s=i.get("returnUrl"),d=i.get("message"),c=i.get("error"),u=I3(d),m=Ph(c),g=i.get("trigger"),p=f.useRef({});return f.useEffect(()=>{var y;if(g&&t){const h=l.find(k=>k.name.toLowerCase()===g.toLowerCase());h&&p.current[h.name]&&((y=p.current[h.name])==null||y.submit())}},[g,t,l]),o(ri,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(dr,{})})}),u&&e(C,{paddingBottom:"size-100",children:e(Ee,{variant:"success",children:u})}),m&&e(C,{paddingBottom:"size-100",children:e(Ee,{variant:"danger",children:m})}),n&&e(L3,{initialError:null,onSubmit:()=>{r(y=>{const h=new URLSearchParams(y);return h.delete("message"),h.delete("error"),h})}}),a&&o(te,{children:[n?e("div",{css:Ad,children:"or"}):null,e(x3,{initialError:null,onSubmit:()=>{r(y=>{const h=new URLSearchParams(y);return h.delete("message"),h.delete("error"),h})}})]}),(n||a)&&t?e("div",{css:Ad,children:"or"}):null,t&&e(te,{children:e("ul",{css:A3,children:l.map(y=>e("li",{children:e(Ih,{idpName:y.name,idpDisplayName:y.displayName,returnUrl:s,ref:h=>{p.current[y.name]=h}},y.name)},y.name))})})]})}const xh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ResetPasswordFormMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ResetPasswordFormMutation",selections:a},params:{cacheID:"d09af5e3a2a3d10f117373e25bef11e6",id:null,metadata:{},name:"ResetPasswordFormMutation",operationKind:"mutation",text:`mutation ResetPasswordFormMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}})();xh.hash="f8f5c30b0e00c17cdda7557c73c3c2d3";const Lh={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ResetPasswordFormQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null}],type:"Query",abstractKey:null};Lh.hash="1161643b76edb6ef437d8f136038cf21";const At=4;function E3(n){var u;const a=Me(),l=Ve(),t=T.useFragment(Lh,n.query),[i,r]=T.useMutation(xh),{control:s,handleSubmit:d}=sn({defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}}),c=f.useCallback(m=>{i({variables:{input:{currentPassword:m.currentPassword,newPassword:m.newPassword}},onCompleted:()=>{const g=Pc({path:"/login",searchParams:{message:"password_reset"}});a(g)},onError:g=>{l({title:"Failed to reset password",message:g.message})}})},[i,a,l]);return o(bn,{onSubmit:d(c),children:[((u=t.viewer)==null?void 0:u.email)&&e(Nr,{children:o(Fe,{name:"email",type:"email",autoComplete:"email",isRequired:!0,isReadOnly:!0,value:t.viewer.email,children:[e(J,{children:"Email"}),e(ge,{})]})}),e(H,{name:"currentPassword",control:s,rules:{required:"the current is required"},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{type:"password",name:m,isRequired:!0,isInvalid:h,onChange:g,onBlur:p,value:y,id:"current-password",autoComplete:"current-password",children:[e(J,{children:"Old Password"}),e(ge,{}),k?e(Ae,{children:k==null?void 0:k.message}):e(v,{slot:"description",children:"The current password"})]})}),e(H,{name:"newPassword",control:s,rules:{required:"Password is required",minLength:{value:At,message:`Password must be at least ${At} characters`},validate:(m,g)=>m!==g.currentPassword||"New password must be different"},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{type:"password",isRequired:!0,name:m,isInvalid:h,onChange:g,onBlur:p,defaultValue:y,id:"new-password",autoComplete:"new-password",children:[e(J,{children:"New Password"}),e(ge,{}),k?e(Ae,{children:k==null?void 0:k.message}):o(v,{slot:"description",children:["Password must be at least ",At," characters"]})]})}),e(H,{name:"confirmPassword",control:s,rules:{required:"Password is required",minLength:{value:At,message:`Password must be at least ${At} characters`},validate:(m,g)=>m===g.newPassword||"Passwords do not match"},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{isRequired:!0,type:"password",name:m,isInvalid:h,onChange:g,onBlur:p,defaultValue:y,autoComplete:"new-password",children:[e(J,{children:"Confirm Password"}),e(ge,{}),k?e(Ae,{children:k==null?void 0:k.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),o("div",{css:K`
          display: flex;
          flex-direction: row;
          gap: var(--ac-global-dimension-size-200);
          padding-top: var(--ac-global-dimension-size-100);
          overflow: hidden;
          & > * {
            width: 50%;
            flex: 1 1 auto;
          }
        `,children:[e(R,{onPress:()=>{a(-1)},children:"Cancel"}),e(R,{variant:"primary",type:"submit",isDisabled:r,children:r?"Resetting...":"Reset Password"})]})]})}function j5(){const n=wn();return o(ri,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(dr,{})})}),e(E3,{query:n})]})}const Et=4,w3="An error occurred. Please try resetting again.";function M3({resetToken:n}){const a=Me(),[l,t]=f.useState(null),[i,r]=f.useState(!1),s=f.useCallback(async({resetToken:m,newPassword:g})=>{t(null),r(!0);try{const p=await fetch(ea("/auth/password-reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:m,password:g})});if(!p.ok){const y=await p.text();t(y);return}}catch{t(w3);return}finally{r(()=>!1)}a("/login?message=password_reset")},[t,a]),{control:d,handleSubmit:c,formState:{isDirty:u}}=sn({defaultValues:{resetToken:n,newPassword:"",confirmPassword:""}});return o(te,{children:[l?e(C,{paddingBottom:"size-100",children:e(Ee,{variant:"danger",children:l})}):null,o(bn,{onSubmit:c(s),children:[e(H,{name:"newPassword",control:d,rules:{required:"Password is required",minLength:{value:Et,message:`Password must be at least ${Et} characters`}},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{type:"password",isRequired:!0,name:m,isInvalid:h,id:"new-password",autoComplete:"new-password",onChange:g,onBlur:p,defaultValue:y,children:[e(J,{children:"New Password"}),e(ge,{}),k?e(Ae,{children:k==null?void 0:k.message}):o(v,{slot:"description",children:["Password must be at least ",Et," characters"]})]})}),e(H,{name:"confirmPassword",control:d,rules:{required:"Password is required",minLength:{value:Et,message:`Password must be at least ${Et} characters`},validate:(m,g)=>m===g.newPassword||"Passwords do not match"},render:({field:{name:m,onChange:g,onBlur:p,value:y},fieldState:{invalid:h,error:k}})=>o(Fe,{type:"password",isRequired:!0,name:m,isInvalid:h,onChange:g,onBlur:p,defaultValue:y,children:[e(J,{children:"Confirm Password"}),e(ge,{}),k?e(Ae,{children:k==null?void 0:k.message}):e(v,{slot:"description",children:"Confirm the new password"})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(R,{variant:u?"primary":"default",type:"submit",isDisabled:i,children:i?"Resetting...":"Reset Password"})})]})]})}function Q5(){const n=Me(),[a]=_n(),l=a.get("token");return l?o(ri,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(dr,{})})}),e(M3,{resetToken:l}),e(C,{paddingTop:"size-200",children:e(b,{direction:"column",alignItems:"center",justifyContent:"center",children:e(Dn,{to:"/login",children:"Back to Login"})})})]}):(n("/login"),null)}const Dh=(function(){var n={alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"resetPasswordLoaderQuery",selections:[n,{args:null,kind:"FragmentSpread",name:"ResetPasswordFormQuery"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"resetPasswordLoaderQuery",selections:[n]},params:{cacheID:"3f2aa2ea2629970ac6ca3c4fa86f1f7b",id:null,metadata:{},name:"resetPasswordLoaderQuery",operationKind:"query",text:`query resetPasswordLoaderQuery {
  viewer {
    id
    email
  }
  ...ResetPasswordFormQuery
}

fragment ResetPasswordFormQuery on Query {
  viewer {
    email
    id
  }
}
`}}})();Dh.hash="17bb397eaa3a44dd33996854e538f2ef";async function B5(){const n=await T.fetchQuery(ze,Dh,{}).toPromise();return n!=null&&n.viewer?n:Pl("/login")}function R3({onResetSent:n}){const[a,l]=f.useState(null),[t,i]=f.useState(!1),r=f.useCallback(async c=>{l(null),i(!0);const u={...c,email:c.email.trim().toLowerCase()};try{const m=await fetch(ea("/auth/password-reset-email"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!m.ok){const g=await m.text();l(g);return}n()}finally{i(()=>!1)}},[n,l]),{control:s,handleSubmit:d}=sn({defaultValues:{email:""}});return o(te,{children:[a?e(C,{paddingBottom:"size-100",children:e(Ee,{variant:"danger",children:a})}):null,o(bn,{onSubmit:d(r),children:[e(H,{name:"email",control:s,render:({field:{onChange:c,value:u,onBlur:m}})=>o(Fe,{name:"email",isRequired:!0,type:"email",onChange:c,onBlur:m,value:u,children:[e(J,{children:"Email"}),e(ge,{placeholder:"your email address"}),e(v,{slot:"description",children:"Enter the email address associated with your account."})]})}),e("div",{css:K`
            margin-top: var(--ac-global-dimension-size-200);
            margin-bottom: var(--ac-global-dimension-size-50);
            button {
              width: 100%;
            }
          `,children:e(R,{variant:"primary",type:"submit",isDisabled:t,children:t?"Sending...":"Send"})})]})]})}function q5(){const[n,a]=f.useState(!1),l=n?o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(Te,{level:1,children:"Check your email"}),e("p",{children:"Thanks! If an account with that email address exists, we sent you a link to reset your password."})]}):o(te,{children:[o(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-100",children:[e(Te,{level:1,children:"Forgot Password"}),e("p",{children:`Enter the email address associated with your account and we'll send you
        a link to reset your password.`})]}),e(R3,{onResetSent:()=>a(!0)})]});return e(ri,{children:o("div",{css:K`
          & a {
            text-align: center;
            width: 100%;
            display: block;
            text-align: center;
            padding-top: var(--ac-global-dimension-size-200);
          }
        `,children:[l,e(b,{direction:"column",alignItems:"center",justifyContent:"center",gap:"size-200",children:e(Dn,{to:"/login",children:"Back to Login"})})]})})}const V3=K`
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-100);
  flex-wrap: wrap;
  justify-content: center;
`;function U5(){const n=window.Config.oAuth2Idps,a=n.length>0,[l]=_n(),t=l.get("returnUrl"),i=!window.Config.basicAuthDisabled,r=l.get("error"),s=Ph(r);return o(ri,{children:[e(b,{direction:"column",gap:"size-200",alignItems:"center",children:e(C,{paddingBottom:"size-200",children:e(dr,{})})}),e(C,{paddingBottom:"size-100",children:e(Ee,{variant:s?"danger":"success",children:s||"You have been logged out"})}),i&&e(C,{paddingY:"size-100",children:e(qn,{to:"/login",children:"Back to login"})}),a&&e("ul",{css:V3,children:n.slice(0,1).map(d=>e("li",{children:e(Ih,{idpName:d.name,idpDisplayName:d.displayName,returnUrl:t},d.name)},d.name))})]})}const _h=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"jwt",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerAPIKeysCreateUserAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"CreateUserApiKeyMutationPayload",kind:"LinkedField",name:"createUserApiKey",plural:!1,selections:[l,{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKey",plural:!1,selections:[t,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"user",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},t],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"500fa7541c393ca91d6fa184c5626b44",id:null,metadata:{},name:"ViewerAPIKeysCreateUserAPIKeyMutation",operationKind:"mutation",text:`mutation ViewerAPIKeysCreateUserAPIKeyMutation(
  $input: CreateUserApiKeyInput!
) {
  createUserApiKey(input: $input) {
    jwt
    apiKey {
      id
      user {
        ...APIKeysTableFragment
        id
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}})();_h.hash="28061ae008e197468be6fd5f2775ccb0";const Ah=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableDeleteAPIKeyMutation",selections:[{alias:null,args:a,concreteType:"DeleteApiKeyMutationPayload",kind:"LinkedField",name:"deleteUserApiKey",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},l],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"4bdd87573f4445b94a5d22dca4c9da3b",id:null,metadata:{},name:"APIKeysTableDeleteAPIKeyMutation",operationKind:"mutation",text:`mutation APIKeysTableDeleteAPIKeyMutation(
  $input: DeleteApiKeyInput!
) {
  deleteUserApiKey(input: $input) {
    query {
      viewer {
        ...APIKeysTableFragment
        id
      }
    }
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}})();Ah.hash="8d26517ce1b7bca6482fbd3dcdd320e3";const Eh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"APIKeysTableFragment"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"APIKeysTableQuery",selections:[{alias:null,args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[l,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],storageKey:null}]},params:{cacheID:"cdfdedf08fd777fb83fabe0bce5ab3db",id:null,metadata:{},name:"APIKeysTableQuery",operationKind:"query",text:`query APIKeysTableQuery(
  $id: ID!
) {
  node(id: $id) {
    __typename
    ...APIKeysTableFragment
    id
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}
`}}})();Eh.hash="6c32098d55e4cba859dcec73f3ccd28c";const wh=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:{refetch:{connection:null,fragmentPathInResult:["node"],operation:Eh,identifierInfo:{identifierField:"id",identifierQueryVariableName:"id"}}},name:"APIKeysTableFragment",selections:[{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},n],type:"User",abstractKey:null}})();wh.hash="6c32098d55e4cba859dcec73f3ccd28c";const Ed=70;function N3({query:n}){"use no memo";const[a,l]=T.useRefetchableFragment(wh,n),t=Le(),[i]=T.useMutation(Ah),r=f.useCallback(g=>{i({variables:{input:{id:g}},onCompleted:()=>{t({title:"API key deleted",message:"The key has been deleted and is no longer active."}),f.startTransition(()=>{l({},{fetchPolicy:"store-and-network"})})}})},[i,t,l]),s=f.useMemo(()=>a.apiKeys.filter(Boolean),[a]),d=f.useMemo(()=>[{header:"Name",accessorKey:"name",size:100,cell:In},{header:"Description",accessorKey:"description",cell:In},{header:"Created At",accessorKey:"createdAt",size:Ed,cell:tn},{header:"Expires At",accessorKey:"expiresAt",size:Ed,cell:tn},{header:"",accessorKey:"id",size:10,cell:({row:p})=>e(b,{direction:"row",justifyContent:"end",width:"100%",children:e(ns,{handleDelete:()=>{r(p.original.id)}})}),meta:{textAlign:"right"}}],[r]),c=Qe({columns:d,data:s,getCoreRowModel:Be()}),u=c.getRowModel().rows,m=c.getRowModel().rows.length===0;return o("table",{css:Kn,children:[e("thead",{children:c.getHeaderGroups().map(g=>e("tr",{children:g.headers.map(p=>e("th",{colSpan:p.colSpan,children:p.isPlaceholder?null:o("div",{className:p.column.getCanSort()?"sort":"",onClick:p.column.getToggleSortingHandler(),style:{left:p.getStart(),width:p.getSize()},children:[de(p.column.columnDef.header,p.getContext()),p.column.getIsSorted()?e(x,{className:"sort-icon",svg:p.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},p.id))},g.id))}),m?e(Xn,{message:"No Keys"}):e("tbody",{children:u.map(g=>e("tr",{children:g.getVisibleCells().map(p=>e("td",{children:de(p.column.columnDef.cell,p.getContext())},p.id))},g.id))})]})}function z3({viewer:n}){var d;const[a,l]=f.useState(null),t=Ve(),[i,r]=T.useMutation(_h),s=f.useCallback((c,u)=>{var m;i({variables:{input:{...c,expiresAt:((m=c.expiresAt)==null?void 0:m.toDate(nt()).toISOString())||null}},onCompleted:g=>{u(),l(g)},onError:g=>{t({title:"Error creating API key",message:g.message})}})},[i,t]);return o(te,{children:[e(ee,{title:"API Keys",extra:o(se,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(xl,{})}),children:"New Key"}),e(oe,{children:e(ae,{size:"M",children:e(Od,{onSubmit:s,isCommitting:r})})})]}),children:e(N3,{query:n})}),e(se,{isOpen:!!a,onOpenChange:()=>l(null),children:e(oe,{children:e(ae,{size:"L",children:e(jd,{jwt:((d=a==null?void 0:a.createUserApiKey)==null?void 0:d.jwt)??""})})})})]})}function $3(){const{systemTheme:n,themeMode:a,setThemeMode:l}=ia(),{displayTimezone:t,setDisplayTimezone:i,programmingLanguage:r,setProgrammingLanguage:s}=Cn(m=>({displayTimezone:m.displayTimezone,setDisplayTimezone:m.setDisplayTimezone,programmingLanguage:m.programmingLanguage,setProgrammingLanguage:m.setProgrammingLanguage})),d=f.useMemo(()=>[{id:"system",label:`Auto (${n})`,icon:e(Nb,{})},{id:"dark",label:"Dark",icon:e(zb,{})},{id:"light",label:"Light",icon:e($b,{})}],[n]),c=f.useMemo(()=>{const m=[...Ob()],g=jb();return m.sort((p,y)=>p==="UTC"?-1:y==="UTC"?1:0),[{value:"local",label:`Local (${nt()})`},...m.map(p=>({value:p,label:`${p} (${Qb({locale:g,timeZone:p})})`}))]},[]),u=t??"local";return e(ee,{title:"Preferences",children:e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-200",children:[e(Ma,{"aria-label":"Theme",label:"Theme",description:"Choose the color theme for the application",selectedKey:a,onSelectionChange:m=>{m&&Bb(m)&&l(m)},children:d.map(m=>e(qe,{id:m.id,textValue:m.label,children:o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(x,{svg:m.icon}),e(v,{weight:"heavy",children:m.label})]})},m.id))}),e(Ma,{"aria-label":"Display Time Zone",label:"Timezone",description:"Choose how timestamps are displayed throughout the application",placeholder:"Search timezones...",selectedKey:u,onSelectionChange:m=>{i(m==="local"?void 0:m)},children:c.map(m=>e(qe,{id:m.value,textValue:m.label,children:e(b,{direction:"column",gap:"size-50",children:e(v,{weight:"heavy",children:m.label})})},m.value))}),e(Ma,{"aria-label":"Programming Language",label:"Programming Language",description:"Choose the default language for code snippets",selectedKey:r,onSelectionChange:m=>{m&&Ub(m)&&s(m)},children:qb.map(m=>e(qe,{id:m,textValue:m,children:e(v,{weight:"heavy",children:m})},m))})]})})})}const Mh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"}],a=[{alias:null,args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"UserMutationPayload",kind:"LinkedField",name:"patchViewer",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ViewerProfileCardMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ViewerProfileCardMutation",selections:a},params:{cacheID:"03f161df42c71b5924a8ee665e01cdce",id:null,metadata:{},name:"ViewerProfileCardMutation",operationKind:"mutation",text:`mutation ViewerProfileCardMutation(
  $input: PatchViewerInput!
) {
  patchViewer(input: $input) {
    __typename
  }
}
`}}})();Mh.hash="4a11ca65151d84fe95f636763c91dc68";function O3(){const{viewer:n,refetchViewer:a}=as(),l=Ve(),t=Le(),[i,r]=T.useMutation(Mh),{control:s,handleSubmit:d,formState:{isDirty:c},reset:u}=sn({defaultValues:{username:(n==null?void 0:n.username)||""}}),m=f.useCallback(g=>{i({variables:{input:{newUsername:g.username}},onCompleted:()=>{t({title:"Profile updated",message:"Your profile has been updated"}),u({username:g.username}),a()},onError:p=>{l({title:"Failed update profile",message:p.message})}})},[i,t,u,a,l]);return n?o(ee,{title:"Profile",extra:n.authMethod==="LOCAL"&&e(qn,{size:"S",to:"/reset-password",children:"Reset Password"}),children:[e(C,{paddingTop:"size-200",paddingStart:"size-200",paddingEnd:"size-200",children:o(b,{direction:"row",gap:"size-200",alignItems:"center",children:[e(wi,{name:n.username,profilePictureUrl:n.profilePictureUrl}),o(b,{direction:"column",gap:"size-50",children:[e(Te,{level:2,weight:"heavy",children:n.username}),e(v,{children:n.role.name.toLocaleLowerCase()})]})]})}),e(C,{children:o(bn,{onSubmit:d(m),children:[e(C,{padding:"size-200",children:o(b,{direction:"column",gap:"size-100",children:[n.email&&o(Fe,{value:n.email,isReadOnly:!0,size:"S",children:[e(J,{children:"Email"}),e(ge,{})]}),e(H,{name:"username",control:s,rules:{required:"A username is required as it needs to be unique"},render:({field:{name:g,onChange:p,onBlur:y,value:h},fieldState:{invalid:k,error:S}})=>o(Fe,{isRequired:!0,name:g,isInvalid:k,onChange:p,onBlur:y,defaultValue:h,size:"S",children:[e(J,{children:"Username"}),e(ge,{}),S?e(Ae,{children:S.message}):e(v,{slot:"description",children:"A unique username"})]})})]})}),e(C,{paddingTop:"size-100",paddingBottom:"size-100",paddingStart:"size-200",paddingEnd:"size-200",borderTopColor:"dark",borderTopWidth:"thin",children:e(b,{direction:"row",gap:"size-100",justifyContent:"end",children:e(R,{variant:c?"primary":"default",size:"S",isDisabled:!c,onPress:()=>{d(m)()},children:r?"Saving...":"Save"})})})]})})]}):null}const j3=K`
  overflow-y: auto;
  height: 100%;
`,Q3=K`
  padding: var(--ac-global-dimension-size-400);
  max-width: 800px;
  min-width: 500px;
  box-sizing: border-box;
  width: 100%;
  margin-left: auto;
  margin-right: auto;
`;function H5(){const{viewer:n,refetchViewer:a}=as();return f.useEffect(()=>{a()},[a]),e("main",{css:j3,children:e("div",{css:Q3,children:o(b,{direction:"column",gap:"size-200",children:[n&&e(O3,{}),e($3,{}),n&&e(z3,{viewer:n})]})})})}function G5(){return e(yo,{})}function W5(){const n=wn();Xe(n);const a=f.useMemo(()=>n.span.__typename==="Span"?n.span:null,[n.span]);if(!a)throw new Error("Span not found");const{playgroundInstance:l,parsingErrors:t,playgroundInput:i}=f.useMemo(()=>hv(a),[a]),r=i!=null?{input:i}:{};return o(b,{direction:"column",height:"100%",children:[e(B3,{span:a,parsingErrors:t}),e(yo,{instances:[l],...r},a.id)]})}function B3({span:n,parsingErrors:a}){const l=Me(),t=a&&a.length>0,[i,r]=f.useState(!0),[s,d]=f.useState(t);return o(b,{direction:"column",children:[i&&e(Ee,{variant:"info",title:"LLM Span Replay",banner:!0,dismissable:!0,onDismissClick:()=>{r(!1)},extra:e(R,{leadingVisual:e(x,{svg:e(Hb,{})}),onPress:()=>{l(`/projects/${n.project.id}/traces/${n.trace.traceId}?${aa}=${n.id}`)},children:"Back to Trace"}),children:`Replay and iterate on your LLM call from your ${n.project.name} project`}),s&&t&&e(Ee,{variant:"warning",banner:!0,dismissable:!0,onDismissClick:()=>{d(!1)},title:"The following errors occurred when parsing span attributes:",children:e("ul",{children:a.map(c=>e("li",{children:c},c))})})]})}const Rh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"spanId"}],a=[{kind:"Variable",name:"id",variableName:"spanId"}],l={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,concreteType:"Project",kind:"LinkedField",name:"project",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"spanId",storageKey:null},s={alias:null,args:null,concreteType:"Trace",kind:"LinkedField",name:"trace",plural:!1,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"traceId",storageKey:null}],storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"attributes",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"invocationInputField",storageKey:null}],u={alias:null,args:null,concreteType:null,kind:"LinkedField",name:"invocationParameters",plural:!0,selections:[l,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"invocationName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"canonicalName",storageKey:null}],type:"InvocationParameterBase",abstractKey:"__isInvocationParameterBase"},{kind:"InlineFragment",selections:c,type:"BooleanInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"BoundedFloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"FloatInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"IntInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"JSONInvocationParameter",abstractKey:null},{kind:"InlineFragment",selections:c,type:"StringListInvocationParameter",abstractKey:null}],storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[t,i,r,s,d,u],type:"Span",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"spanPlaygroundPageLoaderQuery",selections:[{alias:"span",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{kind:"InlineFragment",selections:[i,r,s,d,u],type:"Span",abstractKey:null}],storageKey:null}]},params:{cacheID:"15db907b4e1020d0625053f7530561ad",id:null,metadata:{},name:"spanPlaygroundPageLoaderQuery",operationKind:"query",text:`query spanPlaygroundPageLoaderQuery(
  $spanId: ID!
) {
  span: node(id: $spanId) {
    __typename
    ... on Span {
      id
      project {
        id
        name
      }
      spanId
      trace {
        id
        traceId
      }
      attributes
      invocationParameters {
        __typename
        ... on InvocationParameterBase {
          __isInvocationParameterBase: __typename
          invocationName
          canonicalName
        }
        ... on BooleanInvocationParameter {
          invocationInputField
        }
        ... on StringInvocationParameter {
          invocationInputField
        }
        ... on BoundedFloatInvocationParameter {
          invocationInputField
        }
        ... on FloatInvocationParameter {
          invocationInputField
        }
        ... on IntInvocationParameter {
          invocationInputField
        }
        ... on JSONInvocationParameter {
          invocationInputField
        }
        ... on StringListInvocationParameter {
          invocationInputField
        }
      }
    }
    id
  }
}
`}}})();Rh.hash="ab0e72402c34ac0eaf7cf39a14427121";async function J5(n){const{spanId:a}=n.params;if(!a||typeof a!="string")throw new Error("Invalid spanId");return await T.fetchQuery(ze,Rh,{spanId:a}).toPromise()}const Vh=f.createContext(null),q3=({children:n})=>{const[a,l]=f.useState(""),[t,i]=f.useState([]);return e(Vh.Provider,{value:{selectedPromptLabelIds:t,setSelectedPromptLabelIds:i,filter:a,setFilter:l},children:n})},Nh=()=>{const n=f.useContext(Vh);if(n===null)throw new Error("usePromptsFilterContext must be used within PromptsFilterProvider");return n},zh=(function(){var n=[{alias:null,args:[{kind:"Literal",name:"first",value:100}],concreteType:"PromptLabelConnection",kind:"LinkedField",name:"promptLabels",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptLabelEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"label",args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:"promptLabels(first:100)"}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptsLabelMenuQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"PromptsLabelMenuQuery",selections:n},params:{cacheID:"b1eec4579aec591910252fa2619f47f4",id:null,metadata:{},name:"PromptsLabelMenuQuery",operationKind:"query",text:`query PromptsLabelMenuQuery {
  promptLabels(first: 100) {
    edges {
      label: node {
        id
        name
        color
      }
    }
  }
}
`}}})();zh.hash="8874d1dc96531174072149aea94605a1";const U3=({onSelectionChange:n,selectedLabelIds:a})=>o(la,{children:[o(R,{leadingVisual:e(x,{svg:e(Ql,{})}),children:["Labels",a.length>0?` (${a.length})`:""]}),e(we,{children:e(f.Suspense,{fallback:e(me,{css:K`
                min-width: 300px;
                min-height: 200px;
              `}),children:e(H3,{selectedLabelIds:a,onSelectionChange:n})})})]}),H3=({selectedLabelIds:n,onSelectionChange:a})=>{const{contains:l}=Zt({sensitivity:"base"}),t=T.useLazyLoadQuery(zh,{},{fetchPolicy:"store-and-network"}),i=f.useMemo(()=>t.promptLabels.edges.map(r=>r.label),[t]);return o(Fl,{filter:l,children:[e(C,{padding:"size-200",paddingTop:"size-100",borderBottomWidth:"thin",borderColor:"dark",minWidth:300,children:o(b,{direction:"column",gap:"size-100",children:[e(Te,{level:4,weight:"heavy",children:"Filter prompts by labels"}),e(st,{"aria-label":"Search",autoFocus:!0,children:e(ge,{placeholder:"Search labels"})})]})}),e($n,{items:i,selectionMode:"multiple",renderEmptyState:()=>"No labels found",selectedKeys:n,onSelectionChange:r=>{a(r==="all"?i.map(s=>s.id):Array.from(r))},children:({id:r,name:s,color:d})=>e(Oe,{id:r,textValue:s,children:e(nn,{color:d,children:s})})})]})},G3=()=>{const{setFilter:n,filter:a,selectedPromptLabelIds:l,setSelectedPromptLabelIds:t}=Nh();return e(C,{padding:"size-200",borderBottomWidth:"thin",borderBottomColor:"grey-200",flex:"none",children:o(b,{direction:"row",justifyContent:"space-between",alignItems:"center",gap:"size-100",children:[e(Ll,{"aria-label":"Search prompts by name",onChange:n,defaultValue:a,placeholder:"Search prompts by name"}),o(b,{direction:"row",alignItems:"center",gap:"size-100",flex:"none",children:[e(U3,{selectedLabelIds:l,onSelectionChange:t}),e(qi,{children:e(qn,{size:"M",leadingVisual:e(x,{svg:e(ts,{})}),variant:"primary",to:"/playground",children:"New Prompt"})})]})]})})},$h=(function(){var n=[{kind:"Literal",name:"first",value:100}],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"promptsLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"promptsLoaderQuery",selections:[{alias:null,args:n,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},a],storageKey:null},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:n,filters:["filter","labelIds"],handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"3bf444cc04be064fc037755409e3288d",id:null,metadata:{},name:"promptsLoaderQuery",operationKind:"query",text:`query promptsLoaderQuery {
  ...PromptsTable_prompts
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        version {
          createdAt
          id
        }
        labels {
          id
          name
          color
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();$h.hash="ed4295f193bd2a6d2402a82966d45a7f";const Oh=$h;function Z5(){return T.loadQuery(ze,Oh,{})}const jh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"labelIds"}],a=[{kind:"Variable",name:"after",variableName:"after"},{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"first",variableName:"first"},{kind:"Variable",name:"labelIds",variableName:"labelIds"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"PromptsTablePromptsQuery",selections:[{args:a,kind:"FragmentSpread",name:"PromptsTable_prompts"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"PromptsTablePromptsQuery",selections:[{alias:null,args:a,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},l],storageKey:null},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[l,t,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:a,filters:["filter","labelIds"],handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}]},params:{cacheID:"c742220ba8617113856418d1b6fb0c13",id:null,metadata:{},name:"PromptsTablePromptsQuery",operationKind:"query",text:`query PromptsTablePromptsQuery(
  $after: String = null
  $filter: PromptFilter = null
  $first: Int = 100
  $labelIds: [ID!] = null
) {
  ...PromptsTable_prompts_2FeKoo
}

fragment PromptsTable_prompts_2FeKoo on Query {
  prompts(first: $first, after: $after, filter: $filter, labelIds: $labelIds) {
    edges {
      prompt: node {
        id
        name
        description
        version {
          createdAt
          id
        }
        labels {
          id
          name
          color
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();jh.hash="33daede08f0acc18f45f19692993314f";const Qh=(function(){var n=["prompts"],a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"after"},{defaultValue:null,kind:"LocalArgument",name:"filter"},{defaultValue:100,kind:"LocalArgument",name:"first"},{defaultValue:null,kind:"LocalArgument",name:"labelIds"}],kind:"Fragment",metadata:{connection:[{count:"first",cursor:"after",direction:"forward",path:n}],refetch:{connection:{forward:{count:"first",cursor:"after"},backward:null,path:n},fragmentPathInResult:[],operation:jh}},name:"PromptsTable_prompts",selections:[{alias:"prompts",args:[{kind:"Variable",name:"filter",variableName:"filter"},{kind:"Variable",name:"labelIds",variableName:"labelIds"}],concreteType:"PromptConnection",kind:"LinkedField",name:"__PromptsTable_prompts_connection",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[a,l,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null}})();Qh.hash="33daede08f0acc18f45f19692993314f";const Bh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{fields:[{kind:"Variable",name:"promptId",variableName:"promptId"}],kind:"ObjectValue",name:"input"}],l=[{kind:"Literal",name:"first",value:100}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptsTable_prompts"}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptDialogMutation",selections:[{alias:null,args:a,concreteType:"DeletePromptMutationPayload",kind:"LinkedField",name:"deletePrompt",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:"PromptConnection",kind:"LinkedField",name:"prompts",plural:!1,selections:[{alias:null,args:null,concreteType:"PromptEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"prompt",args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"PromptVersion",kind:"LinkedField",name:"version",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},t],storageKey:null},{alias:null,args:null,concreteType:"PromptLabel",kind:"LinkedField",name:"labels",plural:!0,selections:[t,i,{alias:null,args:null,kind:"ScalarField",name:"color",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},{alias:null,args:null,concreteType:"Prompt",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null}],storageKey:"prompts(first:100)"},{alias:null,args:l,filters:["filter","labelIds"],handle:"connection",key:"PromptsTable_prompts",kind:"LinkedHandle",name:"prompts"}],storageKey:null}],storageKey:null}]},params:{cacheID:"f37f369f2b729a5193d63006fe1ac7e2",id:null,metadata:{},name:"DeletePromptDialogMutation",operationKind:"mutation",text:`mutation DeletePromptDialogMutation(
  $promptId: ID!
) {
  deletePrompt(input: {promptId: $promptId}) {
    query {
      ...PromptsTable_prompts
    }
  }
}

fragment PromptsTable_prompts on Query {
  prompts(first: 100) {
    edges {
      prompt: node {
        id
        name
        description
        version {
          createdAt
          id
        }
        labels {
          id
          name
          color
        }
      }
      cursor
      node {
        __typename
        id
      }
    }
    pageInfo {
      endCursor
      hasNextPage
    }
  }
}
`}}})();Bh.hash="af218c6f8442ad552dd44771a2d55275";function W3({promptId:n,onDeleted:a}){const[l,t]=T.useMutation(Bh),i=Le(),r=Ve(),s=f.useCallback(()=>{l({variables:{promptId:n},onCompleted:()=>{i({title:"Delete Successful",message:"Prompt has been deleted."}),a()},onError:d=>{r({title:"Failed to delete prompt",message:d.message})}})},[l,r,i,a,n]);return e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Delete Prompt"}),e(ke,{children:e(be,{slot:"close"})})]}),e(C,{padding:"size-200",children:e(v,{color:"danger",children:"Are you sure you want to delete this prompt? This action cannot be undone and all services dependent on this prompt will be affected."})}),e(C,{paddingEnd:"size-200",paddingTop:"size-100",paddingBottom:"size-100",borderTopColor:"light",borderTopWidth:"thin",children:o(b,{direction:"row",justifyContent:"end",gap:"size-100",children:[e(R,{variant:"default",slot:"close",size:"S",children:"Cancel"}),e(R,{variant:"danger",onPress:()=>{s()},size:"S",isDisabled:t,children:"Delete Prompt"})]})})]})})}function J3({onDeleted:n,promptId:a}){const[l,t]=f.useState(!1),i=f.useCallback(()=>{t(!0)},[]);return o(ja,{children:[o(la,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(ll,{})})}),e(we,{children:e($n,{"aria-label":"Prompt action menu",onAction:r=>{switch(r){case"DELETE":i();break}},children:e(Oe,{id:"DELETE",children:o(b,{direction:"row",gap:"size-75",justifyContent:"start",alignItems:"center",children:[e(x,{svg:e(Tn,{})}),e(te,{children:"Delete"})]})})})})]}),e(se,{isOpen:l,onOpenChange:t,children:e(ae,{children:e(W3,{promptId:a,onDeleted:()=>{n(),t(!1)}})})})]})}function Z3(){const n=Me();return e(C,{width:"100%",paddingY:"size-400",children:e(b,{direction:"column",width:"100%",alignItems:"center",justifyContent:"center",children:e(C,{width:"100%",maxWidth:"780px",children:o(b,{direction:"column",gap:"size-400",alignItems:"center",children:[e(v,{size:"XL",children:"Create and manage prompt templates for your AI applications."}),e(Ts,{src:"https://storage.googleapis.com/arize-phoenix-assets/assets/videos/prompts.mp4",autoPlay:!0,muted:!0,loop:!0}),o(b,{direction:"row",gap:"size-200",children:[e(gt,{href:"https://arize.com/docs/phoenix/get-started/get-started-prompt-playground",target:"_blank",leadingVisual:e(x,{svg:e(Ps,{})}),children:"Documentation"}),e(R,{variant:"primary",leadingVisual:e(x,{svg:e(Qa,{})}),onPress:()=>n("/playground"),children:"Playground"})]})]})})})})}const X3=100;function Y3(n){"use no memo";const{filter:a,selectedPromptLabelIds:l}=Nh(),t=Me(),i=f.useRef(null),r=f.useMemo(()=>({filter:a.trim()?{value:a,col:"name"}:null,labelIds:l.length>0?l:null}),[a,l]),{data:s,loadNext:d,hasNext:c,isLoadingNext:u,refetch:m}=T.usePaginationFragment(Qh,n.query);f.useEffect(()=>{f.startTransition(()=>{m(r,{fetchPolicy:"store-and-network"})})},[m,r]);const g=f.useMemo(()=>s.prompts.edges.map(I=>({lastUpdatedAt:I.prompt.version.createdAt,...I.prompt})),[s]),p=f.useCallback(I=>{if(I){const{scrollHeight:L,scrollTop:M,clientHeight:E}=I;L-M-E<300&&!u&&c&&d(X3,{UNSTABLE_extraVariables:r})}},[c,u,d,r]),y=Ks(),h=f.useMemo(()=>{const I=[{header:"name",accessorKey:"name",cell:({row:L})=>e(Dn,{to:`${L.original.id}`,children:L.original.name})},{header:"labels",accessorKey:"labels",cell:({row:L})=>e("ul",{css:K`
                display: flex;
                flex-direction: row;
                gap: var(--ac-global-dimension-size-100);
              `,children:L.original.labels.map(M=>e(nn,{color:M.color,children:M.name},M.id))})},{header:"description",accessorKey:"description",cell:In},{header:"last updated",accessorKey:"lastUpdatedAt",cell:tn}];return y&&I.push({id:"actions",header:"",size:5,accessorKey:"id",cell:({row:L})=>o(b,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:[e(ja,{children:e(qn,{leadingVisual:e(x,{svg:e(Qa,{})}),size:"S","aria-label":"Open in playground",to:`${L.original.id}/playground`,children:"Playground"})}),e(J3,{promptId:L.original.id,onDeleted:()=>{m(r,{fetchPolicy:"network-only"})}})]})}),I},[m,r,y]),k=Qe({columns:h,data:g,getCoreRowModel:Be(),getSortedRowModel:Vn()}),S=k.getRowModel().rows;return S.length===0?e(Z3,{}):e("div",{css:K`
        flex: 1 1 auto;
        overflow: auto;
      `,onScroll:I=>p(I.target),ref:i,children:o("table",{css:Al,children:[e("thead",{children:k.getHeaderGroups().map(I=>e("tr",{children:I.headers.map(L=>{var M;return e("th",{colSpan:L.colSpan,children:L.isPlaceholder?null:o("div",{className:L.column.getCanSort()?"sort":"","aria-role":L.column.getCanSort()?"button":null,onClick:L.column.getToggleSortingHandler(),style:{textAlign:(M=L.column.columnDef.meta)==null?void 0:M.textAlign},children:[de(L.column.columnDef.header,L.getContext()),L.column.getIsSorted()?e(x,{className:"sort-icon",svg:L.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},L.id)})},I.id))}),e("tbody",{children:S.map(I=>e("tr",{onClick:()=>{t(`${I.original.id}`)},children:I.getVisibleCells().map(L=>{var M;return e("td",{align:(M=L.column.columnDef.meta)==null?void 0:M.textAlign,children:de(L.column.columnDef.cell,L.getContext())},L.id)})},I.id))})]})})}function X5(){const n=wn();Xe(n);const a=T.usePreloadedQuery(Oh,n);return e(q3,{children:o(b,{direction:"column",height:"100%",children:[e(G3,{}),e(Y3,{query:a})]})})}const qh=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PromptVersionTagsConfigCard_data",selections:[n,{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}})();qh.hash="3650e60f18eb8d95b707df7bdbce99a9";const Uh=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"promptId"}],a=[{kind:"Variable",name:"input",variableName:"input"}],l=[{kind:"Variable",name:"id",variableName:"promptId"}],t={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"PromptVersionTagsConfigCard_data"}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DeletePromptVersionTagButtonMutation",selections:[{alias:null,args:a,concreteType:"PromptVersionTagMutationPayload",kind:"LinkedField",name:"deletePromptVersionTag",plural:!1,selections:[{alias:null,args:null,concreteType:"Query",kind:"LinkedField",name:"query",plural:!1,selections:[{alias:null,args:l,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},t,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"PromptVersionTag",kind:"LinkedField",name:"versionTags",plural:!0,selections:[t,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promptVersionId",storageKey:null}],storageKey:null}],type:"Prompt",abstractKey:null}],storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"387e2e286ff86ad049a2b4afbd189b22",id:null,metadata:{},name:"DeletePromptVersionTagButtonMutation",operationKind:"mutation",text:`mutation DeletePromptVersionTagButtonMutation(
  $input: DeletePromptVersionTagInput!
  $promptId: ID!
) {
  deletePromptVersionTag(input: $input) {
    query {
      node(id: $promptId) {
        __typename
        ...PromptVersionTagsConfigCard_data
        id
      }
    }
  }
}

fragment PromptVersionTagsConfigCard_data on Prompt {
  id
  versionTags {
    id
    name
    description
    promptVersionId
  }
}
`}}})();Uh.hash="58fa5b2b6e7af186229c70b90082644a";function e4({promptVersionTagId:n,promptId:a}){const[l,t]=f.useState(!1),i=Le(),[r,s]=T.useMutation(Uh);return o(se,{isOpen:l,onOpenChange:t,children:[e(R,{"aria-label":"Delete tag",size:"S",leadingVisual:e(x,{svg:e(Tn,{})})}),e(oe,{children:e(ae,{size:"S",children:o(re,{children:[o(fe,{children:[e(he,{children:"Delete Tag"}),e(ke,{children:e(be,{})})]}),e(C,{padding:"size-200",children:e(C,{paddingBottom:"size-100",children:e(v,{color:"danger",size:"XS",children:"Are you sure you want to delete this tag? This will make pulling prompts by this tag no longer possible. Make sure this tag is not used before deleting."})})}),e(C,{paddingX:"size-200",paddingY:"size-100",borderTopWidth:"thin",borderColor:"light",children:o(b,{gap:"size-100",justifyContent:"end",children:[e(R,{size:"S",onPress:()=>t(!1),children:"Cancel"}),e(R,{variant:"danger",size:"S",onPress:()=>r({variables:{input:{promptVersionTagId:n},promptId:a},onCompleted:()=>{i({title:"Tag Deleted",message:"The tag has been deleted"})}}),children:s?"Deleting...":"Delete Tag"})]})})]})})})]})}function n4({prompt:n}){"use no memo";const a=T.useFragment(qh,n),l=f.useMemo(()=>[{header:"Name",accessorKey:"name"},{header:"Description",accessorKey:"description",cell:In},{header:"Version",accessorKey:"promptVersionId",cell:({row:d})=>{const{promptId:c,promptVersionId:u}=d.original;return e(Dn,{to:`/prompts/${c}/versions/${u}`,children:d.original.promptVersionId})}},{id:"actions",header:"",size:5,accessorKey:"id",cell:({row:d})=>e(b,{direction:"row",gap:"size-100",justifyContent:"end",width:"100%",children:e(e4,{promptVersionTagId:d.original.id,promptId:d.original.promptId},d.original.id)})}],[]),t=f.useMemo(()=>a.versionTags.map(d=>({id:d.id,name:d.name,description:d.description,promptId:a.id,promptVersionId:d.promptVersionId})),[a]),i=Qe({columns:l,data:t,getCoreRowModel:Be(),getSortedRowModel:Vn()}),r=i.getRowModel().rows,s=r.length===0;return e(ee,{title:"Tags",children:o("table",{css:Kn,children:[e("thead",{children:i.getHeaderGroups().map(d=>e("tr",{children:d.headers.map(c=>e("th",{colSpan:c.colSpan,children:c.isPlaceholder?null:o("div",{className:c.column.getCanSort()?"sort":"",onClick:c.column.getToggleSortingHandler(),style:{left:c.getStart(),width:c.getSize()},children:[de(c.column.columnDef.header,c.getContext()),c.column.getIsSorted()?e(x,{className:"sort-icon",svg:c.column.getIsSorted()==="asc"?e(xn,{}):e(Ln,{})}):null]})},c.id))},d.id))}),s?e(Xn,{message:"No Tags"}):e("tbody",{children:r.map(d=>e("tr",{children:d.getVisibleCells().map(c=>e("td",{children:de(c.column.columnDef.cell,c.getContext())},c.id))},d.id))})]})})}function Y5(){const n=wn();return Xe(n),e(b,{direction:"row",height:"100%",children:e(C,{height:"100%",overflow:"auto",width:"100%","data-testid":"scroll-container",children:e(C,{padding:"size-200",children:e(b,{direction:"column",gap:"size-200",marginStart:"auto",marginEnd:"auto",maxWidth:900,children:e(n4,{prompt:n.prompt})})})})})}function Hh(){return"FS"in window}function a4(n){if(window.Config.basename){let a=window.Config.basename;return a=a.replace(/^\/+|\/+$/g,"").replace(/\//g,"-"),`${a}-${n}`}return n}function l4(n){if(Hh())try{FS("setIdentity",{uid:a4(n.uid),properties:{displayName:n.displayName,email:n.email}})}catch(a){console.error("Error setting FullStory identity",a)}}const Gh=(function(){var n=[{alias:null,args:null,concreteType:"ServerStatus",kind:"LinkedField",name:"serverStatus",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"insufficientStorage",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StorageAlertQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"StorageAlertQuery",selections:n},params:{cacheID:"f9f3d6dcbdc1417ed8012eebb951f0e2",id:null,metadata:{},name:"StorageAlertQuery",operationKind:"query",text:`query StorageAlertQuery {
  serverStatus {
    insufficientStorage
  }
}
`}}})();Gh.hash="5c04da349a0a5767c71ce3cb72ee8d17";const t4=Gh;function i4(){const n=T.useLazyLoadQuery(t4,{}),[a,l]=f.useState(!1);return!n.serverStatus.insufficientStorage||a?null:o(Ee,{variant:"danger",banner:!0,dismissable:!0,onDismissClick:()=>l(!0),children:["Due to insufficient storage, most operations are restricted.",window.Config.supportEmail&&o(te,{children:[" Contact ",e("a",{href:`mailto:${window.Config.supportEmail}`,children:window.Config.supportEmail})," for assistance."]})]})}const r4=K`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  z-index: 1000;
`;function s4(){const n=window.Config.hasDbThreshold;return e("div",{css:r4,children:e(f.Suspense,{fallback:null,children:n&&e(i4,{})})})}function eD(){const n=wn();return Xe(n),f.useEffect(()=>{Hh()&&n.viewer&&l4({uid:n.viewer.id,displayName:n.viewer.username,email:n.viewer.email})},[n]),o(Gb,{query:n,children:[e(s4,{}),e(Ue,{})]})}const Wh=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"email",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"passwordNeedsReset",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"authenticatedRootLoaderQuery",selections:[{args:null,kind:"FragmentSpread",name:"ViewerContext_viewer"},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n,a,l,t],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"authenticatedRootLoaderQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[n,a,l,{alias:null,args:null,kind:"ScalarField",name:"profilePictureUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isManagementUser",storageKey:null},{alias:null,args:null,concreteType:"UserRole",kind:"LinkedField",name:"role",plural:!1,selections:[i,n],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"authMethod",storageKey:null},{alias:null,args:null,concreteType:"UserApiKey",kind:"LinkedField",name:"apiKeys",plural:!0,selections:[n,i,{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"expiresAt",storageKey:null}],storageKey:null},t],storageKey:null}]},params:{cacheID:"909f2b392805d784bcac384c6d208692",id:null,metadata:{},name:"authenticatedRootLoaderQuery",operationKind:"query",text:`query authenticatedRootLoaderQuery {
  ...ViewerContext_viewer
  viewer {
    id
    username
    email
    passwordNeedsReset
  }
}

fragment APIKeysTableFragment on User {
  apiKeys {
    id
    name
    description
    createdAt
    expiresAt
  }
  id
}

fragment ViewerContext_viewer on Query {
  viewer {
    id
    username
    email
    profilePictureUrl
    isManagementUser
    role {
      name
      id
    }
    authMethod
    ...APIKeysTableFragment
  }
}
`}}})();Wh.hash="7df3b0168622116913f7d14b4a0a6a0a";async function nD(){var a;const n=await T.fetchQuery(ze,Wh,{}).toPromise();if((a=n==null?void 0:n.viewer)!=null&&a.passwordNeedsReset){const l=Pc({path:"/reset-password"});return Pl(l)}return n}const o4=K`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: var(--ac-global-dimension-size-200);
  padding: var(--ac-global-dimension-size-200);
`;function aD(){return e("main",{children:o(b,{direction:"column",width:"100%",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",children:e(Vi,{title:"Support",subTitle:"We are here to help. Pick a channel below to get in touch with us."})}),o("div",{css:o4,children:[e(wt,{leadingVisual:e(x,{svg:e(Wb,{})}),href:"https://arize.com/docs/phoenix",title:"Documentation",description:"Visit our documentation for tutorials and AI support."}),e(wt,{leadingVisual:e(x,{svg:e(Eo,{})}),href:"https://github.com/Arize-ai/phoenix/issues",title:"GitHub Issues",description:"Create an issue on Github to report bugs or request new features."}),e(wt,{leadingVisual:e(x,{svg:e(Eo,{})}),href:"https://github.com/Arize-ai/phoenix/discussions",title:"GitHub Discussions",description:"Create a discussion on Github to ask questions or share feedback."}),e(wt,{leadingVisual:e(x,{svg:e(wo,{})}),href:"https://arize-ai.slack.com/join/shared_invite/zt-11t1vbu4x-xkBIHmOREQnYnYDH1GDfCg?__hstc=259489365.a667dfafcfa0169c8aee4178d115dc81.1733501603539.1733501603539.1733501603539.1&__hssc=259489365.1.1733501603539&__hsfp=3822854628&submissionGuid=381a0676-8f38-437b-96f2-fc10875658df#/shared-invite/email",title:"Slack",description:"Join our Slack community to chat with other users and the team."}),e(wt,{leadingVisual:e(x,{svg:e(wo,{})}),href:"mailto:phoenix-support@arize.com?subject=Slack%20Connect%20Request",title:"Slack Connect",description:"Get a dedicated support channel for you and your team."})]})]})})}const d4=K`
  padding: var(--ac-global-dimension-size-200)
    var(--ac-global-dimension-size-200) var(--ac-global-dimension-size-200);
  border: var(--ac-global-border-size-thin) solid
    var(--ac-global-border-color-dark);
  border-radius: var(--ac-global-dimension-size-100);
  cursor: pointer;
  background-color: var(--ac-global-background-color-dark);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-size-50);
  color: var(--ac-global-color-text-700);
  transition: border-color 0.2s ease-in-out;
  text-decoration: none;
  &:hover {
    border-color: var(--ac-global-color-primary);
  }
`,wt=({leadingVisual:n,href:a,title:l,description:t})=>o("a",{css:d4,href:a,target:"_blank",rel:"noreferrer",children:[o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[n,e(Te,{level:2,children:l})]}),e(v,{color:"text-700",children:t})]}),Jh=(function(){var n=[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"startTime",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"endTime",storageKey:null}],a=[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:n,storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:n,storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ModelRootQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ModelRootQuery",selections:a},params:{cacheID:"c3baccc5527002697b40a06eef432a4d",id:null,metadata:{},name:"ModelRootQuery",operationKind:"query",text:`query ModelRootQuery {
  model {
    primaryInferences {
      name
      startTime
      endTime
    }
    referenceInferences {
      name
      startTime
      endTime
    }
    corpusInferences {
      name
      startTime
      endTime
    }
  }
}
`}}})();Jh.hash="b73d8f3f532a0c6f88863f3c6dd5734f";const c4=Jh;function u4(){const n=T.useLazyLoadQuery(c4,{}),{model:{primaryInferences:a,referenceInferences:l,corpusInferences:t}}=n;return e(Zb,{primaryInferences:a,referenceInferences:l??null,corpusInferences:t??null,children:e(Jb,{timeRangeBounds:{start:new Date(a.startTime),end:new Date(a.endTime)},children:e(Ue,{})})})}const lD=Object.freeze(Object.defineProperty({__proto__:null,ModelRoot:u4},Symbol.toStringTag,{value:"Module"})),Zh=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"endTime"},a={defaultValue:null,kind:"LocalArgument",name:"startTime"},l=[{kind:"Variable",name:"endTime",variableName:"endTime"},{kind:"Variable",name:"startTime",variableName:"startTime"}],t=[{kind:"Literal",name:"first",value:50}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={fields:[{kind:"Variable",name:"end",variableName:"endTime"},{kind:"Variable",name:"start",variableName:"startTime"}],kind:"ObjectValue",name:"timeRange"},d={alias:null,args:null,kind:"ScalarField",name:"cursor",storageKey:null},c=[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i],u={alias:null,args:null,concreteType:"PageInfo",kind:"LinkedField",name:"pageInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"endCursor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"hasNextPage",storageKey:null}],storageKey:null};return{fragment:{argumentDefinitions:[n,a],kind:"Fragment",metadata:null,name:"ModelInferencesPageQuery",selections:[{args:l,kind:"FragmentSpread",name:"ModelSchemaTable_dimensions"},{args:l,kind:"FragmentSpread",name:"ModelEmbeddingsTable_embeddingDimensions"}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,n],kind:"Operation",name:"ModelInferencesPageQuery",selections:[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:t,concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"dimension",args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},{alias:"cardinality",args:[{kind:"Literal",name:"metric",value:"cardinality"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[{kind:"Literal",name:"metric",value:"percentEmpty"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"min",args:[{kind:"Literal",name:"metric",value:"min"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"mean",args:[{kind:"Literal",name:"metric",value:"mean"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"max",args:[{kind:"Literal",name:"metric",value:"max"},s],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},u],storageKey:"dimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelSchemaTable_dimensions",kind:"LinkedHandle",name:"dimensions"},{alias:null,args:t,concreteType:"EmbeddingDimensionConnection",kind:"LinkedField",name:"embeddingDimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"EmbeddingDimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:"embedding",args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:[i,r,{alias:"euclideanDistance",args:[{kind:"Literal",name:"metric",value:"euclideanDistance"},s],kind:"ScalarField",name:"driftMetric",storageKey:null}],storageKey:null},d,{alias:null,args:null,concreteType:"EmbeddingDimension",kind:"LinkedField",name:"node",plural:!1,selections:c,storageKey:null}],storageKey:null},u],storageKey:"embeddingDimensions(first:50)"},{alias:null,args:t,filters:null,handle:"connection",key:"ModelEmbeddingsTable_embeddingDimensions",kind:"LinkedHandle",name:"embeddingDimensions"}],storageKey:null}]},params:{cacheID:"d4ce45828b9b8ab1f08d7bf38299a533",id:null,metadata:{},name:"ModelInferencesPageQuery",operationKind:"query",text:`query ModelInferencesPageQuery(
  $startTime: DateTime!
  $endTime: DateTime!
) {
  ...ModelSchemaTable_dimensions_3uKjWt
  ...ModelEmbeddingsTable_embeddingDimensions_3uKjWt
}

fragment ModelEmbeddingsTable_embeddingDimensions_3uKjWt on Query {
  model {
    embeddingDimensions(first: 50) {
      edges {
        embedding: node {
          id
          name
          euclideanDistance: driftMetric(metric: euclideanDistance, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
          id
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}

fragment ModelSchemaTable_dimensions_3uKjWt on Query {
  model {
    dimensions(first: 50) {
      edges {
        dimension: node {
          id
          name
          type
          dataType
          cardinality: dataQualityMetric(metric: cardinality, timeRange: {start: $startTime, end: $endTime})
          percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: {start: $startTime, end: $endTime})
          min: dataQualityMetric(metric: min, timeRange: {start: $startTime, end: $endTime})
          mean: dataQualityMetric(metric: mean, timeRange: {start: $startTime, end: $endTime})
          max: dataQualityMetric(metric: max, timeRange: {start: $startTime, end: $endTime})
          psi: driftMetric(metric: psi, timeRange: {start: $startTime, end: $endTime})
        }
        cursor
        node {
          __typename
          id
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
}
`}}})();Zh.hash="b4f2409b23d3c72afd3d9f43e813f1c9";function m4(n){const{referenceInferences:a}=Ua(),{timeRange:l}=ml(),t=T.useLazyLoadQuery(Zh,{startTime:l.start.toISOString(),endTime:l.end.toISOString()});return o("main",{children:[o(xs,{children:[e(Ic,{}),a?e(xc,{inferencesRole:"reference",timeRange:{start:new Date(a.startTime),end:new Date(a.endTime)}}):null]}),e("section",{css:K`
          margin: var(--ac-global-dimension-static-size-200);
        `,children:e(ee,{title:"Model Schema",titleSeparator:!1,children:o(jn,{children:[o(On,{children:[e(ve,{id:"all",children:"All"}),e(ve,{id:"embeddings",children:"Embeddings"}),e(ve,{id:"dimensions",children:"Dimensions"})]}),e(Re,{id:"all",children:o(ha,{defaultExpandedKeys:["embeddings","dimensions"],children:[o(We,{id:"embeddings",children:[e(He,{children:"Embeddings"}),e(Ge,{children:e(Mo,{model:t})})]}),o(We,{id:"dimensions",children:[e(He,{children:"Dimensions"}),e(Ge,{children:e(Ro,{model:t})})]})]})}),e(Re,{id:"embeddings",children:e(Mo,{model:t})}),e(Re,{id:"dimensions",children:e(Ro,{model:t})})]})})}),e(Ue,{})]})}const tD=Object.freeze(Object.defineProperty({__proto__:null,ModelInferencesPage:m4},Symbol.toStringTag,{value:"Module"})),Xh=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"hasReference"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"timeRange",variableName:"timeRange"},s=[r],d=[{kind:"Variable",name:"hasReference",variableName:"hasReference"},r],c={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},u=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}],m={kind:"Literal",name:"metric",value:"cardinality"},g={kind:"Literal",name:"metric",value:"percentEmpty"},p={kind:"Literal",name:"inferencesRole",value:"reference"};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[i,{args:s,kind:"FragmentSpread",name:"DimensionSegmentsBarChart_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionCountStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionDriftStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionCardinalityStats_dimension"},{args:d,kind:"FragmentSpread",name:"DimensionPercentEmptyStats_dimension"},{args:s,kind:"FragmentSpread",name:"DimensionQuantilesStats_dimension"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPageQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[c,i,{kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[c,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:u,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:u,storageKey:null}],storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},r],kind:"ScalarField",name:"driftMetric",storageKey:null},{alias:"cardinality",args:[m,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"percentEmpty",args:[g,r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},r],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[p,m],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'},{alias:"referencePercentEmpty",args:[p,g],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"39ebdc3f16bc7a35f11f82fbe817bae7",id:null,metadata:{},name:"DimensionPageQuery",operationKind:"query",text:`query DimensionPageQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $hasReference: Boolean!
) {
  dimension: node(id: $dimensionId) {
    __typename
    ... on Dimension {
      id
      ...DimensionSegmentsBarChart_dimension_3E0ZE6
      ...DimensionCountStats_dimension_3E0ZE6
      ...DimensionDriftStats_dimension_3E0ZE6
      ...DimensionCardinalityStats_dimension_1JBzL3
      ...DimensionPercentEmptyStats_dimension_1JBzL3
      ...DimensionQuantilesStats_dimension_3E0ZE6
    }
    id
  }
}

fragment DimensionCardinalityStats_dimension_1JBzL3 on Dimension {
  id
  cardinality: dataQualityMetric(metric: cardinality, timeRange: $timeRange)
  referenceCardinality: dataQualityMetric(metric: cardinality, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionCountStats_dimension_3E0ZE6 on Dimension {
  id
  count: dataQualityMetric(metric: count, timeRange: $timeRange)
}

fragment DimensionDriftStats_dimension_3E0ZE6 on Dimension {
  id
  psi: driftMetric(metric: psi, timeRange: $timeRange)
}

fragment DimensionPercentEmptyStats_dimension_1JBzL3 on Dimension {
  id
  percentEmpty: dataQualityMetric(metric: percentEmpty, timeRange: $timeRange)
  referencePercentEmpty: dataQualityMetric(metric: percentEmpty, inferencesRole: reference) @include(if: $hasReference)
}

fragment DimensionQuantilesStats_dimension_3E0ZE6 on Dimension {
  p99: dataQualityMetric(metric: p99, timeRange: $timeRange)
  p75: dataQualityMetric(metric: p75, timeRange: $timeRange)
  p50: dataQualityMetric(metric: p50, timeRange: $timeRange)
  p25: dataQualityMetric(metric: p25, timeRange: $timeRange)
  p1: dataQualityMetric(metric: p01, timeRange: $timeRange)
}

fragment DimensionSegmentsBarChart_dimension_3E0ZE6 on Dimension {
  id
  segmentsComparison(primaryTimeRange: $timeRange) {
    segments {
      bin {
        __typename
        ... on NominalBin {
          __typename
          name
        }
        ... on IntervalBin {
          __typename
          range {
            start
            end
          }
        }
        ... on MissingValueBin {
          __typename
        }
      }
      counts {
        primaryValue
      }
    }
    totalCounts {
      primaryValue
    }
  }
}
`}}})();Xh.hash="667ef1a20e42077fcd704bf788c9357c";const Yh=(function(){var n={kind:"Literal",name:"metric",value:"cardinality"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCardinalityStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"cardinality",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referenceCardinality",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"cardinality")'}]}],type:"Dimension",abstractKey:null}})();Yh.hash="8b4edef350e4df49e799afa70ca34918";function g4(n){const a=T.useFragment(Yh,n.dimension);return o(te,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Cardinality"}),e(v,{children:Ye(a.cardinality)}),a.referenceCardinality!=null&&e(v,{size:"S",color:"purple-800",children:Ye(a.referenceCardinality)})]})}const ek=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"cardinalityTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"cardinality"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionCardinalityTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"3c329f10094fdfe6dfbc0c7742bcffc4",id:null,metadata:{},name:"DimensionCardinalityTimeSeriesQuery",operationKind:"query",text:`query DimensionCardinalityTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      cardinalityTimeSeries: dataQualityTimeSeries(metric: cardinality, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}})();ek.hash="54017cf4e3febc3e99e1d95c98800ef7";const si={top:25,right:18,left:18,bottom:5},p4=new Intl.NumberFormat([],{maximumFractionDigits:2}),nk=()=>{const{grey300:n}=Un();return{color:n}};function y4({active:n,payload:a,label:l}){var r;const{fullTimeFormatter:t}=kn(),{color:i}=nk();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=typeof s=="number"?p4.format(s):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:i,name:"Cardinality",value:d}),e(Oi,{})]})}return null}function f4({dimensionId:n}){var d;const{timeRange:a}=ml(),l=bt(a),t=T.useLazyLoadQuery(ek,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),{color:i}=nk(),r=((d=t.dimension.cardinalityTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],s=St({samplingIntervalMinutes:l.samplingIntervalMinutes});return e(yn,{width:"100%",height:"100%",children:o(at,{data:r,margin:si,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"cardinalityColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:i,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:i,stopOpacity:0})]})}),e(vn,{...vt,tickFormatter:c=>s(new Date(c))}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Cardinality",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{content:y4}),e(jt,{type:"monotone",dataKey:"value",stroke:i,fillOpacity:1,fill:"url(#cardinalityColorUv)"})]})})}const ak={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionCountStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"count",args:[{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null};ak.hash="6dccac51f3fb0853276677c692af5a43";function h4(n){const l=T.useFragment(ak,n.dimension).count??0;return o(te,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"Total Count"}),e(v,{size:"L",children:Ye(l)})]})}const lk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"DimensionCountTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"695a044545346c5b69438bef3d905a3e",id:null,metadata:{},name:"DimensionCountTimeSeriesQuery",operationKind:"query",text:`query DimensionCountTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}})();lk.hash="0e3c417502e042a162e263efd78e1877";const k4=new Intl.NumberFormat([],{maximumFractionDigits:2}),tk=()=>{const{grey300:n}=Un();return{barColor:n}};function b4({active:n,payload:a,label:l}){var r;const{fullTimeFormatter:t}=kn(),{barColor:i}=tk();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=typeof s=="number"?k4.format(s):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:i,shape:"square",name:"Count",value:d})]})}return null}function S4({dimensionId:n}){var c;const{timeRange:a}=ml(),l=bt(a),r=(((c=T.useLazyLoadQuery(lk,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},countGranularity:l}).embedding.trafficTimeSeries)==null?void 0:c.data)||[]).map(u=>({...u,timestamp:new Date(u.timestamp).valueOf()})),s=St({samplingIntervalMinutes:l.samplingIntervalMinutes}),{barColor:d}=tk();return e(yn,{width:"100%",height:"100%",children:o(oa,{data:r,margin:si,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"countBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:d,stopOpacity:1}),e("stop",{offset:"95%",stopColor:d,stopOpacity:.5})]})}),e(vn,{...vt,tickFormatter:u=>s(new Date(u))}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Count",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{...Ls,content:b4}),e(Ze,{dataKey:"value",fill:"url(#countBarColor)",spacing:5})]})})}const ik=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"dimensionId"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],a=[{kind:"Variable",name:"id",variableName:"dimensionId"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t=[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null},d=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],c={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:d,storageKey:null},u={alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:d,storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[l,{kind:"InlineFragment",selections:[{kind:"RequiredField",field:{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[i,r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[i,s],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[i],type:"MissingValueBin",abstractKey:null}],storageKey:null},c],storageKey:null},u],storageKey:null},action:"THROW"}],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"DimensionDriftBreakdownSegmentBarChartQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,l,{kind:"InlineFragment",selections:[{alias:null,args:t,concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[i,{kind:"InlineFragment",selections:[r],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[s],type:"IntervalBin",abstractKey:null}],storageKey:null},c],storageKey:null},u],storageKey:null}],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"2e05d1ca13480861b72938edd162c36f",id:null,metadata:{},name:"DimensionDriftBreakdownSegmentBarChartQuery",operationKind:"query",text:`query DimensionDriftBreakdownSegmentBarChartQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      segmentsComparison(primaryTimeRange: $timeRange) {
        segments {
          bin {
            __typename
            ... on NominalBin {
              __typename
              name
            }
            ... on IntervalBin {
              __typename
              range {
                start
                end
              }
            }
            ... on MissingValueBin {
              __typename
            }
          }
          counts {
            primaryValue
            referenceValue
          }
        }
        totalCounts {
          primaryValue
          referenceValue
        }
      }
    }
  }
}
`}}})();ik.hash="f42c6bfff21c628edc1e297e0a0462d4";const wd=Wi(".2f"),rk=()=>{const{primary:n,reference:a}=Un();return{primaryBarColor:n,referenceBarColor:a}};function v4({active:n,payload:a,label:l}){var r,s,d,c,u,m;const{primaryBarColor:t,referenceBarColor:i}=rk();if(n&&a&&a.length){const g=(s=(r=a[0])==null?void 0:r.payload)==null?void 0:s.primaryName,p=(d=a[0])==null?void 0:d.value,y=(u=(c=a[0])==null?void 0:c.payload)==null?void 0:u.referenceName,h=(m=a[1])==null?void 0:m.value;return o(gn,{children:[e(v,{elementType:"h3",size:"S",weight:"heavy",children:l}),e(_e,{color:t,shape:"square",name:g,value:p!=null?`${wd(p)}%`:"--"}),e(_e,{color:i,shape:"square",name:y,value:h!=null?`${wd(h)}%`:"--"})]})}return null}function F4(n){var y,h,k,S,F;const{fullTimeFormatter:a}=kn(),{primaryInferences:l,referenceInferences:t}=Ua(),i=l.name,r=(t==null?void 0:t.name)||"reference",{selectedTimestamp:s}=Hi(),d=f.useMemo(()=>s??new Date(l.endTime),[s,l.endTime]),c=f.useMemo(()=>({start:Bc(d,2).toISOString(),end:d.toISOString()}),[d]),u=T.useLazyLoadQuery(ik,{dimensionId:n.dimensionId,timeRange:c}),m=f.useMemo(()=>{var E,P,_,D,A;const I=((E=u.dimension.segmentsComparison)==null?void 0:E.segments)??[],L=((_=(P=u.dimension.segmentsComparison)==null?void 0:P.totalCounts)==null?void 0:_.primaryValue)??0,M=((A=(D=u.dimension.segmentsComparison)==null?void 0:D.totalCounts)==null?void 0:A.referenceValue)??0;return I.map(V=>{var N,B;const j=((N=V.counts)==null?void 0:N.primaryValue)??0,ce=((B=V.counts)==null?void 0:B.referenceValue)??0,W=Lc(V.bin),Pe=j/L*100,ne=ce/M*100;return{name:W,primaryName:i,referenceName:r,primaryPercent:Pe,referencePercent:ne}})},[(y=u.dimension.segmentsComparison)==null?void 0:y.segments,(k=(h=u.dimension.segmentsComparison)==null?void 0:h.totalCounts)==null?void 0:k.primaryValue,(F=(S=u.dimension.segmentsComparison)==null?void 0:S.totalCounts)==null?void 0:F.referenceValue,i,r]),{primaryBarColor:g,referenceBarColor:p}=rk();return o(b,{direction:"column",height:"100%",children:[e(C,{flex:"none",paddingTop:"size-100",paddingStart:"size-200",children:e(v,{elementType:"h3",size:"S",color:"text-700",children:`Distribution comparison at ${a(new Date(c.end))}`})}),e(C,{flex:!0,children:e(yn,{children:o(oa,{data:m,margin:{top:15,right:18,left:18,bottom:5},children:[o("defs",{children:[o("linearGradient",{id:"dimensionPrimarySegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:1}),e("stop",{offset:"95%",stopColor:g,stopOpacity:.5})]}),o("linearGradient",{id:"dimensionReferenceSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:p,stopOpacity:1}),e("stop",{offset:"95%",stopColor:p,stopOpacity:.5})]})]}),e(vn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Percent",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)"}),e(pn,{...Ls,content:v4}),e(Ze,{dataKey:"primaryPercent",fill:"url(#dimensionPrimarySegmentsBarColor)"}),e(Ze,{dataKey:"referencePercent",fill:"url(#dimensionReferenceSegmentsBarColor)"})]})})})]})}const sk={argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionDriftStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"psi",args:[{kind:"Literal",name:"metric",value:"psi"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"driftMetric",storageKey:null}],type:"Dimension",abstractKey:null};sk.hash="f8a9fb08a14f63906e38bc247d50b189";const C4=o(kt,{variant:"info",placement:"top end",children:[e(Te,{weight:"heavy",level:4,children:"Population Stability Index"}),e(v,{children:"PSI is a symmetric metric that measures the relative entropy, or difference in information represented by two distributions. It can be thought of as measuring the distance between two data distributions showing how different the two distributions are from each other."}),e("footer",{children:e(tl,{href:"https://arize.com/blog-course/population-stability-index-psi/#:~:text=Population%20Stability%20Index%20(PSI)%20Overview,distributions%20are%20from%20each%20other.",children:"Learn more"})})]});function K4(n){const a=T.useFragment(sk,n.dimension);return o(te,{children:[o(b,{direction:"row",alignItems:"center",gap:"size-25",children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"PSI"}),C4]}),e(v,{size:"L",children:kl(a.psi)})]})}const ok=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"driftGranularity"},t={defaultValue:null,kind:"LocalArgument",name:"timeRange"},i=[{kind:"Variable",name:"id",variableName:"dimensionId"}],r={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"granularity",variableName:"driftGranularity"},{kind:"Literal",name:"metric",value:"psi"},s],concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t],kind:"Fragment",metadata:null,name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[r,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,t,l,n],kind:"Operation",name:"DimensionDriftTimeSeriesQuery",selections:[{alias:"embedding",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},r,c],storageKey:null}]},params:{cacheID:"76a27456cd1f545ddb16fc0d9ef09fc1",id:null,metadata:{},name:"DimensionDriftTimeSeriesQuery",operationKind:"query",text:`query DimensionDriftTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $driftGranularity: Granularity!
  $countGranularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      driftTimeSeries(metric: psi, timeRange: $timeRange, granularity: $driftGranularity) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}})();ok.hash="e458e42625d1c4dcdd2359a8d33d32a8";const dk=()=>{const{blue500:n,grey300:a}=Un();return{color:n,barColor:a}};function T4({active:n,payload:a,label:l}){var r;const{fullTimeFormatter:t}=kn(),{color:i}=dk();if(n&&a&&a.length){const s=((r=a[1])==null?void 0:r.value)??null;return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:i,name:"PSI",value:kl(s)}),e(Oi,{}),o("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);
            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(x,{svg:e(Qt,{})}),e("span",{children:"Click to view details"})]})]})}return null}function P4({dimensionId:n}){var y,h;const{timeRange:a}=ml(),{selectedTimestamp:l,setSelectedTimestamp:t}=Hi(),i=bt(a),r=T.useLazyLoadQuery(ok,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},driftGranularity:Dc(a),countGranularity:i}),s=((y=r.embedding.driftTimeSeries)==null?void 0:y.data)||[],d=((h=r.embedding.trafficTimeSeries)==null?void 0:h.data.reduce((k,S)=>(k[S.timestamp]=S.value,k),{}))??{},c=s.map(k=>{const S=d[k.timestamp];return{...k,traffic:S,timestamp:new Date(k.timestamp).valueOf()}}),u=St({samplingIntervalMinutes:i.samplingIntervalMinutes}),m=f.useCallback(k=>{const{activeIndex:S}=k;let F;if(typeof S=="number"?F=S:typeof S=="string"&&!isNaN(Number(S))&&(F=Number(S)),typeof F=="number"&&c[F]){const I=c[F];t(new Date(I.timestamp))}},[t,c]),{color:g,barColor:p}=dk();return e(yn,{width:"100%",height:"100%",children:o(at,{data:c,margin:si,onClick:m,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"dimensionDriftColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:g,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:g,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:p,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:p,stopOpacity:0})]})]}),e(vn,{...vt,tickFormatter:k=>u(new Date(k))}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"PSI",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-color-grey-500)"}}),e(an,{yAxisId:"right",orientation:"right",tick:!1,tickLine:!1,width:0}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{content:T4}),e(Ze,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(jt,{type:"monotone",dataKey:"value",stroke:g,fillOpacity:1,fill:"url(#dimensionDriftColorUv)"}),l!=null?e(Hc,{..._c,x:l.getTime(),label:e(Gc,{...Ac})}):null]})})}const ck=(function(){var n={kind:"Literal",name:"metric",value:"percentEmpty"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"hasReference"},{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyStats_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:"percentEmpty",args:[n,{kind:"Variable",name:"timeRange",variableName:"timeRange"}],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{condition:"hasReference",kind:"Condition",passingValue:!0,selections:[{alias:"referencePercentEmpty",args:[{kind:"Literal",name:"inferencesRole",value:"reference"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:'dataQualityMetric(inferencesRole:"reference",metric:"percentEmpty")'}]}],type:"Dimension",abstractKey:null}})();ck.hash="1e10d0449d6607d9292f355548c41c78";function I4(n){const a=T.useFragment(ck,n.dimension);return o(te,{children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:"% Empty"}),e(v,{size:"L",children:$t(a.percentEmpty)}),a.referencePercentEmpty!=null&&e(v,{size:"M",color:"purple-800",children:$t(a.referencePercentEmpty)})]})}const uk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"InlineFragment",selections:[{alias:"percentEmptyTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"granularity"},{kind:"Literal",name:"metric",value:"percentEmpty"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,r],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionPercentEmptyTimeSeriesQuery",selections:[{alias:"embedding",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,r],storageKey:null}]},params:{cacheID:"85842391b76ccca79e3b6f506fb1d78d",id:null,metadata:{},name:"DimensionPercentEmptyTimeSeriesQuery",operationKind:"query",text:`query DimensionPercentEmptyTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  embedding: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      percentEmptyTimeSeries: dataQualityTimeSeries(metric: percentEmpty, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}})();uk.hash="c04e7d788249ceb6f9f7a9ff50a28efd";const x4=new Intl.NumberFormat([],{maximumFractionDigits:2}),mk=()=>{const{grey100:n}=Un();return{color:n}};function L4({active:n,payload:a,label:l}){var r;const{fullTimeFormatter:t}=kn(),{color:i}=mk();if(n&&a&&a.length){const s=((r=a[0])==null?void 0:r.value)??null,d=typeof s=="number"?x4.format(s):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:i,name:"% Empty",value:d})]})}return null}function D4({dimensionId:n}){var d;const{timeRange:a}=ml(),l=bt(a),i=((d=T.useLazyLoadQuery(uk,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}).embedding.percentEmptyTimeSeries)==null?void 0:d.data.map(c=>({timestamp:new Date(c.timestamp).valueOf(),value:c.value})))||[],r=St({samplingIntervalMinutes:l.samplingIntervalMinutes}),{color:s}=mk();return e(yn,{width:"100%",height:"100%",children:o(at,{data:i,margin:si,syncId:"dimensionDetails",children:[e("defs",{children:o("linearGradient",{id:"percentEmptyColorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:s,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:s,stopOpacity:0})]})}),e(vn,{...vt,tickFormatter:c=>r(new Date(c))}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Empty",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{content:L4}),e(Pa,{type:"monotone",dataKey:"value",stroke:s,fillOpacity:1,fill:"url(#percentEmptyColorUv)"})]})})}const gk=(function(){var n={kind:"Variable",name:"timeRange",variableName:"timeRange"};return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionQuantilesStats_dimension",selections:[{alias:"p99",args:[{kind:"Literal",name:"metric",value:"p99"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p75",args:[{kind:"Literal",name:"metric",value:"p75"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p50",args:[{kind:"Literal",name:"metric",value:"p50"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p25",args:[{kind:"Literal",name:"metric",value:"p25"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null},{alias:"p1",args:[{kind:"Literal",name:"metric",value:"p01"},n],kind:"ScalarField",name:"dataQualityMetric",storageKey:null}],type:"Dimension",abstractKey:null}})();gk.hash="c306c8eafb1d34be464d3a658d5f94a7";function _4(n){const a=T.useFragment(gk,n.dimension);return e("ul",{css:K`
        display: flex;
        flex-direction: column;
        gap: var(--ac-global-dimension-static-size-50);
      `,children:Object.keys(a).map(l=>{const t=a[l];return o("li",{css:K`
              display: flex;
              flex-direction: column;
              align-items: flex-end;
            `,children:[e(v,{elementType:"h3",size:"XS",color:"text-700",children:l}),e(v,{size:"S","data-raw":t,children:el(t)})]},l)})})}const pk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},a={defaultValue:null,kind:"LocalArgument",name:"granularity"},l={defaultValue:null,kind:"LocalArgument",name:"timeRange"},t=[{kind:"Variable",name:"id",variableName:"dimensionId"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={kind:"Variable",name:"granularity",variableName:"granularity"},s={kind:"Variable",name:"timeRange",variableName:"timeRange"},d=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],c={kind:"InlineFragment",selections:[{alias:"p99TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p99"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p75TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p75"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p50TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p50"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p25TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p25"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null},{alias:"p01TimeSeries",args:[r,{kind:"Literal",name:"metric",value:"p01"},s],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:d,storageKey:null}],type:"Dimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[i,c],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[n,l,a],kind:"Operation",name:"DimensionQuantilesTimeSeriesQuery",selections:[{alias:"dimension",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},i,c],storageKey:null}]},params:{cacheID:"04ae2e4b101a75b965867de769810e0c",id:null,metadata:{},name:"DimensionQuantilesTimeSeriesQuery",operationKind:"query",text:`query DimensionQuantilesTimeSeriesQuery(
  $dimensionId: ID!
  $timeRange: TimeRange!
  $granularity: Granularity!
) {
  dimension: node(id: $dimensionId) {
    __typename
    id
    ... on Dimension {
      p99TimeSeries: dataQualityTimeSeries(metric: p99, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p75TimeSeries: dataQualityTimeSeries(metric: p75, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p50TimeSeries: dataQualityTimeSeries(metric: p50, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p25TimeSeries: dataQualityTimeSeries(metric: p25, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
      p01TimeSeries: dataQualityTimeSeries(metric: p01, timeRange: $timeRange, granularity: $granularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
}
`}}})();pk.hash="83342058bb8f50dad5bec299b4bc034d";const A4=Wi("~s");var yk=(n=>(n.p99_p01="p99_p01",n.p75_p25="p75_p25",n.p50="p50",n))(yk||{});const E4=new Intl.NumberFormat([],{maximumFractionDigits:2});function Mt(n){return typeof n=="number"?E4.format(n):"--"}const fk=()=>{const n=Un();return{outerColor:n.grey500,innerColor:n.grey300,lineColor:n.default}};function w4({active:n,payload:a,label:l}){const{fullTimeFormatter:t}=kn(),{outerColor:i,innerColor:r,lineColor:s}=fk();if(n&&a&&a.length){const d=a[0].payload;return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${t(new Date(l))}`}),e(_e,{color:i,name:"p99",value:Mt(d.p99_p01[0])}),e(_e,{color:r,name:"p75",value:Mt(d.p75_p25[0])}),e(_e,{color:s,name:"p50",value:Mt(d.p50)}),e(_e,{color:r,name:"p25",value:Mt(d.p75_p25[1])}),e(_e,{color:i,name:"p01",value:Mt(d.p99_p01[1])})]})}return null}function M4({dimensionId:n}){var L,M,E,P,_;const{timeRange:a}=ml(),l=bt(a),t=T.useLazyLoadQuery(pk,{dimensionId:n,timeRange:{start:a.start.toISOString(),end:a.end.toISOString()},granularity:l}),i=((L=t.dimension.p99TimeSeries)==null?void 0:L.data.map(D=>D))||[],r=((M=t.dimension.p01TimeSeries)==null?void 0:M.data.map(D=>D))||[],s=((E=t.dimension.p75TimeSeries)==null?void 0:E.data.map(D=>D))||[],d=((P=t.dimension.p25TimeSeries)==null?void 0:P.data.map(D=>D))||[],c=((_=t.dimension.p50TimeSeries)==null?void 0:_.data.map(D=>D))||[],u=i.map((D,A)=>({timestamp:new Date(D.timestamp).valueOf(),p99_p01:[D.value,r[A].value],p75_p25:[s[A].value,d[A].value],p50:c[A].value})),m=St({samplingIntervalMinutes:l.samplingIntervalMinutes}),[g,p]=f.useState(Object.keys(yk).reduce((D,A)=>(D[A]=!1,D),{})),y=D=>{g[D.dataKey]||p({...g})},h=()=>{p({...g})},k=D=>{p({...g,[String(D.dataKey)]:!g[D.dataKey]})},{outerColor:S,innerColor:F,lineColor:I}=fk();return e(yn,{width:"100%",height:"100%",children:o(at,{data:u,margin:si,syncId:"dimensionDetails",children:[o("defs",{children:[o("linearGradient",{id:"p99_p01ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:S,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:S,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:S,stopOpacity:.7})]}),o("linearGradient",{id:"p75_p25ColorUV",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"10%",stopColor:F,stopOpacity:.7}),e("stop",{offset:"50%",stopColor:F,stopOpacity:.3}),e("stop",{offset:"90%",stopColor:F,stopOpacity:.7})]})]}),e(vn,{...vt,tickFormatter:D=>m(new Date(D))}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"Value",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},tickFormatter:D=>A4(D),style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{content:w4}),e(sa,{onClick:k,onMouseOver:y,onMouseOut:h}),e(jt,{type:"monotone",dataKey:"p99_p01",name:"p99 - p01",fillOpacity:1,fill:"url(#p99_p01ColorUV)",stroke:S,hide:g.p99_p01===!0}),e(jt,{type:"monotone",dataKey:"p75_p25",name:"p75 - p25",fillOpacity:1,stroke:F,fill:"url(#p75_p25ColorUV)",hide:g.p75_p25===!0}),e(Pa,{type:"monotone",dataKey:"p50",stroke:I,hide:g.p50===!0})]})})}const hk=(function(){var n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},a=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null}];return{argumentDefinitions:[{defaultValue:null,kind:"LocalArgument",name:"timeRange"}],kind:"Fragment",metadata:null,name:"DimensionSegmentsBarChart_dimension",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"primaryTimeRange",variableName:"timeRange"}],concreteType:"Segments",kind:"LinkedField",name:"segmentsComparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Segment",kind:"LinkedField",name:"segments",plural:!0,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bin",plural:!1,selections:[{kind:"InlineFragment",selections:[n,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],type:"NominalBin",abstractKey:null},{kind:"InlineFragment",selections:[n,{alias:null,args:null,concreteType:"NumericRange",kind:"LinkedField",name:"range",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"start",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"end",storageKey:null}],storageKey:null}],type:"IntervalBin",abstractKey:null},{kind:"InlineFragment",selections:[n],type:"MissingValueBin",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"counts",plural:!1,selections:a,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"DatasetValues",kind:"LinkedField",name:"totalCounts",plural:!1,selections:a,storageKey:null}],storageKey:null}],type:"Dimension",abstractKey:null}})();hk.hash="8cef9841e9a5bd7d0d50acb5db9028b0";const R4=Wi(".2f"),kk=()=>{const{primary:n}=Un();return{color:n}};function V4({active:n,payload:a,label:l}){var i;const{color:t}=kk();if(n&&a&&a.length&&typeof l=="string"){const r=(i=a[0])==null?void 0:i.value;return e(gn,{children:e(_e,{color:t,shape:"square",name:l,value:r!=null?`${R4(r)}%`:"--"})})}return null}function N4(n){const a=T.useFragment(hk,n.dimension),l=f.useMemo(()=>{var s,d,c;const i=((s=a.segmentsComparison)==null?void 0:s.segments)??[],r=((c=(d=a.segmentsComparison)==null?void 0:d.totalCounts)==null?void 0:c.primaryValue)??0;return i.map(u=>{var y;const m=((y=u.counts)==null?void 0:y.primaryValue)??0,g=Lc(u.bin),p=m/r*100;return{name:g,percent:p}})},[a]),{color:t}=kk();return e(yn,{children:o(oa,{data:l,margin:{top:25,right:18,left:18,bottom:5},children:[e("defs",{children:o("linearGradient",{id:"dimensionSegmentsBarColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:t,stopOpacity:1}),e("stop",{offset:"95%",stopColor:t,stopOpacity:.5})]})}),e(vn,{dataKey:"name",style:{fill:"var(--ac-global-text-color-700)"}}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:"% Volume",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{...Ls,content:V4}),e(Ze,{dataKey:"percent",fill:"url(#dimensionSegmentsBarColor)",spacing:15})]})})}function z4(){const{dimensionId:n}=on(),a=Me(),[l,t]=f.useState(!0),{timeRange:i}=ml(),r=wn();Xe(r);const{referenceInferences:s}=Ua(),d=s!==null,c=d,u=r.dimension.shape!=="continuous",m=r.dimension.dataType==="numeric",g=T.useLazyLoadQuery(Xh,{dimensionId:n,timeRange:{start:i.start.toISOString(),end:i.end.toISOString()},hasReference:d});if(!n)throw new Error("Dimension ID is required to display a dimension");const p=y=>{t(y),y||a("/model")};return e(Ec,{initialTimestamp:new Date(i.end),children:e(se,{isOpen:l,onOpenChange:p,children:e(oe,{isDismissable:!0,children:e(ae,{variant:"slideover",size:"L",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:r.dimension.name}),e(ke,{children:e(be,{})})]}),e("main",{css:K`
                    padding: var(--ac-global-dimension-static-size-100);
                    display: flex;
                    flex-direction: column;
                    min-height: 400px;
                    overflow-y: auto;
                    height: 100%;
                  `,children:e(f.Suspense,{fallback:e(me,{}),children:o(b,{direction:"column",gap:"size-100",children:[e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:e(N4,{dimension:g.dimension})}),e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600","data-testid":"dimension-count-time-series-view",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(S4,{dimensionId:n}),e(xt,{children:e(h4,{dimension:g.dimension})})]})}),c?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",children:o(b,{direction:"column",alignItems:"stretch",children:[e(C,{width:"100%",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(P4,{dimensionId:n})}),e(xt,{children:e(K4,{dimension:g.dimension})})]})}),e(C,{height:"size-1600",width:"100%",borderTopColor:"dark",borderTopWidth:"thin",children:e(f.Suspense,{fallback:e(me,{}),children:e(F4,{dimensionId:n})})})]})}):null,m?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-3000",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(M4,{dimensionId:n})}),e(xt,{children:e(_4,{dimension:g.dimension})})]})}):null,u?e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(C,{flex:!0,children:e(f4,{dimensionId:n})}),e(xt,{children:e(g4,{dimension:g.dimension})})]})}):null,e(C,{borderColor:"dark",borderRadius:"medium",borderWidth:"thin",height:"size-1600",children:o(b,{direction:"row",alignItems:"stretch",height:"100%",children:[e(D4,{dimensionId:n}),e(xt,{children:e(I4,{dimension:g.dimension})})]})})]})})})]})})})})})})}const bk=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"dataType",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"shape",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"dimensionLoaderQuery",selections:[{alias:"dimension",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t,i,r],type:"Dimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"f16f279b01e4bc5c5261bbdb629a0b73",id:null,metadata:{},name:"dimensionLoaderQuery",operationKind:"query",text:`query dimensionLoaderQuery(
  $id: ID!
) {
  dimension: node(id: $id) {
    __typename
    ... on Dimension {
      id
      name
      dataType
      shape
    }
    id
  }
}
`}}})();bk.hash="00f0d45ac038a51b4b30d9c5251f701e";async function $4(n){const{dimensionId:a}=n.params;return T.fetchQuery(ze,bk,{id:a}).toPromise()}const iD=Object.freeze(Object.defineProperty({__proto__:null,DimensionPage:z4,dimensionLoader:$4},Symbol.toStringTag,{value:"Module"})),Sk={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"MetricSelector_dimensions"}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"EmbeddingPageModelQuery",selections:[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],storageKey:null}]},params:{cacheID:"fd9d393b5de6aab89ac3f91ac93def55",id:null,metadata:{},name:"EmbeddingPageModelQuery",operationKind:"query",text:`query EmbeddingPageModelQuery {
  model {
    ...MetricSelector_dimensions
  }
}

fragment MetricSelector_dimensions on InferenceModel {
  numericDimensions: dimensions(include: {dataTypes: [numeric]}) {
    edges {
      node {
        id
        name
        type
      }
    }
  }
}
`}};Sk.hash="374499f7f8ce6919e4a0a4ecbe380c52";const vk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"clusterMinSamples"},a={defaultValue:null,kind:"LocalArgument",name:"clusterSelectionEpsilon"},l={defaultValue:null,kind:"LocalArgument",name:"dataQualityMetricColumnName"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQualityMetric"},i={defaultValue:null,kind:"LocalArgument",name:"fetchPerformanceMetric"},r={defaultValue:null,kind:"LocalArgument",name:"id"},s={defaultValue:null,kind:"LocalArgument",name:"minClusterSize"},d={defaultValue:null,kind:"LocalArgument",name:"minDist"},c={defaultValue:null,kind:"LocalArgument",name:"nNeighbors"},u={defaultValue:null,kind:"LocalArgument",name:"nSamples"},m={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},g={defaultValue:null,kind:"LocalArgument",name:"timeRange"},p=[{kind:"Variable",name:"id",variableName:"id"}],y={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},k={alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},S={alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},F=[y,{alias:null,args:null,kind:"ScalarField",name:"eventId",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"coordinates",plural:!1,selections:[h,{kind:"InlineFragment",selections:[k,S,{alias:null,args:null,kind:"ScalarField",name:"z",storageKey:null}],type:"Point3D",abstractKey:null},{kind:"InlineFragment",selections:[k,S],type:"Point2D",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EmbeddingMetadata",kind:"LinkedField",name:"embeddingMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"linkToData",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"rawData",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null}],I=[{alias:null,args:null,kind:"ScalarField",name:"primaryValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"referenceValue",storageKey:null}],L={kind:"InlineFragment",selections:[{alias:null,args:[{kind:"Variable",name:"clusterMinSamples",variableName:"clusterMinSamples"},{kind:"Variable",name:"clusterSelectionEpsilon",variableName:"clusterSelectionEpsilon"},{kind:"Variable",name:"minClusterSize",variableName:"minClusterSize"},{kind:"Variable",name:"minDist",variableName:"minDist"},{kind:"Variable",name:"nNeighbors",variableName:"nNeighbors"},{kind:"Variable",name:"nSamples",variableName:"nSamples"},{kind:"Variable",name:"timeRange",variableName:"timeRange"}],concreteType:"UMAPPoints",kind:"LinkedField",name:"UMAPPoints",plural:!1,selections:[{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"data",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"referenceData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"UMAPPoint",kind:"LinkedField",name:"corpusData",plural:!0,selections:F,storageKey:null},{alias:null,args:null,concreteType:"Cluster",kind:"LinkedField",name:"clusters",plural:!0,selections:[y,{alias:null,args:null,kind:"ScalarField",name:"eventIds",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"driftRatio",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"primaryToCorpusRatio",storageKey:null},{condition:"fetchDataQualityMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"columnName",variableName:"dataQualityMetricColumnName"},{kind:"Literal",name:"metric",value:"mean"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"dataQualityMetric",plural:!1,selections:I,storageKey:null}]},{condition:"fetchPerformanceMetric",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"}],concreteType:"DatasetValues",kind:"LinkedField",name:"performanceMetric",plural:!1,selections:I,storageKey:null}]}],storageKey:null},{alias:null,args:null,concreteType:"Retrieval",kind:"LinkedField",name:"contextRetrievals",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"queryId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"documentId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"relevance",storageKey:null}],storageKey:null}],storageKey:null}],type:"EmbeddingDimension",abstractKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d,c,u,m,g],kind:"Fragment",metadata:null,name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[L],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[r,g,d,c,u,s,n,a,t,l,i,m],kind:"Operation",name:"EmbeddingPageUMAPQuery",selections:[{alias:"embedding",args:p,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[h,L,y],storageKey:null}]},params:{cacheID:"d9999f636a5bf081cc90ab4c726f82ab",id:null,metadata:{},name:"EmbeddingPageUMAPQuery",operationKind:"query",text:`query EmbeddingPageUMAPQuery(
  $id: ID!
  $timeRange: TimeRange!
  $minDist: Float!
  $nNeighbors: Int!
  $nSamples: Int!
  $minClusterSize: Int!
  $clusterMinSamples: Int!
  $clusterSelectionEpsilon: Float!
  $fetchDataQualityMetric: Boolean!
  $dataQualityMetricColumnName: String
  $fetchPerformanceMetric: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      UMAPPoints(timeRange: $timeRange, minDist: $minDist, nNeighbors: $nNeighbors, nSamples: $nSamples, minClusterSize: $minClusterSize, clusterMinSamples: $clusterMinSamples, clusterSelectionEpsilon: $clusterSelectionEpsilon) {
        data {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        referenceData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        corpusData {
          id
          eventId
          coordinates {
            __typename
            ... on Point3D {
              x
              y
              z
            }
            ... on Point2D {
              x
              y
            }
          }
          embeddingMetadata {
            linkToData
            rawData
          }
          eventMetadata {
            predictionId
            predictionLabel
            actualLabel
            predictionScore
            actualScore
          }
        }
        clusters {
          id
          eventIds
          driftRatio
          primaryToCorpusRatio
          dataQualityMetric(metric: {columnName: $dataQualityMetricColumnName, metric: mean}) @include(if: $fetchDataQualityMetric) {
            primaryValue
            referenceValue
          }
          performanceMetric(metric: {metric: $performanceMetric}) @include(if: $fetchPerformanceMetric) {
            primaryValue
            referenceValue
          }
        }
        contextRetrievals {
          queryId
          documentId
          relevance
        }
      }
    }
    id
  }
}
`}}})();vk.hash="ef95e709ca26aebdf07386ab97205b1e";function O4(){const{theme:n}=ia();return f.useMemo(()=>n==="light"?Xb:Yb,[n])}function j4(){const{embeddingDimensionId:n}=on();if(!n)throw new Error("Missing embeddingDimensionId in URL params");return n}const Fk={euclideanDistance:{name:"Euclidean Distance",shortName:"Euc. Distance",definition:"Euclidean distance over time captures how much your primary inferences's embeddings are drifting from the reference data. Euclidean distance of the embeddings is calculated by taking the centroid of the embedding vectors for each inferences and calculating the distance between the two centroids."},queryDistance:{name:"Query Distance",shortName:"Query Distance",definition:"The query distance is the euclidean distance of the centroid of queries from the centroid of the corpus."},accuracyScore:{name:"Accuracy Score",shortName:"Accuracy",definition:"Accuracy classification score. In multi-label classification, this function computes subset accuracy: the set of labels predicted for a sample must exactly match the corresponding set of labels in the ground truth."}};function Ul(n){const a=Fk[n];return a!=null?a.shortName:n}function Ar(n){const a=Fk[n];return a&&a.definition!=null&&a.definition||null}function tt(n){return`${n.column}:${n.dir}`}function Q4(){const{referenceInferences:n}=Ua(),a=!!n,l=xe(s=>s.clusterSort),t=xe(s=>s.setClusterSort),i=f.useMemo(()=>{const s=[];return a&&s.push({label:"Most drift",value:tt({column:"driftRatio",dir:"desc"})}),[...s,{label:"Largest clusters",value:tt({column:"size",dir:"desc"})},{label:"Smallest clusters",value:tt({column:"size",dir:"asc"})},{label:"Highest metric value",value:tt({column:"primaryMetricValue",dir:"desc"})},{label:"Lowest metric value",value:tt({column:"primaryMetricValue",dir:"asc"})}]},[a]),r=tt(l);return o(la,{"aria-label":"Sort clusters by",children:[e(R,{trailingVisual:e(x,{svg:e(eS,{})}),size:"S",children:"Sort"}),e(we,{children:e($n,{style:{width:200},selectedKeys:[r],selectionMode:"single",items:i,onSelectionChange:s=>{if(s instanceof Set&&s.size>0){const[d]=s.values(),[c,u]=d.split(":");t({column:c,dir:u})}},children:s=>e(Oe,{id:s.value,textValue:s.value,children:s.label},s.value)})})]})}const Ck={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"MetricSelector_dimensions",selections:[{alias:"numericDimensions",args:[{kind:"Literal",name:"include",value:{dataTypes:["numeric"]}}],concreteType:"DimensionConnection",kind:"LinkedField",name:"dimensions",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:'dimensions(include:{"dataTypes":["numeric"]})'}],type:"InferenceModel",abstractKey:null};Ck.hash="372c00c9d4e2e0512af55c958b21c5e0";const it=":";function B4(n){return["drift","performance","dataQuality","retrieval"].includes(n)}function Rt(n){const{type:a,metric:l}=n;switch(a){case"drift":return`${a}${it}${l}`;case"retrieval":return`${a}${it}${l}`;case"performance":return`${a}${it}${l}`;case"dataQuality":{const{name:t}=n.dimension;return`${a}${it}${l}${it}${t}`}default:Ne()}}function q4({metricKey:n,dimensions:a}){const[l,t,i]=n.split(it);if(!B4(l))throw new Error(`Invalid metric type: ${l}`);switch(l){case"drift":return{type:l,metric:t};case"retrieval":return{type:l,metric:t};case"performance":return{type:l,metric:t};case"dataQuality":{const r=a.find(s=>s.name===i);if(!r)throw new Error(`Invalid dimension name: ${i}`);return{type:l,metric:t,dimension:r}}default:Ne()}}const U4=K`
  /* Align with other toolbar components */
  .react-aria-Button {
    height: 30px;
    min-height: 30px;
  }

  .react-aria-Label {
    padding: 5px 0;
    display: inline-block;
    font-size: var(--ac-global-dimension-static-font-size-75);
    font-weight: var(--px-font-weight-heavy);
  }
`;function H4({model:n}){const[,a]=f.useTransition(),l=T.useFragment(Ck,n),{referenceInferences:t,corpusInferences:i}=Ua(),r=!!t,s=!!i,d=xe(h=>h.metric),c=xe(h=>h.loading),u=xe(h=>h.setMetric),m=l.numericDimensions.edges.map(h=>h.node),g=m.length>0,p=f.useCallback(h=>{if(!h||typeof h!="string")return;const k=q4({metricKey:h,dimensions:m});a(()=>{u(k)})},[u,m,a]),y=[];return r&&y.push({key:Rt({type:"drift",metric:"euclideanDistance"}),label:"Euclidean Distance"}),s&&y.push({key:Rt({type:"retrieval",metric:"queryDistance"}),label:"Query Distance"}),y.push({key:Rt({type:"performance",metric:"accuracyScore"}),label:"Accuracy Score"}),g&&m.forEach(h=>{y.push({key:Rt({type:"dataQuality",metric:"average",dimension:h}),label:`${h.name} avg`})}),o(Se,{delay:0,children:[o(Dl,{value:d?Rt(d):void 0,onChange:p,placeholder:"Select a metric...",isDisabled:c,size:"S","aria-label":"Analysis metric",css:U4,children:[e(J,{children:"Metric"}),o(R,{children:[e(wl,{}),e(na,{})]}),e(we,{children:e(Bn,{children:y.map(h=>e(dn,{id:h.key,children:h.label},h.key))})})]}),o(fa,{children:[e(ln,{}),o("section",{css:K`
            h4 {
              margin-bottom: 0.5rem;
            }
          `,children:[e(Te,{level:4,children:"Analysis Metric"}),e(v,{children:"Select a metric to drive the analysis of your embeddings."}),e(v,{children:"To analyze the the drift between your two inferences, select a drift metric and the UI will highlight areas of high drift."}),e(v,{children:"To analyze the quality of your embeddings, select a dimension data quality metric by which to analyze the point cloud. The UI will highlight areas where the data quality is degrading."})]})]})]})}const Kk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"countGranularity"},a={defaultValue:null,kind:"LocalArgument",name:"dimensionId"},l={defaultValue:null,kind:"LocalArgument",name:"embeddingDimensionId"},t={defaultValue:null,kind:"LocalArgument",name:"fetchDataQuality"},i={defaultValue:null,kind:"LocalArgument",name:"fetchDrift"},r={defaultValue:null,kind:"LocalArgument",name:"fetchPerformance"},s={defaultValue:null,kind:"LocalArgument",name:"fetchQueryDistance"},d={defaultValue:null,kind:"LocalArgument",name:"metricGranularity"},c={defaultValue:null,kind:"LocalArgument",name:"performanceMetric"},u={defaultValue:null,kind:"LocalArgument",name:"timeRange"},m=[{kind:"Variable",name:"id",variableName:"embeddingDimensionId"}],g={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},p={kind:"Variable",name:"granularity",variableName:"metricGranularity"},y={kind:"Variable",name:"timeRange",variableName:"timeRange"},h=[p,{kind:"Literal",name:"metric",value:"euclideanDistance"},y],k=[{alias:null,args:null,concreteType:"TimeSeriesDataPoint",kind:"LinkedField",name:"data",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null}],storageKey:null}],S={kind:"InlineFragment",selections:[{condition:"fetchDrift",kind:"Condition",passingValue:!0,selections:[{alias:"euclideanDistanceTimeSeries",args:h,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"driftTimeSeries",plural:!1,selections:k,storageKey:null}]},{condition:"fetchQueryDistance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:h,concreteType:"DriftTimeSeries",kind:"LinkedField",name:"retrievalMetricTimeSeries",plural:!1,selections:k,storageKey:null}]},{alias:"trafficTimeSeries",args:[{kind:"Variable",name:"granularity",variableName:"countGranularity"},{kind:"Literal",name:"metric",value:"count"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:k,storageKey:null}],type:"EmbeddingDimension",abstractKey:null},F=[{kind:"Variable",name:"id",variableName:"dimensionId"}],I={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:[p,{kind:"Literal",name:"metric",value:"mean"},y],concreteType:"DataQualityTimeSeries",kind:"LinkedField",name:"dataQualityTimeSeries",plural:!1,selections:k,storageKey:null}],type:"Dimension",abstractKey:null},L={alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{condition:"fetchPerformance",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[p,{fields:[{kind:"Variable",name:"metric",variableName:"performanceMetric"}],kind:"ObjectValue",name:"metric"},y],concreteType:"PerformanceTimeSeries",kind:"LinkedField",name:"performanceTimeSeries",plural:!1,selections:k,storageKey:null}]}],storageKey:null},M={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null};return{fragment:{argumentDefinitions:[n,a,l,t,i,r,s,d,c,u],kind:"Fragment",metadata:null,name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:m,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[g,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[I],storageKey:null}]},L],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[l,u,d,n,i,s,t,a,r,c],kind:"Operation",name:"MetricTimeSeriesQuery",selections:[{alias:"embedding",args:m,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[M,g,S],storageKey:null},{condition:"fetchDataQuality",kind:"Condition",passingValue:!0,selections:[{alias:"dimension",args:F,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[M,I,g],storageKey:null}]},L]},params:{cacheID:"752d4bce509b4932d2511c656378a7bf",id:null,metadata:{},name:"MetricTimeSeriesQuery",operationKind:"query",text:`query MetricTimeSeriesQuery(
  $embeddingDimensionId: ID!
  $timeRange: TimeRange!
  $metricGranularity: Granularity!
  $countGranularity: Granularity!
  $fetchDrift: Boolean!
  $fetchQueryDistance: Boolean!
  $fetchDataQuality: Boolean!
  $dimensionId: ID!
  $fetchPerformance: Boolean!
  $performanceMetric: PerformanceMetric!
) {
  embedding: node(id: $embeddingDimensionId) {
    __typename
    id
    ... on EmbeddingDimension {
      euclideanDistanceTimeSeries: driftTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchDrift) {
        data {
          timestamp
          value
        }
      }
      retrievalMetricTimeSeries(metric: euclideanDistance, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchQueryDistance) {
        data {
          timestamp
          value
        }
      }
      trafficTimeSeries: dataQualityTimeSeries(metric: count, timeRange: $timeRange, granularity: $countGranularity) {
        data {
          timestamp
          value
        }
      }
    }
  }
  dimension: node(id: $dimensionId) @include(if: $fetchDataQuality) {
    __typename
    ... on Dimension {
      name
      dataQualityTimeSeries(metric: mean, timeRange: $timeRange, granularity: $metricGranularity) {
        data {
          timestamp
          value
        }
      }
    }
    id
  }
  model {
    performanceTimeSeries(metric: {metric: $performanceMetric}, timeRange: $timeRange, granularity: $metricGranularity) @include(if: $fetchPerformance) {
      data {
        timestamp
        value
      }
    }
  }
}
`}}})();Kk.hash="c0f9fd33875d639882a5b673d484bf3d";const Md=new Intl.NumberFormat([],{maximumFractionDigits:2}),Tk=()=>{const n=Un(),a=n.blue400,l=n.grey500;return{color:a,barColor:l}};function G4({active:n,payload:a,label:l}){var s,d,c;const{color:t,barColor:i}=Tk(),{fullTimeFormatter:r}=kn();if(n&&a&&a.length){const u=((s=a[1])==null?void 0:s.value)??null,m=((d=a[0])==null?void 0:d.value)??null,g=typeof u=="number"?Md.format(u):"--",p=typeof m=="number"?Md.format(m):"--";return o(gn,{children:[l&&e(v,{weight:"heavy",size:"S",children:`${r(new Date(l))}`}),e(_e,{color:t,name:((c=a[1])==null?void 0:c.payload.metricName)??"Metric",value:g}),e(_e,{color:i,shape:"square",name:"Count",value:p}),e(Oi,{}),o("div",{css:K`
            display: flex;
            flex-direction: row;
            align-items: center;
            color: var(--ac-global-color-primary);
            gap: var(--ac-global-dimension-static-size-50);

            margin-top: var(--ac-global-dimension-static-size-50);
          `,children:[e(x,{svg:e(Qt,{})}),e("span",{children:"Click to view the point cloud at this time"})]})]})}return null}function W4(n){switch(n.type){case"drift":return"Embedding Drift";case"performance":return"Model Performance";case"dataQuality":return"Data Quality";case"retrieval":return"Query Distance";default:Ne()}}function J4(n){if(n)switch(n.type){case"drift":return Ul(n.metric);case"performance":return Ul(n.metric);case"dataQuality":return`${n.dimension.name} avg`;case"retrieval":return Ul(n.metric);default:Ne()}else return"Count"}function Z4(n){switch(n.type){case"drift":return Ar(n.metric);case"performance":return Ar(n.metric);case"dataQuality":return null;case"retrieval":return Ar(n.metric);default:Ne()}}function X4({embeddingDimensionId:n}){const a=xe(E=>E.metric),l=a.type==="drift",t=a.type==="retrieval",i=a.type==="dataQuality",r=a.type==="performance",{timeRange:s}=ml(),{selectedTimestamp:d,setSelectedTimestamp:c}=Hi(),u=bt(s),m=T.useLazyLoadQuery(Kk,{embeddingDimensionId:n,timeRange:{start:s.start.toISOString(),end:s.end.toISOString()},metricGranularity:Dc(s),countGranularity:u,fetchDrift:l,fetchQueryDistance:t,fetchDataQuality:i,fetchPerformance:r,dimensionId:a.type==="dataQuality"?a.dimension.id:n,performanceMetric:a.type==="performance"?a.metric:"accuracyScore"}),g=St({samplingIntervalMinutes:u.samplingIntervalMinutes}),p=Y4({data:m,metric:a}),h=e9(m).reduce((E,P)=>(E[P.timestamp]=P.value,E),{})??{},k=p.map(E=>{const P=h[E.timestamp];return{...E,traffic:P,timestamp:new Date(E.timestamp).getTime()}}),S=J4(a),F=Z4(a),{color:I,barColor:L}=Tk(),M=f.useCallback(E=>{const{activeIndex:P}=E;let _;if(typeof P=="number"?_=P:typeof P=="string"&&!isNaN(Number(P))&&(_=Number(P)),typeof _=="number"&&k[_]){const D=k[_];c(new Date(D.timestamp))}},[c,k]);return o("section",{css:K`
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        h3 {
          padding: var(--ac-global-dimension-static-size-100)
            var(--ac-global-dimension-static-size-200) 0
            var(--ac-global-dimension-static-size-200);
          flex: none;
          display: flex;
          flex-direction: row;
          align-items: center;
          gap: var(--ac-global-dimension-static-size-50);
        }
        & > div {
          flex: 1 1 auto;
          width: 100%;
          overflow: hidden;
        }
      `,children:[o(Te,{level:3,children:[W4(a),F!=null?o(kt,{children:[e(Te,{level:4,children:S}),e(v,{children:F})]}):null]}),e("div",{children:e(yn,{width:"100%",height:"100%",children:o(at,{data:k,margin:{top:25,right:18,left:18,bottom:10},onClick:M,children:[o("defs",{children:[o("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:I,stopOpacity:.8}),e("stop",{offset:"95%",stopColor:I,stopOpacity:0})]}),o("linearGradient",{id:"barColor",x1:"0",y1:"0",x2:"0",y2:"1",children:[e("stop",{offset:"5%",stopColor:L,stopOpacity:.3}),e("stop",{offset:"95%",stopColor:L,stopOpacity:0})]})]}),e(vn,{...vt,tickFormatter:E=>g(new Date(E)),style:{fill:"var(--ac-global-text-color-700)"}}),e(an,{stroke:"var(--ac-global-color-grey-500)",label:{value:S,angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(an,{yAxisId:"right",orientation:"right",label:{value:"Count",angle:90,position:"insideRight",style:{textAnchor:"middle",fill:"var(--ac-global-text-color-900)"}},style:{fill:"var(--ac-global-text-color-700)"}}),e(Sn,{strokeDasharray:"4 4",stroke:"var(--ac-global-color-grey-500)",strokeOpacity:.5}),e(pn,{content:G4}),e(Ze,{yAxisId:"right",dataKey:"traffic",fill:"url(#barColor)",spacing:5}),e(jt,{type:"monotone",dataKey:"value",stroke:I,fillOpacity:1,fill:"url(#colorUv)"}),d!=null?e(Hc,{..._c,x:d.getTime(),label:e(Gc,{...Ac})}):null]})})})]})}function Y4({data:n,metric:a}){var l,t,i,r,s,d;if(((l=n.embedding.euclideanDistanceTimeSeries)==null?void 0:l.data)!=null&&n.embedding.euclideanDistanceTimeSeries.data.length>0)return n.embedding.euclideanDistanceTimeSeries.data.map(c=>({metricName:Ul(a.metric),...c}));if(((t=n.embedding.retrievalMetricTimeSeries)==null?void 0:t.data)!=null&&n.embedding.retrievalMetricTimeSeries.data.length>0)return n.embedding.retrievalMetricTimeSeries.data.map(c=>({metricName:Ul(a.metric),...c}));if(n.dimension&&((r=(i=n.dimension)==null?void 0:i.dataQualityTimeSeries)==null?void 0:r.data)!=null&&n.dimension.dataQualityTimeSeries.data.length>0){const c=n.dimension.name||"unknown";return n.dimension.dataQualityTimeSeries.data.map(u=>({metricName:`${c} avg`,...u}))}else{if(n.model&&((s=n.model.performanceTimeSeries)==null?void 0:s.data)!=null&&n.model.performanceTimeSeries.data.length>0)return n.model.performanceTimeSeries.data.map(c=>({metricName:Ul(a.metric),...c}));if(((d=n.embedding.trafficTimeSeries)==null?void 0:d.data)!=null)return n.embedding.trafficTimeSeries.data.map(c=>({metricName:"Count",...c}))}return[]}function e9(n){var a;return((a=n.embedding.trafficTimeSeries)==null?void 0:a.data)!=null?[...n.embedding.trafficTimeSeries.data]:[]}const Pk=(function(){var n={defaultValue:null,kind:"LocalArgument",name:"corpusEventIds"},a={defaultValue:null,kind:"LocalArgument",name:"primaryEventIds"},l={defaultValue:null,kind:"LocalArgument",name:"referenceEventIds"},t=[{kind:"Variable",name:"eventIds",variableName:"primaryEventIds"}],i={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},r={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},s={alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"value",storageKey:null},c={alias:null,args:null,concreteType:"EventMetadata",kind:"LinkedField",name:"eventMetadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"predictionId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"predictionScore",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualLabel",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"actualScore",storageKey:null}],storageKey:null},u={alias:null,args:null,concreteType:"PromptResponse",kind:"LinkedField",name:"promptAndResponse",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"prompt",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"response",storageKey:null}],storageKey:null},m={alias:null,args:null,kind:"ScalarField",name:"documentText",storageKey:null},g=[i,{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[r,s],storageKey:null},d],storageKey:null},c,u,m],p=[{kind:"Variable",name:"eventIds",variableName:"referenceEventIds"}],y=[{kind:"Variable",name:"eventIds",variableName:"corpusEventIds"}],h=[i,{alias:null,args:null,concreteType:"DimensionWithValue",kind:"LinkedField",name:"dimensions",plural:!0,selections:[{alias:null,args:null,concreteType:"Dimension",kind:"LinkedField",name:"dimension",plural:!1,selections:[r,s,i],storageKey:null},d],storageKey:null},c,u,m];return{fragment:{argumentDefinitions:[n,a,l],kind:"Fragment",metadata:null,name:"PointSelectionPanelContentQuery",selections:[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:t,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:g,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:p,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:g,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:y,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:g,storageKey:null}],storageKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[a,l,n],kind:"Operation",name:"PointSelectionPanelContentQuery",selections:[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"primaryInferences",plural:!1,selections:[{alias:null,args:t,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"referenceInferences",plural:!1,selections:[{alias:null,args:p,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Inferences",kind:"LinkedField",name:"corpusInferences",plural:!1,selections:[{alias:null,args:y,concreteType:"Event",kind:"LinkedField",name:"events",plural:!0,selections:h,storageKey:null}],storageKey:null}],storageKey:null}]},params:{cacheID:"12c88e562048659c9ca654fccf693fb2",id:null,metadata:{},name:"PointSelectionPanelContentQuery",operationKind:"query",text:`query PointSelectionPanelContentQuery(
  $primaryEventIds: [ID!]!
  $referenceEventIds: [ID!]!
  $corpusEventIds: [ID!]!
) {
  model {
    primaryInferences {
      events(eventIds: $primaryEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    referenceInferences {
      events(eventIds: $referenceEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
    corpusInferences {
      events(eventIds: $corpusEventIds) {
        id
        dimensions {
          dimension {
            name
            type
            id
          }
          value
        }
        eventMetadata {
          predictionId
          predictionLabel
          predictionScore
          actualLabel
          actualScore
        }
        promptAndResponse {
          prompt
          response
        }
        documentText
      }
    }
  }
}
`}}})();Pk.hash="4bd627481610322f2acbcf73dfbfaadc";const Rd=K`
  margin: var(--ac-global-dimension-static-size-200);
  display: flex;
  flex-direction: column;
  gap: var(--ac-global-dimension-static-size-100);
  & > div {
    display: flex;
    flex-direction: row;
    dt {
      font-weight: bold;
      flex: none;
      width: 130px;
    }
    dd {
      flex: 1 1 auto;
      margin-inline-start: 0;
    }
  }
`;function Vt(n){return e("div",{css:K`
        max-height: 200px;
        overflow-y: auto;
      `,children:e("pre",{css:K`
          padding: var(--ac-global-dimension-static-size-200);
          color: var(--ac-global-text-color-900);
          white-space: normal;
          margin: 0;
        `,children:n.children})})}function n9({event:n}){"use no memo";const a=n.retrievedDocuments&&n.retrievedDocuments.length>0,l=!n.id.includes("CORPUS");return o("section",{css:K`
        height: 100%;
        overflow-y: auto;
      `,children:[e(i9,{event:n}),o(ha,{defaultExpandedKeys:["prediction","document","dimensions","retrievals"],children:[l?o(We,{id:"prediction",children:[e(He,{children:"Prediction Details"}),e(Ge,{children:o("dl",{css:Rd,children:[n.predictionId!=null&&o("div",{children:[e("dt",{children:"Prediction ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]}),n.predictionLabel!=null&&o("div",{children:[e("dt",{children:"Prediction Label"}),e("dd",{children:n.predictionLabel})]}),n.predictionScore!=null&&o("div",{children:[e("dt",{children:"Prediction Score"}),e("dd",{children:n.predictionScore})]}),n.actualLabel!=null&&o("div",{children:[e("dt",{children:"Actual Label"}),e("dd",{children:n.actualLabel})]}),n.actualScore!=null&&o("div",{children:[e("dt",{children:"Actual Score"}),e("dd",{children:n.actualScore})]})]})})]}):o(We,{id:"document",children:[e(He,{children:"Document Details"}),e(Ge,{children:e("dl",{css:Rd,children:n.predictionId!=null&&o("div",{children:[e("dt",{children:"Document ID"}),e("dd",{css:K`
                        display: flex;
                        align-items: center;
                      `,children:n.predictionId})]})})})]}),o(We,{id:"dimensions",children:[e(He,{children:"Dimensions"}),e(Ge,{children:e(l9,{dimensions:n.dimensions})})]}),a&&o(We,{id:"retrievals",children:[o(He,{children:["Retrieved Documents",e(La,{children:n.retrievedDocuments.length})]}),e(Ge,{children:e("ul",{css:K`
                  padding: var(--ac-global-dimension-static-size-100);
                  li + li {
                    margin-top: var(--ac-global-dimension-static-size-100);
                  }
                `,children:n.retrievedDocuments.map(t=>e("li",{children:e(a9,{document:t})},t.id))})})]})]})]})}function a9({document:n}){return e(C,{borderRadius:"medium",backgroundColor:"light",children:o(b,{direction:"column",children:[e(C,{width:"100%",borderBottomWidth:"thin",borderBottomColor:"dark",children:o(b,{direction:"row",justifyContent:"space-between",margin:"size-100",alignItems:"center",children:[o(b,{direction:"row",gap:"size-50",alignItems:"center",children:[e(x,{svg:e(cc,{})}),o(Te,{level:4,children:["document ",n.id]})]}),typeof n.relevance=="number"&&e(nn,{color:"var(--ac-global-color-blue-1000)",children:`relevance ${el(n.relevance)}`})]})}),e("pre",{css:K`
            padding: var(--ac-global-dimension-static-size-200);
            white-space: normal;
            margin: 0;
          `,children:n.text})]})})}function l9({dimensions:n}){const a=f.useMemo(()=>n.map(i=>({name:i.dimension.name,type:i.dimension.type,value:i.value??"--"})),[n]),l=f.useMemo(()=>[{header:()=>"Name",accessorKey:"name"},{header:()=>"Type",accessorKey:"type"},{header:()=>"Value",accessorKey:"value"}],[]),t=Qe({columns:l,data:a,getCoreRowModel:Be()});return o("table",{css:Kn,children:[e("thead",{children:t.getHeaderGroups().map(i=>e("tr",{children:i.headers.map(r=>e("th",{colSpan:r.colSpan,children:r.isPlaceholder?null:e("div",{children:de(r.column.columnDef.header,r.getContext())})},r.id))},i.id))}),t.getCoreRowModel().rows.length?e("tbody",{children:t.getRowModel().rows.map(i=>e("tr",{children:i.getVisibleCells().map(r=>e("td",{children:de(r.column.columnDef.cell,r.getContext())},r.id))},i.id))}):e(r9,{})]})}function t9({dataUrl:n}){const a=nS(n),l=aS(n);return a?e("video",{src:n,controls:!0,css:K`
          width: 100%;
          height: 500px;
          background-color: black;
        `}):l?e("audio",{src:n,controls:!0,autoPlay:!0}):e("img",{src:n,alt:"event image",width:"100%",height:"200px",css:K`
        object-fit: contain;
        background-color: black;
      `})}function i9({event:n}){const a=n.linkToData||void 0,l=n.rawData,t=n.prompt||n.response?{prompt:n.prompt,response:n.response}:null,i=n.documentText;let r=null;return a?r=o(b,{direction:"column",children:[e(t9,{dataUrl:a}),l&&o(We,{id:"raw",children:[e(He,{children:"Raw Data"}),e(Ge,{children:e(Vt,{children:l})})]})]}):i?r=o(We,{id:"document",children:[e(He,{children:"Document"}),e(Ge,{children:e(Vt,{children:i})})]}):t?r=o(ha,{defaultExpandedKeys:["prompt","response"],children:[o(We,{id:"prompt",children:[e(He,{children:"Prompt"}),e(Ge,{children:e(Vt,{children:t.prompt})})]}),o(We,{id:"response",children:[e(He,{children:"Response"}),e(Ge,{children:e(Vt,{children:t.response})})]})]}):n.rawData&&(r=e(Vt,{children:n.rawData})),r}function r9(){return e("tbody",{className:"is-empty",children:e("tr",{children:e("td",{colSpan:100,css:K`
            text-align: center;
            padding: var(--ac-global-dimension-size-300)
              var(--ac-global-dimension-size-300) !important;
          `,children:e(Ti,{message:"This embedding has no associated dimensions"})})})})}const Ik=(function(){var n=[{alias:null,args:null,concreteType:"InferenceModel",kind:"LinkedField",name:"model",plural:!1,selections:[{alias:null,args:null,concreteType:"ExportedFile",kind:"LinkedField",name:"exportedFiles",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ExportSelectionButtonExportsQuery",selections:n,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"ExportSelectionButtonExportsQuery",selections:n},params:{cacheID:"2f7e3554305121746dc799b6a8d120da",id:null,metadata:{},name:"ExportSelectionButtonExportsQuery",operationKind:"query",text:`query ExportSelectionButtonExportsQuery {
  model {
    exportedFiles {
      fileName
    }
  }
}
`}}})();Ik.hash="7e6db431afe21f137e54505645c787f4";const xk=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"eventIds"}],a=[{alias:null,args:[{kind:"Variable",name:"eventIds",variableName:"eventIds"}],concreteType:"ExportedFile",kind:"LinkedField",name:"exportEvents",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"fileName",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"ExportSelectionButtonMutation",selections:a,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"ExportSelectionButtonMutation",selections:a},params:{cacheID:"d370df04ca30a5059288c7aa298239a8",id:null,metadata:{},name:"ExportSelectionButtonMutation",operationKind:"mutation",text:`mutation ExportSelectionButtonMutation(
  $eventIds: [ID!]!
) {
  exportEvents(eventIds: $eventIds) {
    fileName
  }
}
`}}})();xk.hash="8b0d6962e2034d4c148d1b9919111d2f";const s9=`import phoenix as px

exports = px.active_session().exports
dataframe = exports[-1]
dataframe`,o9=K`
  .cm-content {
    padding: var(--ac-global-dimension-static-size-100);
  }
`;function d9({value:n}){const{theme:a}=ia(),l=a==="light"?Ml:Rl;return e(Vl,{value:n,basicSetup:!1,extensions:[Yt()],editable:!1,theme:l,css:o9})}function c9(){const n=xe(u=>u.selectedEventIds),[a,l]=T.useMutation(xk),[t,i]=f.useState(null),[r,s]=f.useState(!1),d=f.useCallback(()=>{a({variables:{eventIds:[...n]},onCompleted:u=>{i(u.exportEvents),s(!0)}})},[a,n]);return o(te,{children:[e(R,{size:"S",leadingVisual:e(x,{svg:l?e(ta,{}):e(Ui,{})}),"aria-label":"Export selection / cluster",isDisabled:l,onPress:d,children:l?"Exporting":"Export"}),e(se,{isOpen:r&&t!==null,onOpenChange:u=>{s(u),!u&&!t&&i(null)},children:e(oe,{isDismissable:!0,children:e(ae,{variant:"slideover",size:"M",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Cluster Exports"}),e(ke,{children:e(be,{})})]}),t&&o(te,{children:[e(Ee,{variant:"success",banner:!0,title:"Export succeeded",extra:e(R,{variant:"success",size:"S",onPress:()=>{window.open(`/exports?filename=${t.fileName}`,"_self")},children:"Download"})}),o("div",{css:K`
                        display: flex;
                        flex-direction: column;
                        justify-content: space-between;
                        align-items: flex-start;
                        padding: 16px;
                        gap: 16px;
                      `,children:[e("p",{css:K`
                          margin: 0;
                          flex: 1 1 auto;
                        `,children:"You can retrieve your export in your notebook via"}),e(C,{borderColor:"light",borderWidth:"thin",borderRadius:"medium",children:e(d9,{value:s9})})]}),e(ha,{defaultExpandedKeys:["all-exports"],children:o(We,{id:"all-exports",children:[e(He,{children:"Latest Exports"}),e(Ge,{children:e(f.Suspense,{fallback:e(me,{}),children:e(u9,{})})})]})})]})]})})})})})]})}function u9(){const n=T.useLazyLoadQuery(Ik,{},{fetchPolicy:"network-only"});return e(os,{children:n.model.exportedFiles.map((a,l)=>e(ss,{children:o("div",{css:K`
              display: flex;
              flex-direction: row;
              justify-content: space-between;
              align-items: center;
            `,children:[a.fileName,e(R,{size:"S","aria-label":"Download",variant:"default",leadingVisual:e(x,{svg:e(Ui,{})}),onPress:()=>{window.open(`/exports?filename=${a.fileName}`,"_self")}})]})},l))})}function m9(n){const{getInferencesNameByRole:a}=Ua(),{events:l,onItemSelected:t}=n,i=xe(u=>u.eventIdToDataMap),r=xe(u=>u.eventIdToGroup),s=xe(u=>u.pointGroupColors),d=xe(u=>u.selectionGridSize),c=xe(u=>u.setHoveredEventId);return e("div",{css:K`
        flex: 1 1 auto;
        overflow-y: auto;
      `,"data-testid":"grid-view-scroll-container",children:e("ul",{"data-grid-size":d,css:K`
          &[data-grid-size="small"] {
            --grid-item-min-width: 100px;
            --grid-item-height: 100px;
          }
          &[data-grid-size="medium"] {
            --grid-item-min-width: 200px;
            --grid-item-height: 200px;
          }
          &[data-grid-size="large"] {
            --grid-item-min-width: 300px;
            --grid-item-height: 200px;
          }
          padding: var(--ac-global-dimension-static-size-200);
          transition: all 0.2s ease-in-out;
          display: grid;
          grid-template-columns: repeat(
            auto-fill,
            minmax(var(--grid-item-min-width), 1fr)
          );
          flex-wrap: wrap;
          gap: var(--ac-global-dimension-static-size-200);
          & > li {
            min-width: var(--grid-item-min-width);
            height: var(--grid-item-height);
          }
        `,children:l.map((u,m)=>{const g=i.get(u.id),{rawData:p=null,linkToData:y=null}=(g==null?void 0:g.embeddingMetadata)??{},{predictionLabel:h=null,actualLabel:k=null}=(g==null?void 0:g.eventMetadata)??{},S=lS(u.id),F=a(S),I=r[u.id],L=s[I];return e("li",{children:e(tS,{rawData:p,linkToData:y,inferencesName:F,group:I,onClick:()=>{t(u.id)},onMouseOver:()=>{c(u.id)},onMouseOut:()=>{c(null)},color:L,size:d,predictionLabel:h,actualLabel:k,promptAndResponse:u.promptAndResponse,documentText:u.documentText,autoPlay:!1})},m)})})})}function g9({data:n,onPointSelected:a}){"use no memo";const{primaryInferences:l,referenceInferences:t}=Ua(),i=xe(m=>m.metric),[r,s]=f.useState([]),{columns:d,tableData:c}=f.useMemo(()=>{const m=n.filter(L=>L.id.includes("CORPUS")===!1);let g=!1,p=!1,y=!1,h=!1,k=!1;n.forEach(L=>{L.linkToData&&(g=!0),L.rawData&&(p=!0),(L.prompt||L.response)&&(y=!0),L.predictionLabel&&(h=!0),L.actualLabel&&(k=!0)});const S=[];t&&S.push({header:"Inference Set",accessorKey:"id",size:50,cell:({getValue:L})=>e(p9,{id:L(),primaryInferencesName:l.name,referenceInferencesName:(t==null?void 0:t.name)??"reference"})}),g&&S.push({header:"Link",accessorKey:"linkToData",cell:({getValue:L})=>{const M=L();if(typeof M=="string"){const E=M.split("/").pop();return e(tl,{href:M,children:E})}return null}}),y?(S.push({header:"Prompt",accessorKey:"prompt",cell:In,size:200}),S.push({header:"Response",accessorKey:"response",cell:In,size:200})):p&&S.push({header:"Raw Data",accessorKey:"rawData"}),h&&S.push({header:"Prediction Label",accessorKey:"predictionLabel",size:50}),k&&S.push({header:"Actual Label",accessorKey:"actualLabel",size:50});const F=[];if(i&&i.type==="dataQuality"){const L=i.dimension.name;F.push({header:i.dimension.name,accessorKey:"metric",cell:iS,sortingFn:"basic"}),m.forEach(M=>{var P;const E=(P=M.dimensions.find(_=>_.dimension.name===L))==null?void 0:P.value;M.metric=E!=null?Number(E):null})}return{columns:[...S,...F,{header:"",id:"view-details",size:50,cell:({row:L})=>e(R,{"aria-label":"view point details",size:"S",onPress:()=>{a(L.original.id)},children:"view details"})}],tableData:m}},[n,a,l,t,i]),u=Qe({columns:d,data:c,state:{sorting:r},getCoreRowModel:Be(),onSortingChange:s,getSortedRowModel:Vn()});return o("table",{css:Kn,children:[e("thead",{children:u.getHeaderGroups().map(m=>e("tr",{children:m.headers.map(g=>o("th",{children:[g.isPlaceholder?null:o("div",{className:g.column.getCanSort()?"sort":"",onClick:g.column.getToggleSortingHandler(),children:[de(g.column.columnDef.header,g.getContext()),g.column.getIsSorted()?e(x,{className:"sort-icon",svg:g.column.getIsSorted()==="asc"?e(Ln,{}):e(xn,{})}):null]}),e("div",{onMouseDown:g.getResizeHandler(),onTouchStart:g.getResizeHandler(),className:`resizer ${g.column.getIsResizing()?"isResizing":""}`,style:{transform:g.column.getIsResizing()?`translateX(${u.getState().columnSizingInfo.deltaOffset}px)`:""}})]},g.id))},m.id))}),e("tbody",{children:u.getRowModel().rows.map(m=>e("tr",{children:m.getVisibleCells().map(g=>e("td",{style:{width:g.column.getSize()},children:de(g.column.columnDef.cell,g.getContext())},g.id))},m.id))})]})}function p9({id:n,primaryInferencesName:a,referenceInferencesName:l}){const t=n.includes("PRIMARY"),i=O4();return o(b,{direction:"row",gap:"size-100",alignItems:"center",children:[e(sS,{shape:rS.circle,color:i[t?0:1]}),t?a:l]})}const y9=K`
  width: 100%;
  height: 100%;
  position: relative;
  display: flex;
  flex-direction: column;
  /* Give spacing for the close icon */
  & > .ac-tabs {
    padding-top: 17px;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    [role="tablist"] {
      flex: none;
    }
    .ac-tabs__pane-container {
      display: flex;
      flex-direction: column;
      flex: 1 1 auto;
      overflow: hidden;
      [role="tabpanel"] {
        display: flex;
        flex-direction: column;
        flex: 1 1 auto;
        overflow: hidden;
      }
    }
  }
`;function f9({event:n,relevance:a}){return{id:n.eventMetadata.predictionId||"unknown id",text:n.documentText??"empty document",relevance:a}}function h9(){const n=xe(P=>P.selectedEventIds),a=xe(P=>P.setSelectedEventIds),l=xe(P=>P.setSelectedClusterId),t=xe(P=>P.selectionDisplay),[i,r]=f.useState(null),{primaryEventIds:s,referenceEventIds:d,corpusEventIds:c}=f.useMemo(()=>{const P=[],_=[],D=[];return n.forEach(A=>{A.includes("PRIMARY")?P.push(A):A.includes("CORPUS")?D.push(A):_.push(A)}),{primaryEventIds:P,referenceEventIds:_,corpusEventIds:D}},[n]),u=T.useLazyLoadQuery(Pk,{primaryEventIds:[...s],referenceEventIds:[...d],corpusEventIds:[...c]}),m=f.useMemo(()=>{var A,V,j,ce,W,Pe;const P=((V=(A=u.model)==null?void 0:A.primaryInferences)==null?void 0:V.events)??[],_=((ce=(j=u.model)==null?void 0:j.referenceInferences)==null?void 0:ce.events)??[],D=((Pe=(W=u.model)==null?void 0:W.corpusInferences)==null?void 0:Pe.events)??[];return[...P,..._,...D]},[u]),g=()=>{a(new Set),l(null)},p=xe(P=>P.eventIdToDataMap),y=xe(P=>P.pointData),h=xe(P=>P.selectionSearchText),k=f.useMemo(()=>m.map(P=>{var A,V,j,ce,W,Pe,ne;const _=p.get(P.id),D=[];return y!=null&&(_==null?void 0:_.retrievals)!=null&&_.retrievals.forEach(({documentId:N,relevance:B})=>{const Q=y[N];Q!=null&&D.push(f9({event:Q,relevance:B}))}),{id:P.id,predictionId:((A=P.eventMetadata)==null?void 0:A.predictionId)??null,actualLabel:((V=P.eventMetadata)==null?void 0:V.actualLabel)??null,actualScore:((j=P.eventMetadata)==null?void 0:j.actualScore)??null,predictionLabel:((ce=P.eventMetadata)==null?void 0:ce.predictionLabel)??null,predictionScore:((W=P.eventMetadata)==null?void 0:W.predictionScore)??null,rawData:(_==null?void 0:_.embeddingMetadata.rawData)??null,linkToData:(_==null?void 0:_.embeddingMetadata.linkToData)??null,dimensions:P.dimensions,prompt:((Pe=P.promptAndResponse)==null?void 0:Pe.prompt)??null,response:((ne=P.promptAndResponse)==null?void 0:ne.response)??null,retrievedDocuments:D,documentText:P.documentText??null}}),[m,p,y]),S=f.useMemo(()=>{if(h){const P=h.toLowerCase();return k.filter(_=>{var D,A,V,j;return _.id.includes(P)||((D=_.documentText)==null?void 0:D.toLowerCase().includes(P))||((A=_.predictionId)==null?void 0:A.includes(P))||((V=_.prompt)==null?void 0:V.toLowerCase().includes(P))||((j=_.response)==null?void 0:j.toLowerCase().includes(P))})}return k},[k,h]),F=f.useMemo(()=>{if(h){const P=h.toLowerCase();return m.filter(_=>{var D,A,V,j,ce,W,Pe;return _.id.includes(P)||((D=_.documentText)==null?void 0:D.toLowerCase().includes(P))||((V=(A=_.eventMetadata)==null?void 0:A.predictionId)==null?void 0:V.includes(P))||((ce=(j=_.promptAndResponse)==null?void 0:j.prompt)==null?void 0:ce.toLowerCase().includes(P))||((Pe=(W=_.promptAndResponse)==null?void 0:W.response)==null?void 0:Pe.toLowerCase().includes(P))})}return m},[m,h]),I=f.useMemo(()=>i?k.find(_=>_.id===i)??null:null,[k,i]),L=m.length,M=F.length,E=P=>{P||r(null)};return o("section",{css:y9,children:[o("div",{role:"toolbar",css:K`
          position: absolute;
          top: var(--ac-global-dimension-static-size-100);
          right: var(--ac-global-dimension-static-size-200);
          display: flex;
          flex-direction: row-reverse;
          gap: var(--ac-global-dimension-static-size-100);
        `,children:[e(R,{size:"S",leadingVisual:e(x,{svg:e(mt,{})}),"aria-label":"Clear selection",onPress:g}),e(c9,{})]}),o(jn,{children:[e(On,{children:e(ve,{id:"selection",children:"Selection"})}),o(ua,{id:"selection",children:[e(k9,{numSelectedEvents:L,numMatchingEvents:M,searchText:h}),t===wc.list?e("div",{css:K`
                flex: 1 1 auto;
                overflow-y: auto;
              `,children:e(g9,{data:S,onPointSelected:r})}):e(m9,{events:F,onItemSelected:r})]})]}),e(se,{isOpen:I!==null,onOpenChange:E,children:e(oe,{children:e(ae,{variant:"slideover",size:"L",children:e(re,{children:o(ye,{children:[o(fe,{children:[e(he,{children:"Embedding Details"}),e(ke,{children:e(be,{})})]}),I&&e(n9,{event:I})]})})})})})]})}function k9({numSelectedEvents:n,numMatchingEvents:a,searchText:l}){const t=xe(u=>u.selectionDisplay),i=xe(u=>u.setSelectionDisplay),r=xe(u=>u.selectionGridSize),s=xe(u=>u.setSelectionGridSize),d=xe(u=>u.setSelectionSearchText),c=f.useMemo(()=>l?`${a}/${n} match "${l}"`:`${n} selected`,[n,a,l]);return e(xs,{extra:o("div",{css:K`
            display: flex;
            flex-direction: row;
            gap: var(--ac-global-dimension-static-size-100);
          `,children:[e(st,{size:"S",onChange:u=>{d(u)},children:e(ge,{placeholder:"Search by text or ID"})}),t===wc.gallery&&e(oS,{size:r,onChange:s}),e(dS,{mode:t,onChange:u=>{i(u)}})]}),children:e(v,{children:c})})}const Lk=vk;function b9(){const{referenceInferences:n,corpusInferences:a}=Ua(),{timeRange:l}=ml(),t=f.useMemo(()=>{let i={};return a!=null?i=cS():n!=null?i=uS():i=mS(),i={...i,umapParameters:{...window.Config.UMAP}},i},[a,n]);return e(Ec,{initialTimestamp:l.end,children:e(gS,{...t,children:e(S9,{})})})}function S9(){const n=j4(),{primaryInferences:a,referenceInferences:l}=Ua(),t=xe(F=>F.umapParameters),i=xe(F=>F.getHDSCANParameters),r=xe(F=>F.getMetric),s=xe(F=>F.reset),d=xe(F=>F.setLoading),[c,u]=f.useState(!0),[m,g,p]=T.useQueryLoader(Lk),{selectedTimestamp:y}=Hi(),h=f.useMemo(()=>y??new Date(a.endTime),[y,a.endTime]),k=f.useMemo(()=>({start:Bc(h,2).toISOString(),end:h.toISOString()}),[h]),S=T.useLazyLoadQuery(Sk,{});return f.useEffect(()=>{s(),d(!0);const F=r();return g({id:n,timeRange:k,...t,...i(),fetchDataQualityMetric:F.type==="dataQuality",fetchPerformanceMetric:F.type==="performance",dataQualityMetricColumnName:F.type==="dataQuality"?F.dimension.name:null,performanceMetric:F.type==="performance"?F.metric:"accuracyScore"},{fetchPolicy:"network-only"}),()=>{p()}},[d,s,n,g,p,t,i,r,k]),o("main",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      `,children:[e(I9,{}),o(xs,{extra:e(Il,{onChange:F=>{u(F)},isSelected:c,labelPlacement:"start",children:"Show Timeseries"}),children:[e(Ic,{}),l?e(xc,{inferencesRole:"reference",timeRange:{start:new Date(l.startTime),end:new Date(l.endTime)}}):null,e(H4,{model:S.model})]}),o($a,{direction:"vertical",children:[c?o(te,{children:[e(An,{defaultSize:20,collapsible:!0,order:1,children:e(f.Suspense,{fallback:e(me,{}),children:e(X4,{embeddingDimensionId:n})})}),e(sl,{css:Bt})]}):null,e(An,{order:2,children:e("div",{css:K`
              width: 100%;
              height: 100%;
              position: relative;
            `,children:e(f.Suspense,{fallback:e(pS,{}),children:m?e(F9,{queryReference:m}):null})})})]})]})}function v9(n){if(n.__typename!=="Point3D")throw new Error(`Expected Point3D but got ${n.__typename} for coordinates`);return[n.x,n.y,n.z]}function F9({queryReference:n}){const a=T.usePreloadedQuery(Lk,n),l=f.useMemo(()=>{var u,m;return((m=(u=a.embedding)==null?void 0:u.UMAPPoints)==null?void 0:m.data)??[]},[a]),t=f.useMemo(()=>{var u,m;return((m=(u=a.embedding)==null?void 0:u.UMAPPoints)==null?void 0:m.referenceData)??[]},[a]),i=f.useMemo(()=>{var u,m;return((m=(u=a.embedding)==null?void 0:u.UMAPPoints)==null?void 0:m.corpusData)??[]},[a]),r=f.useMemo(()=>{var u,m;return((m=(u=a.embedding)==null?void 0:u.UMAPPoints)==null?void 0:m.contextRetrievals)??[]},[a]),s=f.useMemo(()=>[...l,...t,...i].map(m=>({...m,position:v9(m.coordinates),metaData:{id:m.eventId}})),[t,l,i]),d=xe(u=>u.setInitialData),c=xe(u=>u.setClusters);return ZS(()=>{var m,g;const u=((g=(m=a.embedding)==null?void 0:m.UMAPPoints)==null?void 0:g.clusters)||[];d({points:s,clusters:u,retrievals:r})},[s,n,r,d,c]),e("div",{css:K`
        flex: 1 1 auto;
        display: flex;
        flex-direction: row;
        align-items: stretch;
        width: 100%;
        height: 100%;
      `,"data-testid":"point-cloud-display",children:o($a,{direction:"horizontal",children:[e(An,{id:"embedding-left",defaultSize:15,maxSize:30,minSize:10,collapsible:!0,children:o($a,{autoSaveId:"embedding-controls-vertical",direction:"vertical",children:[e(An,{css:K`
                display: flex;
                flex-direction: column;
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  display: flex;
                  flex-direction: column;
                  [role="tablist"] {
                    flex: none;
                  }
                  .ac-tabs__pane-container {
                    flex: 1 1 auto;
                    overflow: hidden;
                    display: flex;
                    flex-direction: column;
                    & > div {
                      height: 100%;
                    }
                  }
                }
              `,children:e(T9,{})}),e(sl,{css:Bt}),e(An,{css:K`
                .ac-tabs {
                  height: 100%;
                  overflow: hidden;
                  .ac-tabs__pane-container {
                    height: 100%;
                    overflow-y: auto;
                  }
                }
              `,children:o(jn,{children:[o(On,{children:[e(ve,{id:"display",children:"Display"}),e(ve,{id:"hyperparameters",children:"Hyperparameters"})]}),e(ua,{id:"display",children:e(yS,{})}),e(ua,{id:"hyperparameters",children:e(fS,{})})]})})]})}),e(sl,{css:Qi}),e(An,{children:o("div",{css:K`
              position: relative;
              width: 100%;
              height: 100%;
            `,children:[e(C9,{}),e(hS,{})]})})]})})}function C9(){return xe(a=>a.selectedEventIds).size===0?null:e("div",{css:K`
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      `,"data-testid":"selection-panel",children:o($a,{direction:"vertical",children:[e(An,{}),e(sl,{css:Bt,style:{zIndex:1}}),e(An,{id:"embedding-point-selection",defaultSize:40,minSize:20,order:2,style:{zIndex:1},children:e(K9,{children:e(f.Suspense,{fallback:e(me,{}),children:e(h9,{})})})})]})})}function K9(n){return e("div",{css:K`
        background-color: var(--ac-global-color-grey-75);
        width: 100%;
        height: 100%;
      `,children:n.children})}const T9=f.memo(function(){const{referenceInferences:a}=Ua(),l=xe(g=>g.clusters),t=xe(g=>g.selectedClusterId),i=xe(g=>g.metric),r=xe(g=>g.setSelectedClusterId),s=xe(g=>g.setSelectedEventIds),d=xe(g=>g.setHighlightedClusterId),c=xe(g=>g.setClusterColorMode),u=a==null||i.type==="drift",m=f.useCallback(g=>{c(g==="configuration"?Vo.highlight:Vo.default)},[c]);return o(jn,{onSelectionChange:g=>m(g),children:[o(On,{children:[o(ve,{id:"clusters",children:["Clusters ",e(La,{children:l.length})]}),e(ve,{id:"configuration",children:"Configuration"})]}),e(ua,{id:"clusters",children:o(b,{direction:"column",height:"100%",children:[e(C,{borderBottomColor:"dark",borderBottomWidth:"thin",backgroundColor:"dark",flex:"none",padding:"size-50",children:e(b,{direction:"row",justifyContent:"end",children:e(Q4,{})})}),e(C,{flex:"1 1 auto",overflow:"auto",children:e("ul",{css:K`
                flex: 1 1 auto;
                display: flex;
                flex-direction: column;
                gap: var(--ac-global-dimension-size-100);
                margin: var(--ac-global-dimension-size-100);
              `,children:l.map(g=>e("li",{children:e(kS,{clusterId:g.id,numPoints:g.eventIds.length,isSelected:t===g.id,driftRatio:g.driftRatio,primaryToCorpusRatio:g.primaryToCorpusRatio,primaryMetricValue:g.primaryMetricValue,referenceMetricValue:g.referenceMetricValue,metricName:P9(i),hideReference:u,onClick:()=>{t!==g.id?(r(g.id),s(new Set(g.eventIds))):(r(null),s(new Set))},onMouseEnter:()=>{d(g.id)},onMouseLeave:()=>{d(null)}})},g.id))})})]})}),e(ua,{id:"configuration",children:e(C,{overflow:"auto",height:"100%",children:e(bS,{})})})]})});function P9(n){const{type:a,metric:l}=n;switch(a){case"dataQuality":return`${n.dimension.name} avg`;case"drift":{switch(l){case"euclideanDistance":return"Cluster Drift";default:Ne()}break}case"performance":return Ul(l);case"retrieval":{switch(l){case"queryDistance":return"% Query";default:Ne()}break}default:Ne()}}function I9(){const n=Ve(),a=xe(t=>t.errorMessage),l=xe(t=>t.setErrorMessage);return f.useEffect(()=>{a!==null&&n({title:"An error occurred",message:a,action:{text:"Dismiss",onClick:()=>{l(null)}}})},[a,n,l]),null}const Dk=(function(){var n=[{defaultValue:null,kind:"LocalArgument",name:"id"}],a=[{kind:"Variable",name:"id",variableName:"id"}],l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},t={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null};return{fragment:{argumentDefinitions:n,kind:"Fragment",metadata:null,name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[l,t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"embeddingLoaderQuery",selections:[{alias:"embedding",args:a,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l,{kind:"InlineFragment",selections:[t],type:"EmbeddingDimension",abstractKey:null}],storageKey:null}]},params:{cacheID:"6f34962d234c6eb9fc0812628dd9a905",id:null,metadata:{},name:"embeddingLoaderQuery",operationKind:"query",text:`query embeddingLoaderQuery(
  $id: ID!
) {
  embedding: node(id: $id) {
    __typename
    ... on EmbeddingDimension {
      id
      name
    }
    id
  }
}
`}}})();Dk.hash="96d029150ec0c7e5419c2efa0ee67fc5";async function x9(n){const{embeddingDimensionId:a}=n.params;return T.fetchQuery(ze,Dk,{id:a}).toPromise()}const rD=Object.freeze(Object.defineProperty({__proto__:null,EmbeddingPage:b9,embeddingLoader:x9},Symbol.toStringTag,{value:"Module"}));export{Y5 as $,l5 as A,w5 as B,_5 as C,I5 as D,M5 as E,q5 as F,D5 as G,R9 as H,x5 as I,R5 as J,G5 as K,O5 as L,J5 as M,W5 as N,Z5 as O,H5 as P,X5 as Q,j5 as R,iT as S,i5 as T,Y9 as U,e5 as V,c5 as W,d5 as X,o5 as Y,u5 as Z,X9 as _,lT as a,n5 as a0,a5 as a1,s5 as a2,$5 as a3,aD as a4,q9 as a5,U9 as a6,$9 as a7,z9 as a8,H9 as a9,G9 as aa,z5 as ab,O9 as ac,j9 as ad,Q9 as ae,B9 as af,N9 as ag,N5 as ah,V5 as ai,g5 as aj,K5 as ak,p5 as al,m5 as am,W9 as an,eD as ao,V9 as ap,M9 as aq,E9 as ar,w9 as as,lD as at,tD as au,iD as av,rD as aw,tT as b,Ci as c,t5 as d,U5 as e,Q5 as f,nD as g,f5 as h,P5 as i,h5 as j,v5 as k,S5 as l,r5 as m,b5 as n,J9 as o,F5 as p,C5 as q,B5 as r,y5 as s,k5 as t,O4 as u,Z9 as v,T5 as w,L5 as x,E5 as y,A5 as z};
